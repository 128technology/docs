<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Unable to bind accelerated networking interfaces in Azure when using vmbus-id | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/kb/2024/04/25/I95-54541"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Unable to bind accelerated networking interfaces in Azure when using vmbus-id | SSN Docs"><meta data-rh="true" name="description" content="Recent changes to fix MTU to use the max device supported value causes the SSR to set MTU to 9K. However since NetVSC does not support Scatter RX, it fails to bind because the SSR uses packet buffers of size 2K, and cannot span multiple mbufs."><meta data-rh="true" property="og:description" content="Recent changes to fix MTU to use the max device supported value causes the SSR to set MTU to 9K. However since NetVSC does not support Scatter RX, it fails to bind because the SSR uses packet buffers of size 2K, and cannot span multiple mbufs."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-04-25T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="6.1,6.1.5"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/kb/2024/04/25/I95-54541"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/kb/2024/04/25/I95-54541" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/kb/2024/04/25/I95-54541" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/kb/rss.xml" title="SSR Knowledge Base Articles RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/kb/atom.xml" title="SSR Knowledge Base Articles Atom Feed">
<link rel="alternate" type="application/json" href="/kb/feed.json" title="SSR Knowledge Base Articles JSON Feed"><link rel="stylesheet" href="/assets/css/styles.b50a304b.css">
<script src="/assets/js/runtime~main.a950bc09.js" defer="defer"></script>
<script src="/assets/js/main.6a47f0e3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/kb">Knowledge Base</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><main class="col col--9 col--offset-1" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Recent changes to fix MTU to use the max device supported value causes the SSR to set MTU to 9K. However since NetVSC does not support Scatter RX, it fails to bind because the SSR uses packet buffers of size 2K, and cannot span multiple mbufs."><header><h1 class="title_f1Hy" itemprop="headline">Unable to bind accelerated networking interfaces in Azure when using vmbus-id</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-04-25T00:00:00.000Z" itemprop="datePublished">April 25, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Recent changes to fix MTU to use the max device supported value causes the SSR to set MTU to 9K. However since NetVSC does not support Scatter RX, it fails to bind because the SSR uses packet buffers of size 2K, and cannot span multiple mbufs.</p>
<p><strong>Issue ID:</strong> I95-54541<br>
<strong>Last Updated:</strong> 2024-04-25<br>
<strong>Introduced in SSR Version:</strong> 6.1.5</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem">Problem<a href="#problem" class="hash-link" aria-label="Direct link to Problem" title="Direct link to Problem">​</a></h3>
<p>NetVSC does not support Scatter RX, so with new changes to use 9K max RX, it is unable to span multipe 2K packet buffers. When matched with MLX in accelerated networking, the MLX device fails to initialize.
During device configuration, user specified MTU exceeding 2K will cause init failure for that device interface.</p>
<p>Limit the MTU (also max RX size in DPDK) of NetVSC devices to SSR packet buffer size.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-notes">Release Notes<a href="#release-notes" class="hash-link" aria-label="Direct link to Release Notes" title="Direct link to Release Notes">​</a></h3>
<p>Fixes an issue where device-interfaces configured in Azure VM would fail during initialization and port remains operationally down.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="severity">Severity<a href="#severity" class="hash-link" aria-label="Direct link to Severity" title="Direct link to Severity">​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Details</summary><div><div class="collapsibleContent_i85q"><p>The potential impact of a software defect if encountered. Severity levels are:</p><ul>
<li>Critical: Could severely affect service, capacity/traffic, and maintenance capabilities. May have a prolonged impact to the entire system.</li>
<li>Major: Could seriously affect system operation, maintenance, administration and related tasks.</li>
<li>Minor: Would not significantly impair the functioning or affect service.</li>
</ul></div></div></details>
<p>Major</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="status">Status<a href="#status" class="hash-link" aria-label="Direct link to Status" title="Direct link to Status">​</a></h3>
<p>Closed</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="resolved-in">Resolved In<a href="#resolved-in" class="hash-link" aria-label="Direct link to Resolved In" title="Direct link to Resolved In">​</a></h3>
<p><a href="/docs/release_notes_128t_6.1#release-618-15">6.1.8</a>,
<a href="/docs/release_notes_128t_6.2#release-624-14r2">6.2.4</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="product">Product<a href="#product" class="hash-link" aria-label="Direct link to Product" title="Direct link to Product">​</a></h3>
<p>Azure SSR AMI</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functional-area">Functional Area<a href="#functional-area" class="hash-link" aria-label="Direct link to Functional Area" title="Direct link to Functional Area">​</a></h3>
<p>Interface Binding</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="workaround">Workaround<a href="#workaround" class="hash-link" aria-label="Direct link to Workaround" title="Direct link to Workaround">​</a></h3>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Details</summary><div><div class="collapsibleContent_i85q"><p>Juniper may provide a method to temporarily circumvent a problem; workarounds do not exist for all issues.</p></div></div></details>
<p>Disable the accelerated networking to allow the device to be bound via PCLI address instead of vmbus-id.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/kb/tags/6-1">6.1</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/kb/tags/6-1-5">6.1.5</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/kb/2024/04/25/I95-56233"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Packet forwarding stops in AWS after several hours</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/kb/2024/04/25/I95-56437"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Application Identification incompatible with DSCP Steering</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#problem" class="table-of-contents__link toc-highlight">Problem</a></li><li><a href="#release-notes" class="table-of-contents__link toc-highlight">Release Notes</a></li><li><a href="#severity" class="table-of-contents__link toc-highlight">Severity</a></li><li><a href="#status" class="table-of-contents__link toc-highlight">Status</a></li><li><a href="#resolved-in" class="table-of-contents__link toc-highlight">Resolved In</a></li><li><a href="#product" class="table-of-contents__link toc-highlight">Product</a></li><li><a href="#functional-area" class="table-of-contents__link toc-highlight">Functional Area</a></li><li><a href="#workaround" class="table-of-contents__link toc-highlight">Workaround</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Juniper Networks, Inc.</div></div></div></footer></div>
</body>
</html>
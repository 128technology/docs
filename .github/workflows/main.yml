# .github/workflows/deploy.yml

 name: github pages

 on:
   push:
     branches:
       - master
     paths:
      - .github/workflows/main.yml
   pull_request:
     branches:
       - master
 env:
   WORKDIR: build
  
 jobs:
   deploy:
     runs-on: ubuntu-latest
     defaults:
       run:
         working-directory: build
     strategy:
       matrix:
         node-version: [12.x]
     steps:
       - uses: actions/checkout@v2

       - name: Setup Node ${{ matrix.node-version }}
         uses: actions/setup-node@v1
         with:
           node-version: ${{ matrix.node-version }}
        
       - name: Cache Node.js modules
         uses: actions/cache@v2
         with:
           # npm cache files are stored in `~/.npm` on Linux/macOS
           path: ~/.npm 
           key: ${{ runner.OS }}-node-${{ hashFiles('**/package-lock.json') }}
           restore-keys: |
             ${{ runner.OS }}-node-
             ${{ runner.OS }}-
       - name: Install dependencies
         run: npm ci

       - name: Build
         run: npm run build
       
       #- name: Test
       #  run: npm run check-links

       #- name: Broken Link Checker Action
       #  uses: gaurav-nelson/github-action-markdown-link-check@v1
       #  with:
       #    use-verbose-mode: 'yes'
       #    folder-path: 'docs'
           # check-modified-files-only: 'yes'

       - name: Deploy
         uses: peaceiris/actions-gh-pages@v3.7.3
         with:
           github_token: ${{ secrets.GITHUB_TOKEN }}
           publish_dir: ./${{ env.WORKDIR }}/build

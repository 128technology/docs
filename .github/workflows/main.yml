# .github/workflows/deploy.yml

 name: github pages

 on:
   push:
     branches:
       - master
   pull_request:
     branches:
       - master

 jobs:
   deploy:
     runs-on: ubuntu-latest
     strategy:
       matrix:
         node-version: [12.x]
     steps:
       - uses: actions/checkout@v2

       - name: Setup Node ${{ matrix.node-version }}
         uses: actions/setup-node@v1
         with:
           node-version: ${{ matrix.node-version }}
        
       - name: Cache Node.js modules
         uses: actions/cache@v2
         with:
           # npm cache files are stored in `~/.npm` on Linux/macOS
           path: ~/.npm 
           key: ${{ runner.OS }}-node-${{ hashFiles('**/package-lock.json') }}
           restore-keys: |
             ${{ runner.OS }}-node-
             ${{ runner.OS }}-
       - name: Install dependencies
         run: npm ci

       - name: Build
         run: npm run build
       
       #- name: Test
       #  run: npm run check-links
       - name: Broken Link Checker Action
         uses: technote-space/broken-link-checker-action@v1.1.3
         with:
           target: ./build/
           recursive: true

       - name: Deploy
         uses: peaceiris/actions-gh-pages@v3
         with:
           github_token: ${{ secrets.GITHUB_TOKEN }}
           publish_dir: build

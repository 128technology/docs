"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[4961],{3905:function(e,t,n){n.d(t,{Zo:function(){return l},kt:function(){return h}});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=r.createContext({}),p=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},l=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=p(n),h=i,f=u["".concat(c,".").concat(h)]||u[h]||d[h]||o;return n?r.createElement(f,a(a({ref:t},l),{},{components:n})):r.createElement(f,a({ref:t},l))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=u;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var p=2;p<o;p++)a[p]=n[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},18114:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return c},default:function(){return h},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return d}});var r=n(87462),i=n(63366),o=(n(67294),n(3905)),a=["components"],s={title:"Adaptive Encryption",sidebar_label:"Adaptive Encryption"},c=void 0,p={unversionedId:"sec_adaptive_encrypt",id:"sec_adaptive_encrypt",title:"Adaptive Encryption",description:"Introduction",source:"@site/docs/sec_adaptive_encrypt.md",sourceDirName:".",slug:"/sec_adaptive_encrypt",permalink:"/docs/sec_adaptive_encrypt",draft:!1,tags:[],version:"current",lastUpdatedAt:1702328937,formattedLastUpdatedAt:"Dec 11, 2023",frontMatter:{title:"Adaptive Encryption",sidebar_label:"Adaptive Encryption"},sidebar:"docs",previous:{title:"NTP Authentication",permalink:"/docs/config_ntp_auth"},next:{title:"Security Policies",permalink:"/docs/sec_security_policy"}},l={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Overview",id:"overview",level:2},{value:"IPSEC",id:"ipsec",level:3},{value:"TCP",id:"tcp",level:3},{value:"Non-TCP and Non-IPSEC Protocols",id:"non-tcp-and-non-ipsec-protocols",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Reporting",id:"reporting",level:2}],u={toc:d};function h(e){var t=e.components,n=(0,i.Z)(e,a);return(0,o.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,"In order to provide security across the WAN, the SSR Networking Platform provides the functionality to encrypt between peered routers. However, for traffic that is already encrypted by the end host, this is redundant. Adaptive Encryption is aimed at identifying the encrypted traffic and providing security for non-encrypted traffic by encrypting it through the SSR."),(0,o.kt)("p",null,"On a service where most of the traffic is expected to be encrypted, the goal is to identify and encrypt those few sessions that are not. This eliminates the performance overhead of encrypting traffic that is already encrypted."),(0,o.kt)("p",null,"Adaptive encryption only applies to payload encryption, not metadata encryption."),(0,o.kt)("h2",{id:"overview"},"Overview"),(0,o.kt)("p",null,"When adaptive encryption is enabled and the first packet arrives in the service area, the L4 protocol determines how it is handled."),(0,o.kt)("h3",{id:"ipsec"},"IPSEC"),(0,o.kt)("p",null,"If the packet has an IPSEC ESP header, the stream is encrypted and the session is installed without additional encryption actions. If the packet matches the IPSEC or IPSEC-NAT session-type, it\u2019s assumed to be IPSEC and treated as IPSEC ESP."),(0,o.kt)("h3",{id:"tcp"},"TCP"),(0,o.kt)("p",null,"For TCP streams, TLS is currently the most widely used end-to-end encryption protocol. It is used to encrypt all HTTPS traffic.\nTLS, and other protocols that ride on top of TCP, are not seen until the 4th packet of the stream. At that point the session has been established and the router has chosen whether or not to encrypt.\nWith Adaptive Encryption enabled, the router assumes that the TCP session is likely to be encrypted. No encryption actions are installed, but a DPI action is enabled.  The DPI action looks for TLS headers after the TCP handshake is complete."),(0,o.kt)("p",null,"If the DPI action sees the TLS handshake, it is disabled and the session carries on, unencrypted by the router.\nIf the DPI action does not see a TLS handshake, all packets are diverted back to the service area and the session modified for encryption. Starting with that packet, all subsequent packets on the session are encrypted over the fabric."),(0,o.kt)("p",null,"It is important to note that detouring packets to the service-area for session modification is expensive. Using this feature on a service where most of the traffic is unencrypted will double the load on the service-area."),(0,o.kt)("h2",{id:"non-tcp-and-non-ipsec-protocols"},"Non-TCP and Non-IPSEC Protocols"),(0,o.kt)("p",null,"If a packet is plain UDP, ICMP, or any other non-TCP and non-IPSEC protocol, it is assumed to be unencrypted and is installed with encryption actions. "),(0,o.kt)("h2",{id:"configuration"},"Configuration"),(0,o.kt)("p",null,"Adaptive Encryption is enabled by a boolean in the ",(0,o.kt)("a",{parentName:"p",href:"/docs/config_reference_guide#security"},"security-policy"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ladmin@conductor-east-1.RTR_EAST_CONDUCTOR (security[name=aes1])# adaptive-encryption\nusage: adaptive-encryption [<boolean>]\nPrevent packets that are detected as encrypted from being encrypted again as they pass through the router.\npositional arguments:\nboolean    The value to set for this field\nboolean:\n--------\nA true or false value.\nOptions: true or false\n")),(0,o.kt)("p",null,"A security-policy can be applied for multiple purposes. However, because adaptive-encryption only applies to payload encryption, ",(0,o.kt)("strong",{parentName:"p"},"the adaptive encryption field only has meaning where the policy is configured on a service and encryption is also enabled.")," If the same security-policy is configured on an interface, the field has no meaning."),(0,o.kt)("h2",{id:"reporting"},"Reporting"),(0,o.kt)("p",null,"Use the following show commands to view statistics to verify whether the feature is active. "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Number of sessions the router has detected are unencrypted:"),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"show stats packet-processing action success dpi unencrypted"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Number of sessions the router has detected are TLS encrypted:"),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"show stats packet-processing action success dpi client detected")),(0,o.kt)("admonition",{parentName:"li",type:"note"},(0,o.kt)("p",{parentName:"admonition"},"The show stats packet-processing command is also used for Application Identification and may be incremented even if Adaptive Encryption is not enabled."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Number of sessions have been modified to be encrypted:"),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"show stats service-area received adaptive-encryption-modify-packets")))))}h.isMDXComponent=!0}}]);
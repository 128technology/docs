"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[8247],{3905:function(e,n,t){t.d(n,{Zo:function(){return d},kt:function(){return m}});var i=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=i.createContext({}),c=function(e){var n=i.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},d=function(e){var n=c(e.components);return i.createElement(s.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},u=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=c(t),m=a,h=u["".concat(s,".").concat(m)]||u[m]||p[m]||r;return t?i.createElement(h,o(o({ref:n},d),{},{components:t})):i.createElement(h,o({ref:n},d))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,o=new Array(r);o[0]=u;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var c=2;c<r;c++)o[c]=t[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,t)}u.displayName="MDXCreateElement"},83004:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},metadata:function(){return s},toc:function(){return c},default:function(){return p}});var i=t(87462),a=t(63366),r=(t(67294),t(3905)),o=["components"],l={title:"IPsec Client plugin",sidebar_label:"IPsec Client"},s={unversionedId:"plugin_ipsec_client",id:"plugin_ipsec_client",isDocsHomePage:!1,title:"IPsec Client plugin",description:"The 128T-ipsec-client plugin provides a way to send and encrypt traffic to IPsec endpoints through the 128T router. It is possible to configure the plugin for each router to have multiple destination IPsec endpoints and thus the 128T will failover between them. This is accomplished by performing a Service Function Chain (SFC) with Libreswan, a third-party IPsec client. By enabling this plugin, you can provide IPsec tunnel connectivity to third party providers from your 128T router.",source:"@site/docs/plugin_ipsec_client.md",sourceDirName:".",slug:"/plugin_ipsec_client",permalink:"/docs/plugin_ipsec_client",version:"current",lastUpdatedAt:1637271945,formattedLastUpdatedAt:"11/18/2021",sidebar_label:"IPsec Client",frontMatter:{title:"IPsec Client plugin",sidebar_label:"IPsec Client"},sidebar:"docs",previous:{title:"ICMP Reachability Detection Plugin",permalink:"/docs/plugin_icmp_reachability_detection"},next:{title:"Loopback Static Routes Plugin",permalink:"/docs/plugin_loopback_static_routes"}},c=[{value:"Configuration",id:"configuration",children:[{value:"Profiles",id:"profiles",children:[]},{value:"Clients",id:"clients",children:[]},{value:"Generated 128T Configuration",id:"generated-128t-configuration",children:[]},{value:"User-Specific 128T Configuration",id:"user-specific-128t-configuration",children:[]},{value:"Complete Example Configuration",id:"complete-example-configuration",children:[]}]},{value:"Thirdparty Software &amp; Licenses",id:"thirdparty-software--licenses",children:[]},{value:"Troubleshooting",id:"troubleshooting",children:[{value:"Data Model",id:"data-model",children:[]},{value:"Logging",id:"logging",children:[]},{value:"Salt",id:"salt",children:[]},{value:"PCLI Enhancements",id:"pcli-enhancements",children:[]},{value:"Systemd Services",id:"systemd-services",children:[]},{value:"Failover Alarms",id:"failover-alarms",children:[]}]},{value:"Release Notes",id:"release-notes",children:[{value:"Release 2.2.0, 3.1.0",id:"release-220-310",children:[]},{value:"Release 1.0.7, 2.0.7, 2.1.0, 3.0.2",id:"release-107-207-210-302",children:[]},{value:"Release 3.0.1",id:"release-301",children:[]},{value:"Release 3.0.0",id:"release-300",children:[]},{value:"Release 1.0.6, 2.0.6",id:"release-106-206",children:[]},{value:"Release 1.0.5, 2.0.5",id:"release-105-205",children:[]},{value:"Release 1.0.4, 2.0.4",id:"release-104-204",children:[]},{value:"Release 1.0.1, 2.0.1",id:"release-101-201",children:[]}]}],d={toc:c};function p(e){var n=e.components,t=(0,a.Z)(e,o);return(0,r.kt)("wrapper",(0,i.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The 128T-ipsec-client plugin provides a way to send and encrypt traffic to IPsec endpoints through the 128T router. It is possible to configure the plugin for each router to have multiple destination IPsec endpoints and thus the 128T will failover between them. This is accomplished by performing a ",(0,r.kt)("a",{parentName:"p",href:"/docs/plugin_intro#service-function-chaining"},"Service Function Chain (SFC)")," with Libreswan, a third-party IPsec client. By enabling this plugin, you can provide IPsec tunnel connectivity to third party providers from your 128T router."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The instructions for installing and managing the plugin can be found ",(0,r.kt)("a",{parentName:"p",href:"/docs/plugin_intro#installation-and-management"},"here"),"."))),(0,r.kt)("h2",{id:"configuration"},"Configuration"),(0,r.kt)("p",null,"In the below configuration examples, there are two of each plugin configuration element. The first has all configuration elements explicitly configured with the defaults if applicable and the other is the bare minimum using all of the default values. The values enclosed in ",(0,r.kt)("inlineCode",{parentName:"p"},"<>")," are fields that didn\u2019t have default values specified by the plugin. If any of these optional, non-defaulted fields are unspecified, then they will use the Libreswan defaults which can be found ",(0,r.kt)("a",{parentName:"p",href:"https://libreswan.org/man/ipsec.conf.5.html"},"here"),". The values enclosed in ",(0,r.kt)("inlineCode",{parentName:"p"},"[]")," are fields that didn't have default values specified by the plugin and will not be included in the generated 128T configuration."),(0,r.kt)("h3",{id:"profiles"},"Profiles"),(0,r.kt)("p",null,"Profiles are reusable IPsec settings that can be used across multiple nodes in a router and multiple IPsec endpoint ",(0,r.kt)("inlineCode",{parentName:"p"},"remote"),"s."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"router\n   ipsec-profile gateway1\n       name gateway1\n       ike-encryption aes128\n       ike-digest sha1\n       ike-modp modp1024\n       ike-v2 insist\n       authentication-protocol esp\n       phase2-encryption null\n       phase2-digest md5\n       phase2-modp modp1024\n       ike-lifetime 1h\n       connection-lifetime 8h\n       ike-retransmit-interval <ike-retransmit-interval>\n       compress false\n       perfect-forward-secrecy false\n       dpddelay <dpddelay>\n       dpdtimeout <dpdtimeout>\n       dpdaction restart\n       local-id <local-id>\n       metric <metric>\n       mtu <mtu>\n       pre-shared-key psk1\n   exit\n   ipsec-profile gateway2\n       name gateway2\n       pre-shared-key psk2\n   exit\nexit\n")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"This plugin can only connect to IPsec endpoints that support pre-shared key authentication."))),(0,r.kt)("h3",{id:"clients"},"Clients"),(0,r.kt)("p",null,"Clients are a collection of remote endpoints which can be used for failover purposes."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"node\n    ipsec-client client1\n        name client1\n        enabled true\n        tenant t1\n        remote c1gateway1\n            name c1gateway1\n            host gateway1.com\n            profile gateway1\n            vector-name [vector-name]\n            tenant [tenant]\n            subnet <subnet>\n            remote-id <remote-id>\n\n        exit\n        remote c1gateway2\n            name gateway2\n            host gateway2.com\n            profile gateway2\n        exit\n    exit\nexit\n")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Only one ",(0,r.kt)("inlineCode",{parentName:"p"},"ipsec-client")," can be configured per node, but two ",(0,r.kt)("inlineCode",{parentName:"p"},"remote"),"s can be configured per client."))),(0,r.kt)("h3",{id:"generated-128t-configuration"},"Generated 128T Configuration"),(0,r.kt)("p",null,"A KNI per remote is created with the name of the ",(0,r.kt)("inlineCode",{parentName:"p"},"remote")," and a single egress KNI is created with the name of the ",(0,r.kt)("inlineCode",{parentName:"p"},"ipsec-client"),"."),(0,r.kt)("h3",{id:"user-specific-128t-configuration"},"User-Specific 128T Configuration"),(0,r.kt)("p",null,"To allow the maximum flexibility on getting the traffic into the plugin's network namespace and getting the traffic out, we rely on the user to configure those means (usually through services and service routes)."),(0,r.kt)("p",null,"You will need to have the IPsec endpoint bound traffic sent into the KNIs with the names of the ",(0,r.kt)("inlineCode",{parentName:"p"},"remote"),"s. You can use builtin 128T failover techniques due to the KNIs being reported operationally down when the corresponding tunnel is down. You will also need to configure a way for the traffic to be routed towards the IPsec endpoint after being encrypted. All of this encrypted traffic will be assigned to the ",(0,r.kt)("inlineCode",{parentName:"p"},"tenant")," configured under ",(0,r.kt)("inlineCode",{parentName:"p"},"ipsec-client"),"."),(0,r.kt)("h3",{id:"complete-example-configuration"},"Complete Example Configuration"),(0,r.kt)("p",null,"Below is an example of a complete, but minimal configuration entered by the user."),(0,r.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"This example configuration is good to understand all of the concepts but should not be used on a system as is."))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"config\n    authority\n        tenant ipsec\n        exit\n\n        tenant lan\n        exit\n\n        service         cleartext\n            name            cleartext\n            address         1.1.1.0/24\n\n            access-policy   lan\n                source      lan\n                permission  allow\n            exit\n        exit\n\n        service         ipsec\n            name           ipsec\n            address        172.16.4.3\n\n            access-policy  ipsec\n                source      ipsec\n                permission  allow\n            exit\n        exit\n\n        router               router1\n            ipsec-profile         primary\n                name                 primary\n                pre-shared-key       somekey1\n            exit\n\n            ipsec-profile         secondary\n                name                 secondary\n                pre-shared-key       somekey2\n            exit\n\n            node node1\n                device-interface          lan\n                    name               lan\n\n                    network-interface  lanintf\n                        name          lanintf\n                        tenant        lan\n\n                        address       172.16.1.2\n                            ip-address     172.16.1.2\n                            prefix-length  24\n                            gateway        2.2.2.1\n                        exit\n                    exit\n                exit\n\n                device-interface          wan\n                    name               wan\n\n                    network-interface  wanintf\n                        name          wanintf\n\n                        address       172.16.3.2\n                            ip-address     172.16.3.2\n                            prefix-length  24\n                            gateway        172.16.3.5\n                        exit\n                    exit\n                exit\n\n                ipsec-client              client1\n                    name     client1\n                    enabled  true\n                    tenant   ipsec\n\n                    remote   rem1\n                        name     rem1\n                        host     172.16.4.3\n                        profile  primary\n                    exit\n\n                    remote   rem2\n                        name     rem2\n                        host     172.16.5.4\n                        profile  secondary\n                    exit\n                exit\n            exit\n\n            service-route         rem1\n                name          rem1\n                service-name  cleartext\n\n                next-hop      router1 rem1-intf\n                    node-name   router1\n                    interface   rem1-intf\n                    gateway-ip  169.254.129.6\n                exit\n            exit\n\n            service-route         rem2\n                name          rem2\n                service-name  cleartext\n\n                next-hop      router1 rem2-intf\n                    node-name   router1\n                    interface   rem2-intf\n                    gateway-ip  169.254.129.10\n                exit\n            exit\n\n            service-route         ipsec\n                name          ipsec\n                service-name  ipsec\n\n                next-hop      router1 wanintf\n                    node-name   router1\n                    interface   wanintf\n                    gateway-ip  172.16.3.5\n                exit\n            exit\n        exit\n    exit\nexit\n")),(0,r.kt)("p",null,"Upon commit, the plugin will generate other configuration as shown below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'config\n    authority\n        router router1\n            node node1\n                device-interface          client1\n                    name               client1\n                    description        "Auto-generated host interface for use with ipsec-client"\n                    type               host\n                    network-namespace  client1\n\n                    network-interface  client1-intf\n                        name       client1-intf\n                        type       external\n                        tenant     ipsec\n\n                        address    169.254.129.1\n                            ip-address     169.254.129.1\n                            prefix-length  30\n                            gateway        169.254.129.2\n                        exit\n                    exit\n                exit\n\n                device-interface          rem1\n                    name               rem1\n                    description        "Auto-generated host interface for use with ipsec-client"\n                    type               host\n                    network-namespace  client1\n\n                    network-interface  rem1-intf\n                        name       rem1-intf\n                        type       external\n                        tenant     _internal_\n\n                        address    169.254.129.5\n                            ip-address     169.254.129.5\n                            prefix-length  30\n                            gateway        169.254.129.6\n                        exit\n                    exit\n                exit\n\n                device-interface          rem2\n                    name               rem2\n                    description        "Auto-generated host interface for use with ipsec-client"\n                    type               host\n                    network-namespace  client1\n\n                    network-interface  rem2-intf\n                        name       rem2-intf\n                        type       external\n                        tenant     _internal_\n\n                        address    169.254.129.9\n                            ip-address     169.254.129.9\n                            prefix-length  30\n                            gateway        169.254.129.10\n                        exit\n                    exit\n                exit\n            exit\n        exit\n    exit\nexit\n')),(0,r.kt)("h2",{id:"thirdparty-software--licenses"},"Thirdparty Software & Licenses"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Libreswan v3.23-5.el7_5 (GNU GPLv2)")),(0,r.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,r.kt)("h3",{id:"data-model"},"Data Model"),(0,r.kt)("p",null,"If the data model doesn\u2019t appear in the PCLI or GUI, make sure that you have restarted the 128T service."),(0,r.kt)("h3",{id:"logging"},"Logging"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"/var/log/128technology/persistentDataManager.log")," file at trace level will hold whether the configuration generation was run as well as output and return code.\nThe ",(0,r.kt)("inlineCode",{parentName:"p"},"/var/log/128technology/automatedProvisioner.log")," file at trace level will hold whether the pillar generation was run as well as output and return code.\nConfiguration and pillar generation logs can be found on the conductor under ",(0,r.kt)("inlineCode",{parentName:"p"},"/var/log/128technology/plugins/ipsec-client-config-generation.log")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"/var/log/128technology/plugins/ipsec-client-pillar-generation.log")," respectively."),(0,r.kt)("h3",{id:"salt"},"Salt"),(0,r.kt)("p",null,"Salt status can be found on the conductor by utilizing the PCLI\u2019s ",(0,r.kt)("inlineCode",{parentName:"p"},"show assets")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"show assets <asset-id>")," commands."),(0,r.kt)("h3",{id:"pcli-enhancements"},"PCLI Enhancements"),(0,r.kt)("p",null,"To check the status of the IPsec tunnels for a given ingress KNI, extra IPsec tunnel related output will be found in the ",(0,r.kt)("inlineCode",{parentName:"p"},"show device-interface")," command."),(0,r.kt)("p",null,"Example output for a healthy tunnel:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"admin@combo-west.RTR_WEST_COMBO# show device-interface name rem2\nTue 2020-06-30 16:44:39 UTC\n\n=========================================================\n combo-west:rem2\n=========================================================\n Type:                host\n Forwarding:          true\n Mode:                host\n MAC Address:         22:ee:4e:b6:37:a8\n\n Admin Status:        up\n Operational Status:  up\n Redundancy Status:   non-redundant\n Speed:               1000\n Duplex:              full\n\n in-octets:                        9992\n in-unicast-pkts:                   161\n in-errors:                           0\n out-octets:                       6986\n out-unicast-pkts:                  161\n out-errors:                         11\n\n IPSec:\n     Tunnel Status:   Up\n     Tunnel Details:\n         Name:        ipsec-client-tunnel-secondary-rem2\n         Remote id:   172.16.5.4\n         SA creation time:\n           2020-06-30 16:37:50\n         In bytes:    0\n         Out bytes:   336\n     SA Count:        1\n\nCompleted in 0.12 seconds\n")),(0,r.kt)("p",null,"Example output for a tunnel that is down:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"========================================\n combo-west:rem1\n========================================\n Type:                host\n Forwarding:          true\n Mode:                host\n MAC Address:         76:78:79:fc:eb:69\n\n Admin Status:        up\n Operational Status:  down\n Redundancy Status:   non-redundant\n Speed:               0\n Duplex:              unknown\n\n in-octets:                     1962932\n in-unicast-pkts:                 32710\n in-errors:                           0\n out-octets:                    1373442\n out-unicast-pkts:                32701\n out-errors:                          6\n\n IPSec:\n   Tunnel Status:     Down\n")),(0,r.kt)("h3",{id:"systemd-services"},"Systemd Services"),(0,r.kt)("p",null,"To check the status of the IPsec client service on the router, you can run ",(0,r.kt)("inlineCode",{parentName:"p"},"show system services")," which will show all 128T related services running on the specified node. The one for this plugin is named ",(0,r.kt)("inlineCode",{parentName:"p"},"128t-ipsec"),"."),(0,r.kt)("p",null,"To verify that the services are running properly on the 128T router:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"systemctl status 128t-ipsec@<client>.service"))),(0,r.kt)("h3",{id:"failover-alarms"},"Failover Alarms"),(0,r.kt)("p",null,"If a tunnel goes down, we set the corresponding ingress KNI to be operationally down. An alarm will be created when this happens."),(0,r.kt)("p",null,"Example output when the tunnel for ",(0,r.kt)("inlineCode",{parentName:"p"},"rem1")," goes down:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-admin@combo-west.RTR_WEST_COMBO#",metastring:"show alarms",show:!0,alarms:!0},"Tue 2020-06-30 16:42:50 UTC\n\n============== ===================== ========== ============= =========== ==================================\n ID             Time                  Severity   Source        Category    Message\n============== ===================== ========== ============= =========== ==================================\n combo-west:8   2020-06-30 16:32:42   critical   unavailable   interface   Intf rem1 (4) operationally down\n\nThere are 0 shelved alarms\nCompleted in 0.10 seconds\n")),(0,r.kt)("h2",{id:"release-notes"},"Release Notes"),(0,r.kt)("h3",{id:"release-220-310"},"Release 2.2.0, 3.1.0"),(0,r.kt)("h4",{id:"new-features-and-improvements"},"New Features and Improvements"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-1289")," Ability to provision custom MSS on the remote tunnel interfaces")),(0,r.kt)("p",null,"The feature adds support for configuring a custom MSS value on the remote IPSec tunnel interface. The new configuration can be found under ",(0,r.kt)("inlineCode",{parentName:"p"},"router > node > ipsec-client > remote > enforced-mss"),". The configuration follows the same format as the ",(0,r.kt)("a",{parentName:"p",href:"/docs/config_reference_guide/#network-interface"},"network-interface > enforced-mss"),"."),(0,r.kt)("h3",{id:"release-107-207-210-302"},"Release 1.0.7, 2.0.7, 2.1.0, 3.0.2"),(0,r.kt)("h4",{id:"issues-fixed"},"Issues Fixed"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"PLUGIN-1092")," IPSec left and right subnet configuration does not always work correctly"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"Resolution:"))," The non-default left and right subnet configuration is correctly translated to corresponding libreswan configuration.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"PLUGIN-1103")," IPSec remote host does not appear as link on the GUI"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"Resolution:"))," The GUI presentation model was updated to include the missing key field."))),(0,r.kt)("h3",{id:"release-301"},"Release 3.0.1"),(0,r.kt)("h4",{id:"issues-fixed-1"},"Issues Fixed"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-1092")," Added fix for local and remote subnet configuration option to allow a single value or a list of values.")),(0,r.kt)("h3",{id:"release-300"},"Release 3.0.0"),(0,r.kt)("h4",{id:"issues-fixed-2"},"Issues Fixed"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-768")," Support the IPSec client plugin in 128T versions ",(0,r.kt)("inlineCode",{parentName:"li"},"5.1.0")," and greater."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-611")," Added support for plugin state. Plugin state information can be accessed on the PCLI using ",(0,r.kt)("inlineCode",{parentName:"li"},"show plugins state [router <router>] [node <node>] [{detail | summmary}] 128T-ipsec-client"))),(0,r.kt)("h3",{id:"release-106-206"},"Release 1.0.6, 2.0.6"),(0,r.kt)("h4",{id:"issues-fixed-3"},"Issues Fixed"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-1057")," Ensure all critical IPsec client directories are created during installation of the plugin."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-1053")," Added an inactive IPsec client plugin state to allow seamless migration from zscaler. The inactive state is achieved by excluding ",(0,r.kt)("inlineCode",{parentName:"li"},"ipsec-client")," from the configuration."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-1046")," Provide IPsec client auto-upgrade capability while crossing the 128T version ",(0,r.kt)("inlineCode",{parentName:"li"},"4.3.0")," boundary.")),(0,r.kt)("h3",{id:"release-105-205"},"Release 1.0.5, 2.0.5"),(0,r.kt)("h4",{id:"issues-fixed-4"},"Issues Fixed"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-994")," The ",(0,r.kt)("inlineCode",{parentName:"li"},"ipsec-client > remote-id")," configuration is not being used correctly when generating the libreswan config.")),(0,r.kt)("h3",{id:"release-104-204"},"Release 1.0.4, 2.0.4"),(0,r.kt)("h4",{id:"issues-fixed-5"},"Issues Fixed"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-384")," Added an MTU configuration option to the ipsec profile."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-333")," The ",(0,r.kt)("inlineCode",{parentName:"li"},"plugin-network")," ip prefix setting in the configuration was ignored and would instead use the default ip prefix setting."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-336")," Using the ",(0,r.kt)("inlineCode",{parentName:"li"},"vector-name")," configuration option would generate invalid configuration."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-400")," Added a local subnet configuration option and enhanced the remote subnet configuration option to allow a list of values.")),(0,r.kt)("h3",{id:"release-101-201"},"Release 1.0.1, 2.0.1"),(0,r.kt)("h4",{id:"issues-fixed-6"},"Issues Fixed"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"PLUGIN-47")," Created generic IPsec client plugin to provide connectivity to remote ipsec endpoints. This version supports a single client with up to two remote endpoints.")))}p.isMDXComponent=!0}}]);
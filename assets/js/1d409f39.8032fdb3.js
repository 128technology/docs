"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[4969],{53959:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var t=r(74848),o=r(28453);const i={title:"SSR1300 and SSR1400 BIOS Upgrade for the Intel X722",sidebar_labe:"SSR1300 and SSR1400 BIOS Upgrade for the Intel X722"},s=void 0,a={id:"howto_update_bios",title:"SSR1300 and SSR1400 BIOS Upgrade for the Intel X722",description:"Juniper SSR1300 and SSR1400 incorporate Intel X722 NICs. To support the LLDP feature available in SSR releases 6.1 and greater, a BIOS upgrade to version 4.09 is required. This BIOS version contains updated Intel Management Engine (ME) and X722 NIC firmware, which is required for the LLDP feature.",source:"@site/docs/howto_update_bios.md",sourceDirName:".",slug:"/howto_update_bios",permalink:"/docs/howto_update_bios",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"SSR1300 and SSR1400 BIOS Upgrade for the Intel X722",sidebar_labe:"SSR1300 and SSR1400 BIOS Upgrade for the Intel X722"},sidebar:"docs",previous:{title:"Link Aggregation and LACP",permalink:"/docs/config_lacp"},next:{title:"LTE and Dual LTE Configuration",permalink:"/docs/howto_lte"}},l={},d=[{value:"Affected Hardware",id:"affected-hardware",level:3},{value:"Prerequsites",id:"prerequsites",level:3},{value:"Version Checks",id:"version-checks",level:4},{value:"Installation",id:"installation",level:2},{value:"Online Installation from the SSR Repository",id:"online-installation-from-the-ssr-repository",level:3},{value:"RPM Download and Off-line Installation",id:"rpm-download-and-off-line-installation",level:3},{value:"Upgrading the BIOS and X722 Firmware",id:"upgrading-the-bios-and-x722-firmware",level:2},{value:"Post-Upgrade Power Cycle",id:"post-upgrade-power-cycle",level:3},{value:"Sample Upgrade Output",id:"sample-upgrade-output",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Juniper SSR1300 and SSR1400 incorporate Intel X722 NICs. To support the LLDP feature available in SSR releases 6.1 and greater, a BIOS upgrade to version 4.09 is required. This BIOS version contains updated Intel Management Engine (ME) and X722 NIC firmware, which is required for the LLDP feature."}),"\n",(0,t.jsx)(n.p,{children:"The Intel X722 NIC will be referred to as the X722 or X722 NIC for the remainder of this document."}),"\n",(0,t.jsx)(n.p,{children:"In order to fully integrate the new Intel ME firmware delivered by the BIOS, the software powers down the system after the firmware upgrade, and the user MUST manually power the system back up."}),"\n",(0,t.jsxs)(n.p,{children:["Although the update procedure can be initiated remotely over ssh, personnel must be available ",(0,t.jsx)(n.strong,{children:"ON SITE"})," to perform the ",(0,t.jsx)(n.a,{href:"#post-upgrade-power-cycle",children:"mandatory post-update power cycle"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"affected-hardware",children:"Affected Hardware"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"SSR1300"}),"\n",(0,t.jsx)(n.li,{children:"SSR1400"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"prerequsites",children:"Prerequsites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["BIOS update package: ",(0,t.jsx)(n.code,{children:"afulnx-5.16.02.0111-3.el7.x86_64.rpm"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"SSH or console for root access to the target system."}),"\n",(0,t.jsx)(n.li,{children:"Personnel available on site to perform the post-update power cycle."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"version-checks",children:"Version Checks"}),"\n",(0,t.jsxs)(n.p,{children:["To verify the BIOS version use the ",(0,t.jsx)(n.code,{children:"dmidecode"})," command:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"$ dmidecode -s bios-version\nSSR1300V405\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"$ dmidecode -s bios-version\nSSR1400V405\n"})}),"\n",(0,t.jsxs)(n.p,{children:["In this example, the BIOS version of the SSR1300 is ",(0,t.jsx)(n.code,{children:"4.05"}),". After the upgrade, the BIOS version should be ",(0,t.jsx)(n.code,{children:"4.09"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"$ dmidecode -s bios-version\nSSR1300V409\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"$ dmidecode -s bios-version\nSSR1400V409\n"})}),"\n",(0,t.jsx)(n.p,{children:"To verify the NIC firmware version, first find the X722 PCI address:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"[t128@YOUR-DEVICE-HERE ~]$ lspci | grep X722\n6a:00.0 Ethernet controller: Intel Corporation Ethernet Connection X722 for 10GbE SFP+ (rev 04)\n6a:00.1 Ethernet controller: Intel Corporation Ethernet Connection X722 for 10GbE SFP+ (rev 04)\n6a:00.2 Ethernet controller: Intel Corporation Ethernet Connection X722 for 10GbE SFP+ (rev 04)\n6a:00.3 Ethernet controller: Intel Corporation Ethernet Connection X722 for 10GbE SFP+ (rev 04)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Using the PCI address found above (6a:00), use ",(0,t.jsx)(n.code,{children:"dmesg"})," to identify the firmware version:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"[t128@YOUR-DEVICE-HERE ~]$ dmesg |grep 6a:00 | grep nvm\n[ 5.460406] i40e 0000:6a:00.0: fw 3.1.55727 api 1.5 nvm 3.31 0x80000d00 1.1766.0\n[ 5.649662] i40e 0000:6a:00.1: fw 3.1.55727 api 1.5 nvm 3.31 0x80000d00 1.1766.0\n[ 5.790353] i40e 0000:6a:00.2: fw 3.1.55727 api 1.5 nvm 3.31 0x80000d00 1.1766.0\n[ 5.861986] i40e 0000:6a:00.3: fw 3.1.55727 api 1.5 nvm 3.31 0x80000d00 1.1766.0\n"})}),"\n",(0,t.jsx)(n.p,{children:"In the example above, the X722 firmware version is 3.31."}),"\n",(0,t.jsxs)(n.p,{children:["Alternatively, if the X722 NIC is bound to linux only, you can use ",(0,t.jsx)(n.code,{children:"ethtool"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"[root@YOUR-DEVICE-HERE t128]# ethtool -i xe-0-0\ndriver: i40e\nversion: 2.16.11\nfirmware-version: 3.31 0x80000d00 1.1766.0\nexpansion-rom-version:\nbus-info: 0000:6a:00.0\nsupports-statistics: yes\nsupports-test: yes\nsupports-eeprom-access: yes\nsupports-register-dump: yes\nsupports-priv-flags: yes\n"})}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.p,{children:"The BIOS update package can be installed using either of two methods:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"On-line install from Juniper SSR repositories."}),"\n",(0,t.jsx)(n.li,{children:"RPM download & off-line installation."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"online-installation-from-the-ssr-repository",children:"Online Installation from the SSR Repository"}),"\n",(0,t.jsx)(n.p,{children:"On systems with internet access, use the following steps to download and install the updated BIOS RPM package from the SSR Repositories."}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Login to your SSR device using SSH or through the console."}),"\n",(0,t.jsxs)(n.li,{children:["Enter the following command:\n",(0,t.jsx)(n.code,{children:"sudo dnf install -y afulnx"})]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"sudo dnf install -y afulnx-5.16.02.0111-3\n\nDependencies resolved.\n========================================================================================================================\n Package                Arch                   Version                               Repository                    Size\n========================================================================================================================\nInstalling:\n afulnx                 x86_64                 5.16.02.0111-3.el7                    @commandline                  13 M\n\nTransaction Summary\n========================================================================================================================\nInstall  1 Package\n\nTotal size: 13 M\nInstalled size: 66 M\nDownloading Packages:\nRunning transaction check\nTransaction check succeeded.\nRunning transaction test\nTransaction test succeeded.\nRunning transaction\n  Preparing        :                                                                                                1/1 \n  Installing       : afulnx-5.16.02.0111-3.el7.x86_64                                                               1/1 \n  Verifying        : afulnx-5.16.02.0111-3.el7.x86_64                                                               1/1 \n\nInstalled:\n  afulnx.x86_64 5.16.02.0111-3.el7                                                                                      \n\nComplete!\n\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Proceed with the next step, ",(0,t.jsx)(n.a,{href:"#upgrading-the-bios-and-x722-firmware",children:"Upgrading the BIOS and Firmware"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"rpm-download-and-off-line-installation",children:"RPM Download and Off-line Installation"}),"\n",(0,t.jsxs)(n.p,{children:["For systems that do not have internet access (air-gap systems), you can download the BIOS update package ",(0,t.jsx)(n.code,{children:"afulnx-5.16.02.0111-3.el7.x86_64.rpm"})," from the SSR repository. This method requires saving the RPM to a USB device and then copying it into the ",(0,t.jsx)(n.code,{children:"/tmp"})," directory of the SSR. Use the following steps to perform the download and installation:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["From an internet connected computer, download the BIOS update package from the following repository to a USB drive:\n",(0,t.jsx)(n.code,{children:"https://software.128technology.com/artifactory/list/rpm-128t-deps-release-local/CentOS/7.5/packaging/afulnx-5.16.02.0111-3.el7.x86_64.rpm"})]}),"\n",(0,t.jsx)(n.li,{children:"Login to your SSR device using SSH or through the console."}),"\n",(0,t.jsx)(n.li,{children:"Insert the USB into the SSR device."}),"\n",(0,t.jsxs)(n.li,{children:["Download the BIOS update RPM into the ",(0,t.jsx)(n.code,{children:"/tmp"})," directory on the target SSR device."]}),"\n",(0,t.jsxs)(n.li,{children:["Enter the following command:\n",(0,t.jsx)(n.code,{children:"sudo dnf install -y /tmp/afulnx-5.16.02.0111-3.el7.x86_64.rpm"})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Proceed with the next step, ",(0,t.jsx)(n.a,{href:"#upgrading-the-bios-and-x722-firmware",children:"Upgrading the BIOS and Firmware"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"upgrading-the-bios-and-x722-firmware",children:"Upgrading the BIOS and X722 Firmware"}),"\n",(0,t.jsx)(n.p,{children:"After the upgrade package has been installed onto your SSR hardware, the BIOS and X722 firmware must be upgraded, and the Post-Upgrade Power Cycle must be performed. Complete steps 1-3 and then perform the Post-Upgrade Power Cycle."}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Enter the following command:\n",(0,t.jsx)(n.code,{children:"sudo /usr/libexec/update_bios.sh"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["When prompted, confirm [",(0,t.jsx)(n.code,{children:"Y"}),"] that you understand this will shut down the system, and a manual power cycle will be required from on-site personnel to resume service."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"important",children:(0,t.jsx)(n.p,{children:"DO NOT INTERRUPT THIS PROCESS AFTER CONFIRMING! Doing so may result in an unbootable system, requiring it to be returned to the factory for reprogramming."})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsx)(n.li,{children:"The upgrade process takes place:"}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Current BIOS version is saved as a backup."}),"\n",(0,t.jsx)(n.li,{children:"Current DMI information is saved."}),"\n",(0,t.jsx)(n.li,{children:"BIOS, ME, and NIC firmware is updated."}),"\n",(0,t.jsx)(n.li,{children:"Saved DMI information is programmed into the new BIOS."}),"\n",(0,t.jsx)(n.li,{children:"The system initiates a controlled shutdown and power-off."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The update process can take up to 10 minutes, from confirmation to initiating system shutdown."}),"\n",(0,t.jsx)(n.h3,{id:"post-upgrade-power-cycle",children:"Post-Upgrade Power Cycle"}),"\n",(0,t.jsxs)(n.p,{children:["On-site personnel ",(0,t.jsx)(n.strong,{children:"MUST"})," perform the following post-update power cycle process. Power cycle the unit as follows:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Remove all power cords from the system."}),"\n",(0,t.jsx)(n.li,{children:"Wait 30 seconds."}),"\n",(0,t.jsx)(n.li,{children:"Reconnect all power cords to the system."}),"\n",(0,t.jsx)(n.li,{children:"Power up the device."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The system will boot using the new v4.09 BIOS and v6.5 X722 firmware."}),"\n",(0,t.jsx)(n.h3,{id:"sample-upgrade-output",children:"Sample Upgrade Output"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'[root@YOUR-DEVICE-HERE]# /usr/libexec/update_bios.sh \n\nCurrent BIOS version SSR1400V405 will be updated using FNCA5520C0SSR6B409.BIN\n\nWARNING: Continuing will automatically shut down this system after BIOS update\n         A manual power cycle will be required to resume service\n\nContinue? [y/n] : y\n\n+---------------------------------------------------------------------------+\n|                 AMI Firmware Update Utility v5.16.02.0111                 |\n|      Copyright (c) 1985-2023, American Megatrends International LLC.      |\n|         All rights reserved. Subject to AMI licensing agreement.          |\n+---------------------------------------------------------------------------+\n Saving current BIOS into file: /usr/libexec/afulnx64/SSR1400V405.saved\n Reading flash ............... done                \n\n Process completed.\n\nSaving DMI: AS<device> 0002 0002 AS<device> AS<device> 71C15841-ECD5-5C49-9D13-447D356767E7 (4158C171D5EC495C9D13447D356767E7)\n\nCAUTION: DO NOT interrupt this operation, the system may become unbootable\n\n\nBroadcast message from root@as<device> (pts/0) (Tue Aug 13 14:29:36 2024):\n\nBIOS update in progress. DO NOT reboot or interrupt\n\n+---------------------------------------------------------------------------+\n|                 AMI Firmware Update Utility v5.16.02.0111                 |\n|      Copyright (c) 1985-2023, American Megatrends International LLC.      |\n|         All rights reserved. Subject to AMI licensing agreement.          |\n+---------------------------------------------------------------------------+\n Reading flash ...................... Done                \n - ME Data Size Checking ............ Pass\n - System Secure Flash .............. Enabled\n - FFS Checksums .................... Pass\n - Check RomLayout .................. Pass\n Loading File To Verify Memory ...... Done                \n Erasing Main Block ................. Done                \n Updating Main Block ................ Done                \n Verifying Main Block ............... Done                \n Erasing Boot Block ................. Done                \n Updating Boot Block ................ Done                \n Verifying Boot Block ............... Done                \n Erasing NVRAM Block ................ Done                \n Updating NVRAM Block ............... Done                \n Verifying NVRAM Block .............. Done                \n Loading The ME Data To BIOS ........ Done                \n - Update success for FDR                              \n - Update success for GBEA                             \n - PTT is locked, skip updating.                       \n - Successful Update Recovery Loader to OPRx!!         \n - Successful Update MFSB                              \n - Successful Update FTPR!!                            \n - Successful Update MFS, IVB1 and IVB2!!              \n - Successful Update FLOG and UTOK!!                   \n - ME Entire Image update success !!                   \n \n WARNING !!\n System must power-off to have the changes which take effect!\n\n Process completed.\n\n\nRestoring DMI: AS<device> 0002 0002 AS<device> AS<device> 71C15841-ECD5-5C49-9D13-447D356767E7 (4158C171D5EC495C9D13447D356767E7)\n\n+---------------------------------------------------------------------------+\n|        AMI Desktop Management Interface Edit Utility v5.27.03.0010        |\n|      Copyright (c) 1985-2021, American Megatrends International LLC.      |\n|         All rights reserved. Subject to AMI licensing agreement.          |\n+---------------------------------------------------------------------------+\n\nInitializing the SMBIOS interface.  Please wait a moment......\n          Name              R/W  Status  Information\n--------------------------  ---  ------  ----------------------------------\n(/SS)System Serial number    W    Done   "AS<device>" \n(/SV)System version          W    Done   "0002" \n(/SU)System UUID             W    Done   "4158C171D5EC495C9D13447D356767E7" \n(/BV)Baseboard version       W    Done   "0002" \n(/BS)Baseboard Serial number W    Done   "AS<device>" \n(/BT)Baseboard Asset Tag     W    Done   "AS<device>" \nBIOS update successful\n\nIMPORTANT: Please power cycle the system now\n\nShutdown scheduled for Tue 2024-08-13 14:34:39 UTC, use \'shutdown -c\' to cancel.\n\n[root@YOUR-DEVICE-HERE]# \nBroadcast message from root@YOUR-DEVICE-HERE (Tue 2024-08-13 14:33:39 UTC):\n\nPowering off due to BIOS update\nThe system is going down for power-off at Tue 2024-08-13 14:34:39 UTC!\n\n'})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>a});var t=r(96540);const o={},i=t.createContext(o);function s(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);
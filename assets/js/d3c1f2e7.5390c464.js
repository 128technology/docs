"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[6448],{7454:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var t=o(74848),r=o(28453);const i={title:"Secure ZTP Onboarding Using a Mist Proxy",sidebar_label:"Secure ZTP Onboarding Using a Mist Proxy"},s=void 0,c={id:"sec-ztp-web-proxy",title:"Secure ZTP Onboarding Using a Mist Proxy",description:"With only MPLS or private connectivity available, it is possible to leverage a connection to Mist using an explicit proxy and a private web proxy in the network. This type of web proxy is often used to bridge the gap between private and public networks.",source:"@site/docs/sec-ztp-web-proxy.md",sourceDirName:".",slug:"/sec-ztp-web-proxy",permalink:"/docs/sec-ztp-web-proxy",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Secure ZTP Onboarding Using a Mist Proxy",sidebar_label:"Secure ZTP Onboarding Using a Mist Proxy"},sidebar:"docs",previous:{title:"Initialize Your Device - Advanced Workflows",permalink:"/docs/initialize_u-iso_adv_workflow"},next:{title:"Cloud Platform Support",permalink:"/docs/supported_cloud_platforms"}},d={},l=[{value:"Secure ZTP Onboarding",id:"secure-ztp-onboarding",level:2}];function a(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"With only MPLS or private connectivity available, it is possible to leverage a connection to Mist using an explicit proxy and a private web proxy in the network. This type of web proxy is often used to bridge the gap between private and public networks."}),"\n",(0,t.jsx)(n.p,{children:"There are two steps to the process of onboarding using a Mist proxy; Provisioning a conductor, and configuring the SSR to identify and use the non-transparent proxy."}),"\n",(0,t.jsx)(n.p,{children:"This document provides information perform the secure ZTP onboarding process."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["It is recommended that before configuring the web proxy and secure ZTP, you provision the Conductor. For information about onboarding a conductor-managed router through Mist, please see ",(0,t.jsx)(n.a,{href:"/docs/onboard_ssr_to_conductor",children:"Onboard an SSR Device to a Conductor"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["After the conductor has been provisioned, ",(0,t.jsx)(n.a,{href:"/docs/config-proxy-server",children:"Configure the proxy server"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Once those steps have been completed, continue with the ",(0,t.jsx)(n.a,{href:"#secure-ztp-onboarding",children:"Secure ZTP Onboarding"})," procedure below."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"secure-ztp-onboarding",children:"Secure ZTP Onboarding"}),"\n",(0,t.jsx)(n.p,{children:"The sZTP process is the following:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["SSR devices are ",(0,t.jsx)(n.a,{href:"/docs/config-proxy-server",children:"configured with an SSR Mist connection using a web proxy"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:['Upon installation, the SSR will "phone home" to the Mist Global1 EP terminator ',(0,t.jsx)(n.code,{children:"ep-terminator.mistsys.net"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Based on the target claimed environment, the device is redirected to the appropriate organization."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The client creates a TLS connection to Mist cloud and validates using OCRA authentication.\nMist Cloud validates the client by leveraging onboard TPM with a request/response challenge."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The Mist org/site is configured with the following information to be validated and installed on the device:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Conductor IP address"}),"\n",(0,t.jsx)(n.li,{children:"Pre-shared secret obtained from the conductor"}),"\n",(0,t.jsx)(n.li,{children:"Root CA for the cert installed on the conductor (optional)"}),"\n",(0,t.jsx)(n.li,{children:"Install the Root CA on the local router to validate the conductor"}),"\n",(0,t.jsx)(n.li,{children:"Install the pre-shared secret in secure storage"}),"\n",(0,t.jsx)(n.li,{children:"The SSR will securely onboard itself to the provided staging conductor"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Once the router is onboarded to the Onboarding Conductor, the following information is sent to the router:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Conductor IP address of the operational/production conductor"}),"\n",(0,t.jsx)(n.li,{children:"Pre-shared secret obtained from the operational conductor"}),"\n",(0,t.jsx)(n.li,{children:"Root CA for the cert installed on the operational conductor"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The Onboarding Conductor triggers certificate creation on the router."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"A Certificate Signing Request for the generated public key is triggered."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The Onboarding Conductor pushes down the SVR configuration for peering with the operational hub."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The Root CA is installed on the local router to validate the conductor."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"The pre-shared secret is installed in secure storage."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Finally, the onboarding conductor will trigger a ",(0,t.jsx)(n.code,{children:"migrate"})," command to re-target the router to the operational conductor."]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>c});var t=o(96540);const r={},i=t.createContext(r);function s(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);
"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[1628],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(n),m=a,k=c["".concat(s,".").concat(m)]||c[m]||d[m]||i;return n?r.createElement(k,o(o({ref:t},u),{},{components:n})):r.createElement(k,o({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},91263:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return d}});var r=n(87462),a=n(63366),i=(n(67294),n(3905)),o=["components"],l={title:"Traceroute",sidebar_label:"Traceroute"},s=void 0,p={unversionedId:"ts_traceroute",id:"ts_traceroute",title:"Traceroute",description:"Version History",source:"@site/docs/ts_traceroute.md",sourceDirName:".",slug:"/ts_traceroute",permalink:"/docs/ts_traceroute",draft:!1,tags:[],version:"current",lastUpdatedAt:1708446926,formattedLastUpdatedAt:"Feb 20, 2024",frontMatter:{title:"Traceroute",sidebar_label:"Traceroute"},sidebar:"docs",previous:{title:"T1 Troubleshooting",permalink:"/docs/ts_t1_troubleshooting"},next:{title:"Troubleshooting VRF",permalink:"/docs/ts_troubleshooting_vrf"}},u={},d=[{value:"Version History",id:"version-history",level:4},{value:"How It Works",id:"how-it-works",level:2},{value:"Command Information",id:"command-information",level:2},{value:"Keyword Arguments",id:"keyword-arguments",level:4},{value:"Positional Arguments",id:"positional-arguments",level:4},{value:"Example Service Traceroute:",id:"example-service-traceroute",level:4},{value:"Show Command",id:"show-command",level:3}],c={toc:d};function m(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h4",{id:"version-history"},"Version History"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Release"),(0,i.kt)("th",{parentName:"tr",align:null},"Modification"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"6.1.0"),(0,i.kt)("td",{parentName:"tr",align:null},"This feature was introduced.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"6.2.3-R2"),(0,i.kt)("td",{parentName:"tr",align:null},"Updates and improvements made to the keyword arguments")))),(0,i.kt)("p",null,"Traceroute is implemented as a troubleshooting tool, allowing you to debug connectivity from point to point."),(0,i.kt)("p",null,"Network administrators frequently make use of Linux traceroute as a complement to ping when isolating intermediate connectivity issues and troubleshooting MTU, and TTL issues. Traceroute provides information on the intermediate connectivity on a hop-by-hop basis between a source and destination. The SSR Traceroute commands provide the ability to detect failure points in connectivity along the network traffic flow. With the routing model and distributed nature of the SSR, traceroute behaves differently depending on the use case."),(0,i.kt)("p",null,"The following types of traceroute are available:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"routed traceroute"),": Mirrors the traceroute utility in Unix. Uses the service, tenant, and interface according to the SSR\u2019s route table."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"service traceroute"),": Analogous to the service-ping functionality. Useful to debug test traffic as defined in the deployment."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"peer traceroute"),": Performs traceroute between two adjacent SSRs. Useful for diagnosing peering issues.")),(0,i.kt)("h2",{id:"how-it-works"},"How It Works"),(0,i.kt)("p",null,"Discovery packets are sent from the originating SSR to a single the destination port with varying time-to-live (TTL) values. For each iteration, the TTL is increased by 1, and a 3 packet burst is transmitted. This process is repeated until the originating SSR receives a suitable \u2018terminating\u2019 packet from the final destination, or until an upper-limit is reached for hop counts. "),(0,i.kt)("p",null,"For service-traceroute and routed-traceroute, ICMP echo requests are the default discovery packets. Peer-traceroute uses BFD packets as the default. To support instances where ICMP replies are disabled at the destination or disallowed by firewall rules, UDP is also supported."),(0,i.kt)("h2",{id:"command-information"},"Command Information"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"admin@combo-west-a.combo-west# traceroute\nusage: traceroute [max-hops <max-hops>] [wait-time <wait-time>] [egress-interface <egress-interface>] [source-ip <source-ip>] [gateway-ip <gateway-ip>] [service <service>] [tenant <tenant>] [peer <peer>] router <router> node <node> <destination-ip>\n")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"traceroute")," command creates a traceroute context for probing the path to a specified endpoint. Traceroute targets can be specified as SVR peers, service/tenant defined endpoints, or targets reachable by routing."),(0,i.kt)("h4",{id:"keyword-arguments"},"Keyword Arguments"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Element"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"egress-interface"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"Network interface on which to originate the traceroute session")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"gateway-ip"),(0,i.kt)("td",{parentName:"tr",align:null},"IP address"),(0,i.kt)("td",{parentName:"tr",align:null},"The gateway address on the egress interface")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"max-hops"),(0,i.kt)("td",{parentName:"tr",align:null},"integer"),(0,i.kt)("td",{parentName:"tr",align:null},"The maximum number of hops before the operation is terminated")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"node"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"The node on which to start the traceroute")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"peer"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"The peer name for the traceroute command (default is empty)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"router"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"The router on which to start the traceroute")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"service"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"The service for the traceroute command (default is empty)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"source-ip"),(0,i.kt)("td",{parentName:"tr",align:null},"IP address"),(0,i.kt)("td",{parentName:"tr",align:null},"The source address. Optional if the matching service utilizes a source-nat (default: 127.0.0.1)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"tenant"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"The tenant name for the traceroute command (default is empty)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"wait-time"),(0,i.kt)("td",{parentName:"tr",align:null},"integer"),(0,i.kt)("td",{parentName:"tr",align:null},"The maximum time, in seconds, to wait for a response to each probe (default 3s)")))),(0,i.kt)("h4",{id:"positional-arguments"},"Positional Arguments"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Element"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"destination-ip"),(0,i.kt)("td",{parentName:"tr",align:null},"IP address"),(0,i.kt)("td",{parentName:"tr",align:null},"The destination address")))),(0,i.kt)("p",null,"To define each of the traceroute types, enter at least the following parameters:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Service Traceroute"),": Enter the service name and destination-ip. (Additional arguments are optional)"),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"traceroute service <service-name> tenant <tenant-name> source-ip <address> <destination-ip>")),(0,i.kt)("p",{parentName:"li"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"source-ip")," is only required if there is no ",(0,i.kt)("inlineCode",{parentName:"p"},"source-nat")," configured. If you omit the ",(0,i.kt)("inlineCode",{parentName:"p"},"source-ip")," without ",(0,i.kt)("inlineCode",{parentName:"p"},"source-nat")," configured, then you will get an error requesting to either apply ",(0,i.kt)("inlineCode",{parentName:"p"},"source-nat,")," or provide a ",(0,i.kt)("inlineCode",{parentName:"p"},"source-ip"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Routed Traceroute"),": Enter the destination-ip. By specifying the optional arguments ",(0,i.kt)("inlineCode",{parentName:"p"},"egress-interface")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"gateway-ip"),", routed traceroute will bypass the service, tenant, and routing table. "),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"traceroute <destination-ip> egress-interface <interface-name> <gateway-ip>"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Peer Traceroute"),": Enter the peer name, egress-interface, and destination-ip. (Additional arguments are optional)"),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"traceroute peer <peer> egress-interface <interface-name> <destination-ip>")),(0,i.kt)("p",{parentName:"li"},"Peer name, egress-interface, and destination IP can be found using the ",(0,i.kt)("inlineCode",{parentName:"p"},"show peers")," command:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"admin@combo-west-a.combo-west# show peers\nFri 2023-12-08 18:29:26 UTC\n\u2714 Retrieving peer paths...\n\n========= ========= =================== ================ ======== ============= ==========\n Peer      Node      Network Interface   Destination      Status   Hostname      Path MTU\n========= ========= =================== ================ ======== ============= ==========\n test-3    runner    intf1               192.168.128.2    up       unavailable       1500\n\nCompleted in 0.11 seconds\n")))),(0,i.kt)("h4",{id:"example-service-traceroute"},"Example Service Traceroute:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"admin@combo-west-a.combo-west# traceroute service east tenant red 172.16.1.201\nRunning traceroute...\ntraceroute to 172.16.1.201, 64 hops max \n1. 172.16.102.101 10ms 7ms 1ms\n2. 172.16.101.1 20ms 5ms 2ms\n3. 172.16.4.1 42ms 5ms 6ms\n4. 172.16.1.201 4ms 4ms 3ms\n")),(0,i.kt)("h3",{id:"show-command"},"Show Command"),(0,i.kt)("p",null,"Use ",(0,i.kt)("inlineCode",{parentName:"p"},"show stats traceroute")," to display traceroute metrics."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"admin@combo-west-a.combo-west# show stats traceroute \n\nTue 2023-02-07 14:55:09 UTC \n\nRetrieving statistics... \n\nTraceroute Handling Stats \n\n------------------------- \n\n============================= ============== ======= \n\n Metric                        Node           Value \n\n============================= ============== ======= \n\n received port-unreachable     combo-west-a       1 \n\n received ttl-expired          combo-west-a       3 \n\n received unexpected-packets   combo-west-a       0 \n\nCompleted in 0.04 seconds \n")))}m.isMDXComponent=!0}}]);
"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[4556],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return f}});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),f=i,m=d["".concat(l,".").concat(f)]||d[f]||p[f]||a;return n?r.createElement(m,o(o({ref:t},u),{},{components:n})):r.createElement(m,o({ref:t},u))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var c=2;c<a;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},835:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return f},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return p}});var r=n(87462),i=n(63366),a=(n(67294),n(3905)),o=["components"],s={title:"Multicast",sidebar_label:"Multicast"},l=void 0,c={unversionedId:"config_multicast",id:"config_multicast",title:"Multicast",description:"Multicast is a \u201cone source, many destinations\u201d method of traffic distribution, meaning only the destinations that explicitly indicate their need to receive the information from a particular source receive the traffic stream.",source:"@site/docs/config_multicast.md",sourceDirName:".",slug:"/config_multicast",permalink:"/docs/config_multicast",draft:!1,tags:[],version:"current",lastUpdatedAt:1693421765,formattedLastUpdatedAt:"Aug 30, 2023",frontMatter:{title:"Multicast",sidebar_label:"Multicast"},sidebar:"docs",previous:{title:"BFD with BGP and OSPF",permalink:"/docs/config_bfd"},next:{title:"Link Aggregation and LACP",permalink:"/docs/config_lacp"}},u={},p=[{value:"Multicast on the SSR",id:"multicast-on-the-ssr",level:2},{value:"Multicast Configuration",id:"multicast-configuration",level:3},{value:"Configuration Process",id:"configuration-process",level:3},{value:"Configuration for rtr2",id:"configuration-for-rtr2",level:4},{value:"Configuration for Spoke 1 (rtr0)",id:"configuration-for-spoke-1-rtr0",level:4},{value:"Configuration for Spoke 2 (rtr1)",id:"configuration-for-spoke-2-rtr1",level:4},{value:"Configure the Service",id:"configure-the-service",level:4},{value:"Other Considerations",id:"other-considerations",level:4},{value:"Show Commands",id:"show-commands",level:2}],d={toc:p};function f(e){var t=e.components,s=(0,i.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Multicast is a \u201cone source, many destinations\u201d method of traffic distribution, meaning only the destinations that explicitly indicate their need to receive the information from a particular source receive the traffic stream."),(0,a.kt)("p",null,"Network applications that can function with unicast but are better suited for multicast include collaborative groupware, teleconferencing, periodic or \u201cpush\u201d data delivery (stock quotes, sports scores, magazines, newspapers, and advertisements), server or website replication, and distributed interactive simulation (DIS) such as war simulations or virtual reality. Any IP network concerned with reducing network resource overhead for one-to-many or many-to-many data or multimedia applications with multiple receivers benefits from multicast."),(0,a.kt)("p",null,"Please refer to the ",(0,a.kt)("a",{parentName:"p",href:"https://www.juniper.net/documentation/us/en/software/junos/multicast/topics/concept/multicast-ip-overview.html"},"Juniper Multicast Overview")," for more in-depth information about Multicast. "),(0,a.kt)("h2",{id:"multicast-on-the-ssr"},"Multicast on the SSR"),(0,a.kt)("p",null,"Multicast on the SSR supports the following protocols and topology: "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"PIM Sparse-Mode"),(0,a.kt)("li",{parentName:"ul"},"PIM Source-Specific Multicast (PIM-SSM)"),(0,a.kt)("li",{parentName:"ul"},"Static Configuration of RP"),(0,a.kt)("li",{parentName:"ul"},"IGMP v2/v3"),(0,a.kt)("li",{parentName:"ul"},"Multicast over SVR in Hub and Spoke topology")),(0,a.kt)("h3",{id:"multicast-configuration"},"Multicast Configuration"),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"In order to support Multicast over SVR, the BGP over SVR configuration is used in conjunction with the PIM configuration to generate auto-provisioned services and service-paths. BGP over SVR must be provisioned to support the Multicast feature. See ",(0,a.kt)("a",{parentName:"p",href:"/docs/config_bgp#bgp-over-svr-bgposvr"},"BGP over SVR")," for configuration details. ")),(0,a.kt)("p",null,"The following are the components necessary to configure multicast over SVR on the SSR. Configuration for each of the components is provided below, and a full example configuration is provided at the end of this process. "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Routing Interface: Specify the BGP over SVR interface"),(0,a.kt)("li",{parentName:"ul"},"BGP over SVR: See ",(0,a.kt)("a",{parentName:"li",href:"/docs/config_bgp#bgp-over-svr-bgposvr"},"BGP over SVR")," for configuration details. "),(0,a.kt)("li",{parentName:"ul"},"Routing protocol such as IGMPv2/v3"),(0,a.kt)("li",{parentName:"ul"},"PIM"),(0,a.kt)("li",{parentName:"ul"},"RP: The Rendezvous Point. In the current implementation, the RP must be external to the SSR. "),(0,a.kt)("li",{parentName:"ul"},"Service: Services are created for the multicast traffic, and defined for the Group address."),(0,a.kt)("li",{parentName:"ul"},"Multicast-sender-policy: Defines the tenant that is allowed to be the source of the multicast stream."),(0,a.kt)("li",{parentName:"ul"},"Access Policy: Configures the tenants allowed to receive the multicast traffic via IGMP joins at routers in the network. ")),(0,a.kt)("p",null,"Refer to ",(0,a.kt)("a",{parentName:"p",href:"/docs/config_tenants"},"Tenants")," for more information on configuring Tenants."),(0,a.kt)("h3",{id:"configuration-process"},"Configuration Process"),(0,a.kt)("p",null,"The following diagram represents a simple multicast configuration. A Client sends a multicast to address 225.1.1.1. Location1 and Location2 want to receive this multicast stream. The network is setup to use an external, non-SSR Rendezvous Point (RP) at 20.20.20.20 for all multicast traffic. This router is 192.168.22.2 and is configured for BGP with SSR rtr2. It advertises 20.20.20.20 as the RP for multicast into BGP,  allowing the SSR network to identify the path to the RP."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Multicast diagram",src:n(32714).Z,width:"2062",height:"1200"})),(0,a.kt)("p",null,"Key points in the rtr2 configuration:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"BGP is configured with the external router, 192.168.22.2"),(0,a.kt)("li",{parentName:"ul"},"BGP over SVR is configured with two spokes"),(0,a.kt)("li",{parentName:"ul"},"PIM is configured on the LAN interface towards the external router"),(0,a.kt)("li",{parentName:"ul"},"The tenant ",(0,a.kt)("inlineCode",{parentName:"li"},"edsel")," is configured on the LAN interface")),(0,a.kt)("h4",{id:"configuration-for-rtr2"},"Configuration for rtr2"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"config\n    authority\n        router  rtr2\n            node                 node1\n                name              node1\n                device-interface  eth6\n                    network-interface  lan3\n                        name       lan3\n                        tenant     edsel\n                        address    192.168.22.1\n                            ip-address     192.168.22.1\n                            prefix-length  30\n                            gateway        192.168.22.2\n                        exit\n                    exit\n                exit\n            exit\n            routing              default-instance\n                type              default-instance\n                routing-protocol  bgp\n                    type            bgp\n                    local-as        65128\n                    neighbor        192.168.22.2\n                        neighbor-address  192.168.22.2\n                        neighbor-as       65100\n                    exit\n                    neighbor        192.168.128.0\n                        neighbor-address  192.168.128.0\n                        neighbor-as       65128\n                        transport\n\n                            local-address\n                                routing-interface  loopback0\n                            exit\n                        exit\n                        address-family    ipv4-unicast\n                            afi-safi       ipv4-unicast\n                            next-hop-self  true\n                        exit\n                    exit\n                    neighbor        192.168.128.1\n                        neighbor-address  192.168.128.1\n                        neighbor-as       65128\n                        transport\n\n                            local-address\n                                routing-interface  loopback0\n                            exit\n                        exit\n                        address-family    ipv4-unicast\n                            afi-safi       ipv4-unicast\n                            next-hop-self  true\n                        exit\n                    exit\n                exit\n                pim\n                    interface  node1 lan3\n                        node       node1\n                        interface  lan3\n                    exit\n                    rp         224.0.0.0/4\n                        address      20.20.20.20\n                        group-range  224.0.0.0/4\n                    exit\n                exit\n")),(0,a.kt)("h4",{id:"configuration-for-spoke-1-rtr0"},"Configuration for Spoke 1 (rtr0)"),(0,a.kt)("p",null,"Key points for the Spoke configuration - this applies to each spoke, since the configuration is nearly identical."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"BGP over SVR configured to the hub"),(0,a.kt)("li",{parentName:"ul"},"PIM configured with the same RP on the LAN interface"),(0,a.kt)("li",{parentName:"ul"},"IGMP configured on the LAN interface"),(0,a.kt)("li",{parentName:"ul"},"Using tenant ",(0,a.kt)("inlineCode",{parentName:"li"},"studebaker")," on the LAN where the IGMP joins originate")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"config\n    authority\n        router  rtr0\n            node                 node1\n                device-interface  eth3\n                    network-interface  lan0\n                        tenant     studebaker\n                        address    192.168.0.1\n                            ip-address     192.168.0.1\n                            prefix-length  24\n                        exit\n                    exit\n                exit\n            exit\n            routing              default-instance\n                type              default-instance\n                interface         loopback0\n                    name        loopback0\n                    ip-address  192.168.128.0\n                exit\n                routing-protocol  bgp\n                    type            bgp\n                    local-as        65128\n                    address-family  ipv4-unicast\n                        afi-safi  ipv4-unicast\n                        network   192.168.0.0/24\n                            network-address  192.168.0.0/24\n                        exit\n                    exit\n                    neighbor        192.168.128.2\n                        neighbor-address  192.168.128.2\n                        neighbor-as       65128\n                        transport\n\n                            local-address\n                                routing-interface  loopback0\n                            exit\n                        exit\n                    exit\n                exit\n                igmp\n                    interface  node1 lan0\n                        node       node1\n                        interface  lan0\n                    exit\n                exit\n                pim\n                    interface  node1 lan0\n                        node       node1\n                        interface  lan0\n                    exit\n                    rp         225.0.0.0/4\n                        address      20.20.20.20\n                        group-range  225.0.0.0/4\n                    exit\n                exit\n            exit\n        exit\n    exit\nexit\n")),(0,a.kt)("h4",{id:"configuration-for-spoke-2-rtr1"},"Configuration for Spoke 2 (rtr1)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"config\n    authority\n        router  rtr1\n            node                 node1\n                device-interface  eth3\n                    network-interface  lan0\n                        tenant     studebaker\n                        address    192.168.1.1\n                            ip-address     192.168.1.1\n                            prefix-length  24\n                        exit\n                    exit\n                exit\n            exit\n            routing              default-instance\n                type              default-instance\n                interface         loopback0\n                    name        loopback0\n                    ip-address  192.168.128.1\n                exit\n                routing-protocol  bgp\n                    type            bgp\n                    local-as        65128\n                    address-family  ipv4-unicast\n                        afi-safi  ipv4-unicast\n                        network   192.168.1.0/24\n                            network-address  192.168.1.0/24\n                        exit\n                    exit\n                    neighbor        192.168.128.2\n                        neighbor-address  192.168.128.2\n                        neighbor-as       65128\n                        transport\n                            local-address\n                                routing-interface  loopback0\n                            exit\n                        exit\n                    exit\n                exit\n                igmp\n                    interface  node1 lan0\n                        node       node1\n                        interface  lan0\n                    exit\n                exit\n                pim\n                    interface  node1 lan0\n                        node       node1\n                        interface  lan0\n                    exit\n                    rp         224.0.0.0/4\n                        address      20.20.20.20\n                        group-range  224.0.0.0/4\n                    exit\n                exit\n            exit\n        exit\n    exit\nexit\n")),(0,a.kt)("h4",{id:"configure-the-service"},"Configure the Service"),(0,a.kt)("p",null,"The service allows the traffic to flow. It allows the tenant from the hub ",(0,a.kt)("inlineCode",{parentName:"p"},"edsel")," to send the multicast stream, and the tenants ",(0,a.kt)("inlineCode",{parentName:"p"},"studebaker")," on each spoke can join and receive the multicast stream.   "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"config\n    authority\n        service  multicast\n            name                     multicast\n            address                  224.0.0.0/4\n            access-policy            studebaker\n                source  studebaker\n            exit\n            multicast-sender-policy  edsel\n                source  edsel\n            exit\n        exit\n    exit\nexit\n")),(0,a.kt)("h4",{id:"other-considerations"},"Other Considerations"),(0,a.kt)("p",null,"While this configuration example uses one RP for the multicast range, you can use different RPs for different multicast addresses or ranges. The same can be done for the service; smaller services for more specific ranges of multicast with different senders and receivers as needed."),(0,a.kt)("h2",{id:"show-commands"},"Show Commands"),(0,a.kt)("p",null,"Each of the commands listed below and the subcommands for each, provide additional details for multicast visibility. Use the links to learn more about each command."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Command"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/docs/cli_reference#show-igmp-interface"},"show igmp interface")),(0,a.kt)("td",{parentName:"tr",align:null},"Display the igmp interfaces")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/docs/cli_reference#show-igmp-groups"},"show igmp groups")),(0,a.kt)("td",{parentName:"tr",align:null},"Display the igmp groups")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/docs/cli_reference#show-pim-mroute"},"show pim mroute")),(0,a.kt)("td",{parentName:"tr",align:null},"Display the PIM mroute")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/docs/cli_reference#show-pim-interface"},"show pim interface")),(0,a.kt)("td",{parentName:"tr",align:null},"Display the PIM interface")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/docs/cli_reference#show-pim-join"},"show pim join")),(0,a.kt)("td",{parentName:"tr",align:null},"Display the PIM Joins")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/docs/cli_reference#show-pim-neighbor"},"show pim neighbor")),(0,a.kt)("td",{parentName:"tr",align:null},"Display the PIM neighbor")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/docs/cli_reference#show-pim-rp-info"},"show pim rp-info")),(0,a.kt)("td",{parentName:"tr",align:null},"Display the PIM RP info")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"/docs/cli_reference#show-pim-state"},"show pim state")),(0,a.kt)("td",{parentName:"tr",align:null},"Display the PIM state")))),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Each show command allows a vrf option:\n",(0,a.kt)("inlineCode",{parentName:"p"},"show ip igmp [vrf <vrfname>]")," ")))}f.isMDXComponent=!0},32714:function(e,t,n){t.Z=n.p+"assets/images/config_multicast-4cb2c030f1789f1575ed5998fe943a78.png"}}]);
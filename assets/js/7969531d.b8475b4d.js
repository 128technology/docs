"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[2987],{87225:(e,r,o)=>{o.r(r),o.d(r,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>d,toc:()=>c});var n=o(74848),s=o(28453);const t={title:"Upgrades with Restricted Internet Access",sidebar_label:"Upgrades with Restricted Internet Access"},i=void 0,d={id:"upgrade_restricted_access",title:"Upgrades with Restricted Internet Access",description:'In some secure deployments where networks are strictly internal to an organization, SSR devices do not have access to the internet to download updated software. In these networks, referred to as "air-gap" networks, it is necessary to manually download the SSR software on to a device such as a USB and perform an upgrade from inside the network.',source:"@site/docs/upgrade_restricted_access.md",sourceDirName:".",slug:"/upgrade_restricted_access",permalink:"/docs/upgrade_restricted_access",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Upgrades with Restricted Internet Access",sidebar_label:"Upgrades with Restricted Internet Access"},sidebar:"docs",previous:{title:"Upgrading a Router",permalink:"/docs/upgrade_router"},next:{title:"Legacy Upgrades",permalink:"/docs/upgrade_legacy"}},a={},c=[{value:"How Does It Work?",id:"how-does-it-work",level:2},{value:"Setting Offline Mode",id:"setting-offline-mode",level:3},{value:"Air-Gap Network Upgrade Process",id:"air-gap-network-upgrade-process",level:2},{value:"Upgrade Considerations",id:"upgrade-considerations",level:3},{value:"Single-Version 6.3.0 Upgrade",id:"single-version-630-upgrade",level:3},{value:"Mixed Version Upgrade",id:"mixed-version-upgrade",level:3},{value:"Package-based Software Upgrade",id:"package-based-software-upgrade",level:3},{value:"Import ISO",id:"import-iso",level:3}];function l(e){const r={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.p,{children:'In some secure deployments where networks are strictly internal to an organization, SSR devices do not have access to the internet to download updated software. In these networks, referred to as "air-gap" networks, it is necessary to manually download the SSR software on to a device such as a USB and perform an upgrade from inside the network.'}),"\n",(0,n.jsxs)(r.p,{children:["To identify a device in an air-gap network, SSR conductors and routers are configured in ",(0,n.jsx)(r.code,{children:"offline-mode"}),", indicating they do not have internet access. This is defined in the ",(0,n.jsx)(r.code,{children:"router > system > software-update > repository"})," configuration, using the ",(0,n.jsx)(r.code,{children:"source-type"})," setting. Upgrading devices in this configuration is addressed in this document."]}),"\n",(0,n.jsx)(r.p,{children:"Other configurable software update modes on a router:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"conductor-only"}),": The router retrieves software versions only from the conductor. This is often used on internal networks where the routers do not have direct internet access."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"prefer-conductor"}),": The router will retrieve software versions from the conductor, but if the conductor is not available it will fall back to using the internet."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"internet-only"})," (default): The router will use Juniper's publicly hosted repositories for retrieving software images."]}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["For information about configuring software access modes on a router, please see ",(0,n.jsx)(r.a,{href:"/docs/config_reference_guide#software-update",children:(0,n.jsx)(r.code,{children:"software-update"})})]}),"\n",(0,n.jsx)(r.h2,{id:"how-does-it-work",children:"How Does It Work?"}),"\n",(0,n.jsxs)(r.p,{children:["In networks that do not have internet access, routers are configured to override the ",(0,n.jsx)(r.code,{children:"source-type"})," setting and retrieve software directly from the conductor."]}),"\n",(0,n.jsx)(r.h3,{id:"setting-offline-mode",children:"Setting Offline Mode"}),"\n",(0,n.jsxs)(r.p,{children:["In the GUI, set ",(0,n.jsx)(r.code,{children:"router > system > software-update > repository > offline-mode"})," to ",(0,n.jsx)(r.code,{children:"true"}),"."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:"From the PCLI:"})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"config\n    authority\n        router\n            system\n                software-update\n                    repository\n                        offline-mode true\n                    exit\n                exit\n            exit\n        exit\n    exit\nexit\n"})}),"\n",(0,n.jsx)(r.h2,{id:"air-gap-network-upgrade-process",children:"Air-Gap Network Upgrade Process"}),"\n",(0,n.jsx)(r.p,{children:"The following are use cases for upgrades within an air-gap network."}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"#single-version-630-upgrade",children:"Single-Version 6.3.0 Upgrade"}),"."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"#mixed-version-upgrade",children:"Mixed Version Upgrade"}),", where the conductor is upgraded to version 6.3 and the routers are upgraded to earlier image-based versions, or left to be upgraded later."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"#package-based-software-upgrade",children:"Package-based Software Upgrade"}),"."]}),"\n"]}),"\n",(0,n.jsx)(r.admonition,{type:"note",children:(0,n.jsx)(r.p,{children:"Use these procedures for upgrades only. When performing an initial installation of version 6.3.x software or greater, the image-based SSR ISO is required."})}),"\n",(0,n.jsx)(r.h3,{id:"upgrade-considerations",children:"Upgrade Considerations"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:"Offline-Mode: Upgrading 6.3.x Conductor Deployments to 6.3.x+"})}),"\n",(0,n.jsxs)(r.p,{children:["An issue has been identified that may be observed in conductor deployments running version 6.3.x software, when attempting to upgrade from one 6.3.x patch release to another. This results in the message, ",(0,n.jsx)(r.code,{children:"SSR firmware upgrade failed for the local node: SSR upgrade failed after reboot"}),". To work around this, run ",(0,n.jsx)(r.code,{children:"request system software upgrade installation-service"})," from the command line of the Conductor, after importing the image-based ISO. Once complete, perform the full system upgrade from the Web-interface. This issue will be resolved in a future release."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:"Offline-Mode: Onboarding Routers Running older SSR Software to a 6.3.x Conductor"})}),"\n",(0,n.jsxs)(r.p,{children:["We have identified an issue when onboarding SSR routers installed with older versions of software (such as 5.4.4) to Conductors running 6.3.x, when running in offline-mode. In some cases, certain software packages are not available to be installed during onboarding. To work around this issue, import the ",(0,n.jsx)(r.strong,{children:"package-based"}),' (the "128T" prefixed) ISO for the current conductor version onto the conductor. This provides the necessary software packages to complete the onboarding process. This issue will be resolved in a future release.']}),"\n",(0,n.jsx)(r.h3,{id:"single-version-630-upgrade",children:"Single-Version 6.3.0 Upgrade"}),"\n",(0,n.jsxs)(r.p,{children:["The following process is used to upgrade a Conductor and Conductor-managed Routers to ",(0,n.jsx)(r.strong,{children:"version 6.3.0"})," of the SSR software. Beginning with SSR software version 6.3.0, a conductor can manage routers running image-based software installations."]}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["On a system that has internet access, use the ",(0,n.jsx)(r.a,{href:"/docs/intro_downloading_iso#downloading-an-iso",children:"ISO Download procedure"})," to download the ",(0,n.jsx)(r.code,{children:"128T-6.3.0-107.r1.el7.OTP.v1.x86_64.iso"})," from the ",(0,n.jsx)(r.a,{href:"https://software.128technology.com/artifactory/list/generic-128t-isos-release-local/6.3/",children:"6.3 Package Based ISO Download"})," page."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.a,{href:"/docs/intro_creating_bootable_usb",children:"Create a bootable USB"})," drive from the downloaded ISO."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Import the ",(0,n.jsx)(r.code,{children:"128T-6.3.0-107.r1.el7.OTP.v1.x86_64.iso"})," ISO onto the conductor using the ",(0,n.jsx)(r.a,{href:"#import-iso",children:(0,n.jsx)(r.code,{children:"import iso"})})," command."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Upgrade the conductor using the ",(0,n.jsx)(r.a,{href:"/docs/upgrade_ibu_conductor",children:"Conductor Upgrade procedure"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Download the ",(0,n.jsx)(r.code,{children:"SSR-6.3.0-107.r1.el7.x86_64.ibu-v1.iso"})," from the ",(0,n.jsx)(r.a,{href:"https://software.128technology.com/artifactory/list/generic-128t-install-images-release-local",children:"SSR Software Images"})," page. "]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.a,{href:"/docs/intro_creating_bootable_usb",children:"Create a bootable USB"})," drive from the SSR ISO."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Import the ",(0,n.jsx)(r.code,{children:"SSR-6.3.0-xx.r1.el7.x86_64.ibu-v1.iso"})," ISO onto the conductor. The conductor will act as the software repository for the subsequent router upgrades. Do ",(0,n.jsx)(r.strong,{children:"not"})," install this package onto the conductor, only import it."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Upgrade individual routers using the ",(0,n.jsx)(r.a,{href:"/docs/upgrade_router",children:"Router Upgrade"})," procedure."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.admonition,{type:"note",children:(0,n.jsxs)(r.p,{children:["The process to upgrade a ",(0,n.jsx)(r.strong,{children:"conductor from a version less than 6.3.0 to 6.3.0 or greater"})," requires the use of the ",(0,n.jsx)(r.code,{children:"128T-6.3.X-XX.r1.el7.OTP.v1.x86_64.iso"})," package based 128T ISO. After the initial upgrade to 6.3.X, all future upgrades will only require the import of the image-based SSR ISO; for example, ",(0,n.jsx)(r.code,{children:"SSR-6.3.3-1.r1.el7.x86_64.ibu-v1.iso"}),"."]})}),"\n",(0,n.jsx)(r.h3,{id:"mixed-version-upgrade",children:"Mixed Version Upgrade"}),"\n",(0,n.jsxs)(r.p,{children:["If you are upgrading to version 6.3.0 on the Conductor and wish to upgrade the routers, note that after the conductor is upgraded to 6.3.x, routers upgraded to 6.1 or greater will require the image-based SSR ISO. In versions prior to version 6.3.0, image-based software running on conductor-managed routers was not supported, however version 6.3.0 allows your conductor to manage routers running ",(0,n.jsx)(r.strong,{children:"both"})," image-based and package-based software."]}),"\n",(0,n.jsx)(r.p,{children:"The following workflow demonstrates upgrading a conductor to version 6.3.0, and a router to version 6.1.10."}),"\n",(0,n.jsx)(r.admonition,{type:"note",children:(0,n.jsxs)(r.p,{children:["The process to upgrade a ",(0,n.jsx)(r.strong,{children:"conductor to 6.3.0"})," requires the use of the ",(0,n.jsx)(r.code,{children:"128T-6.3.0-107.r1.el7.OTP.v1.x86_64.iso"}),". After the initial upgrade to 6.3.0, all future upgrades will only require the import of the ",(0,n.jsx)(r.code,{children:"SSR-6.3.X-XX.r1.el7.x86_64.ibu-v1.iso"}),"."]})}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["On a system that has internet access, use the ",(0,n.jsx)(r.a,{href:"/docs/intro_downloading_iso#downloading-an-iso",children:"ISO Download procedure"})," to download the ",(0,n.jsx)(r.code,{children:"128T-6.3.0-107.r1.el7.OTP.v1.x86_64.iso"})," from the ",(0,n.jsx)(r.a,{href:"https://software.128technology.com/artifactory/list/generic-128t-isos-release-local",children:"SSR ISO Download"})," page."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.a,{href:"/docs/intro_creating_bootable_usb",children:"Create a bootable USB"})," drive from the SSR ISO."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Import the ",(0,n.jsx)(r.code,{children:"128T-6.3.0-107.r1.el7.OTP.v1.x86_64.iso"})," ISO onto the conductor using the ",(0,n.jsx)(r.a,{href:"#import-iso",children:(0,n.jsx)(r.code,{children:"import iso"})})," command."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Upgrade the conductor using the ",(0,n.jsx)(r.a,{href:"/docs/upgrade_ibu_conductor",children:"Conductor Upgrade procedure"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Navigate to the ",(0,n.jsx)(r.a,{href:"https://software.128technology.com/artifactory/list/generic-128t-install-images-release-local",children:"SSR Software Images"})," page, identify the software image version you will use to upgrade the target router or routers, and download it. "]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"For example, if you are upgrading a router to SSR Version 6.1.10, you will need to download the following files:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.code,{children:"SSR-6.1.10-8.lts.el7.x86_64.ibu-v1.iso"})}),"\n"]}),"\n",(0,n.jsxs)(r.ol,{start:"6",children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.a,{href:"/docs/intro_creating_bootable_usb",children:"Create a bootable USB"})," drive from the SSR ISO."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Import the ",(0,n.jsx)(r.code,{children:"SSR-6.1.10-8.lts.el7.x86_64.ibu-v1.iso"})," ISO onto the conductor. The conductor will act as the software repository for the subsequent router upgrades. Do ",(0,n.jsx)(r.strong,{children:"not"})," install this package onto the conductor, only import it."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Upgrade individual routers using the ",(0,n.jsx)(r.a,{href:"/docs/upgrade_router",children:"Router Upgrade"})," procedure."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.admonition,{type:"note",children:(0,n.jsx)(r.p,{children:"In an HA setup, when using offline-mode for routers to access the software from the conductors, the ISO must be imported to both conductors before performing the upgrade."})}),"\n",(0,n.jsx)(r.h3,{id:"package-based-software-upgrade",children:"Package-based Software Upgrade"}),"\n",(0,n.jsx)(r.p,{children:"For upgrades of Conductor and Conductor-managed routers to software versions prior to 6.3.0, the package-based ISO's are used."}),"\n",(0,n.jsx)(r.p,{children:"In this example workflow, the conductor will be upgraded to 6.2.6, and the routers to 6.1.10."}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["On a system that has internet access, use the ",(0,n.jsx)(r.a,{href:"/docs/intro_downloading_iso#downloading-an-iso",children:"ISO Download procedure"})," to download the ",(0,n.jsx)(r.code,{children:"128T-6.2.6-15.sts.el7.OTP.v1.x86_64.iso"})," software package from the ",(0,n.jsx)(r.a,{href:"https://software.128technology.com/artifactory/list/generic-128t-isos-release-local",children:"128T package-based ISO Download"})," page."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.a,{href:"/docs/intro_creating_bootable_usb",children:"Create a bootable USB"})," drive from the SSR ISO."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:"Plug the USB into your device."}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Import the ",(0,n.jsx)(r.code,{children:"128T-6.2.6-15.sts.el7.OTP.v1.x86_64.iso"})," package onto the conductor using the ",(0,n.jsx)(r.a,{href:"#import-iso",children:(0,n.jsx)(r.code,{children:"import iso"})})," command."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Upgrade the conductor using the ",(0,n.jsx)(r.a,{href:"/docs/upgrade_ibu_conductor",children:"Conductor Upgrade procedure"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Download the ",(0,n.jsx)(r.code,{children:"128T-6.1.10-8.lts.el7.OTP.v1.x86_64.iso"})," software package from the ",(0,n.jsx)(r.a,{href:"https://software.128technology.com/artifactory/list/generic-128t-isos-release-local",children:"SSR ISO Download"})," page. "]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Import the ",(0,n.jsx)(r.code,{children:"128T-6.1.10-8.lts.el7.OTP.v1.x86_64.iso"})," package onto the conductor using the ",(0,n.jsx)(r.a,{href:"#import-iso",children:(0,n.jsx)(r.code,{children:"import iso"})})," command. The conductor will act as the software repository for the subsequent router upgrades. You do ",(0,n.jsx)(r.strong,{children:"not"})," install this package onto the conductor, only import it."]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsxs)(r.p,{children:["Upgrade individual routers using the ",(0,n.jsx)(r.a,{href:"/docs/upgrade_router",children:"Router Upgrade"})," procedure."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"import-iso",children:"Import ISO"}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.a,{href:"/docs/cli_reference#import-iso",children:(0,n.jsx)(r.code,{children:"import iso"})})," command is used to import the SSR ISO onto a local repository, allowing the SSR to be upgraded without connecting to Juniper servers. When upgrading a conductor or when ",(0,n.jsx)(r.code,{children:"offline-mode"})," is defined for a router, the ISO must be imported to the target conductor to perform the upgrade."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.code,{children:"import iso [check-rpm-signature <check-rpm-signature>] [force] [verbose] {hunt | filepath <filepath>}"})}),"\n",(0,n.jsxs)(r.p,{children:["Use the ",(0,n.jsx)(r.code,{children:"filepath"})," argument to specify the exact location of the ISO. ",(0,n.jsx)(r.code,{children:"hunt"})," will search for files that match the patterns ",(0,n.jsx)(r.code,{children:"128T*.iso"}),", ",(0,n.jsx)(r.code,{children:"SSR*.iso"}),", or ",(0,n.jsx)(r.code,{children:"SSR*.tar"}),", and the corresponding checksum and signature files. These checksum and signature files are essential for security verification and are included as part of the ",(0,n.jsx)(r.code,{children:"import iso"})," operation. To install the 6.3.0 software, the following file must be downloaded to the USB and imported onto the conductor:"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.code,{children:"SSR-6.3.0-107.r1.el7.x86_64.ibu-v1.iso"})}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"After the local software repository has been updated with the ISO, the upgrade can proceed."})]})}function h(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},28453:(e,r,o)=>{o.d(r,{R:()=>i,x:()=>d});var n=o(96540);const s={},t=n.createContext(s);function i(e){const r=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),n.createElement(t.Provider,{value:r},e.children)}}}]);
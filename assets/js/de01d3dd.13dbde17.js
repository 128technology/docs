"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[1832],{43667:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var i=s(74848),t=s(28453);const r={title:"Static Bi-directional NAT",sidebar_label:"Static Bi-directional NAT"},o=void 0,c={id:"config_static_nat",title:"Static Bi-directional NAT",description:"SSR supports source NAT pool configurations at interface and service-route level as described in Static NAT Bindings. However, this is not always sufficient to enable simple configuration for static bidirectional NAT between two same-sized subnets.",source:"@site/docs/config_static_nat.md",sourceDirName:".",slug:"/config_static_nat",permalink:"/docs/config_static_nat",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Static Bi-directional NAT",sidebar_label:"Static Bi-directional NAT"},sidebar:"docs",previous:{title:"Source and Destination NAT",permalink:"/docs/config_source-dest_nat"},next:{title:"Dynamic Ingress Source NAT",permalink:"/docs/config_dnat"}},a={},d=[{value:"Example",id:"example",level:4},{value:"Non-SVR Traffic",id:"non-svr-traffic",level:2},{value:"Service Level",id:"service-level",level:3},{value:"Network Interface Level",id:"network-interface-level",level:3},{value:"Service Route Level",id:"service-route-level",level:3},{value:"Using the GUI",id:"using-the-gui",level:2},{value:"Show Commands",id:"show-commands",level:2},{value:"Source NAT",id:"source-nat",level:3},{value:"Destination NAT",id:"destination-nat",level:3},{value:"Version History",id:"version-history",level:4}];function l(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["SSR supports source NAT pool configurations at interface and service-route level as described in ",(0,i.jsx)(n.a,{href:"/docs/config_nat_pools#static-nat-bindings",children:"Static NAT Bindings"}),". However, this is not always sufficient to enable simple configuration for static bidirectional NAT between two same-sized subnets."]}),"\n",(0,i.jsx)(n.p,{children:"Static NAT defines a one-to-one mapping from one IP subnet to another IP subnet. The mapping includes source IP address translation in one direction and destination IP address translation in the reverse direction. In cases where IP address overlapping is found, such as when merging networks (for example, a corporate acquisition and merger) this simple configuration change is significantly less work than changing all the local IP addresses. The diagram below illustrates this example."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Static Nat Diagram",src:s(53532).A+"",width:"488",height:"948"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"spk-lan2"})," network-interface is not routable (cannot send or receive traffic) in the ",(0,i.jsx)(n.code,{children:"Corp"})," and ",(0,i.jsx)(n.code,{children:"Internet"})," networks. The client in ",(0,i.jsx)(n.code,{children:"spk-lan2"})," has a local IP within the ",(0,i.jsx)(n.code,{children:"192.168.1.0/24"})," subnet and overlaps with another client from ",(0,i.jsx)(n.code,{children:"Corp"})," in ",(0,i.jsx)(n.code,{children:"spk-lan1"}),". This will cause problems for any sessions between ",(0,i.jsx)(n.code,{children:"hub-lan1"})," or ",(0,i.jsx)(n.code,{children:"spk-lan1"})," to ",(0,i.jsx)(n.code,{children:"spk-lan2"}),". By configuring ",(0,i.jsx)(n.code,{children:"bidirectional-nat"})," on ",(0,i.jsx)(n.code,{children:"spk-lan1"})," and ",(0,i.jsx)(n.code,{children:"spk-lan2"}),", the two ",(0,i.jsx)(n.code,{children:"192.168.1.0/24"})," subnets are mapped to ",(0,i.jsx)(n.code,{children:"172.16.128.0/24"})," and ",(0,i.jsx)(n.code,{children:"172.16.129.0/24"})," respectively and differentiate themselves on the hub router."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"bidirectional-nat"})," provides value in two ways:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"NAT an unroutable private IP to a routable public IP"}),"\n",(0,i.jsx)(n.li,{children:"NAT duplicate private IPs (on different routers/networks) to different public IPs to provide differentiation on the receiving end"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"config\n    authority\n        router      spoke\n            node       node1-spoke\n                device-interface    spk-lan2\n                    network-interface    spk-lan2\n                        bidirectional-nat    192.168.1.0/24\n                            local-ip         192.168.1.0/24\n                            remote-ip        172.16.128.0/24\n                        exit \n                    exit\n                exit\n                \n                device-interface    spk-lan1\n                    network-interface   spk-lan1\n                        bidirectional-nat    192.168.1.0/24\n                            local-ip         192.168.1.0/24\n                            remote-ip        172.16.129.0/24\n                        exit \n                    exit\n                exit\n            exit\n        exit\n    exit\nexit \n\n"})}),"\n",(0,i.jsx)(n.h2,{id:"non-svr-traffic",children:"Non-SVR Traffic"}),"\n",(0,i.jsx)(n.p,{children:"In order for non-SVR traffic (for example, LAN-to-LAN traffic traversing a single SSR) to take advantage of static-NAT addressing, you must disable egress source-nat. This is done in the following locations within the configuration"}),"\n",(0,i.jsx)(n.h3,{id:"service-level",children:"Service Level"}),"\n",(0,i.jsxs)(n.p,{children:["Disable ",(0,i.jsx)(n.code,{children:"egress source-nat"})," at the service level by setting ",(0,i.jsx)(n.code,{children:"service > source-nat"})," to ",(0,i.jsx)(n.code,{children:"disabled"})," as shown below."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'authority\n    service LAN-to-LAN\n        name LAN-to-LAN\n        description "LAN-to-LAN non-SVR traffic traversing a single SSR router"\n        source-nat disabled\n        scope private\n        security aes1\n        address <dest-lan-subnet>\n        access-policy <src-lan-subnet>\n            source <src-lan-subnet>\n            permission allow\n        exit\n    exit\nexit\n'})}),"\n",(0,i.jsx)(n.h3,{id:"network-interface-level",children:"Network Interface Level"}),"\n",(0,i.jsxs)(n.p,{children:["Disable ",(0,i.jsx)(n.code,{children:"egress source-nat"})," at the network-interface level by setting ",(0,i.jsx)(n.code,{children:"network-interface > source-nat"})," to ",(0,i.jsx)(n.code,{children:"false"})," and not configuring ",(0,i.jsx)(n.code,{children:"network-interface > egress-source-nat-pool"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"authority\n    router SSR-router\n        name SSR-router\n        node SSR-node\n            name SSR-node\n            device-interface egress-LAN\n                name egress-LAN\n                network-interface egress-LAN\n                    name egress-LAN\n                    source-nat false\n                    egress-source-nat-pool <DON'T CONFIGURE>\n                exit\n            exit\n        exit\n    exit\nexit\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-route-level",children:"Service Route Level"}),"\n",(0,i.jsxs)(n.p,{children:["Disable ",(0,i.jsx)(n.code,{children:"egress source-nat"})," at the service-route level by ",(0,i.jsx)(n.strong,{children:"not"})," configuring ",(0,i.jsx)(n.code,{children:"service-route > next-hop > source-nat-pool"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"authority\n    router SSR\n        service-route LAN-to-LAN-route\n            name LAN-to-LAN-route\n            service-name LAN-to-LAN\n            next-hop node egress-LAN\n                node-name SSR-node\n                interface egress-LAN\n                source-nat-pool <DON'T CONFIGURE>\n            exit\n        exit\n    exit\nexit\n"})}),"\n",(0,i.jsx)(n.h2,{id:"using-the-gui",children:"Using the GUI"}),"\n",(0,i.jsx)(n.p,{children:"Set the local and remote IP addresses under Authority > Router > Node > Device Interface > Network Interface."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Network Interface",src:s(17089).A+"",width:"944",height:"230"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Bidirectional NAT Config",src:s(19828).A+"",width:"942",height:"250"})}),"\n",(0,i.jsx)(n.h2,{id:"show-commands",children:"Show Commands"}),"\n",(0,i.jsxs)(n.p,{children:["For details about command output, refer to the ",(0,i.jsx)(n.a,{href:"/docs/cli_reference#show-sessions",children:(0,i.jsx)(n.code,{children:"show sessions"})})," and ",(0,i.jsx)(n.a,{href:"/docs/cli_reference#show-sessions-by-id",children:(0,i.jsx)(n.code,{children:"show sessions by-id"})})," commands."]}),"\n",(0,i.jsx)(n.h3,{id:"source-nat",children:"Source NAT"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["On the session ingress node, the ",(0,i.jsx)(n.code,{children:"show sessions by-id"})," output has an Ingress Source NAT field where the source-nat type, NAT\u2019d source address, NAT\u2019d port, and protocol are displayed."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Session Ingress",src:s(98855).A+"",width:"1642",height:"484"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["On the session egress node the ",(0,i.jsx)(n.code,{children:"show sessions by-id"})," output has an Ingress Source NAT field where the source-nat type, NAT\u2019d source address, NAT\u2019d port, and protocol are displayed."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Session Egress",src:s(96204).A+"",width:"1602",height:"546"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"show sessions"})," output has ",(0,i.jsx)(n.code,{children:"NAT IP"})," and ",(0,i.jsx)(n.code,{children:"NAT Port"})," columns where the NAT\u2019d source address and NAT\u2019d source port are displayed."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"NAT IP and Port",src:s(48469).A+"",width:"1284",height:"302"})}),"\n",(0,i.jsx)(n.h3,{id:"destination-nat",children:"Destination NAT"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["On the session egress node the ",(0,i.jsx)(n.code,{children:"show sessions by-id"})," output shows the NAT\u2019d destination address in the Forward Flow ",(0,i.jsx)(n.code,{children:"NextHop"})," and Reverse Flow ",(0,i.jsx)(n.code,{children:"src ip"})," fields."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Destination forward flow",src:s(48150).A+"",width:"1940",height:"726"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"show sessions"})," output reverse flow ",(0,i.jsx)(n.code,{children:"src ip "}),"column also shows the NAT\u2019d destination address."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Destination Reverse Flow Source IP",src:s(29773).A+"",width:"1290",height:"308"})}),"\n",(0,i.jsx)(n.h4,{id:"version-history",children:"Version History"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Release"}),(0,i.jsx)(n.th,{children:"Modification"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"6.2.0"}),(0,i.jsx)(n.td,{children:"Static NAT Feature Introduced"})]})})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},48150:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/dest-nat1-164a3dad3c58b299aae2cd7fc7c0b3f2.png"},29773:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/dest-nat2-16fc36a4fdfcf8b924bb42df74b0c7e9.png"},98855:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/source-nat1-49193d54a10ca5d36f982863be15715b.png"},96204:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/source-nat2-cb12fc356f5609cef7db9b2c584ddbb8.png"},48469:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/source-nat3-2eae8ac297dce5b61bff6ec37de7ebdb.png"},53532:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/static_nat_example-29a76f18237ff4aaafc180c1ca333294.png"},19828:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/static_nat_gui_nat-config-20fa526292c727c7ca77445a1969e57d.png"},17089:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/static_nat_gui_net-intf-1138f11e436b3bb0872570b8172b945e.png"},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var i=s(96540);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);
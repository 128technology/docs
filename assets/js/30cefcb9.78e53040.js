"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[1744],{70367:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var i=s(74848),t=s(28453);const r={title:"Upgrade from 5.6 to 6.1 may result in missing FIB entries",date:"2024-4-24",tags:["6.1","6.1.7"],hide_table_of_contents:!1},o=void 0,a={permalink:"/kb/2024/04/24/I95-55904",source:"@site/kb/2024-04-24-I95-55904.md",title:"Upgrade from 5.6 to 6.1 may result in missing FIB entries",description:"Upgrade from 5.6.8 to 6.1.7 may result in missing FIB entries and service-paths, causing connectivity issues.",date:"2024-04-24T00:00:00.000Z",formattedDate:"April 24, 2024",tags:[{label:"6.1",permalink:"/kb/tags/6-1"},{label:"6.1.7",permalink:"/kb/tags/6-1-7"}],hasTruncateMarker:!0,authors:[],frontMatter:{title:"Upgrade from 5.6 to 6.1 may result in missing FIB entries",date:"2024-4-24",tags:["6.1","6.1.7"],hide_table_of_contents:!1},unlisted:!1,prevItem:{title:"Upgrade from 6.1 to 6.2 changes PCI mapping in AWS",permalink:"/kb/2024/04/25/I95-57085"}},l={authorsImageUrls:[]},c=[{value:"Problem",id:"problem",level:3},{value:"Release Notes",id:"release-notes",level:3},{value:"Severity",id:"severity",level:3},{value:"Status",id:"status",level:3},{value:"Resolved In",id:"resolved-in",level:3},{value:"Product",id:"product",level:3},{value:"Functional Area",id:"functional-area",level:3},{value:"Workaround",id:"workaround",level:3},{value:"Command Help",id:"command-help",level:4},{value:"Sample",id:"sample",level:4}];function d(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Upgrade from 5.6.8 to 6.1.7 may result in missing FIB entries and service-paths, causing connectivity issues."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Issue ID:"})," I95-55904",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Last Updated:"})," 2024-04-24",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Introduced in SSR Version:"})," 6.1.7"]}),"\n",(0,i.jsx)(n.h3,{id:"problem",children:"Problem"}),"\n",(0,i.jsxs)(n.p,{children:["The key of the data structure storing service configuration is a net::IpMask, which has custom ",(0,i.jsx)(n.code,{children:"operator<"})," and ",(0,i.jsx)(n.code,{children:"operator=="})," operator functions. These operators treat the bits after the prefix length as 1s, so 147.161.128.0/17 should be equal to 147.161.254.0/23 (as an example). The container used in 5.6 uses the ",(0,i.jsx)(n.code,{children:"operator<"}),". The container used in 6.1 takes a hash operator which is not hashing these equivalent net::IpMasks to be equal, hence the difference in behavior."]}),"\n",(0,i.jsx)(n.h3,{id:"release-notes",children:"Release Notes"}),"\n",(0,i.jsx)(n.p,{children:"Fix case where adding services with overlapping address prefixes would cause config to not apply in highway."}),"\n",(0,i.jsx)(n.h3,{id:"severity",children:"Severity"}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)(n.p,{children:"The potential impact of a software defect if encountered. Severity levels are:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Critical: Could severely affect service, capacity/traffic, and maintenance capabilities. May have a prolonged impact to the entire system."}),"\n",(0,i.jsx)(n.li,{children:"Major: Could seriously affect system operation, maintenance, administration and related tasks."}),"\n",(0,i.jsx)(n.li,{children:"Minor: Would not significantly impair the functioning or affect service."}),"\n"]})]}),"\n",(0,i.jsx)(n.p,{children:"Critical"}),"\n",(0,i.jsx)(n.h3,{id:"status",children:"Status"}),"\n",(0,i.jsx)(n.p,{children:"Closed"}),"\n",(0,i.jsx)(n.h3,{id:"resolved-in",children:"Resolved In"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"/docs/release_notes_128t_6.1#release-618-15",children:"6.1.8"})}),"\n",(0,i.jsx)(n.h3,{id:"product",children:"Product"}),"\n",(0,i.jsx)(n.p,{children:"SSR"}),"\n",(0,i.jsx)(n.h3,{id:"functional-area",children:"Functional Area"}),"\n",(0,i.jsx)(n.p,{children:"Routing"}),"\n",(0,i.jsx)(n.h3,{id:"workaround",children:"Workaround"}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"Juniper may provide a method to temporarily circumvent a problem; workarounds do not exist for all issues."})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl -JLO https://github.com/majes-git/128t-scripts/raw/main/t128-show-ip-prefix-conflicts.pyz\nchmod +x t128-show-ip-prefix-conflicts.pyz\n"})}),"\n",(0,i.jsx)(n.h4,{id:"command-help",children:"Command Help"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'$ ./t128-show-ip-prefix-conflicts.pyz --help\nusage: t128-show-ip-prefix-conflicts.pyz [-h] [-c HOST] [-u USER] [-p PASSWORD] [--config-store {running,candidate}] [-r READ_JSON] [--dump-json]\n\nShow overlapping ip prefixes in 128T services\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -c HOST, --host HOST  Conductor/router hostname\n  -u USER, --user USER  Conductor/router username (if no key auth)\n  -p PASSWORD, --password PASSWORD\n                        Conductor/router password (if no key auth)\n  --config-store {running,candidate}\n                        Config store to be used (running/candidate)\n  -r READ_JSON, --read-json READ_JSON\n                        Read services config from json file\n  --dump-json           Write config dump to json file "t128-show-ip-prefix-conflicts.json"\n'})}),"\n",(0,i.jsx)(n.h4,{id:"sample",children:"Sample"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'$ ./t128-show-ip-prefix-conflicts.pyz -r ssr-configuration.json\nWARNING: Service "zscaler__client.internet" has conflicting addresses:\n* 147.161.254.0/23 and 147.161.128.0/17\n* 104.129.192.0/20 and 104.129.206.0/23\n* 136.226.0.0/16 and 136.226.254.0/23\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var i=s(96540);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);
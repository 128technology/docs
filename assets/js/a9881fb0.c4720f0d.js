"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[7306],{5691:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>d,toc:()=>a});var i=n(74848),r=n(28453);const t={title:"USB Boot and Storage Security",sidebar_label:"USB Boot and Storage Security"},o=void 0,d={id:"sec-usb-security",title:"USB Boot and Storage Security",description:"This document provides guidance on disabling USB booting and storage in the SSR BIOS, and disabling USB storage in the Operating System.",source:"@site/docs/sec-usb-security.md",sourceDirName:".",slug:"/sec-usb-security",permalink:"/docs/sec-usb-security",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"USB Boot and Storage Security",sidebar_label:"USB Boot and Storage Security"},sidebar:"docs",previous:{title:"Security Hardening Guidelines",permalink:"/docs/sec_hardening_guidelines"},next:{title:"Disable Console Output",permalink:"/docs/sec-disable-console-output"}},l={},a=[{value:"Disabling USB Storage on the BIOS: SSR120 and SSR130",id:"disabling-usb-storage-on-the-bios-ssr120-and-ssr130",level:3},{value:"BIOS on SSR1200 SSR1300 SSR1400 SSR1500",id:"bios-on-ssr1200-ssr1300-ssr1400-ssr1500",level:3},{value:"BIOS Passwords",id:"bios-passwords",level:4},{value:"Disabling the USB Storage Module",id:"disabling-the-usb-storage-module",level:3}];function c(e){const s={code:"code",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.p,{children:"This document provides guidance on disabling USB booting and storage in the SSR BIOS, and disabling USB storage in the Operating System."}),"\n",(0,i.jsx)(s.p,{children:"The steps to disable USB storage in the BIOS vary depending on the model of SSR system, while the steps for disabling USB storage in the operating system are the same across all models."}),"\n",(0,i.jsx)(s.p,{children:"These steps assume that you have a working and configured connection to the serial port on the device."}),"\n",(0,i.jsx)(s.h3,{id:"disabling-usb-storage-on-the-bios-ssr120-and-ssr130",children:"Disabling USB Storage on the BIOS: SSR120 and SSR130"}),"\n",(0,i.jsx)(s.p,{children:"When an administrator password is set in the SSR120 or SSR130 BIOS, USB mass storage devices are not presented as options in the boot order, nor are they offered as a single boot override option when the BIOS is not in administrator mode."}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["If the system is powered off, power it on. If it is currently running, reboot it from the linux shell. When the system reboots, the message ",(0,i.jsx)(s.code,{children:"Press ESC for boot menu"})," will appear."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Press ",(0,i.jsx)(s.code,{children:"Escape"}),". The following menu appears:"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"Select boot device:\n\n    1. AHCI/1: KINGSTON SA400M8120G ATA-10 Hard-Disk (111 GiBytes)\n    2. iPXE (PCI 04:00.0)\n    3. iPXE (PCI 04:00.1)\n    4. Payload [admin]\n    5. Payload [setup]\n\n    t. TPM Configuration\n"})}),"\n",(0,i.jsx)(s.p,{children:"The exact number of entries in this list are determined by the devices plugged into the unit at the time, and if the BIOS is already in administrator mode."}),"\n",(0,i.jsxs)(s.ol,{start:"3",children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Locate the entry labeled ",(0,i.jsx)(s.code,{children:"Payload [admin]"})," and enter the number."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["In the ",(0,i.jsx)(s.code,{children:"Payload [admin]"})," menu, enter ",(0,i.jsx)(s.code,{children:"e"})," to enter the administrator mode before proceeding."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"e Enter administrator mode"})}),"\n",(0,i.jsxs)(s.p,{children:["If prompted for a password, press ",(0,i.jsx)(s.code,{children:"<enter>"}),"."]}),"\n",(0,i.jsx)(s.p,{children:"Once in administrator mode, there will be an entry to change the password:"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"c Change Password"})}),"\n",(0,i.jsxs)(s.ol,{start:"5",children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Press ",(0,i.jsx)(s.code,{children:"c"})," to change the administrator password."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"When prompted, enter the new administrator password and then enter it again to verify."}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Press ",(0,i.jsx)(s.code,{children:"l"})," to leave administrator mode."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Press ",(0,i.jsx)(s.code,{children:"s"})," to save these changes and exit."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Upon subsequent boots, if interrupted with ",(0,i.jsx)(s.code,{children:"esc"})," when prompted, USB devices will not be shown as bootable devices. To reset the USB as a bootable device, the password set in the steps above will be required to re-enter administrator mode."]}),"\n",(0,i.jsx)(s.h3,{id:"bios-on-ssr1200-ssr1300-ssr1400-ssr1500",children:"BIOS on SSR1200 SSR1300 SSR1400 SSR1500"}),"\n",(0,i.jsx)(s.p,{children:"On the SSR1200, SSR1300, SSR1400, SSR1500 the BIOS contains configuration specifically for USB mass storage devices."}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"If the unit is powered off, power it on. If it is already running, reboot it\nfrom the linux shell."}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"When prompted, press a key to enter setup."}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Use the ",(0,i.jsx)(s.code,{children:"right arrow"})," key to move to the tab labeled ",(0,i.jsx)(s.code,{children:"Advanced"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"BIOS Advanced Tab",src:n(17810).A+"",width:"1608",height:"1068"})}),"\n",(0,i.jsxs)(s.ol,{start:"4",children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Use the ",(0,i.jsx)(s.code,{children:"down arrow"})," key to select ",(0,i.jsx)(s.code,{children:"USB Configuration"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Use the ",(0,i.jsx)(s.code,{children:"down arrow"})," key to select the ",(0,i.jsx)(s.code,{children:"USB Mass Storage Driver Support"})," menu entry."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Press ",(0,i.jsx)(s.code,{children:"enter"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"USB Mass Storage",src:n(97772).A+"",width:"1608",height:"1068"})}),"\n",(0,i.jsxs)(s.ol,{start:"7",children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Select ",(0,i.jsx)(s.code,{children:"Disabled"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Exit the BIOS."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h4,{id:"bios-passwords",children:"BIOS Passwords"}),"\n",(0,i.jsx)(s.p,{children:"Please use the BIOS menus to enable/set the BIOS password."}),"\n",(0,i.jsx)(s.h3,{id:"disabling-the-usb-storage-module",children:"Disabling the USB Storage Module"}),"\n",(0,i.jsx)(s.p,{children:"Use the following procedure to disable the USB storage module in the Operating System. This process applies to all SSR devices."}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["As the ",(0,i.jsx)(s.code,{children:"root"})," user in the linux shell, create the following file, with the contents and permissions shown here:"]}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"chown root:root /etc/modprobe.d/disable-usb-storage.conf\nchmod 644 /etc/modprobe.d/disable-usb-storage.conf\n"})}),"\n",(0,i.jsxs)(s.ol,{start:"2",children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Verify that the following module is disabled using each of the commands below."}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["The ",(0,i.jsx)(s.code,{children:"rmmod"})," command may return a ",(0,i.jsx)(s.strong,{children:"Module not loaded"})," error if there are no USB storage devices connected."]}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"rmmod usb-storage\nmodprobe usb-storage\n"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["The ",(0,i.jsx)(s.code,{children:"lsmod"})," command should succeed without error, eturn no output, and the module will remain unloaded:"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"lsmod | grep usb_storage"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Rebuild initramfs images with the command"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"dracut -f --regenerate-all"})}),"\n",(0,i.jsxs)(s.ol,{start:"4",children:["\n",(0,i.jsxs)(s.li,{children:["Reboot, and verify that the ",(0,i.jsx)(s.code,{children:"usb_storage"})," module does not load."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"lsmod | grep usb-storage"})})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},17810:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/sec-bios-adv-tab-66614014ba1819a61bf3957ba6522741.png"},97772:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/sec-usb-storage-disable-ae21b71b757382f93da7d110e97076de.png"},28453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>d});var i=n(96540);const r={},t=i.createContext(r);function o(e){const s=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);
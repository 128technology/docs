"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[694],{15709:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var i=t(74848),r=t(28453);const o={title:"High Memory usage for application-director",date:"2024-5-29",tags:["6.2.3","6.2.4"],hide_table_of_contents:!1},a=void 0,s={permalink:"/kb/2024/05/29/I95-56484",source:"@site/kb/2024-05-29-I95-56484.md",title:"High Memory usage for application-director",description:"Changes to use a new database in the app-id engine have introduced high memory utilization for the application-director.",date:"2024-05-29T00:00:00.000Z",formattedDate:"May 29, 2024",tags:[{label:"6.2.3",permalink:"/kb/tags/6-2-3"},{label:"6.2.4",permalink:"/kb/tags/6-2-4"}],hasTruncateMarker:!0,authors:[],frontMatter:{title:"High Memory usage for application-director",date:"2024-5-29",tags:["6.2.3","6.2.4"],hide_table_of_contents:!1},unlisted:!1,prevItem:{title:"Memory Allocation Exception in Device Disabled Error output",permalink:"/kb/2024/06/25/I95-54838"},nextItem:{title:"Packet forwarding stops in AWS after several hours",permalink:"/kb/2024/04/25/I95-56233"}},c={authorsImageUrls:[]},l=[{value:"Problem",id:"problem",level:3},{value:"Release Notes",id:"release-notes",level:3},{value:"Severity",id:"severity",level:3},{value:"Status",id:"status",level:3},{value:"Resolved In",id:"resolved-in",level:3},{value:"Product",id:"product",level:3},{value:"Functional Area",id:"functional-area",level:3},{value:"Workaround",id:"workaround",level:3}];function d(e){const n={code:"code",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Changes to use a new database in the app-id engine have introduced high memory utilization for the application-director."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Issue ID:"})," I95-56484"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Last Updated:"})," 2024-05-29"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Introduced in SSR Version:"})," 6.2.3"]}),"\n",(0,i.jsx)(n.h3,{id:"problem",children:"Problem"}),"\n",(0,i.jsx)(n.p,{children:"The application-director has a race condition that can occur during app-id module updates, app-id database reloads, and configuration changes."}),"\n",(0,i.jsx)(n.p,{children:"It is possible that stale connections to a database will utilize excessive memory over a long duration (application-director uptime)."}),"\n",(0,i.jsxs)(n.p,{children:["The administrator might notice alarms for high system memory and an Application Director alarm with the message ",(0,i.jsx)(n.code,{children:"IP Database reload failed."})]}),"\n",(0,i.jsx)(n.h3,{id:"release-notes",children:"Release Notes"}),"\n",(0,i.jsx)(n.p,{children:"Resolve application-director stale database connection memory leak."}),"\n",(0,i.jsx)(n.h3,{id:"severity",children:"Severity"}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)(n.p,{children:"The potential impact of a software defect if encountered. Severity levels are:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Critical: Could severely affect service, capacity/traffic, and maintenance capabilities. May have a prolonged impact to the entire system."}),"\n",(0,i.jsx)(n.li,{children:"Major: Could seriously affect system operation, maintenance, administration and related tasks."}),"\n",(0,i.jsx)(n.li,{children:"Minor: Would not significantly impair the functioning or affect service."}),"\n"]})]}),"\n",(0,i.jsx)(n.p,{children:"Major"}),"\n",(0,i.jsx)(n.h3,{id:"status",children:"Status"}),"\n",(0,i.jsx)(n.p,{children:"Resolved"}),"\n",(0,i.jsx)(n.h3,{id:"resolved-in",children:"Resolved In"}),"\n",(0,i.jsx)(n.p,{children:"6.2.5"}),"\n",(0,i.jsx)(n.h3,{id:"product",children:"Product"}),"\n",(0,i.jsx)(n.p,{children:"SSR"}),"\n",(0,i.jsx)(n.h3,{id:"functional-area",children:"Functional Area"}),"\n",(0,i.jsx)(n.p,{children:"System Health"}),"\n",(0,i.jsx)(n.h3,{id:"workaround",children:"Workaround"}),"\n",(0,i.jsx)(t,{children:(0,i.jsx)(n.p,{children:"Juniper may provide a method to temporarily circumvent a problem; workarounds do not exist for all issues."})}),"\n",(0,i.jsx)(n.p,{children:"Utilizing SSR metrics data, custom charts can be used to view memory usage over time to identify processes that are increasing. Also, the PCLI provides a way to view current process memory utilization and a way to compare the current value a previous point in time."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"admin@node.router# show stats process memory process-name application-director\nThu 2024-05-30 20:38:03 UTC\n\u2714 Retrieving statistics...\n\nProcess Memory Metrics\n----------------------\n\n======== ====== ====================== ============\n Metric   Node   Process-name                Value\n======== ====== ====================== ============\n rss      node   application-director     61681664\n vsz      node   application-director   1589444608\n"})}),"\n",(0,i.jsx)(n.p,{children:"The above values will appear as bytes. Shown below is comparing the current value to 10 days prior."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"admin@node.router# show stats process memory process-name application-director since 10d\nThu 2024-05-30 20:52:39 UTC\n\u2714 Retrieving statistics...\n\nSince: 2024-05-20 20:52:39\n\nProcess Memory Metrics\n----------------------\n\n======== ====== ====================== =========\n Metric   Node   Process-name             Value\n======== ====== ====================== =========\n rss      node   application-director   1171456\n vsz      node   application-director         0\n"})}),"\n",(0,i.jsx)(n.p,{children:"In this case, the delta is 10Mb which is normal operating behavior."}),"\n",(0,i.jsx)(n.p,{children:"However, if the deltas over time are increasing significantly such that the current utilization has doubled or tripled, this is a good indicator that this issue is occurring."}),"\n",(0,i.jsxs)(n.p,{children:["If you have confirmed the ",(0,i.jsx)(n.code,{children:"application-director"})," has significant memory increases over time, the service can be restarted on the offending device using ",(0,i.jsx)(n.code,{children:"systemctl restart application-director"})," as a privileged User."]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var i=t(96540);const r={},o=i.createContext(r);function a(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);
"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[4160],{52647:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>c,toc:()=>l});var i=t(74848),s=t(28453),o=t(1140);const a={title:"Tenancy Design",sidebar_label:"Tenancy Design"},r=void 0,c={id:"bcp_tenants",title:"Tenancy Design",description:"The tenant is one of the foundational data model elements within the Session Smart Router (SSR), and represents a consumer of network services. Tenancy is the logical partitioning of a network\u2019s resources, done in the interest of restricting access to network services to only the users and groups for which they\u2019re intended.",source:"@site/docs/bcp_tenants.mdx",sourceDirName:".",slug:"/bcp_tenants",permalink:"/docs/bcp_tenants",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1710456059,formattedLastUpdatedAt:"Mar 14, 2024",frontMatter:{title:"Tenancy Design",sidebar_label:"Tenancy Design"},sidebar:"docs",previous:{title:"Service Policy Baseline Defaults",permalink:"/docs/bcp_service-policy_defaults"},next:{title:"Command Line Reference",permalink:"/docs/cli_reference"}},d={},l=[{value:"Intended Audience",id:"intended-audience",level:2},{value:"Overview",id:"overview",level:2},{value:"Basic Tenant Workflow",id:"basic-tenant-workflow",level:3},{value:"Tenant Assignment",id:"tenant-assignment",level:3},{value:"Viewing a Router&#39;s Tenancy",id:"viewing-a-routers-tenancy",level:4},{value:"Tenant Hierarchies",id:"tenant-hierarchies",level:3},{value:"Tenant Configuration",id:"tenant-configuration",level:2},{value:"Per-interface Tenancy",id:"per-interface-tenancy",level:3},{value:"Per-neighborhood Tenancy",id:"per-neighborhood-tenancy",level:3},{value:"Special Tenants",id:"special-tenants",level:3},{value:"The Fabric Tenant",id:"the-fabric-tenant",level:4},{value:"The Global Tenant",id:"the-global-tenant",level:4},{value:"The Internal Tenant",id:"the-internal-tenant",level:4},{value:"Tenancy Strategies",id:"tenancy-strategies",level:2},{value:"Before You Begin",id:"before-you-begin",level:3},{value:"Assess the Current Profile",id:"assess-the-current-profile",level:4},{value:"Choose a Baseline Model",id:"choose-a-baseline-model",level:4},{value:"Site Discovery",id:"site-discovery",level:4},{value:"Refining and Adapting the Design",id:"refining-and-adapting-the-design",level:3},{value:"General Considerations and Best Practices",id:"general-considerations-and-best-practices",level:3},{value:"Use Case: Retail SD-WAN",id:"use-case-retail-sd-wan",level:3},{value:"Notes about the Model",id:"notes-about-the-model",level:4},{value:"Site Surveys",id:"site-surveys",level:4},{value:"Conclusions",id:"conclusions",level:4}];function h(e){const n={admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.em,{children:"tenant"})," is one of the foundational data model elements within the Session Smart Router (SSR), and represents a consumer of network ",(0,i.jsx)(n.em,{children:"services"}),". Tenancy is the logical partitioning of a network\u2019s resources, done in the interest of restricting access to network services to only the users and groups for which they\u2019re intended."]}),"\n",(0,i.jsx)(n.p,{children:"This document provides an overview of tenancy in the SSR, how it is configured, and provides guidance for modeling the segmentation of a network using the SSR's data modeling language."}),"\n",(0,i.jsx)(n.h2,{id:"intended-audience",children:"Intended Audience"}),"\n",(0,i.jsx)(n.p,{children:"This document is intended for network architects, to assist them in the fomulation of a design for a tenancy structure in their network. It is also intended as a reference guide for network administrators and network operations personnel, to help understand the principles behind SSR's tenancy."}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.p,{children:["Tenancy is the logical partitioning of a network\u2019s resources, done in the interest of restricting access to network services to only the users and groups for which they\u2019re intended. Tenants are defined within an ",(0,i.jsx)(n.em,{children:"authority"}),", and span each router within that authority. I.e., the services made available to that tenant can exist anywhere within the authority, irrespective of router, and the SSR solution propagates routing information throughout the tenant to advertise the service\u2019s availability. At their core, tenants are intended to provide complete network segregation."]}),"\n",(0,i.jsx)(n.p,{children:'An example for how tenants could be used would be segregating two distinct user populations within an organization; e.g., "developers" from "administrators." Another example would be multiple customers within the AWS infrastructure; in this case, each tenant would likely be organized by customer.'}),"\n",(0,i.jsx)(n.h3,{id:"basic-tenant-workflow",children:"Basic Tenant Workflow"}),"\n",(0,i.jsx)(n.p,{children:"To segment your network using tenants, you follow a simple, three step workflow:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Define the tenants for your network. Strategies for how to define tenants are described later in this document, in the ",(0,i.jsx)(n.em,{children:"Tenancy Strategies"})," section."]}),"\n",(0,i.jsxs)(n.li,{children:["Assign the rules for how a router identifies inbound traffic as belonging to a tenant. This is described in the ",(0,i.jsx)(n.em,{children:"Tenant Configuration"})," section below."]}),"\n",(0,i.jsxs)(n.li,{children:["Selectively allow or deny tenants to your network's ",(0,i.jsx)(n.em,{children:"services"})," using ",(0,i.jsx)(n.code,{children:"access-control"})," stanzas"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["By following this workflow, you'll grant access to your network's services only to those that should be allowed access. This is the basis of Juniper's approach to ",(0,i.jsx)(n.em,{children:"Zero Trust Networking"}),": every ",(0,i.jsx)(n.code,{children:"service"})," expressly identifies who (via tenancy) will have a route to it."]}),"\n",(0,i.jsxs)(n.p,{children:["But the SSR approach to Zero Trust Networking does not make configuring all possible sources and destinations of network traffic onerous; through the use of ",(0,i.jsx)(n.em,{children:"CIDR Services"})," (described in the ",(0,i.jsx)(n.em,{children:"Services and Service Policies"})," documentation, and ",(0,i.jsx)(n.em,{children:"Tenant Hierarchies"})," (described below), you can jumpstart your network implementation right away."]}),"\n",(0,i.jsx)(n.h3,{id:"tenant-assignment",children:"Tenant Assignment"}),"\n",(0,i.jsx)(n.p,{children:"As new sessions arrive at an SSR, the router will attempt to classify the source of that session request into one of its configured tenants. This classification is done in one of three ways:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["The session request arrives on an interface that has been designated as exclusively belonging to a single tenant; this is accomplished using the ",(0,i.jsx)(n.em,{children:"per-interface tenancy"})," approach, described below"]}),"\n",(0,i.jsxs)(n.li,{children:["The session request arrives on an interface from a prefix that has been specified as belonging to a tenant (i.e., a single interface can be partitioned into separate tenants based upon subnet mask); this is accomplished using the ",(0,i.jsx)(n.em,{children:"per-neighborhood tenancy"})," approach, described below"]}),"\n",(0,i.jsx)(n.li,{children:"The session request arrives containing SSR metadata, supplied by an adjacent instance of the SSR, which has already classified this packet as belonging to a specific tenant"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Should none of these result in a definitive determination on the tenant of the source of this session request, the session is associated with the ",(0,i.jsx)(n.em,{children:"global tenant"}),' (see the section on "Special Tenants" for more information on the global tenant). Once the tenant has been identified \u2013 either as a specific tenant, or as the global tenant \u2013 this acts as a filter into the SSR\u2019s FIB. Only the routes associated with that tenant are available to that user group. While this somewhat resembles the way a legacy router uses VRFs to create separate RIBs and FIBs, the segment by ',(0,i.jsx)(n.em,{children:"tenant"})," is pervasive among all routers within an Authority by design, and is applied ubiquitously among all varieties of networks: public IP space, private, cloud, IPv4, IPv6, etc."]}),"\n",(0,i.jsx)(o.A,{chartCode:'\n    st=>start: Packet Arrives\n      metadata=>condition: Packet has metadata?\n      int=>condition: Interface has a tenant?\n      nh=>condition: Neighborhood-based tenant?\n      tm=>operation: Tenant taken from metadata\n      ti=>operation: Tenant taken from interface\n      th=>operation: Tenant taken from neighborhood\n      global=>operation: Tenant assigned as "global"\n      e=>end: Proceed to FIB lookup\n    st->metadata\n    metadata(no)->int\n    metadata(yes,right)->tm->e\n    int(yes,right)->ti->e\n    int(no)->nh\n    nh(yes,right)->th->e\n    nh(no)->global->e\n  '}),"\n",(0,i.jsx)(n.h4,{id:"viewing-a-routers-tenancy",children:"Viewing a Router's Tenancy"}),"\n",(0,i.jsxs)(n.p,{children:["The PCLI command ",(0,i.jsx)(n.code,{children:"show tenant members"})," is used to display the rules for tenant assignment on any router. For each interface on the target router you will see the tenant assignments based on the ",(0,i.jsx)(n.em,{children:"source address"})," of the inbound packets."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"admin@node1.branch1# show tenant members\nSun 2020-03-22 11:44:48 UTC\n\nNode: node1\n\n============ ========= ============== ================= ================== =================\n Device I/F   VLAN ID   Network I/F    Network I/F IP    Source IP Prefix   Tenant\n============ ========= ============== ================= ================== =================\n       eno1         0   internode      169.254.255.0     169.254.255.1/32   <fabric>\n       eno2        10   lan10          10.20.20.1        0.0.0.0/0          pos.acme\n       eno2        20   lan20          172.20.20.1       0.0.0.0/0          voice.acme\n       eno3         0   wan1           198.51.100.2      0.0.0.0/0          <global>\n     kni254         0   controlKniIf   169.254.127.126   0.0.0.0/0          _internal_\n"})}),"\n",(0,i.jsx)(n.h3,{id:"tenant-hierarchies",children:"Tenant Hierarchies"}),"\n",(0,i.jsx)(n.p,{children:"The SSR data model includes the ability to construct hierarchical tenancies, where a \u201cparent\u201d tenant may have one or more \u201cchild\u201d tenants. This hierarchical tenant model allows administrators to create arbitrary groups of tenants and apply policies to that group as a whole, rather than piecemeal. Creating groups of tenants affords the maximum flexibility and minimizes the amount of redundant configuration, as well as improving overall readability of the configuration."}),"\n",(0,i.jsxs)(n.p,{children:["The SSR system uses a dotted notation naming scheme for grouping hierarchies of tenants. For example, a tenant named ",(0,i.jsx)(n.code,{children:"engineering.128technology"})," is a child of the tenant ",(0,i.jsx)(n.code,{children:"128technology"}),". Wherever other configuration objects refer to tenants, the effective scope can be controlled by specifying only a portion of a tenant\u2019s name. For example, a service that specifies ",(0,i.jsx)(n.code,{children:"128technology"})," within an ",(0,i.jsx)(n.code,{children:"access-policy"})," is available to ",(0,i.jsx)(n.code,{children:"engineering.128technology"}),", ",(0,i.jsx)(n.code,{children:"finance.128technology"}),", and ",(0,i.jsx)(n.code,{children:"128technology"}),". However, the policy is applied in only one direction, from parent to child: a service accessible only to ",(0,i.jsx)(n.code,{children:"engineering.128technology"})," will not be available to members of the general ",(0,i.jsx)(n.code,{children:"128technology"})," tenant."]}),"\n",(0,i.jsxs)(n.p,{children:["Tenant hierarchies are configured in virtually every SSR deployment. The most common implementation is to configure a top level enterprise tenant; this lets administrators easily grant access to corporate services to all tenants with a single ",(0,i.jsx)(n.code,{children:"access-policy"})," assignment."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"It is not necessary for an administrator to explicitly create a \u201cparent\u201d tenant prior to creating a \u201cchild\u201d tenant (the UI will perform validation and warn an administrator that their action of creating a child tenant will also create a parent tenant). The UI will prevent the deletion of a parent tenant if it has any child tenants."})}),"\n",(0,i.jsx)(n.p,{children:"Tenant hierarchies can have an unlimited number of tiers, although it is generally unnecessary to have more than two or three levels of parentage. For recommendations on tenancy and organizational tips, refer to the Tenant Strategies section below."}),"\n",(0,i.jsx)(n.h2,{id:"tenant-configuration",children:"Tenant Configuration"}),"\n",(0,i.jsx)(n.p,{children:"Each tenant configured on an SSR conductor is propagated to all managed assets, irrespective of whether that router has any configuration (via interface definition or neighborhood definition) to assign that tenant to inbound traffic. This is because an SSR can receive Secure Vector Routing (SVR) sessions from a peer, identifying the origin as belonging to a permissible tenant."}),"\n",(0,i.jsxs)(n.p,{children:["For example, a branch router may segment its traffic into several, well-known tenants: employee workstations are in a tenant named ",(0,i.jsx)(n.code,{children:"workstations.acme"})," and their VoIP phones are in a tenant named ",(0,i.jsx)(n.code,{children:"voice.acme"}),". There are no employee workstations or VoIP phones at the corporate data center, but the head end router there needs to understand how to forward sessions for these traffic segments. Thus the head end is aware of the existence of these tenants for access control and traffic forwarding purposes."]}),"\n",(0,i.jsx)(n.h3,{id:"per-interface-tenancy",children:"Per-interface Tenancy"}),"\n",(0,i.jsxs)(n.p,{children:["Assigning a tenant to a ",(0,i.jsx)(n.code,{children:"network-interface"})," will cause all traffic arriving on that interface to be considered part of the tenant. Consider the following configuration fragment:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"admin@node1.bernstein# show conf run auth router branch1 node node1 device lan network-interface lan20\n\nconfig\n\n    authority\n\n        router  branch1\n            name  branch1\n\n            node  node1\n                name              node1\n\n                device-interface  lan\n                    name               lan\n\n                    network-interface  lan20\n                        name       lan20\n                        global-id  6\n                        vlan       20\n                        tenant     voice.acme\n\n                        address    172.20.20.1\n                            ip-address     172.20.20.1\n                            prefix-length  24\n                        exit\n                    exit\n                exit\n            exit\n        exit\n    exit\nexit\n"})}),"\n",(0,i.jsx)(n.h3,{id:"per-neighborhood-tenancy",children:"Per-neighborhood Tenancy"}),"\n",(0,i.jsxs)(n.p,{children:['Assigning tenant membership using neighborhoods requires two distinct, coordinated configuration elements. First, you define one or more neighborhoods within a network-interface. (Conceptually, a "neighborhood" is a named, Layer 3 routed network.) Second, within one or more ',(0,i.jsx)(n.code,{children:"tenant"}),' configurations you define which prefixes in that neighborhood are to be considered "members" of that tenant.']}),"\n",(0,i.jsx)(n.p,{children:"Here is a basic neighborhood configuration, as seen on our branch router:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'admin@node1.bernstein# show config run auth router branch1 node node1 device wan network-interface wan1\n\nconfig\n\n    authority\n\n        router  branch1\n            name  branch1\n\n            node  node1\n                name              node1\n\n                device-interface  wan\n                    name               wan\n\n                    network-interface  wan1\n                        name                   wan1\n                        global-id              3\n                        description            "Broadband internet access"\n                        conductor              true\n\n                        neighborhood           internet\n                            name               internet\n                            peer-connectivity  bidirectional\n                            topology           spoke\n                            vector             broadband\n                        exit\n                        inter-router-security  internal\n                        source-nat             true\n                        dhcp                   v4\n                    exit\n                exit\n            exit\n        exit\n    exit\nexit\n'})}),"\n",(0,i.jsx)(n.p,{children:'In this example we\'ve used the neighborhood name "internet" on the WAN interface of the branch router. (This is a common, and recommended neighborhood name with SSR devices attached to the public internet.)'}),"\n",(0,i.jsxs)(n.p,{children:["Here are several ",(0,i.jsx)(n.code,{children:"tenant"})," definitions to illustrate how to define tenancy within that neighborhood:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'config\n\n    authority\n\n        tenant  CX.Oceania\n            name         CX.Oceania\n            description  "Christmas Island"\n\n            member       internet\n                neighborhood  internet\n                address       5.62.60.89/32\n                address       5.62.60.90/31\n                address       5.62.62.85/32\n                address       5.62.62.86/31\n                address       45.12.70.54/32\n                address       45.12.71.54/32\n                address       104.224.54.0/24\n                address       203.119.12.0/24\n                address       203.119.84.0/24\n                address       203.171.248.0/23\n                address       203.171.250.0/25\n                address       203.171.251.0/24\n            exit\n        exit\n\n        tenant  VA.Europe\n            name         VA.Europe\n            description  "Vatican City"\n\n            member       internet\n                neighborhood  internet\n                address       5.62.61.208/30\n                address       5.62.63.197/32\n                address       5.62.63.198/31\n                address       31.220.29.160/27\n                address       45.12.70.237/32\n                address       45.12.70.251/32\n                address       45.12.71.237/32\n                address       45.42.143.0/24\n                address       45.61.44.128/25\n                address       46.36.200.0/22\n                address       57.79.216.0/21\n                address       57.79.224.0/20\n                address       176.31.103.102/32\n                address       185.17.220.0/22\n                address       185.152.68.0/22\n                address       185.238.190.250/32\n                address       193.43.102.0/23\n                address       193.43.128.0/22\n                address       194.50.92.0/24\n                address       212.77.0.0/19\n            exit\n        exit\n    exit\nexit\n'})}),"\n",(0,i.jsxs)(n.p,{children:["We've created two tenants, ",(0,i.jsx)(n.code,{children:"CX.Oceania"})," and ",(0,i.jsx)(n.code,{children:"VA.Europe"}),", and within each tenant's ",(0,i.jsx)(n.code,{children:"member"})," block we've indicated that within the neighborhood (router Layer 3 network) named ",(0,i.jsx)(n.code,{children:"internet"}),", the sets of IP addresses that are allocated for these two countries."]}),"\n",(0,i.jsxs)(n.p,{children:['Thus, if an inbound session arrives from the IP address 212.77.0.128 on an interface that is "in" the ',(0,i.jsx)(n.code,{children:"internet"})," neighborhood, it will be considered to be part of the ",(0,i.jsx)(n.code,{children:"VA.Europe"})," tenant."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Yes, these are really the IP addresses associated with Christmas Island and Vatican City. No, you cannot fill out the rest of the world's GeoIP addresses as tenant members. You'll almost certainly run out of space in your tenant table (officially called the \"source tenant table\"). You can see how much room you have in your source tenant table as well as its current utilization by using the PCLI command ",(0,i.jsx)(n.code,{children:"show capacity"}),"."]})}),"\n",(0,i.jsx)(n.h3,{id:"special-tenants",children:"Special Tenants"}),"\n",(0,i.jsx)(n.p,{children:"The SSR software has several tenants it creates automatically. These tenants are used for specific software functions, and have special meaning described here."}),"\n",(0,i.jsx)(n.h4,{id:"the-fabric-tenant",children:"The Fabric Tenant"}),"\n",(0,i.jsxs)(n.p,{children:['When combining two nodes into a highly available router (dual node high availability), it is commonplace \u2013 and recommended \u2013 to configure a "fabric" interface between them. An SSR with a fabric interface will use install the special ',(0,i.jsx)(n.code,{children:"<fabric>"})," tenant on the fabric interface. This is neither user-configurable nor user-modifiable. This tenant can be seen in the output of ",(0,i.jsx)(n.code,{children:"show tenant members"})," as shown here:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"admin@node1.branch1# show tenant members\nSun 2020-03-22 11:44:48 UTC\n\nNode: node1\n\n============ ========= ================= ================= ================== ==============\n Device I/F   VLAN ID   Network I/F       Network I/F IP    Source IP Prefix   Tenant\n============ ========= ================= ================= ================== ==============\n       eno1         0   internode         169.254.255.0     169.254.255.1/32   <fabric>\n"})}),"\n",(0,i.jsx)(n.h4,{id:"the-global-tenant",children:"The Global Tenant"}),"\n",(0,i.jsx)(n.p,{children:'The "global tenant" is what an SSR will use when it cannot determine the tenant of an inbound session, based on the configuration it has. This means three things must be true:'}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The session is arriving on an interface with no tenant assigned; and"}),"\n",(0,i.jsx)(n.li,{children:"The session is arriving on an interface with no applicable per-neighborhood tenant; and"}),"\n",(0,i.jsx)(n.li,{children:"The session is not carrying metadata from a previous SSR instance that has a tenant identified"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:'Said another way, the global tenant "fills in the holes" in the tenancy on an interface without a tenant explicitly defined, and which uses neighborhood-based tenant assignations.'}),"\n",(0,i.jsxs)(n.p,{children:["The global tenant is not user-modifiable, and administrators cannot create ",(0,i.jsx)(n.code,{children:"access-policy"})," configuration stanzas that reference the global tenant. Instead, access to a service by the global tenant is controlled through the use of the ",(0,i.jsx)(n.code,{children:"scope"})," toggle within a ",(0,i.jsx)(n.code,{children:"service"})," configuration. Setting ",(0,i.jsx)(n.code,{children:"scope"})," to ",(0,i.jsx)(n.code,{children:"public"})," is semantically equivalent to having an ",(0,i.jsx)(n.code,{children:"access-policy"})," that allows the global tenant. Setting ",(0,i.jsx)(n.code,{children:"scope"})," to ",(0,i.jsx)(n.code,{children:"private"})," will only allow tenants that have been explicitly granted access via ",(0,i.jsx)(n.code,{children:"access-policy"})," configuration."]}),"\n",(0,i.jsxs)(n.p,{children:["The global tenant can be seen in the output of ",(0,i.jsx)(n.code,{children:"show tenant members"})," as shown here:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"admin@node1.branch1# show tenant members\nSun 2020-03-22 11:44:48 UTC\n\nNode: node1\n\n============ ========= ================= ================= ================== ==============\n Device I/F   VLAN ID   Network I/F       Network I/F IP    Source IP Prefix   Tenant\n============ ========= ================= ================= ================== ==============\n       eno2         0   broadband         198.51.100.2      0.0.0.0/0          <global>\n"})}),"\n",(0,i.jsx)(n.h4,{id:"the-internal-tenant",children:"The Internal Tenant"}),"\n",(0,i.jsxs)(n.p,{children:["The internal tenant (named ",(0,i.jsx)(n.code,{children:"_internal_"}),"), is arguably the most useful of all of the special tenants. It is immutably assigned to the built-in Kernel NIC Interface (KNI) named ",(0,i.jsx)(n.code,{children:"kni254"}),", which is used for communication to and from the Linux host operating system on the platform on which the SSR software is running."]}),"\n",(0,i.jsxs)(n.p,{children:["By adding an ",(0,i.jsx)(n.code,{children:"access-policy"})," allowing (or denying) ",(0,i.jsx)(n.code,{children:"_internal_"}),' on your service, you can selectively permit processes running in Linux outbound network access. This is commonplace for "host originated" traffic, such as DNS queries, outbound SSH connections, SNMP traps, syslog, etc. The ',(0,i.jsx)(n.code,{children:"_internal_"})," tenant is also critical to the success of ",(0,i.jsx)(n.em,{children:"Conductor Host Services"}),", described in our documentation; this is because the outbound ",(0,i.jsx)(n.code,{children:"salt-minion"})," and NETCONF or REST requests destined for the conductor are initiated within the Linux host operating system."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"netconf"})," configuration is not applicable to version 5.3 and later. NETCONF controls have been replaced with REST API controls, with no loss of functionality."]}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,i.jsxs)(n.p,{children:["For more information on ",(0,i.jsx)(n.code,{children:"kni254"})," and the ",(0,i.jsx)(n.code,{children:"_internal_"})," tenant refer to the section in our documentation titled ",(0,i.jsx)(n.em,{children:"Linux Host Networking"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"admin@node1.branch1# show tenant members\nSun 2020-03-22 11:44:48 UTC\n\nNode: node1\n\n============ ========= ================= ================= ================== ==============\n Device I/F   VLAN ID   Network I/F       Network I/F IP    Source IP Prefix   Tenant\n============ ========= ================= ================= ================== ==============\n     kni254         0   controlKniIf      169.254.127.126   0.0.0.0/0          _internal_\n"})}),"\n",(0,i.jsx)(n.h2,{id:"tenancy-strategies",children:"Tenancy Strategies"}),"\n",(0,i.jsx)(n.p,{children:"Designing a scalable, cohesive tenant strategy is one of the primary keys to success with an SSR-powered network. This section of the guide, assuming you are migrating an existing network to one powered by SSR, will help you perform the following tasks:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Establish a basic tenancy framework for your network topology"}),"\n",(0,i.jsx)(n.li,{children:"Identify sources of existing segmentation data"}),"\n",(0,i.jsx)(n.li,{children:"Migrate data into the SSR data model"}),"\n",(0,i.jsx)(n.li,{children:"Refine and adapt the design"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"before-you-begin",children:"Before You Begin"}),"\n",(0,i.jsx)(n.p,{children:"There are several steps you can take at the outset of designing a tenancy strategy to improve your chances for success. These are:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Assess the current security profile of your network. Because tenancy lets you segment (partition) your network, it will act as the guard rails around how consumers access network destinations."}),"\n",(0,i.jsx)(n.li,{children:"Choose an appropriate baseline tenancy model."}),"\n",(0,i.jsx)(n.li,{children:'Plan for a "discovery process" to identify the rules at each site to map to your baseline tenant structure.'}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"assess-the-current-profile",children:"Assess the Current Profile"}),"\n",(0,i.jsx)(n.p,{children:'Assessing your current security profile entails identifying the unique categories of users/devices at all of your locations. We recommend to do one location "type" at a time; e.g., start with your similarly-equipped branch offices. For each of the different site types in your network, list out all of the different major categories devices on the network. For typical branch office deployments, this will include things such as:'}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Employee workstations (including such things as point-of-sale systems, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"Guest wifi"}),"\n",(0,i.jsx)(n.li,{children:"IP phones"}),"\n",(0,i.jsx)(n.li,{children:'Various "things" such as security cameras, printers, scanners, etc.'}),"\n",(0,i.jsx)(n.li,{children:"Application servers, DHCP servers, DNS servers, and other network services"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The objective for this profiling is to ",(0,i.jsx)(n.em,{children:"group the devices into categories, where a category contains devices expected to have roughly equivalent network policy"}),". A tenant (network segment) carves off access for all of its devices equally; two devices belonging to the same tenant will have equal network access. Thus, it is important to categorize the devices based on which of them share common profiles."]}),"\n",(0,i.jsx)(n.p,{children:"To baseline your tenancy model, it is not necessary to perform exhaustive research, to identify (for example) what distinguishes a finance employee's workstation from a developer's workstation \u2013 we'll get to that in future iterations of the tenancy design. For now, we're just interested in establishing the basic framework."}),"\n",(0,i.jsx)(n.h4,{id:"choose-a-baseline-model",children:"Choose a Baseline Model"}),"\n",(0,i.jsx)(n.p,{children:"A standard baseline for all tenancy models is to consider:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Trusted devices: equipment that is generally given access to internal systems and applications hosted by the enterprise. While the equipment may have some access restrictions, it is generally trusted. E.g., employee workstations"}),"\n",(0,i.jsx)(n.li,{children:"Untrusted devices: equipment that is not trusted by default, and will typically only have access to the internet. E.g., guest wifi"}),"\n",(0,i.jsx)(n.li,{children:'Restricted devices: equipment that may be on a trusted network, but should ideally have limited network access based upon its type. This also includes limited function devices in your DMZ network); e.g., "things"'}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Collate the different devices that you enumerated in your profiling exercise into these three categories. We will refine the model later, to provide differentiation between devices within each category."}),"\n",(0,i.jsx)(n.h4,{id:"site-discovery",children:"Site Discovery"}),"\n",(0,i.jsx)(n.p,{children:"Last is the process for site-specific discovery. For each of the major categories of devices at your site, understand how (or if) each site has rules in place for assigning devices today. Look for things such as:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["VLAN assignments. Usually sites will have distinct VLANs for trusted traffic, guest wifi, VoIP services, etc. Map each of the specific VLANs to your tenants. For VLANs that are entirely comprised of one variety of device (typical with guest wifi and voice), assign that tenant directly to the ",(0,i.jsx)(n.code,{children:"network-interface"})," for that VLAN on your SSR"]}),"\n",(0,i.jsx)(n.li,{children:"DHCP scopes/IPAM systems. How does the site issue out IP addresses? Does the DHCP server give out specific addresses to specific categories of equipment? Use the intelligence provisioned in the DHCP server to model that same configuration in the SSR. (And while you're at it, consider moving DHCP services to the SSR.)"}),"\n",(0,i.jsx)(n.li,{children:"NAC. If your site has a NAC, presumably it has configuration rules in it that can identify how the equipment is deployed at that site."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The goal for the site discovery is to ",(0,i.jsx)(n.em,{children:"understand the rules for how IP addresses are assigned at the site and ensure the SSR model matches"}),". For environments where there is a lot of homogeneity in the site (e.g., financial institutions, retail, oil and gas, etc.), the rules for IP assignment are usually predictable and well known. Use that information to your advantage, to bootstrap the discovery process."]}),"\n",(0,i.jsx)(n.h3,{id:"refining-and-adapting-the-design",children:"Refining and Adapting the Design"}),"\n",(0,i.jsx)(n.p,{children:"Now that you have a basic design in place, consider each category to understand the similarities and differences with each of the items you've placed into that category. For example, you've identified employee workstations in the \"trusted\" category, but there are many types of employee workstations. There are workstations that are used by the finance team that have access to payroll systems and sensitive back office data. There are workstations used by your internal development team that have access to source code repositories and test harnesses. And there are workstations used by your IT team that need access to absolutely everything."}),"\n",(0,i.jsxs)(n.p,{children:["This is where you refine and adapt the design. For each category, establish the common policy associated with all of them. In our case, all of the workstations need access to the internet and to the corporate intranet. We will use the tenant ",(0,i.jsx)(n.code,{children:"workstations"})," and apply it as the ",(0,i.jsx)(n.code,{children:"access-policy"})," for the internet/intranet services."]}),"\n",(0,i.jsxs)(n.p,{children:["We will create the child tenants for each subcategory (",(0,i.jsx)(n.code,{children:"finance.workstations"}),", ",(0,i.jsx)(n.code,{children:"development.workstations"}),", ",(0,i.jsx)(n.code,{children:"it.workstations"}),", etc.) to selectively allow/deny access to specific services needed by those user populations. Within each of these subcategories we can further differentiate between user personas or roles."]}),"\n",(0,i.jsx)(n.h3,{id:"general-considerations-and-best-practices",children:"General Considerations and Best Practices"}),"\n",(0,i.jsx)(n.p,{children:"Regardless of which baseline model you choose, there are some general considerations we recommend for all deployments."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Make tenancy ubiquitous on LAN-side interfaces; everything entering into the LAN side interface of one of your SSR devices should have a tenant defined."}),"\n",(0,i.jsx)(n.li,{children:'Create an enterprise-wide tenant to be used as the "parent" to quickly allow or deny network service access to your entire user population.'}),"\n",(0,i.jsxs)(n.li,{children:["If you have a lab environment that can faithfully reproduce a branch location, create lab-specific prefixes for each of your baseline tenants as described in ",(0,i.jsx)(n.em,{children:"Application Discovery on the SSR"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Start with basic categorization, and don't get too fancy out of the gates. We can (and inevitably will) refine the model over time, as we start to learn more about how the network works."}),"\n",(0,i.jsx)(n.li,{children:"When in doubt about how to categorize your tenants, use a service-oriented approach. List the services you want to make available to each of your network constituents. When you find significant overlap between any subsets of these constituents, consider organizing them into hierarchies to simplify the configuration model."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"use-case-retail-sd-wan",children:"Use Case: Retail SD-WAN"}),"\n",(0,i.jsx)(n.p,{children:'A nationwide retail franchise ("Acme, Inc.") is adopting SSR across their environment to provide SD-WAN services. The retail franchise has three different types of sites:'}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Legacy Acme stores"}),"\n",(0,i.jsx)(n.li,{children:'The "green stores," a retail franchise acquired by Acme in 2012'}),"\n",(0,i.jsx)(n.li,{children:'The "yellow stores" acquired by Acme in 2018'}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The Network Architecture team at Acme did site surveys of all of the equipment in place at all three site varieties and came up with the following list:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Cash registers (point-of-sale systems), also responsible for inventory moves/adds/changes"}),"\n",(0,i.jsx)(n.li,{children:"Security cameras"}),"\n",(0,i.jsx)(n.li,{children:"Handheld barcode scanners"}),"\n",(0,i.jsx)(n.li,{children:"Employee wifi for BYOD"}),"\n",(0,i.jsx)(n.li,{children:"Guest wifi access points"}),"\n",(0,i.jsx)(n.li,{children:"VoIP phones"}),"\n",(0,i.jsx)(n.li,{children:"Printers"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The team categorized things as follows:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Trusted: cash registers, barcode scanners, BYOD"}),"\n",(0,i.jsx)(n.li,{children:"Untrusted: guest wifi access points"}),"\n",(0,i.jsx)(n.li,{children:"Restricted: security cameras, VoIP phones, printers"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This lent itself to the following tenant model:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"acme"}),": the parent tenant for all devices at the retail locations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"trusted.acme"}),": the parent tenant for all trusted devices, used for common network policy (such as internet offload, service function chaining, etc.)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"byod.trusted.acme"}),": employee-owned BYOD"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"pos.trusted.acme"}),": the point-of-sale systems"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"handheld.trusted.acme"}),": the handheld scanners"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guest.acme"}),": the guest wifi"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"voice.acme"}),": the voice equipment"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"restricted.acme"}),": security cameras, printers, etc."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"notes-about-the-model",children:"Notes about the Model"}),"\n",(0,i.jsx)(n.p,{children:"The Network Architecture team realized they have a very simple network at each of their retail stores, and kept the model basic. They needed to make some tough decisions, and here was their thought process:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Decision"}),": how to categorize BYOD? Employees frequently bring in their own smartphones and tablets to work with them, and modern employers embrace the gains in productivity. But these are not company-owned devices. Should they be considered untrusted or trusted? In the end they decided that the BYOD need access to a lot of core services common with the customer-managed POS systems, so they consider them as part of the ",(0,i.jsx)(n.code,{children:"trusted"})," hierarchy. However, by breaking them out into their own category (",(0,i.jsx)(n.code,{children:"byod.trusted.acme"}),") they can add ",(0,i.jsx)(n.code,{children:"access-policy"})," stanzas to ",(0,i.jsx)(n.em,{children:"deny"})," the tenant from services that are too sensitive to trust to BYOD.","\n",(0,i.jsx)(n.admonition,{title:"Key decision",type:"info",children:(0,i.jsx)(n.p,{children:"In the end they decided the overlap between BYOD and POS was greater than the overlap between BYOD and untrusted; thus, it is easier to selectively deny it access to sensitive services than to selectively permit it access to trusted services."})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Decision"}),": why is voice its own category? Voice over IP uses networks in a peculiar way, with no predictable port usage, sessions initiating asymmetrically, and a mix of transport protocols. Also, in most deployments voice is broken out into its own VLAN. For services that are isolated and relegated to their own VLAN, it is simplest to carve out a top-level tenant for it."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"site-surveys",children:"Site Surveys"}),"\n",(0,i.jsx)(n.p,{children:"The Architecture team then went through each of the three store types, to understand how to map the devices into these core tenants. They found that each of the three varieties of stores (legacy, green, yellow) used different IP allocation strategies for everything. Legacy stores had everything segmented by VLAN. This made the mapping exercise straightforward for the team: each VLAN could be mapped to a single tenant cleanly."}),"\n",(0,i.jsxs)(n.p,{children:["The green stores had a VLAN for voice, but used DHCP scoping to assign IP addresses to everything else based on role. The network team decided to keep this enforcement, and migrated the DHCP to the SSR using the same rules. The team then used per-neighborhood tenancy to segment the traffic. The yellow store design... well, that was a bit of a mess. There was very little control in place, with all traffic comingled on the same per-store ",(0,i.jsx)(n.code,{children:"/24"})," network."]}),"\n",(0,i.jsx)(n.p,{children:"From the surveys, they created three configuration templates, segmenting the traffic according to the VLAN"}),"\n",(0,i.jsx)(n.h4,{id:"conclusions",children:"Conclusions"}),"\n",(0,i.jsxs)(n.p,{children:['In the end, the tenant model is flexible and there is no "one correct way" to organize your devices. ',(0,i.jsx)(n.em,{children:"Do what works best for you and your network."})," In the end, readability and the ability to easily document and train your hierarchy to your colleagues will outweigh a perfectly manicured, but hard-to-understand structure."]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},1140:(e,n,t)=>{t.d(n,{A:()=>d});var i=t(96540),s=t(5556),o=t.n(s),a=t(38193),r=t(74848);class c extends i.Component{constructor(e){super(e),this.state={}}componentDidMount(){a.A.canUseDOM&&this.setState({Flowchart:t(95512).A})}render(){const{Flowchart:e}=this.state,{chartCode:n,scale:t=.7}=this.props;return a.A.canUseDOM&&e?(0,r.jsx)("div",{style:{overflowX:"scroll"},children:(0,r.jsx)(e,{options:{scale:t},chartCode:n})}):(0,r.jsx)("div",{})}}c.propTypes={chartCode:o().string.isRequired,scale:o().number};const d=c}}]);
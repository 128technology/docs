"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[7237],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return g}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=u(n),g=r,f=p["".concat(l,".").concat(g)]||p[g]||c[g]||i;return n?a.createElement(f,o(o({ref:t},d),{},{components:n})):a.createElement(f,o({ref:t},d))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var u=2;u<i;u++)o[u]=n[u];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},6677:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return l},default:function(){return g},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return c}});var a=n(87462),r=n(63366),i=(n(67294),n(3905)),o=["components"],s={title:"Configuring Audit Events",sidebar_label:"Audit Events"},l=void 0,u={unversionedId:"config_audit_event",id:"config_audit_event",title:"Configuring Audit Events",description:"The Session Smart Router can be configured to maintain a history of several different class of events in its event log , which can subsequently be used to support compliance audits, forensics on network issues related to configuration (misapplied or otherwise), and traceability. This document covers:",source:"@site/docs/config_audit_event.md",sourceDirName:".",slug:"/config_audit_event",permalink:"/docs/config_audit_event",draft:!1,tags:[],version:"current",lastUpdatedAt:1678977344,formattedLastUpdatedAt:"Mar 16, 2023",frontMatter:{title:"Configuring Audit Events",sidebar_label:"Audit Events"},sidebar:"docs",previous:{title:"VRF Support",permalink:"/docs/config_vrf_learning"},next:{title:"DHCP",permalink:"/docs/config_dhcp"}},d={},c=[{value:"Event Types",id:"event-types",level:2},{value:"Traffic Events",id:"traffic-events",level:3},{value:"Administration Events",id:"administration-events",level:3},{value:"System Events",id:"system-events",level:3},{value:"Alarm Events",id:"alarm-events",level:3},{value:"Provisioning Events",id:"provisioning-events",level:3},{value:"Basic Configuration",id:"basic-configuration",level:2},{value:"Sample Configuration",id:"sample-configuration",level:2},{value:"Enable Basic Audit Logging",id:"enable-basic-audit-logging",level:3},{value:"Storing Events for Short Durations",id:"storing-events-for-short-durations",level:3},{value:"Sending Traffic Events to a Syslog Server",id:"sending-traffic-events-to-a-syslog-server",level:3},{value:"Basic Input and Output Configurations",id:"basic-input-and-output-configurations",level:4},{value:"Remote Logging",id:"remote-logging",level:2},{value:"Secure Syslog Transport",id:"secure-syslog-transport",level:3},{value:"Certificates",id:"certificates",level:4},{value:"TLS and TCP Transport",id:"tls-and-tcp-transport",level:4},{value:"TCP Transport",id:"tcp-transport",level:5},{value:"Viewing the Audit Log",id:"viewing-the-audit-log",level:2}],p={toc:c};function g(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"The Session Smart Router can be configured to maintain a history of several different class of events in its ",(0,i.kt)("em",{parentName:"p"},"event log")," , which can subsequently be used to support compliance audits, forensics on network issues related to configuration (misapplied or otherwise), and traceability. This document covers:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Types of events available on the router"),(0,i.kt)("li",{parentName:"ul"},"Enabling the Audit events (using the PCLI or the GUI)"),(0,i.kt)("li",{parentName:"ul"},"Using the Event Viewer in the GUI")),(0,i.kt)("h2",{id:"event-types"},"Event Types"),(0,i.kt)("p",null,"The events generated by the router are classified into the following categories:"),(0,i.kt)("h3",{id:"traffic-events"},"Traffic Events"),(0,i.kt)("p",null,"Traffic events are generated as sessions as created on the router. These include details such as the protocol, source address, source port, destination address and destination port. In addition, the success or failure status along with a reason code for failure cases are included in the event."),(0,i.kt)("h3",{id:"administration-events"},"Administration Events"),(0,i.kt)("p",null,"Various administration actions performed by a user such as SSH login generate this category of events. The events contain the details about the user action, whether or not the action was permitted, and the reason for any failures."),(0,i.kt)("h3",{id:"system-events"},"System Events"),(0,i.kt)("p",null,"Various system level events such as service and process restarts are generated by this event category. The details include information about the user and details about the underlying action."),(0,i.kt)("h3",{id:"alarm-events"},"Alarm Events"),(0,i.kt)("p",null,"All the SSR alarms generate an add event when the alarm is raised and a clear event when the alarm is cleared. The alarm events can be used to view the history of the events associated with the alarms. The alarm events are implicit events and cannot be disabled via configuration. More details on alarms and events can be found ",(0,i.kt)("a",{parentName:"p",href:"/docs/events_overview"},"here")," "),(0,i.kt)("h3",{id:"provisioning-events"},"Provisioning Events"),(0,i.kt)("p",null,"The provisioning events are generated for software download and upgrades as well as for configuration changes that are processed on the router. For configuration changes the event contains a diff of the configuration change that triggered the event. These are implicit events and cannot be disabled via configuration."),(0,i.kt)("h2",{id:"basic-configuration"},"Basic Configuration"),(0,i.kt)("p",null,"The configuration for audit logging is performed within the ",(0,i.kt)("inlineCode",{parentName:"p"},"system > audit")," branch within a ",(0,i.kt)("inlineCode",{parentName:"p"},"router")," hierarchy. In most cases, the only configuration required for enabling audit logging is adding it to the ",(0,i.kt)("inlineCode",{parentName:"p"},"router")," element for your Authority's conductor. For cases where an SSR router is not managed by a conductor, its audit logging configuration is similarly added to the ",(0,i.kt)("inlineCode",{parentName:"p"},"system > audit")," branch of its ",(0,i.kt)("inlineCode",{parentName:"p"},"router")," hierarchy."),(0,i.kt)("p",null,"SSR version 5.1.0 introduces capabilities to provide additional control over persistence and storage duration of the various events listed above. The table below shows the various configuration options and the corresponding behavior pre- and post- 5.1.0 software."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"name"),(0,i.kt)("th",{parentName:"tr",align:null},"type"),(0,i.kt)("th",{parentName:"tr",align:null},"available version"),(0,i.kt)("th",{parentName:"tr",align:null},"default"),(0,i.kt)("th",{parentName:"tr",align:null},"description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"retention"),(0,i.kt)("td",{parentName:"tr",align:null},"duration"),(0,i.kt)("td",{parentName:"tr",align:null},"5.1.0"),(0,i.kt)("td",{parentName:"tr",align:null},"180 days"),(0,i.kt)("td",{parentName:"tr",align:null},"How long to persist the events listed above.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"traffic > enabled"),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"all"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"Enable/disable the generation of traffic events.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"traffic > persist"),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"5.1.0"),(0,i.kt)("td",{parentName:"tr",align:null},"false"),(0,i.kt)("td",{parentName:"tr",align:null},"If enabled, whether or not to persist the events to the local storage for the configured retention duration.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"administration > enabled"),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"all"),(0,i.kt)("td",{parentName:"tr",align:null},"true"),(0,i.kt)("td",{parentName:"tr",align:null},"Enable/disable the generation of administration events.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"administration > persist"),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"5.1.0"),(0,i.kt)("td",{parentName:"tr",align:null},"true"),(0,i.kt)("td",{parentName:"tr",align:null},"If enabled, whether or not to persist the events to the local storage for the configured retention duration.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"system > enabled"),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"all"),(0,i.kt)("td",{parentName:"tr",align:null},"true"),(0,i.kt)("td",{parentName:"tr",align:null},"Enable/disable the generation of system events.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"system > persist"),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"5.1.0"),(0,i.kt)("td",{parentName:"tr",align:null},"true"),(0,i.kt)("td",{parentName:"tr",align:null},"If enabled, whether or not to persist the events to the local storage for the configured retention duration.")))),(0,i.kt)("p",null,"Beginning with version 5.6, if ",(0,i.kt)("inlineCode",{parentName:"p"},"auditd")," fails to start or is prevented from running, an imediate, real-time message is displayed to all users indicating that the audit logging capability is impacted. This message persists until the failure is resolved."),(0,i.kt)("h2",{id:"sample-configuration"},"Sample Configuration"),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Configuration not related to audit logging has been filtered out for illustrative purposes.")),(0,i.kt)("h3",{id:"enable-basic-audit-logging"},"Enable Basic Audit Logging"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"config\n    authority\n        router  my-router\n            name    my-router\n            system\n                audit\n                    administration\n                        enabled  true\n                    exit\n                exit\n            exit\n        exit\n    exit\nexit\n")),(0,i.kt)("h3",{id:"storing-events-for-short-durations"},"Storing Events for Short Durations"),(0,i.kt)("p",null,"By default the SSR routers store all events except traffic events for up to six months on the local disk. In some cases it might be desirable to shorten the length of time for these events to minimize the impact on the local disk. This can be accomplished as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"config\n    authority\n        router my-router\n            system\n                audit\n                    retention 1d\n                exit\n            exit\n        exit\n    exit\nexit\n")),(0,i.kt)("p",null,"In the above example all the events available on the SSR router are only retained for one day. The ",(0,i.kt)("inlineCode",{parentName:"p"},"retention")," is of type duration and can take values in hours and days; for example, 24h or 1d."),(0,i.kt)("h3",{id:"sending-traffic-events-to-a-syslog-server"},"Sending Traffic Events to a Syslog Server"),(0,i.kt)("p",null,"Traffic events are disabled and not persisted by default because they can produce a large volume of data. However, in situations where the traffic events need to be sent off-box for storage, such as a syslog server, they can be enabled but not persisted to local storage. The following snippet provides an example of that configuration."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"config\n    authority\n        router my-router\n            system\n                audit\n                    traffic\n                        enabled true\n                        persist false\n                    exit\n                exit\n            exit\n        exit\n    exit\n")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"For in-depth explanations of how to configure the Monitoring Agent to handle audit events, refer to the ",(0,i.kt)("a",{parentName:"p",href:"/docs/plugin_monitoring_agent"},"SSR Monitoring Agent")," documentation.")),(0,i.kt)("h4",{id:"basic-input-and-output-configurations"},"Basic Input and Output Configurations"),(0,i.kt)("p",null,"Use the following information to create basic Input and Output configurations."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Create an event collector input to capture the traffic events. An example input configuration is shown below.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-toml"},'[[inputs.t128_events]]\n    # It is a best practice to specify a custom index file location\n    index-file = "/var/lib/128t-monitoring/state/events.index"\n    topic = "events"\n    [inputs.t128_events.tagpass]\n        type = ["traffic"]\n')),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"Define an output for where the events are to be sent. In this example, the events are sent to a syslog server.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-toml"},'[[outputs.syslog]]\n  address = "udp://<ip>:514"\n  default_sdid = "128T"\n')),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},"The input and output are placed in the input and output directories respectively and tied together by the ",(0,i.kt)("a",{parentName:"li",href:"/docs/plugin_monitoring_agent#configuration"},"Monitoring Agent configuration"),". A sample monitoring agent configuration:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"enabled: true\n\ninputs:\n  - name: traffic-events\noutputs:\n  - name: my-syslog\n\n")),(0,i.kt)("p",null,"Once these configurations are in place, starting the Monitoring Agent will send events to syslog. "),(0,i.kt)("h2",{id:"remote-logging"},"Remote Logging"),(0,i.kt)("p",null,"Audit logs can be stored off system by configuring a remote logging server. When the IP address and port are configured, audit logs are sent to the remote system for storage and review. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"config\n    authority\n        router  Fabric128\n            name    Fabric128\n            system\n                audit\n                    remote-logging-server  1.1.1.1 60\n                        address  1.1.1.1\n                        port     60\n                    exit\n                exit\n            exit\n        exit\n    exit\nexit\n")),(0,i.kt)("h3",{id:"secure-syslog-transport"},"Secure Syslog Transport"),(0,i.kt)("p",null,"Beginning with Version 6.0.4, the SSR can be configured to send system generated events over a secure TLS or TCP connection to a remote-logging server for analysis and storage. The current default is a UDP connection."),(0,i.kt)("p",null,"A new configuration element, ",(0,i.kt)("inlineCode",{parentName:"p"},"protocol"),", has been added to the syslog configuration under ",(0,i.kt)("inlineCode",{parentName:"p"},"authority/router/system")," to configure the protocol that the SSR uses to open communication with the syslog server. "),(0,i.kt)("h4",{id:"certificates"},"Certificates"),(0,i.kt)("p",null,"Use ",(0,i.kt)("inlineCode",{parentName:"p"},"config authority")," to configure a certificate for use when opening the TLS connection, and to encrypt packets sent to the syslog server."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Configure a Trusted CA Certificate on the SSR ")),(0,i.kt)("p",null,"Copy the content of the trusted CA certificate into the configuration."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"    admin@test1.Fabric128 (trusted-ca-certificate[name=server-ca])# show\n        name     server-ca\n        content  (text/plain) <-- contents of the server certificate.\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Configure a Client Certificate on the SSR")),(0,i.kt)("p",null,"Copy the content of the client certificate into the configuration."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"    admin@test1.Fabric128 (client-certificate[name=ABC])# show\n        name     ABC\n        content  (text/plain) <---- contents of the client certificate.\n")),(0,i.kt)("p",null,"See ",(0,i.kt)("a",{parentName:"p",href:"/docs/howto_trusted_ca_certificate"},"Adding a Trusted Certificate")," for more information."),(0,i.kt)("h4",{id:"tls-and-tcp-transport"},"TLS and TCP Transport"),(0,i.kt)("p",null,"To provide secure transport for the system generated events, the SSR can be configured to use TLS to open an encrypted communication channel with the syslog server."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"    admin@test1.Fabric128 (syslog)# show\n        severity        info\n        facility        any\n        protocol        tls\n        client-certificate-name  ABC <-- client certificate already configured under authority/client-certificate\n\n        server          172.18.2.183 514\n            ip-address  172.18.2.183\n            port        514\n    exit\n")),(0,i.kt)("h5",{id:"tcp-transport"},"TCP Transport"),(0,i.kt)("p",null,"Configure the SSR to use TCP for transport to syslog server."),(0,i.kt)("admonition",{type:"important"},(0,i.kt)("p",{parentName:"admonition"},"Although using TCP guarantees events are transmitted to the destination syslog server, it is not considered secure because TCP without TLS transmits data in clear text.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"    admin@test1.Fabric128 (syslog)# show\n        severity        info\n        facility        any\n        protocol        tcp\n\n        server          172.18.2.183 514\n            ip-address  172.18.2.183\n            port        514\n    exit\n")),(0,i.kt)("h2",{id:"viewing-the-audit-log"},"Viewing the Audit Log"),(0,i.kt)("p",null,"To view the contents of the audit log via the GUI (on the Conductor or Router as configured above), navigate to the ",(0,i.kt)("strong",{parentName:"p"},"Tools")," page and choose ",(0,i.kt)("strong",{parentName:"p"},"Event History"),". The Event History viewer shows all of the events that the SSR has accumulated, including audit log events. Audit log events are of type ",(0,i.kt)("strong",{parentName:"p"},"ADMIN"),"; use the built-in filtering mechanism to limit the Event History search results to ADMIN type events."))}g.isMDXComponent=!0}}]);
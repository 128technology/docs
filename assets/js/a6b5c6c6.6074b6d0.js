"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[3958],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return g}});var r=t(67294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=r.createContext({}),s=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=s(e.components);return r.createElement(l.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},f=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),f=s(t),g=i,d=f["".concat(l,".").concat(g)]||f[g]||p[g]||a;return t?r.createElement(d,o(o({ref:n},u),{},{components:t})):r.createElement(d,o({ref:n},u))}));function g(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,o=new Array(a);o[0]=f;var c={};for(var l in n)hasOwnProperty.call(n,l)&&(c[l]=n[l]);c.originalType=e,c.mdxType="string"==typeof e?e:i,o[1]=c;for(var s=2;s<a;s++)o[s]=t[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}f.displayName="MDXCreateElement"},52111:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return c},metadata:function(){return l},toc:function(){return s},default:function(){return p}});var r=t(87462),i=t(63366),a=(t(67294),t(3905)),o=["components"],c={title:"Configuring DSCP Steering",sidebar_label:"Configuring DSCP Steering"},l={unversionedId:"config_dscp_steering",id:"config_dscp_steering",isDocsHomePage:!1,title:"Configuring DSCP Steering",description:"When traffic is traversing an encrypted tunnel such as IPSec, every flow within that tunnel shares the same layer 3 headers, making them difficult if not impossible to disambiguate from each other.",source:"@site/docs/config_dscp_steering.md",sourceDirName:".",slug:"/config_dscp_steering",permalink:"/docs/config_dscp_steering",version:"current",lastUpdatedAt:1642693184,formattedLastUpdatedAt:"1/20/2022",sidebar_label:"Configuring DSCP Steering",frontMatter:{title:"Configuring DSCP Steering",sidebar_label:"Configuring DSCP Steering"},sidebar:"docs",previous:{title:"Open Shortest Path First (OSPF)",permalink:"/docs/config_ospf"},next:{title:"VRF Learning",permalink:"/docs/config_vrf_learning"}},s=[{value:"Configuration",id:"configuration",children:[{value:"Service Configuration",id:"service-configuration",children:[]},{value:"Network Interface Configuration",id:"network-interface-configuration",children:[]},{value:"Restrictions",id:"restrictions",children:[]}]},{value:"GUI Configuration Screens",id:"gui-configuration-screens",children:[]}],u={toc:s};function p(e){var n=e.components,c=(0,i.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},u,c,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"When traffic is traversing an encrypted tunnel such as IPSec, every flow within that tunnel shares the same layer 3 headers, making them difficult if not impossible to disambiguate from each other. "),(0,a.kt)("p",null,"When the tunnel endpoint encrypts traffic, it can set a DSCP value representative of the traffic within the tunnel. When the traffic reaches the SSR, the DSCP value can be used as both a representation of traffic engineering priority, and path priority."),(0,a.kt)("h2",{id:"configuration"},"Configuration"),(0,a.kt)("p",null,"DSCP traffic steering must be configured at both the ",(0,a.kt)("inlineCode",{parentName:"p"},"service")," level and the ",(0,a.kt)("inlineCode",{parentName:"p"},"network-interface"),". "),(0,a.kt)("h3",{id:"service-configuration"},"Service Configuration"),(0,a.kt)("p",null,"A DSCP value or range can be configured at the Service level. DSCP aware services are configured in a hierarchy; the parent service is configured without a DSCP value, and each child service is configured with a DSCP value."),(0,a.kt)("p",null,"The following configuration splits the tunnel across 3 services: the traffic with ",(0,a.kt)("inlineCode",{parentName:"p"},"dscp")," value 14 is handled by the high-priority service; the traffic with ",(0,a.kt)("inlineCode",{parentName:"p"},"dscp")," values from 26 to 28 is handled by the low-priority service. The remaining traffic falls back into the tunnel service."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'service          tunnel\n    name           tunnel\n    description    "IPSec Tunnel"\n    scope          public\n    security       internal\n    address        5.5.5.100/0\n    access-policy  red\n        source      red\n        permission  allow\n    exit\nexit\n\nservice          high-priority.tunnel\n    name           high-priority.tunnel\n    description    "The high priority traffic within this tunnel"\n    scope          public\n    security       internal\n    dscp-range     14\n        start-value 14\n    exit\nexit\n\nservice          low-priority.tunnel\n    name           low-priority.tunnel\n    description    "The low priority traffic within this tunnel"\n    scope          public\n    security       internal\n    dscp-range     26\n        start-value 26\n        end-value   28\n    exit\nexit\n\n')),(0,a.kt)("h3",{id:"network-interface-configuration"},"Network Interface Configuration"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"dscp-steering")," option is available at the network-interface level. This allows you to enable traffic steering for DSCP traffic entering on a specific transport and port range rather than an entire interface.  "),(0,a.kt)("p",null,"Only traffic matching the ",(0,a.kt)("inlineCode",{parentName:"p"},"dscp-steering")," properties configured in the ",(0,a.kt)("inlineCode",{parentName:"p"},"service")," and on the ",(0,a.kt)("inlineCode",{parentName:"p"},"network-interface")," will be steered using DSCP. Other traffic will be handled according to the relevant configuration.   "),(0,a.kt)("p",null,"The following example is designed to target IPSec NAT traversal traffic which is typically UDP, with a destination port 4500. "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"network-interface foo\n    name foo\n    global-id 12\n    vlan 0\n    dscp-steering\n        enabled true\n        transport\n            protocol udp\n            port-range\n                start-port 4500\n            exit\n        exit\n    exit\nexit     \n")),(0,a.kt)("h3",{id:"restrictions"},"Restrictions"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The DSCP steering transport list for a network-interface is limited to one range."),(0,a.kt)("li",{parentName:"ul"},"Any service with a ",(0,a.kt)("inlineCode",{parentName:"li"},"dscp-range")," configuration must be a child service."),(0,a.kt)("li",{parentName:"ul"},"Only provisioned service-routes are supported. "),(0,a.kt)("li",{parentName:"ul"},"DSCP steering ranges must not overlap. ")),(0,a.kt)("h2",{id:"gui-configuration-screens"},"GUI Configuration Screens"),(0,a.kt)("p",null,"The following screens demonstrate configuring the network interface using the GUI."),(0,a.kt)("p",null,"Enable DSCP Steering, and select the DSCP Steering Transport button."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"DSCP Steering button",src:t(28052).Z})),(0,a.kt)("p",null,"Select a protocol."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"DSCP Steering Info",src:t(42504).Z})),(0,a.kt)("p",null,"Enter the port or port range."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"DSCP Steering Port Ranges",src:t(20561).Z})))}p.isMDXComponent=!0},28052:function(e,n,t){n.Z=t.p+"assets/images/dscp_steering1-497818971a65ee7bcc6a779407b5beef.png"},42504:function(e,n,t){n.Z=t.p+"assets/images/dscp_steering2-89350fe6ad25f1d8931d862d4ce2001a.png"},20561:function(e,n,t){n.Z=t.p+"assets/images/dscp_steering3-a9bd848096ce7e27566344a1561c6429.png"}}]);
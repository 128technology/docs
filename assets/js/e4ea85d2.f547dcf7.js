"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[4120],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return v}});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=r.createContext({}),c=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(t),v=a,f=u["".concat(s,".").concat(v)]||u[v]||d[v]||i;return t?r.createElement(f,o(o({ref:n},p),{},{components:t})):r.createElement(f,o({ref:n},p))}));function v(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,o=new Array(i);o[0]=u;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var c=2;c<i;c++)o[c]=t[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},93148:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return p},default:function(){return u}});var r=t(87462),a=t(63366),i=(t(67294),t(3905)),o=["components"],l={title:"Configuring Dual Router High Availability and VRRP",sidebar_label:"Dual Router High Availability and VRRP"},s=void 0,c={unversionedId:"config_ha_vrrp",id:"config_ha_vrrp",title:"Configuring Dual Router High Availability and VRRP",description:"The release of the 5.4 software includes VRRP as a configuration option, as well as a new service route parameter, enable-failover, to provide failover across multiple service-routes that have this flag set.",source:"@site/docs/config_ha_vrrp.md",sourceDirName:".",slug:"/config_ha_vrrp",permalink:"/docs/config_ha_vrrp",tags:[],version:"current",lastUpdatedAt:1660765972,formattedLastUpdatedAt:"8/17/2022",frontMatter:{title:"Configuring Dual Router High Availability and VRRP",sidebar_label:"Dual Router High Availability and VRRP"},sidebar:"docs",previous:{title:"Dual Router High Availability using iBGP",permalink:"/docs/config_dual_router_ha"},next:{title:"Non-forwarding HA Interfaces",permalink:"/docs/config_non_forwarding_ha_interfaces"}},p=[{value:"Configure the Primary Router",id:"configure-the-primary-router",children:[{value:"Assign the Peer",id:"assign-the-peer",children:[],level:3},{value:"Configure VRRP",id:"configure-vrrp",children:[],level:3},{value:"Enable Service Route Failover",id:"enable-service-route-failover",children:[],level:3}],level:2},{value:"Configure the Secondary Router",id:"configure-the-secondary-router",children:[{value:"Assign the Peer",id:"assign-the-peer-1",children:[],level:3},{value:"Configure VRRP",id:"configure-vrrp-1",children:[],level:3},{value:"Enable Service Route Failover",id:"enable-service-route-failover-1",children:[],level:3},{value:"Show Command for VRRP Status",id:"show-command-for-vrrp-status",children:[],level:3}],level:2},{value:"Sample VRRP Configuration",id:"sample-vrrp-configuration",children:[],level:2}],d={toc:p};function u(e){var n=e.components,t=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"The release of the 5.4 software includes VRRP as a configuration option, as well as a new service route parameter, ",(0,i.kt)("a",{parentName:"p",href:"#enable-service-route-failover"},(0,i.kt)("inlineCode",{parentName:"a"},"enable-failover")),", to provide failover across multiple service-routes that have this flag set. "),(0,i.kt)("p",null,"The following sample configuration provides context for using vrrp and enabling service route failover to provide failover on a dual router high availability configuration. "),(0,i.kt)("h2",{id:"configure-the-primary-router"},"Configure the Primary Router"),(0,i.kt)("p",null,"Identify the primary router, and configure the following settings."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Peer"),(0,i.kt)("li",{parentName:"ul"},"VRRP and priority on the interfaces"),(0,i.kt)("li",{parentName:"ul"},"Enable failover and set priority on the service routes")),(0,i.kt)("p",null,"The configuration for the secondary router will be similar but not identical. "),(0,i.kt)("h3",{id:"assign-the-peer"},"Assign the Peer"),(0,i.kt)("p",null,"On the primary router, assign the peer router to which the primary will failover. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'config\n    authority\n        router          router-a\n            name                  router-a\n            location              "router-a Philadephia"\n            location-coordinates  +39.9526-75.1652/\n            inter-node-security   internal\n\n            peer                router-b\n                name            router-b\n                authority-name  Authority128\n                router-name     router-b\n')),(0,i.kt)("h3",{id:"configure-vrrp"},"Configure VRRP"),(0,i.kt)("p",null,"Configure node1 on router-a with the following interfaces:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"lan"),(0,i.kt)("li",{parentName:"ul"},"wan"),(0,i.kt)("li",{parentName:"ul"},"far (the inter-router communication link)")),(0,i.kt)("p",null,"Activate VRRP on the ",(0,i.kt)("inlineCode",{parentName:"p"},"lan")," device interface of node1. By configuring ",(0,i.kt)("inlineCode",{parentName:"p"},"router-a")," with a higher VRRP priority (100), ",(0,i.kt)("inlineCode",{parentName:"p"},"router-a")," is identified as the primary router. We will configure ",(0,i.kt)("inlineCode",{parentName:"p"},"router-b")," as the secondary router."),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"These examples demonstrate the use of VRRP for LAN-side network interfaces connected to a common switch. While uncommon in production deployments, VRRP can also be configured for WAN interfaces."))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"            node                  node1\n                name                      node1\n                asset-id                  f1305f6b-44c3-4b1e-b887-7376efc974d7\n                role                      combo\n                asset-validation-enabled  false\n\n                device-interface          lan\n                    name               lan\n                    type               ethernet\n                    pci-address        0000:00:04.0\n\n                    vrrp\n                        enabled                 true\n                        vrid                    128\n                        priority                100\n                    exit\n\n                    network-interface  lan\n                        name          lan\n                        global-id     1\n                        tenant        red\n                        source-nat    false\n                        qp-value      30\n                        mtu           1500\n\n                        address       172.16.1.2\n                            ip-address     172.16.1.2\n                            prefix-length  24\n                        exit\n                        address       172.16.1.111\n                            ip-address     172.16.1.111\n                            prefix-length  24\n                        exit\n                    exit\n                exit\n\n                device-interface          wan\n                    name               wan\n                    type               ethernet\n                    pci-address        0000:00:05.0\n\n                     network-interface  wan\n                        name                   wan\n                        global-id              3\n                        inter-router-security  aes1\n                        source-nat             false\n                        qp-value               30\n                        mtu                    1500\n\n                        address                172.16.2.111\n                            ip-address     172.16.2.111\n                            prefix-length  24\n                        exit\n                    exit\n                exit\n\n                device-interface          far\n                    name               far\n                    type               ethernet\n                    pci-address        0000:00:06.0\n\n                    network-interface  far\n                        name                   far\n                        global-id              2\n\n                        neighborhood           peer\n                            name               peer\n                            peer-connectivity  bidirectional\n                            topology           mesh\n                            vector             peer\n                        exit\n                        inter-router-security  aes1\n                        source-nat             false\n                        qp-value               30\n                        mtu                    1500\n\n                        address                172.16.3.2\n                            ip-address     172.16.3.2\n                            prefix-length  24\n                        exit\n                    exit\n                exit\n            exit\n")),(0,i.kt)("h3",{id:"enable-service-route-failover"},"Enable Service Route Failover"),(0,i.kt)("p",null,"Set ",(0,i.kt)("inlineCode",{parentName:"p"},"enable-failover")," to true. This will enable failover between service routes on router-a.  "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"            service-route        local-route\n                name             local-route\n                service-name     traffic\n                vector           local-vrrp\n                enable-failover  true\n\n                next-hop         node1 wan\n                    node-name    node1\n                    interface    wan\n                exit\n            exit\n\n            service-route        peer-route\n                name             peer-route\n                service-name     traffic\n                vector           peer\n                enable-failover  true\n                next-peer        router-b\n            exit\n")),(0,i.kt)("p",null,"Assign a vector to the service route, and then assign a priority to the vector in the service policy. This priority determines service route preference, with the higher priority being the preferred route. "),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Vector priority is assigned in descending order; the lowest number has the highest priority. To assign vector ",(0,i.kt)("inlineCode",{parentName:"p"},"local-vrrp")," the highest priority, it is assigned a value of 1. Vector ",(0,i.kt)("inlineCode",{parentName:"p"},"peer")," has a ",(0,i.kt)("strong",{parentName:"p"},"lower priority")," of 10.  "))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"        service-policy      poc-policy\n            name            poc-policy\n            service-class   Standard\n\n            vector          local-vrrp\n                name        local-vrrp\n                priority    1\n            exit\n\n            vector          peer\n                name        peer\n                priority    10\n            exit\n\n            session-resiliency    revertible-failover\n            peer-path-resiliency  true\n            path-quality-filter   true\n            max-loss              0.5\n            max-latency           250\n            max-jitter            100\n        exit\n")),(0,i.kt)("p",null,"Configuring session resiliency allows the traffic to fail back to the primary service route once the service-route is operational again. The max-loss, max-latency, and max-jitter settings will determine at what point failover happens. "),(0,i.kt)("h2",{id:"configure-the-secondary-router"},"Configure the Secondary Router"),(0,i.kt)("p",null,"Identify the secondary router, and configure the following settings."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Peer"),(0,i.kt)("li",{parentName:"ul"},"VRRP and priority on the interfaces"),(0,i.kt)("li",{parentName:"ul"},"Enable failover and set priority on the service routes")),(0,i.kt)("p",null,"The differences for the secondary router are the priority values. "),(0,i.kt)("h3",{id:"assign-the-peer-1"},"Assign the Peer"),(0,i.kt)("p",null,"On the secondary router, assign the peer router to which the secondary router will failover when service to the primary router has been restored. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'        router          router-b\n            name                  router-b\n            location              "router-b New York"\n            location-coordinates  +40.7128-074.0059/\n            inter-node-security   internal\n\n            peer                  router-a\n                name            router-a\n                authority-name  Authority128\n                router-name     router-a\n            exit\n')),(0,i.kt)("h3",{id:"configure-vrrp-1"},"Configure VRRP"),(0,i.kt)("p",null,"Configure node1 on router-b with the following interfaces:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"lan"),(0,i.kt)("li",{parentName:"ul"},"wan"),(0,i.kt)("li",{parentName:"ul"},"far (this is the inter-router communication link)")),(0,i.kt)("p",null,"Activate VRRP on the ",(0,i.kt)("inlineCode",{parentName:"p"},"lan")," device interface of node1. Configuring a lower VRRP priority (97) on the ",(0,i.kt)("inlineCode",{parentName:"p"},"lan")," interface of router-b, identifies router-b as the secondary router. On a dual router HA setup, the vrids must be the same on the two redundant/VRRP devices - ",(0,i.kt)("inlineCode",{parentName:"p"},"router-a")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"router-b")," ",(0,i.kt)("inlineCode",{parentName:"p"},"lan")," device interfaces must have the same vrid."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"            node                  node1\n                name                      node1\n                asset-id                  8100f73d-2071-47c3-86cb-07eba002b698\n                role                      combo\n                asset-validation-enabled  false\n\n                device-interface          lan\n                    name               lan\n                    type               ethernet\n                    pci-address        0000:00:04.0\n\n                    vrrp\n                        enabled                 true\n                        vrid                    128\n                        priority                97\n                    exit\n\n                    network-interface  lan\n                        name          lan\n                        global-id     4\n                        tenant        red\n                        source-nat    false\n                        qp-value      30\n                        mtu           1500\n\n                        address       172.16.1.2\n                            ip-address     172.16.1.2\n                            prefix-length  24\n                        exit\n\n                        address       172.16.1.111\n                            ip-address     172.16.1.111\n                            prefix-length  24\n                        exit\n                    exit\n                exit\n\n                device-interface          wan\n                    name               wan\n                    type               ethernet\n                    pci-address        0000:00:05.0\n\n                    network-interface  wan\n                        name                   wan\n                        global-id              6\n                        inter-router-security  aes1\n                        source-nat             false\n                        qp-value               30\n                        mtu                    1500\n\n                        address                172.16.2.111\n                            ip-address         172.16.2.111\n                            prefix-length      24\n                        exit\n                    exit\n                exit\n\n                device-interface       far\n                    name               far\n                    type               ethernet\n                    pci-address        0000:00:06.0\n\n                    network-interface  far\n                        name                   far\n                        global-id              5\n\n                        neighborhood           peer\n                            name               peer\n                            peer-connectivity  bidirectional\n                            topology           mesh\n                            vector             peer\n                        exit\n                        inter-router-security  aes1\n                        source-nat             false\n                        qp-value               30\n                        mtu                    1500\n\n                        address                172.16.3.3\n                            ip-address         172.16.3.3\n                            prefix-length      24\n                        exit\n                    exit\n                exit\n            exit\n")),(0,i.kt)("h3",{id:"enable-service-route-failover-1"},"Enable Service Route Failover"),(0,i.kt)("p",null,"To preserve session state between routers, configure the following service routes. Set ",(0,i.kt)("inlineCode",{parentName:"p"},"enable-failover")," to true."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"            service-route        local-route\n                name             local-route\n                service-name     traffic\n                vector           local-vrrp\n                enable-failover  true\n\n                next-hop         node1 lan\n                    node-name    node1\n                    interface    lan\n                exit\n            exit\n\n            service-route        peer-route\n                name             peer-route\n                service-name     traffic\n                vector           peer\n                enable-failover  true\n                next-peer        router-a\n            exit\n")),(0,i.kt)("p",null,"Assign a vector to the service route, and then assign a priority to the vector in the service policy. This priority determines service route preference, with the higher priority being the preferred route. "),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Vector priority is assigned in descending order; the lowest number has the highest priority. To assign vector ",(0,i.kt)("inlineCode",{parentName:"p"},"local-vrrp")," the highest priority, it is assigned a value of 1. Vector ",(0,i.kt)("inlineCode",{parentName:"p"},"peer")," has a ",(0,i.kt)("strong",{parentName:"p"},"lower priority")," of 10.  "))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"        service-policy      poc-policy\n            name            poc-policy\n            service-class   Standard\n\n            vector          local-vrrp\n                name        local-vrrp\n                priority    1\n            exit\n\n            vector          peer\n                name        peer\n                priority    10\n            exit\n\n            session-resiliency    revertible-failover\n            peer-path-resiliency  true\n            path-quality-filter   true\n            max-loss              0.5\n            max-latency           250\n            max-jitter            100\n        exit\n")),(0,i.kt)("p",null,"Configuring session resiliency allows the traffic to fail back to the primary service route once the service route is operational again. The max-loss, max-latency, and max-jitter settings will determine at what point failover happens."),(0,i.kt)("h3",{id:"show-command-for-vrrp-status"},"Show Command for VRRP Status"),(0,i.kt)("p",null,"VRRP redundancy status (vrrp-active/standby) is displayed in the ",(0,i.kt)("inlineCode",{parentName:"p"},"show device-interface")," output."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"========================================\n test1:10\n========================================\n Type:                ethernet\n Forwarding:          true\n PCI Address:         0000:00:04.0\n MAC Address:         fa:16:3e:96:e3:ef\n\n Admin Status:        up\n Operational Status:  up\n Provisional Status:  up\n Redundancy Status:   vrrp-active\n")),(0,i.kt)("h2",{id:"sample-vrrp-configuration"},"Sample VRRP Configuration"),(0,i.kt)("p",null,"The steps above illustrate the differences in a high availability configuration, but do not comprise a full config. The full sample configuration is provided below for your reference. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'config\n    authority\n        router          router-a\n            name                  router-a\n            location              "router-a Philadephia"\n            location-coordinates  +39.9526-75.1652/\n            inter-node-security   internal\n\n            peer                router-b\n                name            router-b\n                authority-name  Authority128\n                router-name     router-b\n            exit\n\n            node                  node1\n                name                      node1\n                asset-id                  f1305f6b-44c3-4b1e-b887-7376efc974d7\n                role                      combo\n                asset-validation-enabled  false\n\n                device-interface          lan\n                    name               lan\n                    type               ethernet\n                    pci-address        0000:00:04.0\n\n                    vrrp\n                        enabled                 true\n                        vrid                    128\n                        priority                100\n                    exit\n                    network-interface  lan\n                        name          lan\n                        global-id     1\n                        tenant        red\n                        source-nat    false\n                        qp-value      30\n                        mtu           1500\n\n                        address       172.16.1.2\n                            ip-address     172.16.1.2\n                            prefix-length  24\n                        exit\n                        address       172.16.1.111\n                            ip-address     172.16.1.111\n                            prefix-length  24\n                        exit\n                    exit\n                exit\n\n                device-interface          wan\n                    name               wan\n                    type               ethernet\n                    pci-address        0000:00:05.0\n\n                    network-interface  wan\n                        name                   wan\n                        global-id              3\n                        inter-router-security  aes1\n                        source-nat             false\n                        qp-value               30\n                        mtu                    1500\n\n                        address                172.16.2.111\n                            ip-address     172.16.2.111\n                            prefix-length  24\n                        exit\n                    exit\n                exit\n\n                device-interface          far\n                    name               far\n                    type               ethernet\n                    pci-address        0000:00:06.0\n\n                    network-interface  far\n                        name                   far\n                        global-id              2\n\n                        neighborhood           peer\n                            name               peer\n                            peer-connectivity  bidirectional\n                            topology           mesh\n                            vector             peer\n                        exit\n                        inter-router-security  aes1\n                        source-nat             false\n                        qp-value               30\n                        mtu                    1500\n\n                        address                172.16.3.2\n                            ip-address     172.16.3.2\n                            prefix-length  24\n                        exit\n                    exit\n                exit\n            exit\n\n            service-route         local-route\n                name             local-route\n                service-name     traffic\n                vector           local-vrrp\n                enable-failover  true\n\n                next-hop         combo lan\n                    node-name  combo\n                    interface  lan\n                exit\n            exit\n\n            service-route         peer-route\n                name             peer-route\n                service-name     traffic\n                vector           peer\n                enable-failover  true\n                next-peer        router-b\n            exit\n        exit\n\n        router          router-b\n            name                  router-b\n            location              "router-b New York"\n            location-coordinates  +40.7128-074.0059/\n            inter-node-security   internal\n\n            peer                  router-a\n                name            router-a\n                authority-name  Authority128\n                router-name     router-a\n            exit\n\n            node                  node1\n                name                      node1\n                asset-id                  8100f73d-2071-47c3-86cb-07eba002b698\n                role                      combo\n                asset-validation-enabled  false\n\n                device-interface          lan\n                    name               lan\n                    type               ethernet\n                    pci-address        0000:00:04.0\n\n                    vrrp\n                        enabled                 true\n                        vrid                    128\n                        priority                99\n                    exit\n\n                    network-interface  lan\n                        name          lan\n                        global-id     4\n                        tenant        red\n                        source-nat    false\n                        qp-value      30\n                        mtu           1500\n\n                        address       172.16.1.2\n                            ip-address     172.16.1.2\n                            prefix-length  24\n                        exit\n\n                        address       172.16.1.111\n                            ip-address     172.16.1.111\n                            prefix-length  24\n                        exit\n                    exit\n                exit\n\n                device-interface          wan\n                    name               wan\n                    type               ethernet\n                    pci-address        0000:00:05.0\n\n                    network-interface  wan\n                        name                   wan\n                        global-id              6\n                        inter-router-security  aes1\n                        source-nat             false\n                        qp-value               30\n                        mtu                    1500\n\n                        address                172.16.2.111\n                            ip-address         172.16.2.111\n                            prefix-length      24\n                        exit\n                    exit\n                exit\n\n                device-interface       far\n                    name               far\n                    type               ethernet\n                    pci-address        0000:00:06.0\n\n                    network-interface  far\n                        name                   far\n                        global-id              5\n\n                        neighborhood           peer\n                            name               peer\n                            peer-connectivity  bidirectional\n                            topology           mesh\n                            vector             peer\n                        exit\n                        inter-router-security  aes1\n                        rewrite-dscp           false\n                        source-nat             false\n                        qp-value               30\n                        mtu                    1500\n\n                        address                172.16.3.3\n                            ip-address         172.16.3.3\n                            prefix-length      24\n                        exit\n                    exit\n                exit\n            exit\n\n            service-route        local-route\n                name             local-route\n                service-name     traffic\n                vector           local-vrrp\n                enable-failover  true\n\n                next-hop         combo lan\n                    node-name    combo\n                    interface    lan\n                exit \n            exit\n\n            service-route         peer-route\n                name             peer-route\n                service-name     traffic\n                vector           peer\n                enable-failover  true\n                next-peer        router-a\n            exit\n        exit\n\n        security        aes1\n            name               aes1\n            hmac-cipher        sha256\n            hmac-key           (removed)\n            encryption-cipher  aes-cbc-256\n            encryption-key     (removed)\n            encryption-iv      (removed)\n            encrypt            false\n            hmac               false\n        exit\n\n        service         traffic\n            name            traffic\n            service-group   all\n            description     "traffic service for all"\n            enabled         true\n            tenant          red\n            scope           private\n            security        aes1\n\n            transport       udp\n                protocol    udp\n\n                port-range  443\n                    start-port  443\n                exit\n            exit\n            address         172.16.2.0/24\n\n            access-policy   172.16.1.0/24\n                source      172.16.1.0/24\n                permission  allow\n            exit\n            service-policy  poc-policy\n        exit\n\n        service-policy      poc-policy\n            name            poc-policy\n            service-class   Standard\n\n            vector          local-vrrp\n                name        local-vrrp\n                priority    1\n            exit\n\n            vector          peer\n                name        peer\n                priority    10\n            exit\n\n            session-resiliency    revertible-failover\n            peer-path-resiliency  true\n            path-quality-filter   true\n            max-loss              0.5\n            max-latency           250\n            max-jitter            100\n        exit\n\n        session-type    ping\n            name           ping\n            service-class  Standard\n\n            transport      icmp\n                protocol  icmp\n            exit\n        exit\n    exit\nexit\n\n')),(0,i.kt)("p",null,"The following is a config snippet to support vrrp with vlan. The vrrp network-interface with a vlan tag matching the one in the vrrp config will be used for sending out VRRP advertisements."),(0,i.kt)("div",{className:"admonition admonition-important alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"important")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The network-interface must have a static IP address."))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"config\n    authority\n        router    Fabric128\n            name              Fabric128\n            node              test1\n                name              test1\n                enabled           true\n                device-interface  dev\n                    name               dev\n                    type               ethernet\n                    pci-address        0000:00:05.0\n                    vrrp\n                        enabled                 true\n                        vlan                    1\n                        vrid                    128\n                        priority                100\n                        advertisement-interval  1000\n                    exit\n                    network-interface  intf1\n                        name          intf1\n                        vlan          0\n                        type          external\n                        dhcp          v4\n                    exit\n                    network-interface  intf2\n                        name          intf2\n                        vlan          1\n                        type          external\n                        address       172.16.3.1\n                            ip-address     172.16.3.1\n                            prefix-length  24\n                            gateway        172.16.3.10\n                        exit\n                    exit\n                exit\n            exit\n            node              test2\n                name              test2\n                enabled           true\n                device-interface  dev\n                    name               dev\n                    type               ethernet\n                    pci-address        0000:00:05.0\n                    vrrp\n                        enabled                 true\n                        vlan                    1\n                        vrid                    128\n                        priority                99\n                        advertisement-interval  1000\n                    exit\n                    network-interface  intf1\n                        name          intf1\n                        vlan          0\n                        type          external\n                        dhcp          v4\n                    exit\n                    network-interface  intf2\n                        name          intf2\n                        vlan          1\n                        type          external\n                        address       172.16.3.1\n                            ip-address     172.16.3.1\n                            prefix-length  24\n                            gateway        172.16.3.10\n                        exit\n                    exit\n                exit\n            exit\n        exit\n    exit\nexit\n")))}u.isMDXComponent=!0}}]);
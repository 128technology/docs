"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[9991],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),l=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=l(e.components);return a.createElement(c.Provider,{value:t},e.children)},f={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=l(n),m=r,p=u["".concat(c,".").concat(m)]||u[m]||f[m]||i;return n?a.createElement(p,o(o({ref:t},d),{},{components:n})):a.createElement(p,o({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var l=2;l<i;l++)o[l]=n[l];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},46022:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return c},default:function(){return m},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return f}});var a=n(87462),r=n(63366),i=(n(67294),n(3905)),o=["components"],s={title:"Management Traffic over Forwarding Interfaces",sidebar_label:"Management over Forwarding"},c=void 0,l={unversionedId:"config_management_over_forwarding",id:"config_management_over_forwarding",title:"Management Traffic over Forwarding Interfaces",description:"Management traffic is any service that makes direct contact to another asset, either to retrieve or interface with the configuration and status of hardware components (conductor to router), the core operating system (NTP), features of user interfaces to the OS (DNS), or the business application, sometimes taking subsequent action to maintain or change configurations. All actions ultimately provide underlying support to the service being delivered by the managed resource to its users. Access is typically controlled via a set of privileges and will usually allow either modification and/or viewing of sensitive system configurations. Management traffic includes three categories: management, monitoring, and data backups and restores.",source:"@site/docs/config_management_over_forwarding.md",sourceDirName:".",slug:"/config_management_over_forwarding",permalink:"/docs/config_management_over_forwarding",draft:!1,tags:[],version:"current",lastUpdatedAt:1674071854,formattedLastUpdatedAt:"Jan 18, 2023",frontMatter:{title:"Management Traffic over Forwarding Interfaces",sidebar_label:"Management over Forwarding"},sidebar:"docs",previous:{title:"Configuring Forward Error Correction",permalink:"/docs/config_forward_error_correction"},next:{title:"Web Filtering",permalink:"/docs/config_domain-based_web_filter"}},d={},f=[{value:"Benefits",id:"benefits",level:2},{value:"Management Services",id:"management-services",level:2},{value:"Configuration",id:"configuration",level:2},{value:"DNS",id:"dns",level:3},{value:"Management Vectors",id:"management-vectors",level:3},{value:"Utility Address",id:"utility-address",level:3},{value:"Sample Configuration",id:"sample-configuration",level:3},{value:"User Defined Services",id:"user-defined-services",level:3}],u={toc:f};function m(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Management traffic is any service that makes direct contact to another asset, either to retrieve or interface with the configuration and status of hardware components (conductor to router), the core operating system (NTP), features of user interfaces to the OS (DNS), or the business application, sometimes taking subsequent action to maintain or change configurations. All actions ultimately provide underlying support to the service being delivered by the managed resource to its users. Access is typically controlled via a set of privileges and will usually allow either modification and/or viewing of sensitive system configurations. Management traffic includes three categories: management, monitoring, and data backups and restores."),(0,i.kt)("p",null,"Networking equipment's management traffic typically traverses a separate physical interface for the purposes of network isolation and policing."),(0,i.kt)("p",null,"Depending on the nature and size of a deployment, the hardware platform may not have the required number of physical interfaces to separate management traffic. In these cases, the forwarding WAN interface can be leveraged for management traffic."),(0,i.kt)("h2",{id:"benefits"},"Benefits"),(0,i.kt)("p",null,"When using a separate ",(0,i.kt)("a",{parentName:"p",href:"/docs/concepts_interface_types"},"non-forwarding")," interface for management traffic, packet forwarding is managed by Linux's routing table. Leveraging the SSR's native routing capabilities for management traffic provides additional security, segmentation and advanced routing policy."),(0,i.kt)("p",null,"When provisioning management traffic to traverse forwarding interfaces, those interfaces will continue to be available for management related functions (e.g., ssh) even when the SSR is not running, yet will still be protected by firewall rules that match the respective policy. This is particularly important during maintenance operations when the SSR software is taken offline for an upgrade."),(0,i.kt)("admonition",{type:"warning"},(0,i.kt)("p",{parentName:"admonition"},"Once a forwarding interface is provisioned for management traffic, any existing OS configuration for that interface such as ifcfg and firewall rules will be overwritten to match the SSR configuration.")),(0,i.kt)("h2",{id:"management-services"},"Management Services"),(0,i.kt)("p",null,"One of the strengths of the SSR data model is to dynamically apply policy only as needed. As it relates to management traffic, service policy will only be created for those management applications provisioned. The list of applications natively supported are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/concepts_machine_communication#router-to-conductor-connectivity"},"Conductor traffic"),". This works in tandem with ",(0,i.kt)("a",{parentName:"li",href:"/docs/bcp_conductor_deployment"},"conductor services")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/config_reference_guide#webserver"},"Web server access")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/config_reference_guide#address"},"PCLI/SSH")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#dns"},"DNS")," traffic for FQDN resolution"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/config_reference_guide#ntp"},"NTP")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/config_reference_guide#repository"},"Software Updates")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/config_reference_guide#snmp-server"},"SNMP")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/config_reference_guide#syslog"},"Syslog")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/config_reference_guide#syslog"},"IPFIX"))),(0,i.kt)("h2",{id:"configuration"},"Configuration"),(0,i.kt)("p",null,"When enabled, a default route will be configured in Linux's routing table to send all traffic to the interface ",(0,i.kt)("a",{parentName:"p",href:"/docs/concepts_kni"},(0,i.kt)("inlineCode",{parentName:"a"},"kni254")),", which is the pathway into the SSR packet forwarding engine. Thus, standard SSR forwarding rules apply: any traffic originated by the host operating system that does not match a configured service will be dropped. Services and corresponding service routes are automatically created for the applications listed ",(0,i.kt)("a",{parentName:"p",href:"#management-services"},"above"),"."),(0,i.kt)("admonition",{type:"important"},(0,i.kt)("p",{parentName:"admonition"},"Because a default route is added in Linux, all traffic not captured by a static route, will be sent to the SSR. This means that the traffic will either be dropped, or match an existing service and route.")),(0,i.kt)("p",null,"For each of the ",(0,i.kt)("a",{parentName:"p",href:"#management-services"},"management services")," configured, the SSR will automatically generate corresponding ",(0,i.kt)("inlineCode",{parentName:"p"},"service")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"service-route")," configurations for forwarding the respective traffic. The generated configuration objects will all start with the prefix ",(0,i.kt)("inlineCode",{parentName:"p"},"_management_"),"."),(0,i.kt)("p",null,"Each of the service and service-routes share one important attribute: they are created with the ",(0,i.kt)("inlineCode",{parentName:"p"},"generated")," flag set to ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),". If you want to make any modifications to the generated services, you must first set ",(0,i.kt)("inlineCode",{parentName:"p"},"generated")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"false"),", or else your configuration changes will be stripped upon the next time the configuration is committed. For more information on configuration work-flows involving the ",(0,i.kt)("inlineCode",{parentName:"p"},"generated")," flag, refer to the ",(0,i.kt)("a",{parentName:"p",href:"/docs/config_basics#generated-configuration"},"SSR software documentation"),"."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"management")," interfaces cannot be used on device-interface types of ",(0,i.kt)("inlineCode",{parentName:"p"},"host")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"bridge"),".")),(0,i.kt)("h3",{id:"dns"},"DNS"),(0,i.kt)("p",null,"DNS servers can be configured within ",(0,i.kt)("inlineCode",{parentName:"p"},"authority > router > dns-config > address")," in one of two ways:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"automatic")," - if the management interface is configured for DHCP, then the DNS server(s) learned through the DHCP lease are used"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"static")," - up to two DNS server addresses can be configured",(0,i.kt)("admonition",{parentName:"li",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"These addresses are assumed to be reachable via the configured management interface(s).")))),(0,i.kt)("p",null,"If static DNS servers are configured and a network-interface is configured to obtain its address via DHCP, the DNS servers learned through the lease are ordered after any statically defined entries."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Configuring ",(0,i.kt)("inlineCode",{parentName:"p"},"dns-config > address")," is required, however setting ",(0,i.kt)("inlineCode",{parentName:"p"},"dns-config > address")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"automatic")," is only allowed when a management interface is enabled for DHCP.")),(0,i.kt)("h3",{id:"management-vectors"},"Management Vectors"),(0,i.kt)("p",null,"When provisioning multiple management interfaces, a ",(0,i.kt)("em",{parentName:"p"},"management vector")," is used to provide preference amongst the interfaces."),(0,i.kt)("p",null,"When the SSR service is not running, a default route is created for the interface configured as management with the lowest metric (if multiple management interfaces are configured)."),(0,i.kt)("p",null,"For example, the following SSR configuration:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"network-interface  wan1-intf\n    name               wan1-intf\n    conductor          true\n    default-route      true\n    source-nat         true\n    management         true\n    management-vector\n        name      mgmt-vec-1\n        priority  20\n    exit\nexit\n")),(0,i.kt)("p",null,"Will produce the corresponding configuration within Linux:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"# ip route\ndefault dev wan1-intf scope link metric 20\n")),(0,i.kt)("h3",{id:"utility-address"},"Utility Address"),(0,i.kt)("p",null,"Management interfaces can be configured for redundancy between nodes of a HA pair by provisioning ",(0,i.kt)("inlineCode",{parentName:"p"},"authority > router > node > device-interface > shared-phys-address"),". If the interface is redundant and management, a ",(0,i.kt)("inlineCode",{parentName:"p"},"authority > router > node > device-interface > network-interface > address > utility-ip-address")," is required on the network-interface. This address is assigned to the Linux interface when SSR is not running with the original MAC address, not the virtual ",(0,i.kt)("inlineCode",{parentName:"p"},"shared-phys-address")," from SSR configuration. The ",(0,i.kt)("inlineCode",{parentName:"p"},"utility-ip-address")," must be unique per node across the router."),(0,i.kt)("h3",{id:"sample-configuration"},"Sample Configuration"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"config\n    authority\n        conductor-address  192.168.1.12\n        router             Router1\n            name                      Router1\n            dns-config                automatic\n                mode              automatic\n            exit\n            node                      Node1\n                name              Node1\n                device-interface  node1-mgmt\n                    name               node1-mgmt\n                    type               ethernet\n                    pci-address        0000:00:03.0\n                    forwarding         true\n                    network-interface  node1-mgmt-intf\n                        name               node1-mgmt-intf\n                        global-id          3\n                        conductor          true\n                        default-route      true\n                        source-nat         true\n                        management         true\n                        management-vector\n                            name      mgmt-vec-1\n                            priority  20\n                        exit\n                        dhcp               v4\n                    exit\n                exit\n            exit\n        exit\n    exit\nexit\n")),(0,i.kt)("admonition",{type:"important"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("inlineCode",{parentName:"p"},"router > node > device-interface > network-interface > source-nat")," must be set to ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," when using management over forwarding since all management traffic will originate from ",(0,i.kt)("inlineCode",{parentName:"p"},"169.254.x.x"),".\n",(0,i.kt)("inlineCode",{parentName:"p"},"router > node > device-interface > network-interface > default-route")," must also be set to ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," to ensure that Linux uses the network interface as its preferred route for traffic originating from the host OS.")),(0,i.kt)("h3",{id:"user-defined-services"},"User Defined Services"),(0,i.kt)("p",null,"For any other service not defined by the default management services list, the user can configure a ",(0,i.kt)("em",{parentName:"p"},"service")," to best suit their needs. It is necessary to configure the ",(0,i.kt)("a",{parentName:"p",href:"/docs/bcp_tenants#the-internal-tenant"},(0,i.kt)("em",{parentName:"a"},"internal"))," tenant within the ",(0,i.kt)("inlineCode",{parentName:"p"},"access-policy")," of the service to allow traffic originating from the Linux host."))}m.isMDXComponent=!0}}]);
"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[9809],{74194:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>a});var t=i(74848),s=i(28453);const r={title:"Configure Intrusion Detection and Prevention",sidebar_label:"Configure IDP"},o=void 0,c={id:"config_idp",title:"Configure Intrusion Detection and Prevention",description:"In a typical network deployment, there is always a mix of trusted and untrusted traffic. To prevent against security breaches, the SSR uses the IDP Signature database to identify and take action against malicious traffic. SSR services are configured to be monitored, and an IDP policy is applied to the traffic.",source:"@site/docs/config_idp.md",sourceDirName:".",slug:"/config_idp",permalink:"/docs/config_idp",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Configure Intrusion Detection and Prevention",sidebar_label:"Configure IDP"},sidebar:"docs",previous:{title:"Intrusion Detection and Prevention",permalink:"/docs/concepts_ssr_idp"},next:{title:"Troubleshooting IDP",permalink:"/docs/ts_idp"}},l={},a=[{value:"Configuration",id:"configuration",level:2},{value:"Tenant Configuration",id:"tenant-configuration",level:2},{value:"High Availability",id:"high-availability",level:2},{value:"Modifying IDP Policies",id:"modifying-idp-policies",level:2},{value:"GUI Configuration",id:"gui-configuration",level:3},{value:"Offline IDP Policy Updates",id:"offline-idp-policy-updates",level:2},{value:"Additional Verification Steps",id:"additional-verification-steps",level:3},{value:"Troubleshooting",id:"troubleshooting",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"In a typical network deployment, there is always a mix of trusted and untrusted traffic. To prevent against security breaches, the SSR uses the IDP Signature database to identify and take action against malicious traffic. SSR services are configured to be monitored, and an IDP policy is applied to the traffic."}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"idp-policy"})," has three profiles that can be applied to an ",(0,t.jsx)(n.code,{children:"access-policy"}),"; Alert, Standard, and Strict. This allows the same service to receive different IDP treatment for different tenants. Each profile has an associated traffic action that may include all or some of the following actions:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Close the client and server TCP connection."}),"\n",(0,t.jsx)(n.li,{children:"Drop current and all subsequent packets."}),"\n",(0,t.jsx)(n.li,{children:"Alert only, no additional action taken."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["In the following example, all internet traffic originating from the ",(0,t.jsx)(n.code,{children:"corporate"})," tenant identified as malicious or threatening receives a ",(0,t.jsx)(n.code,{children:"strict"})," policy enforcement. Traffic originating from the ",(0,t.jsx)(n.code,{children:"guest"})," tenant that is identified as malicious or threatening only triggers an alert. This means that the same threat entering two different network segments receives different treatment, allowing the administrator to enforce the right level of protection based on corporate policies."]}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["In the following example configuration, three access policies are defined for the service ",(0,t.jsx)(n.code,{children:"internet"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"config\n    authority\n        service  internet\n            name           internet\n            address        0.0.0.0/0\n\n            access-policy  corporate\n                idp-policy  strict\n                source      corporate\n                permission  allow\n            exit\n\n            access-policy  guest\n                idp-policy  alert\n                source      guest\n                permission  allow\n            exit\n\n            access-policy  other\n                source      other\n                permission  allow\n            exit\n        exit\n    exit\nexit\n\n"})}),"\n",(0,t.jsx)(n.h2,{id:"tenant-configuration",children:"Tenant Configuration"}),"\n",(0,t.jsx)(n.p,{children:"IDP requires clear association of subnet to tenant; it is best to define the association as tenant-prefix:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"config\n    authority\n        service  internet\n            name           internet\n            address        0.0.0.0/0\n\n            access-policy  corporate\n                idp-policy  strict\n                source      corporate\n                permission  allow\n            exit\n        exit\n\n        tenant  corporate\n            name    corporate\n        exit\n\n        router  idp \n            name  idp \n\n            node  node\n                name              node\n\n                device-interface  corp-lan\n                    name               corp-lan\n\n                    network-interface  corp-lan\n                        name                   corp-lan\n                        global-id              7\n\n                        tenant-prefixes        corporate\n                            tenant          corporate\n                            source-address  172.16.3.0/24\n                        exit\n                        address                172.16.3.3\n                            ip-address     172.16.3.3\n                            prefix-length  24\n                        exit\n                    exit\n                exit\n            exit\n        exit\n"})}),"\n",(0,t.jsx)(n.h2,{id:"high-availability",children:"High Availability"}),"\n",(0,t.jsx)(n.p,{children:"The IDP engine runs on each node of the system. Traffic is always sent to the IDP instance on the first node - per the order in configuration. Upon failover, the existing sessions do not gracefully failover; the TCP sessions are reset, and new sessions must be established by the client. For UDP sessions, the same best effort behavior can be expected from the IDP engine."}),"\n",(0,t.jsx)(n.h2,{id:"modifying-idp-policies",children:"Modifying IDP Policies"}),"\n",(0,t.jsx)(n.p,{children:"Starting with SSR 6.1.4-R2, users can customize an existing IDP policy, creating exception-based rules. The following is an example workflow:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["A ",(0,t.jsx)(n.strong,{children:"strict"})," ",(0,t.jsx)(n.code,{children:"idp-policy"})," is initially configured for the service below."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"        service      test-app\n            name                  test-app\n            address               172.16.2.0/24\n\n            access-policy         lan\n                idp-policy  strict\n                source      lan\n            exit\n            share-service-routes  false\n        exit\n\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Security events are triggered because traffic typical for that network configuration is considered a risk. The Attack is blocked with the Action CLOSE."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"admin@node.cadillac# show idp events since 2m\nWed 2023-07-12 14:19:00 UTC\n========== ================================== ======== ============= =============================== ========== ========\n Severity   Time                               Threat   Application   Attack                          Protocol   Action\n========== ================================== ======== ============= =============================== ========== ========\n        6   2023-07-12 14:17:54.659000+00:00   MEDIUM   HTTP          HTTP:EXTRA_CONTROL_CHARACTERS   TCP        CLOSE\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The user has identified the attack ",(0,t.jsx)(n.code,{children:"HTTP:EXTRA_CONTROL_CHARACTERS"})," to be of minimal risk to this network and would like to create a rule to change this event to be ",(0,t.jsx)(n.strong,{children:"alert"})," only."]}),"\n",(0,t.jsxs)(n.li,{children:["The user creates an ",(0,t.jsx)(n.code,{children:"idp-profile"})," based on the original ",(0,t.jsx)(n.strong,{children:"strict"})," policy, modifying the outcome and action to alert/allow. By creating an exception for the attack, the specific traffic flows as desired within the network."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Changes are implemented from the SSR GUI or PCLI (in this example the PCLI is used), and validated as part of the existing configuration workflow."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"        idp-profile  strict-but-alert\n            name         strict-but-alert\n            base-policy  strict\n\n            rule         alert-chunk-overflow\n                name     alert-chunk-overflow\n\n                match\n                    vulnerability  HTTP:EXTRA_CONTROL_CHARACTERS\n                exit\n\n                outcome\n                    action  alert\n                exit\n            exit\n        exit\n\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The new service configuration uses the ",(0,t.jsx)(n.code,{children:"idp-profile"})," instead of the ",(0,t.jsx)(n.code,{children:"idp-policy"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"        service      test-app\n            name                  test-app\n            address               172.16.2.0/24\n\n            access-policy         lan\n                idp-profile  strict-but-alert\n                source       lan\n            exit\n            share-service-routes  false\n        exit\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:['After creating a new ruleset for IDP, the traffic will initially be routed "around" that particular set of rules until it is fully loaded into the IDP engine. Use ',(0,t.jsx)(n.code,{children:"show idp application status"})," to verify the traffic status affected by the new rule."]})}),"\n",(0,t.jsx)(n.p,{children:"When the modified profile is applied to the configuration, the following state message appears while it compiles:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"admin@node.cadillac# show idp application status\nWed 2023-07-12 14:25:19 UTC\n\u2714 Retrieving IDP state data...\n\n===============================================\n node.cadillac\n===============================================\n Mode:                    spoke\n Engine:                  on\n Pod:                     active\n Engine Started:          2023-07-11T14:39:55Z\n Up Time:                 23h 45m 24s\n Last Commit:             2023-07-12T13:55:00Z\n Last:                    starting\n\n Engine Message:\n   IDP policy compiling, waiting to finish\n\n"})}),"\n",(0,t.jsx)(n.p,{children:"Once the engine has applied the new policies, the compilation message disappears."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Retrieved IDP state data.\nCompleted in 0.02 seconds\n\n"})}),"\n",(0,t.jsx)(n.p,{children:"Now when the vulnerability is matched, the event is logged, and traffic is allowed to pass:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"admin@node.cadillac# show idp events since 2m\nWed 2023-07-12 14:27:45 UTC\n========== ================================== ======== ============= =============================== ========== ========\n Severity   Time                               Threat   Application   Attack                          Protocol   Action\n========== ================================== ======== ============= =============================== ========== ========\n        6   2023-07-12 14:27:02.777000+00:00   MEDIUM   HTTP          HTTP:EXTRA_CONTROL_CHARACTERS   TCP        NONE\n\n"})}),"\n",(0,t.jsx)(n.h3,{id:"gui-configuration",children:"GUI Configuration"}),"\n",(0,t.jsx)(n.p,{children:"The following steps show how to use the GUI to use an existing IDP policy to create a modified IDP Profile."}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Navigate to the IDP Profile feature.\n",(0,t.jsx)(n.img,{alt:"Add IDP Profile",src:i(27592).A+"",width:"1498",height:"470"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Click ADD."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Enter a Profile Name and click Save. The IDP Profiles configuration screen opens.\n",(0,t.jsx)(n.img,{alt:"Configure the IDP Profile",src:i(37413).A+"",width:"1682",height:"698"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"In the Base Policy, select an existing policy to modify."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"To add exceptions to the rules, select ADD in the Rules field."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Name the New item and click Save. This opens the settings for the new rule."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Identify the following items that will be compared for a match:"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["The information available on the Security Events screen or the ",(0,t.jsx)(n.a,{href:"/docs/concepts_ssr_idp#security-events-dashboard",children:(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"show idp-events"})})})," command can be used to populate and modify the Rules fields shown below."]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Client IP Address prefix"}),"\n",(0,t.jsx)(n.li,{children:"Destination IP Address"}),"\n",(0,t.jsx)(n.li,{children:"Vulnerability"}),"\n",(0,t.jsx)(n.li,{children:"Severity"}),"\n",(0,t.jsx)(n.li,{children:"Action Options"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.img,{alt:"New Rule Settings",src:i(47747).A+"",width:"1674",height:"1692"}),"\nAfter creating the custom ruleset, use the ",(0,t.jsx)(n.code,{children:"access-policy"})," as shown in the workflow above to define the IDP policy where this custom ruleset is used."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:['After creating a new ruleset for IDP, the traffic will initially be routed "around" that particular set of rules until it is fully loaded into the IDP engine. Use ',(0,t.jsx)(n.code,{children:"show idp application status"})," to verify the traffic status affected by the new rule."]})}),"\n",(0,t.jsx)(n.h2,{id:"offline-idp-policy-updates",children:"Offline IDP Policy Updates"}),"\n",(0,t.jsx)(n.p,{children:"This procedure provides steps to download and install an updated IDP Signature Database when the device does not have an internet connection (Air-Gap network). A single compressed file is downloaded, which is then copied to the device."}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Log into the SSR using the admin account (full shell access is necessary)."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Access the cSRX command line interface directly from the SSR shell:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"sudo docker exec -it csrx cli"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Configure the SRX container with the following configuration:"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:" configure\n set security idp traceoptions file idpd\n set security idp traceoptions file size 20m\n set security idp traceoptions flag all\n set security idp traceoptions level all\n commit\n exit\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"After committing the above configuration, run the following CLI command:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"request security idp security-package download full-update"})}),"\n",(0,t.jsx)(n.p,{children:"This command will construct the download URL in the idpd log file, which is specific to the software version running on the device. Since the security engine does not expect to have an internet connection, the command will return a failure status in the CLI. This is expected."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Run the following command:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"show log idpd | match SecPackage"})}),"\n",(0,t.jsxs)(n.p,{children:["This will get the correct URL of the security package for your device from the ",(0,t.jsx)(n.code,{children:"/var/log/idpd"})," file:"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Sample URL"})," from the ",(0,t.jsx)(n.code,{children:"/var/log/idpd"})," log:"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'Jul 19 05:58:37 [idp_secpack_download_handler]: URL sent to get the SecPackage is:\n  \n"https://signatures.juniper.net/cgi-bin/index.cgi?device=vsrx&adv_dev_info=&feature=idp&os=21.3&build=30&dfa=hs&platform_version=19.4&detector=12.6.130240409&from=&to=latest&type=update&sn=&release=10.3"\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"6",children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Copy the URL from ",(0,t.jsx)(n.code,{children:"show log idpd | match SecPackage"})," and change the ",(0,t.jsx)(n.strong,{children:"type"})," parameter value to ",(0,t.jsx)(n.strong,{children:"offline"})," as shown below:"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"type=update"})}),"\n",(0,t.jsx)(n.p,{children:"to"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"type=offline"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"https://signatures.juniper.net/cgi-bin/index.cgi?device=vsrx&adv_dev_info=&feature=idp&os=21.3&build=30&dfa=hs&platform_version=19.4&detector=12.6.130240409&from=&to=latest&type=offline&sn=&release=10.3\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"important",children:(0,t.jsx)(n.p,{children:"Ensure the correct URL is used for your device and version."})}),"\n",(0,t.jsxs)(n.ol,{start:"7",children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Paste your edited URL into a browser on a system with internet access, and press ",(0,t.jsx)(n.code,{children:"Enter"}),". The ",(0,t.jsx)(n.code,{children:"offline-update.tar.gz"})," file is downloaded to your system."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Upload this file onto an SCP server that is reachable by the SSR device through the management connection. This may require enabling the ",(0,t.jsx)(n.em,{children:"internal"})," tenant to reach the SCP server through a management service on TCP port 22. For information about configuring this port, see the ",(0,t.jsx)(n.a,{href:"/docs/config_management_over_forwarding#management-services",children:"Management Services"})," documentation."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Enter the shell and download the security packages using the following CLI commands:"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"start shell\ncd tmp\nscp <user>@<scp_host>:offline-update.tar.gz .\nexit\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"10",children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Use the CLI to unzip and import the security updates from the ",(0,t.jsx)(n.code,{children:"/tmp"})," directory:"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"request security idp security-package offline-download package-path /tmp/offline-update.tar.gz"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Install the policy templates:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"request security idp security-package install"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"additional-verification-steps",children:"Additional Verification Steps"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Check the install status:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"request security idp security-package install status"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Example output:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Done;policy-templates has been successfully updated into internal repository\n(=>/var/db/scripts/commit/templates.xsl)!\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Verify the policy template version:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"show security idp security-package-version"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"List the security package attack details using the following command:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"show security idp attack detail <attack-name>"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.p,{children:"In some cases you may see the following error:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"run request security idp security-package install policy-templates\nopening file (/var/db/idpd/sec-download/sub-download/SignatureUpdate.xml) failed; No such file or directory\n"})}),"\n",(0,t.jsxs)(n.p,{children:["In this instance, the ",(0,t.jsx)(n.code,{children:"SignatureUpdate.xml"})," file has not been copied to the ",(0,t.jsx)(n.code,{children:"/var/db/idpd/sec-download/sub-download/"})," directory."]}),"\n",(0,t.jsxs)(n.p,{children:["Manually copy ",(0,t.jsx)(n.code,{children:"SignatureUpdate.xml"})," and ",(0,t.jsx)(n.code,{children:"templates.xml"})," to ",(0,t.jsx)(n.code,{children:"/var/db/idpd/sec-download/sub-download/"})," and run the update again."]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Unzip ",(0,t.jsx)(n.code,{children:"SignatureUpdate.xml.gz"})," and ",(0,t.jsx)(n.code,{children:"templates.xml.gz"})," in the ",(0,t.jsx)(n.code,{children:"offline-update"})," package."]}),"\n",(0,t.jsxs)(n.li,{children:["Transfer the ",(0,t.jsx)(n.code,{children:"templates.xml"})," and ",(0,t.jsx)(n.code,{children:"SignatureUpdate.xml"})," to ",(0,t.jsx)(n.code,{children:"/var/db/idpd/sec-download/sub-download/"}),":"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"run file list /var/db/idpd/sec-download/sub-download/\n"})}),"\n",(0,t.jsx)(n.p,{children:"Example output:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"/var/db/idpd/sec-download/sub-download/:\nSignatureUpdate.xml*\ntemplates.xml*\n"})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Install policy templates:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"run request security idp security-package install policy-templates"})}),"\n",(0,t.jsx)(n.p,{children:"This is processed in async mode."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Check the install status."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"run request security idp security-package install status"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Example output:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Done;policy-templates has been successfully updated into internal repository\n(=>/var/db/scripts/commit/templates.xsl)!\n"})}),"\n",(0,t.jsx)(n.p,{children:"If you require additional assistance, contact Juniper Technical Support."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},27592:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/auth-settings-idp-profiles-36c3066085e5bd7b9b143d914ddd99a3.png"},47747:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/idp-profiles-rules-201f9f245e4ac1805bfb63385f6b1fbf.png"},37413:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/idp-profiles-f73af9eccbcbc64a79d7c0df71e4cb96.png"},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>c});var t=i(96540);const s={},r=t.createContext(s);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);
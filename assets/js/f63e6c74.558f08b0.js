"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[2404],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return f}});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(n),f=o,h=p["".concat(l,".").concat(f)]||p[f]||d[f]||i;return n?r.createElement(h,a(a({ref:t},u),{},{components:n})):r.createElement(h,a({ref:t},u))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,a[1]=s;for(var c=2;c<i;c++)a[c]=n[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},52054:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return f},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return d}});var r=n(87462),o=n(63366),i=(n(67294),n(3905)),a=["components"],s={title:"Bidirectional Forwarding Detection (BFD)",sidebar_label:"BFD with BGP and OSPF"},l=void 0,c={unversionedId:"config_bfd",id:"config_bfd",title:"Bidirectional Forwarding Detection (BFD)",description:"This section provides information about using BFD with BGP and OSPF protocols on the Session Smart Networking Platform.",source:"@site/docs/config_bfd.md",sourceDirName:".",slug:"/config_bfd",permalink:"/docs/config_bfd",draft:!1,tags:[],version:"current",lastUpdatedAt:1701381437,formattedLastUpdatedAt:"Nov 30, 2023",frontMatter:{title:"Bidirectional Forwarding Detection (BFD)",sidebar_label:"BFD with BGP and OSPF"},sidebar:"docs",previous:{title:"OSPF",permalink:"/docs/config_ospf"},next:{title:"Multicast",permalink:"/docs/config_multicast"}},u={},d=[{value:"Overview",id:"overview",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Example Output",id:"example-output",level:4},{value:"BFD Echo Mode Tests",id:"bfd-echo-mode-tests",level:2}],p={toc:d};function f(e){var t=e.components,n=(0,o.Z)(e,a);return(0,i.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"This section provides information about using BFD with BGP and OSPF protocols on the Session Smart Networking Platform."),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,"BFD asynchronous mode can be enabled on the OSPF interface or the BGP neighbor. BFD configuration allows the following BFD parameters to be set: "),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"enable")," (default: false): Enable/disable BFD asynchronous mode."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"multiplier")," (default: 3): The number of BFD packets that can be lost without the BFD session declared as down."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"required-min-rx-interval")," (default: 1000): The minimum interval in milliseconds that this system must receive a BFD control packet."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"desired-tx-interval")," (default: 1000): The minimum transmission interval in milliseconds used to send BFD control packets.")),(0,i.kt)("p",null,"For OSPF, the BFD configuration can be created for the given OSPF interface. Once a neighbor is learned on this interface, then a BFD session is created with the same addresses used to create the OSPF adjacency.  "),(0,i.kt)("p",null,"For BGP, the BFD configuration is created for a BGP neighbor. Once the BGP neighbor is learned, then a BGP session is created. BFD uses the same addresses as the BGP adjacency. These can be interface addresses for directly connected BGP neighbors, or loopback addresses. "),(0,i.kt)("p",null,"The BFD peers are automatically removed by the protocols once the BGP/OSPF neighbor is removed. The OSPF/BGP adjacency remains up when BFD is configured for the peer. However, if the BFD configuration is modified while the BFD session is Up, then the OSPF/BGP adjacency will flap."),(0,i.kt)("h2",{id:"configuration"},"Configuration"),(0,i.kt)("p",null,"The following is a simple configuration for OSPF and BGP."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"authority\n    router A\n        routing default-instance\n                  ospf              2\n                      area          0.0.0.0\n                          interface  T217_DUT2 inet20\n                                node       T217_DUT2\n                                interface  inet20\n                                    bfd\n                                        enable               true\n                                        required-min-rx-interval 500\n                                        desired-tx-interval  500\n                                        multiplier           3\n\n           \n            routing-protocol bgp\n                neighbor 1.0.0.11\n                    bfd\n                            enable               true\n                            required-min-rx-interval 500\n                            desired-tx-interval  500\n                            multiplier            5\n\n")),(0,i.kt)("p",null,"BFD can also be enabled in the VRF."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"authority\n    router A\n        routing default-instance\n           vrf vrfA\n                      ospf              2\n                          area          0.0.0.0\n                              interface  T217_DUT2 inet30\n                                    node       T217_DUT2\n                                    interface  inet30\n                                        bfd\n                                            enable               true\n                                            required-min-rx-interval 500\n                                            desired-tx-interval  500\n                                            multiplier           3\n\n                routing-protocol bgp\n                    neighbor 1.0.0.11\n                        bfd\n                                   enable               true\n                                   required-min-rx-interval 500\n                                   desired-tx-interval  500\n                                   multiplier           3\n")),(0,i.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,i.kt)("p",null,"The following ",(0,i.kt)("inlineCode",{parentName:"p"},"show")," commands are available through the SSR PCLI. Additionally, the  BFD status is available in the GUI. "),(0,i.kt)("p",null,"The following show commands are also available for insight into the configuration:"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"show bfd [vrf <name>] [peer <ip>] [<verbosity>]")),(0,i.kt)("h4",{id:"example-output"},"Example Output"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"# show bfd\nTue 2022-02-01 15:31:46 UTC\n\n======= =========== ========== ======= =============\n Vrf     Peer        Local      State   Uptime\n======= =========== ========== ======= =============\n         16.0.0.3    16.0.0.2   up      15h 54m 2s\n music   11.1.20.4   g20        up      37m 29s\n         11.1.10.4   g10        up      15h 58m 52s\n\n\n# show bfd vrf music peer 11.1.20.4\nTue 2022-02-01 15:41:16 UTC\n\n======= =========== ======= ======= ========\n Vrf     Peer        Local   State   Uptime\n======= =========== ======= ======= ========\n music   11.1.20.4   g20     up      19s\n\n\n# show bfd detail\nTue 2022-02-01 15:39:13 UTC\n\n==========================================\n Information\n==========================================\n Item:\n   Remote Detect Multiplier:   3\n   Remote Receive Interval:    1000\n   Remote:                     1167833603\n   Vrf:                        default\n   Id:                         3654638929\n   Receive Interval:           1000\n   Remote Transmit Interval:   1000\n   Multihop:                   True\n   Detect Multiplier:          3\n   Passive Mode:               False\n   Status:                     up\n   Remote Echo Interval:       50\n   Local:                      16.0.0.2\n   Remote Diagnostic:          ok\n   Peer:                       16.0.0.3\n   Echo Interval:              0\n   Uptime:                     57689\n   Minimum Ttl:                252\n   Diagnostic:                 ok\n   Transmit Interval:          1000\n Item:\n   Remote Detect Multiplier:   3\n   Remote:                     3892773233\n   Interface:                  g20\n   Remote Receive Interval:    1000\n   Vrf:                        music\n   Id:                         927933835\n   Receive Interval:           1000\n   Remote Transmit Interval:   1000\n   Multihop:                   False\n   Detect Multiplier:          3\n   Passive Mode:               False\n   Status:                     up\n   Remote Echo Interval:       50\n   Remote Diagnostic:          ok\n   Peer:                       11.1.20.4\n   Echo Interval:              0\n   Uptime:                     2696\n   Diagnostic:                 ok\n   Transmit Interval:          1000\n Item:\n   Remote Detect Multiplier:   3\n   Remote:                     3305953639\n   Interface:                  g10\n   Remote Receive Interval:    1000\n   Vrf:                        default\n   Id:                         1713249686\n   Receive Interval:           1000\n   Remote Transmit Interval:   1000\n   Multihop:                   False\n   Detect Multiplier:          3\n   Passive Mode:               False\n   Status:                     up\n   Remote Echo Interval:       50\n   Remote Diagnostic:          ok\n   Peer:                       11.1.10.4\n   Echo Interval:              0\n   Uptime:                     57979\n   Diagnostic:                 ok\n   Transmit Interval:          1000\n\n")),(0,i.kt)("h2",{id:"bfd-echo-mode-tests"},"BFD Echo Mode Tests"),(0,i.kt)("p",null,"This feature enables BFD asynchronous mode support. Many routers use BFD echo mode to ensure a forwarding path is available. While the SSR does not support the sending of BFD echo mode tests to a non-SSR router, we can return the echo mode traffic to the originating router allowing it to pass its echo mode test. Unlike BFD asynchronous mode, BFD echo mode is not handled by a BFD process on the peer router. Instead, it is intended to be processed by the packet forwarding plane and returned to the originating router. In order to pass this echo test traffic, an SSR must be configured to allow this traffic just like any other forwarding traffic. This requires a tenant and a service as with all traffic forwarded by the SSR."),(0,i.kt)("p",null,"To verify that the SSR is capable of relaying the echo mode packets, first ",(0,i.kt)("a",{parentName:"p",href:"/docs/ts_applications#identifying-the-requesting-tenant"},"identify the tenant")," from the ingress interface and source IP address of the peer router. Then, check the FIB to verify that there is a ",(0,i.kt)("a",{parentName:"p",href:"/docs/ts_applications#identifying-the-service"},"match to a service")," for this tenant. BFD echo traffic typically uses UDP destination port 3785 and should have the destination IP address of the peer router. A valid configuration does not require a specific service for BFD so long as this traffic is covered by another configured service. The next-hop of the FIB entry must point towards the egress interface that connects to this peer router."))}f.isMDXComponent=!0}}]);
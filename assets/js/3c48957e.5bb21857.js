"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[5111],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return f}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(n),f=r,h=d["".concat(s,".").concat(f)]||d[f]||p[f]||i;return n?a.createElement(h,o(o({ref:t},u),{},{components:n})):a.createElement(h,o({ref:t},u))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},23182:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return s},default:function(){return f},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return p}});var a=n(87462),r=n(63366),i=(n(67294),n(3905)),o=["components"],l={title:"Native GRE Tunnels",sidebar_label:"Native GRE Tunnels"},s=void 0,c={unversionedId:"config_gre_tunnel",id:"config_gre_tunnel",title:"Native GRE Tunnels",description:"Generic Routing Encapsulation (GRE) is a lightweight tunneling protocol that encapsulates L3 traffic in an L3 and GRE header. The SSR Networking Platform now supports both a GRE plugin as well as native GRE tunnels.",source:"@site/docs/config_gre_tunnel.md",sourceDirName:".",slug:"/config_gre_tunnel",permalink:"/docs/config_gre_tunnel",draft:!1,tags:[],version:"current",lastUpdatedAt:1701206209,formattedLastUpdatedAt:"Nov 28, 2023",frontMatter:{title:"Native GRE Tunnels",sidebar_label:"Native GRE Tunnels"},sidebar:"docs",previous:{title:"Inline Flow Performance Monitoring",permalink:"/docs/config_flow_perf_mon"},next:{title:"In-Memory Metrics",permalink:"/docs/config_in-memory_metrics"}},u={},p=[{value:"Sending Packets",id:"sending-packets",level:2},{value:"Receiving Packets",id:"receiving-packets",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Interface Configuration",id:"interface-configuration",level:3},{value:"Configuration from the GUI",id:"configuration-from-the-gui",level:4},{value:"PCLI Configuration",id:"pcli-configuration",level:4},{value:"Tunnel Statistics",id:"tunnel-statistics",level:3}],d={toc:p};function f(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Generic Routing Encapsulation (GRE) is a lightweight tunneling protocol that encapsulates L3 traffic in an L3 and GRE header. The SSR Networking Platform now supports both a ",(0,i.kt)("a",{parentName:"p",href:"/docs/plugin_gre"},"GRE plugin")," as well as native GRE tunnels. "),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"This is not an SVR feature. GRE tunnels are not created to send packets between peered SSR routers. However, a packet coming from SVR can egress into a GRE tunnel, and vice versa.")),(0,i.kt)("h2",{id:"sending-packets"},"Sending Packets"),(0,i.kt)("p",null,"When a GRE tunnel is configured, sessions are set up to and from the endpoints. With a GRE tunnel configured as a possible path for the service, the load balancer has the option of choosing the tunnel as the packet\u2019s next hop."),(0,i.kt)("p",null,"When the tunnel is selcted as the next hop the session sets up normally, and the the appropriate headers are added for the tunnel. "),(0,i.kt)("h2",{id:"receiving-packets"},"Receiving Packets"),(0,i.kt)("p",null,"On the receiving end, a static flow is created to receive all traffic coming from that tunnel. When a GRE encapsulated packet arrives, the tunnel headers are removed and the packet is forwarded to the normal lookup path. If a session exists, the packet is processed by the corresponding flow. If the session for this packet does not yet exist, a session is created."),(0,i.kt)("h2",{id:"configuration"},"Configuration"),(0,i.kt)("p",null,"Use the following information to configure a GRE tunnel. "),(0,i.kt)("h3",{id:"interface-configuration"},"Interface Configuration"),(0,i.kt)("p",null,"Network-interfaces can be configured as gre-tunnels. These interfaces are virtual interfaces, which must share a VLAN tag with a non-virtual interface. The shared VLAN tag indicates which non-virtual interface the tunnel is associated with."),(0,i.kt)("h4",{id:"configuration-from-the-gui"},"Configuration from the GUI"),(0,i.kt)("p",null,"The following procedure describes configuring a GRE Tunnel using the GUI. "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Under Configuration, select the Router."),(0,i.kt)("li",{parentName:"ol"},"Scroll down and select the Node."),(0,i.kt)("li",{parentName:"ol"},"Select the Device Interface."),(0,i.kt)("li",{parentName:"ol"},"Scroll down to Network Interfaces and click ADD."),(0,i.kt)("li",{parentName:"ol"},"Enter a name for the device interface and click SAVE."),(0,i.kt)("li",{parentName:"ol"},"Under Type, select GRE Tunnel."),(0,i.kt)("li",{parentName:"ol"},"Under Network Interface Tunnel Settings, choose either Inherited or Custom. The Source is the IP address of the start the tunnel. It can be inherited from the associated non-virtual network interface, or configured explicitly using Custom."),(0,i.kt)("li",{parentName:"ol"},"Add the Destination IP address for the tunnel. "),(0,i.kt)("li",{parentName:"ol"},"Click Validate and Commit.")),(0,i.kt)("h4",{id:"pcli-configuration"},"PCLI Configuration"),(0,i.kt)("p",null,"The following example configuration describes using the PCLI to configure a GRE Tunnel.\nRouter and node configuration are provided for context:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"router    Router128\n    name           Router128\n    location       usa  \n    node           test1\n        name              test1\n        enabled           true\n")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Create a device interface ",(0,i.kt)("inlineCode",{parentName:"li"},"GRE"),".")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"        device-interface  GRE\n            name               GRE\n            type               ethernet\n            pci-address        0000:00:06.0\n")),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"Create a non-tunnel interface, ",(0,i.kt)("inlineCode",{parentName:"li"},"base"),". ")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"            network-interface  base\n                name       base\n                global-id  2\n                tenant     red\n\n                address    172.16.3.1\n                    ip-address     172.16.3.1\n                    prefix-length  24\n                exit\n            exit\n")),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},"Create a tunnel interface, ",(0,i.kt)("inlineCode",{parentName:"li"},"tunnel"),". This is the virtual interface representing the tunnel. Set the type field to ",(0,i.kt)("inlineCode",{parentName:"li"},"gre-tunnel"),".")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"            network-interface  tunnel\n                name       tunnel\n                global-id  3\n                type       gre-tunnel\n                tenant     red\n")),(0,i.kt)("p",null,"Please note that in this configuration, the ",(0,i.kt)("inlineCode",{parentName:"p"},"base")," interface and the gre-tunnel interface ",(0,i.kt)("inlineCode",{parentName:"p"},"tunnel")," share the same vlan. For this to work, they must be on a single device-interface. "),(0,i.kt)("ol",{start:4},(0,i.kt)("li",{parentName:"ol"},"Create the tunnel container with a destination of the IP address for the destination of the tunnel. The source identifies how the local IP address is obtained. Setting it to ",(0,i.kt)("inlineCode",{parentName:"li"},"network-interface")," acquires the address from ",(0,i.kt)("inlineCode",{parentName:"li"},"network-interface-base"),".")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"                tunnel\n                    destination  172.16.3.2\n\n                    source\n                        network-interface\n                    exit\n                exit\n            exit\n        exit\n    exit\n")),(0,i.kt)("ol",{start:5},(0,i.kt)("li",{parentName:"ol"},"Create two service-routes for the tunnel, an outbound and inbound. Be sure to specify the virtual tunnel interface as the outbound service-route interface.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"    service-route  gre-outbound\n        name          gre-outbound\n        service-name  gre-outbound\n        next-hop      test1 tunnel\n            node-name   test1\n            interface   tunnel\n            gateway-ip  172.16.3.2\n        exit\n    exit\n\n    service-route  gre-inbound\n        name          gre-inbound\n        service-name  gre-inbound\n\n        next-hop      test1 eth\n            node-name  test1\n            interface  base\n        exit\n    exit\nexit\n\n")),(0,i.kt)("h3",{id:"tunnel-statistics"},"Tunnel Statistics"),(0,i.kt)("p",null,"The following tunnel encapsulation statistics provide details on encapsulation and decapsulation success, as well as failure modes."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"/docs/cli_stats_reference#show-stats-packet-processing-action-success-tunnel-gre-encapsulate"},(0,i.kt)("inlineCode",{parentName:"a"},"stats packet-processing action success tunnel gre encapsulate")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"/docs/cli_stats_reference#show-stats-packet-processing-action-success-tunnel-gre-decapsulate"},(0,i.kt)("inlineCode",{parentName:"a"},"stats packet-processing action success tunnel gre decapsulate")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"/docs/cli_stats_reference#show-stats-packet-processing-action-failure-tunnel-gre-decapsulate"},(0,i.kt)("inlineCode",{parentName:"a"},"stats packet-processing action failure tunnel gre decapsulate")),": The decapsulate failure indicates that the packets entering from the tunnel either were not tunneled properly, or are otherwise malformed.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"/docs/cli_stats_reference#show-stats-packet-processing-action-failure-tunnel-invalid-entry"},(0,i.kt)("inlineCode",{parentName:"a"},"stats packet-processing action failure tunnel invalid-entry")),": The ",(0,i.kt)("inlineCode",{parentName:"p"},"invalid-entry")," stat should be 0; it indicates a system error with propagating the tunnel configuration."))))}f.isMDXComponent=!0}}]);
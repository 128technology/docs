"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[2903],{34621:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var i=t(74848),r=t(28453);const o={title:"Open Shortest Path First (OSPF)",sidebar_label:"OSPF"},s=void 0,a={id:"config_ospf",title:"Open Shortest Path First (OSPF)",description:"This section provides guidance for implementing OSPF on the SSR Networking Platform. The OSPF feature enables a dynamic and flexible integration of SVR in customer networks.",source:"@site/docs/config_ospf.md",sourceDirName:".",slug:"/config_ospf",permalink:"/docs/config_ospf",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1711026369,formattedLastUpdatedAt:"Mar 21, 2024",frontMatter:{title:"Open Shortest Path First (OSPF)",sidebar_label:"OSPF"},sidebar:"docs",previous:{title:"VRF Route Leaking",permalink:"/docs/config_vrf_route_leaking"},next:{title:"BFD with BGP and OSPF",permalink:"/docs/config_bfd"}},d={},l=[{value:"Revision History",id:"revision-history",level:4},{value:"Prerequisites",id:"prerequisites",level:2},{value:"OSPF Configuration",id:"ospf-configuration",level:2},{value:"Configuration Verification",id:"configuration-verification",level:2},{value:"OSPF Troubleshooting Steps",id:"ospf-troubleshooting-steps",level:2}];function c(e){const n={admonition:"admonition",code:"code",h2:"h2",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"This section provides guidance for implementing OSPF on the SSR Networking Platform. The OSPF feature enables a dynamic and flexible integration of SVR in customer networks."}),"\n",(0,i.jsx)(n.p,{children:"Open Shortest Path First (OSPF) is an interior gateway protocol (IGP) that is most often used to dynamically manage network routes in large enterprise networks. It determines routes dynamically by obtaining information from other routers and advertising routes to other routers by way of Link State Advertisements (LSAs). The information gathered from the LSAs is used to construct a topology map of the network. This topology map is shared across routers in the network and used to populate the IP routing table with available routes."}),"\n",(0,i.jsx)(n.p,{children:"Learning routes from OSPF simplifies enterprise configuration and integration with Secure Vector Routing."}),"\n",(0,i.jsx)(n.h4,{id:"revision-history",children:"Revision History"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Release"}),(0,i.jsx)(n.th,{children:"Modification"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"6.2.3-R2"}),(0,i.jsx)(n.td,{children:"Support for OSPF V3 added"})]})})]}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsx)(n.p,{children:"This document presumes you have a running SSR system and want to add configuration to support OSPF. The running SSR system includes configuration for basic platform functionality (e.g., router, node, device-interface, network-interface) and basic routing configuration (e.g., tenants, services, etc.)."}),"\n",(0,i.jsx)(n.h2,{id:"ospf-configuration",children:"OSPF Configuration"}),"\n",(0,i.jsx)(n.p,{children:"Each configuration step below shows both the command line input and corresponding screen from the GUI."}),"\n",(0,i.jsx)(n.p,{children:"As with BGP and static routes, the OSPF configuration exists within the routing configuration container in the SSR data model. First, we\u2019ll configure the OSPF \u201cinstance\u201d and give it the instance-id of 1."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"*admin@labsystem1.fiedler# config authority\n*admin@labsystem1.fiedler (authority)# router burlington \n*admin@labsystem1.fiedler (router[name=burlington])# routing default-instance \n*admin@labsystem1.fiedler (routing[type=default-instance])# ospf 1\n*admin@labsystem1.fiedler (ospf[instance=1])# show \n\ninstance 1\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"OSPF pane",src:t(64500).A+"",width:"1636",height:"536"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"New OSPF instance",src:t(2247).A+"",width:"1236",height:"418"})}),"\n",(0,i.jsx)(n.p,{children:"Next we\u2019ll configure a router-id. Typically, the highest router-id on the network becomes the designated router for the network."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"*admin@labsystem1.fiedler (ospf[instance=1])# router-id 192.0.2.1\n*admin@labsystem1.fiedler (ospf[instance=1])# show \n\ninstance 1\nrouter-id 192.0.2.1\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"OSPF1 Router ID",src:t(10110).A+"",width:"1624",height:"734"})}),"\n",(0,i.jsx)(n.p,{children:"Next we'll configure the OSPF version. The default version is OSPFv2, but you can also configure OSPFv3. Only one OSPFv2 and one OSPFv3 instance is allowed per VRF."}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["The command to configure OSPFv3 is similar to v2 and shown here:\n",(0,i.jsx)(n.code,{children:"version ospfv3"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"*admin@labsystem1.fiedler (ospf[instance=1])# version ospfv2\n*admin@labsystem1.fiedler (ospf[instance=1])# show\ninstance      1\nversion       ospfv2\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"OSPF Version",src:t(73173).A+"",width:"1610",height:"732"})}),"\n",(0,i.jsx)(n.p,{children:"Next we\u2019ll configure an OSPF area and put interfaces into that area. The area is in the format x.x.x.x; for example, area 0 is configured as 0.0.0.0. Interfaces, as they are in other areas of the system, require the node name that contains the interface and the interface\u2019s name."}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"If adding an interface that is part of a highly available set (e.g., they share the same MAC address and global ID), it is important that you only add one of the interfaces into the area. This will be sufficient to achieve high availability, as the SSR software will map the \u201cshared\u201d interface into the area."})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"*admin@labsystem1.fiedler (ospf[instance=1])# area 0.0.0.0\n*admin@labsystem1.fiedler (area[id=0.0.0.0])# interface labsystem5 lan0\n*admin@labsystem1.fiedler (interface[node=labsystem5][interface=lan0])# exit\n*admin@labsystem1.fiedler (area[id=0.0.0.0])# exit\n*admin@labsystem1.fiedler (ospf[instance=1])# show \n\ninstance    1\nversion     ospfv2\nrouter-id 192.0.2.1\narea 0.0.0.0\nid 0.0.0.0\n       interface  labsystem5 lan0\n       node       labsystem5\n       interface lan0\n       exit\nexit\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"OSPF area",src:t(54673).A+"",width:"1502",height:"1190"})}),"\n",(0,i.jsx)(n.p,{children:"Next, we can optionally elect to have the SSR redistribute connected routes, static routes, BGP routes, or service routes into OSPF. This is done with one or more \u201credistribute\u201d elements within the OSPF instance. (Within each of these redistribute elements you can specify metrics, metric-type, and policies to apply to the redistributed routes.)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"*admin@labsystem1.fiedler (ospf[instance=1])# redistribute bgp\n*admin@labsystem1.fiedler (redistribute[protocol=bgp])#\n*admin@labsystem1.fiedler (redistribute[protocol=bgp])# up\n*admin@labsystem1.fiedler (ospf[instance=1])# redistribute static\n*admin@labsystem1.fiedler (redistribute[protocol=static])# up\n*admin@labsystem1.fiedler (ospf[instance=1])# show\ninstance    1\nversion     ospfv2\nrouter-id   192.0.2.1\n\narea          0.0.0.0\n       id            0.0.0.0\n\n       interface  labsystem5 lan0\n       node       labsystem5\n       interface  lan0\n       exit\nexit\n\nredistribute  bgp\n       protocol  bgp\nexit\n\nredistribute  static\n       protocol  static\nexit\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"OSPF Redistribution",src:t(84420).A+"",width:"1098",height:"606"})}),"\n",(0,i.jsx)(n.p,{children:"To enable service routing (service-route elements) to leverage the learned routes that a SSR has exchanged via OSPF (or any routing protocol), the \u201cuse-learned-routes\u201d selector should be enabled in the appropriate service-route configuration."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"*admin@labsystem1.fiedler (router[name=burlington])# service-route rte_internet\n*admin@labsystem1.fiedler (service-route[name=rte_internet])# use-learned-routes\n*admin@labsystem1.fiedler (service-route[name=rte_internet])# show\nname rte_internet\nservice-name internet\nuse-learned-routes\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"OSPF Learned Routes",src:t(58911).A+"",width:"1148",height:"1032"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"OSPF Topology",src:t(31172).A+"",width:"956",height:"371"})}),"\n",(0,i.jsx)(n.h2,{id:"configuration-verification",children:"Configuration Verification"}),"\n",(0,i.jsxs)(n.p,{children:["Several ",(0,i.jsx)(n.code,{children:"show"})," commands are available in the PCLI to display information about the state of the OSP protocol. In addition to the ",(0,i.jsx)(n.code,{children:"show ospf"})," branch of output, you will also see contributions to the RIB from OSPF in the output of ",(0,i.jsx)(n.code,{children:"show rib"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"admin@labsystem1.fiedler# show ospf\nusage: ospf [area <area-id>] [router <router>] [<verbosity>]\n\nShow general information about OSPF\n\nkeyword arguments:\narea   the area to filter OSPF information for\nrouter the router to request OSPF information from\n\npositional arguments:\nverbosity    detail | summary (default: summary)\n\nsubcommands:\nborder-routers    Show information about the OSPF border routers\ndatabase          Show OSPF database information\ninterfaces        Show information about the OSPF interfaces\nneighbors         Show information about OSPF neighbors\nroutes            Show information about the OSPF routes\n"})}),"\n",(0,i.jsx)(n.h2,{id:"ospf-troubleshooting-steps",children:"OSPF Troubleshooting Steps"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Verify OSPF router information (",(0,i.jsx)(n.code,{children:"show ospf detail"})," or ",(0,i.jsx)(n.code,{children:"show ospf summary"}),")","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check the area"}),"\n",(0,i.jsx)(n.li,{children:"Check for adjacency"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Verify OSPF interface (",(0,i.jsx)(n.code,{children:"show ospf interface"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["Verify OSPF neighbors (",(0,i.jsx)(n.code,{children:"show ospf neighbors"}),")","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check state FULL for each neighbor"}),"\n",(0,i.jsx)(n.li,{children:"Verify which router is the designated router"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Verify RIB (",(0,i.jsx)(n.code,{children:"show rib"})," or ",(0,i.jsx)(n.code,{children:"show ospf routes"}),")","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Routes beginning with O are OSPF routes"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Verify FIB (",(0,i.jsx)(n.code,{children:"show fib"}),")","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"FIB entry has the appropriate next hop"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"admin@SSRconductor-node.SSRConductor# show ospf router SSR Router summary\nSat 2018-10-20 17:48:29 UTC\n\n================== =============== ========== ======== =========== ========= =========== ========\nRouter              Router ID       ABR Type   ASBR     External    Area ID   Area Type   Area\n                                               Router   LSA Count                         Border\n                                                                                          Router\n================== =============== ========== ======== =========== ========= =========== ========\nSSR Router          10.52.113.128   unknown    true     84          0.0.0.0\n\nCompleted in 0.66 seconds\nadmin@SSRconductor-node.SSRConductor#\n\n*admin@SSRconductor-node.SSRConductor# show ospf router SSRRouter detail\nSat 2018-10-20 17:46:27 UTC\n\n=============================================================\n Router SSRRouter\n=============================================================\n  Router ID:                             10.10.10.128\n  Deferred Shutdown:                     0.0 s\n  RFC1583 Compatible:                    false\n  Stub Advertisement Enabled:            false\n  Opaque Capable:                        false\n  Post-Start Enabled:                    0.0 s\n  Pre-Shutdown Enabled:                  0.0 s\n  SPF Schedule Delay:                    0.0 s\n  Holdtime Minimum:                      50 ms\n  Holdtime Maximum:                      5000 ms\n  Holdtime Multiplier:                   1\n  SPF Last Executed:                     -1d 17h 56m 15s ago\n  SPF Last Duration:                     0 ms\n  SPF Has Not Run:                       false\n  SPF Timer Due:                         0.0 s\n  LSA Minimum Interval:                  5.0 s\n  LSA Minimum Arrival:                   1.0 s\n  Write Multiplier:                      20\n  Refresh Timer:                         10.0 s\n  ABR Type:                              unknown\n  ASBR Router:                           true\n  External LSA Count:                    84\n  External LSA Checksum:                 0x002c4b5a\n  Opaque AS LSA Count:                   0\n  Opaque AS LSA Checksum:                0x00000000\n  Attached Area Count:                   1\n  Adjacency Changes Logged:              false\n  Adjacency Changes Logged (all):        false\n  Area:\n    Area ID:                             0.0.0.0\n    Backbone:                            true\n    Interface Total Count:               1\n    Interface Active Count:              1\n    Fully Adjacent Neighbor Count:       1\n    Authentication:                      none\n    Passing Fully Virtual Adjacencies:   0\n    SPF Executed Count:                  4\n    LSA Count:                           3\n    LSA Router Count:                    2\n    LSA Router Checksum:                 0x0000c2b1\n    LSA Network Count:                   1\n    LSA Network Checksum:                0x0000c606\n    LSA Summary Count:                   0\n    LSA Summary Checksum:                0x00000000\n    LSA ASBR Count:                      0\n    LSA ASBR Checksum:                   0x00000000\n    LSA NSSA Count:                      0\n    LSA NSSA Checksum:                   0x00000000\n    LSA Opaque Link Count:               0\n    LSA Opaque Link Checksum:            0x00000000\n    LSA Opaque Area Count:               0\n    LSA Opaque Area Checksum:            0x00000000\n    \nCompleted in 0.58 seconds\nadmin@SSRconductor-node.SSRConductor#\n\nadmin@SSRconductor-node.SSRConductor# show ospf database router SSRRouter\nSat 2018-10-20 03:21:52 UTC\n\n============ ============= ============= ============== ============= ===== ============\n Router       Area ID       Type          LSA ID         Advertising   Age   Sequence\n                                                         Router              Number\n============ ============= ============= ============== ============= ===== ============\n SSRRouter   0.0.0.0       Router        10.10.10.128   10.10.10.128  617   0x8000000e\n SSRRouter   0.0.0.0       Router        10.10.10.1     10.10.10.1    385   0x80000017\n SSRRouter   0.0.0.0       Network       10.58.0.0      10.10.10.1    641   0x80000003\n SSRRouter   unavailable   AS_External   10.0.0.0       10.10.10.128  607   0x80000006\n SSRRouter   unavailable   AS_External   10.1.254.96    10.10.10.128  597   0x80000006\n SSRRouter   unavailable   AS_External   10.10.60.0     10.10.10.128  597   0x80000006\n SSRRouter   unavailable   AS_External   10.10.220.0    10.10.10.128  587   0x80000006\n SSRRouter   unavailable   AS_External   10.10.221.0    10.10.10.128  607   0x80000006\n SSRRouter   unavailable   AS_External   10.10.225.0    10.10.10.128  617   0x80000006\n SSRRouter   unavailable   AS_External   10.10.226.0    10.10.10.128  607   0x80000006\n SSRRouter   unavailable   AS_External   10.10.252.0    10.10.10.128  627   0x80000006\n SSRRouter   unavailable   AS_External   10.52.0.0      10.10.10.128  627   0x80000006\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},31172:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/config_ospf-9497231865a44ecb57896a1a5eac6366.png"},64500:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/ospf-image1-1acfcfdce1fdf92f7ea349d374ce4f00.png"},58911:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/ospfv2-image11-1460b1bd46675752d45f15100840fbfc.png"},2247:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/ospfv2-image2-665378480c811f5a61759198d717a149.png"},10110:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/ospfv2-image3-bc5bcc06f42eadfbc00d269163442fc9.png"},73173:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/ospfv2-image3a-c8d7206963d8c41ed6984e4e34d3fa6a.png"},54673:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/ospfv2-image4-f2ff0ea59b37f9eec8133f564ceac44a.png"},84420:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/ospfv2-image9-c45e3ff322d9bbba140421758feb7e91.png"},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var i=t(96540);const r={},o=i.createContext(r);function s(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);
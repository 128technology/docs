"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[5817],{3905:function(e,t,n){n.d(t,{Zo:function(){return l},kt:function(){return f}});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=r.createContext({}),p=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=p(n),f=o,m=d["".concat(c,".").concat(f)]||d[f]||u[f]||a;return n?r.createElement(m,i(i({ref:t},l),{},{components:n})):r.createElement(m,i({ref:t},l))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var p=2;p<a;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},36229:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return c},default:function(){return f},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return u}});var r=n(87462),o=n(63366),a=(n(67294),n(3905)),i=["components"],s={title:"CPU Spikes",sidebar_label:"CPU Spikes"},c=void 0,p={unversionedId:"ts_cpu_spikes",id:"ts_cpu_spikes",title:"CPU Spikes",description:"This guide is to be used when investigating the root cause for an SSR that reports alarms of CPU spikes.",source:"@site/docs/ts_cpu_spikes.md",sourceDirName:".",slug:"/ts_cpu_spikes",permalink:"/docs/ts_cpu_spikes",draft:!1,tags:[],version:"current",lastUpdatedAt:1677781011,formattedLastUpdatedAt:"Mar 2, 2023",frontMatter:{title:"CPU Spikes",sidebar_label:"CPU Spikes"},sidebar:"docs",previous:{title:"AP: Salt Minion",permalink:"/docs/ts_ap_salt_minion"},next:{title:"Connecting to Routers",permalink:"/docs/ts_connecting_to_routers"}},l={},u=[{value:"Expected Behavior",id:"expected-behavior",level:2}],d={toc:u};function f(e){var t=e.components,s=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"This guide is to be used when investigating the root cause for an SSR that reports alarms of CPU spikes."),(0,a.kt)("h2",{id:"expected-behavior"},"Expected Behavior"),(0,a.kt)("p",null,"A CPU alarm is triggered when the average CPU of all of the cores on a system exceeds 85% for thirty seconds. This will not include any CPU cores that are pinned for packet forwarding. The alarm is cleared when the average CPU is below 85% for five (5) seconds."),(0,a.kt)("p",null,"You can determine whether a system has pinned CPU cores by checking the configuration.  The CPU allocation is defined within the ",(0,a.kt)("inlineCode",{parentName:"p"},"node")," configuration of a router."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"admin@gouda.novigrad# show config running authority router novigrad node gouda \n\nconfig\n\n    authority\n\n        router  novigrad\n            name  novigrad\n\n            node  gouda\n                name                        gouda\n                enabled                     true\n                forwarding-core-mode        automatic\n")),(0,a.kt)("p",null,"In particular, the ",(0,a.kt)("inlineCode",{parentName:"p"},"forwarding-core-count")," indicates how many cores are dedicated for fast packet forwarding."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"The default configuration has ",(0,a.kt)("inlineCode",{parentName:"p"},"forwarding-core-mode")," set to ",(0,a.kt)("inlineCode",{parentName:"p"},"automatic")," with no ",(0,a.kt)("inlineCode",{parentName:"p"},"forwarding-core-count")," defined. The SSR platform will attempt to right-size the configuration based on system's available resources. For some deployments, it may be desirable to override the defaults to optimize the platform for your environment.")),(0,a.kt)("p",null,"When the forwarding-count-mode is set to automatic, you can see how the system has allocated resources by issuing the command ",(0,a.kt)("inlineCode",{parentName:"p"},"show platform cpu"),". "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"admin@gouda.novigrad# show platform cpu \nThu 2020-03-19 15:23:24 UTC\n\n===================================================================\n gouda\n===================================================================\n ---------------\n CPU Information\n ---------------\n Type:                     Intel(R) Atom(TM) CPU  C2558  @ 2.40GHz\n Speed:                    2.400096893310547 GHz\n Hyper-Threading:          no\n Cores:                    4\n Forwarding Cores:         1\n Isolated Cores:           1\n Power-Saver:              disabled\n\nCompleted in 2.75 seconds\n")),(0,a.kt)("p",null,"With an understanding of how the system is configured, we can now get to the process of examining the history of CPU usage over time. The SSR stores time series data for a number of KPIs that are relevant for system and service health and operation.  Viewing time series data is best accomplished within the GUI."),(0,a.kt)("p",null,"Navigate to the ",(0,a.kt)("strong",{parentName:"p"},"Custom Reports")," located on the dashboard.  From there create two reports: one for total utilization per CPU and another for utilization per SSR process, as indicated by the images below."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"ts_cpu_spikes_per_cpu_chart",src:n(63959).Z,width:"2826",height:"1290"})),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"ts_cpu_spikes_per_process_chart",src:n(50275).Z,width:"2826",height:"1280"})),(0,a.kt)("p",null,"Alarms are optionally overlaid on top of all charts generated by the SSR.  This is very helpful in correlating system events to system behavior.  The time window of custom reports can be extended from 5 minutes to 6 months.  If you see anomalies in either the CPU and correspondingly a particular application, this may indicate the system is not performing properly."))}f.isMDXComponent=!0},63959:function(e,t,n){t.Z=n.p+"assets/images/ts_cpu_spikes_per_cpu_chart-237fd1e78b82c6d7e8a81bbf0253df13.png"},50275:function(e,t,n){t.Z=n.p+"assets/images/ts_cpu_spikes_per_process_chart-34cf25f6a7d7afd013185ca61054c49a.png"}}]);
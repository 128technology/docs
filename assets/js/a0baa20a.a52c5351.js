"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[6355],{19047:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var i=t(74848),n=t(28453);const r={title:"SEIM Syslog Integration",sidebar_label:"SEIM Syslog Integration"},o=void 0,l={id:"sec-config-seim-syslog",title:"SEIM Syslog Integration",description:"Many customers operate independent (third party) Security Event and Incident Management (SEIM) platforms, for aggregating and analyzing security events across vendors and devices in their network. SEIM tools support the needs of attack detection, investigation, response, and compliance solutions by:",source:"@site/docs/sec-config-seim-syslog.md",sourceDirName:".",slug:"/sec-config-seim-syslog",permalink:"/docs/sec-config-seim-syslog",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"SEIM Syslog Integration",sidebar_label:"SEIM Syslog Integration"},sidebar:"docs",previous:{title:"Security Policies",permalink:"/docs/sec_security_policy"},next:{title:"Security Hardening Guidelines",permalink:"/docs/sec_hardening_guidelines"}},c={},d=[{value:"How Does It Work?",id:"how-does-it-work",level:2},{value:"Configure a Syslog Policy",id:"configure-a-syslog-policy",level:3},{value:"Associate the Syslog Policy with an Access Policy",id:"associate-the-syslog-policy-with-an-access-policy",level:3},{value:"Configure the Syslog Server",id:"configure-the-syslog-server",level:3},{value:"Configuration Parameters",id:"configuration-parameters",level:2},{value:"Syslog Server Configuration Parameters",id:"syslog-server-configuration-parameters",level:3},{value:"Auth(entication) Facility Considerations",id:"authentication-facility-considerations",level:4},{value:"Control the Traffic Event per Policy",id:"control-the-traffic-event-per-policy",level:4},{value:"Traffic Events and Messages",id:"traffic-events-and-messages",level:2},{value:"Structured Syslog Format",id:"structured-syslog-format",level:3},{value:"Common Fields",id:"common-fields",level:3},{value:"SESSION_CREATE",id:"session_create",level:3},{value:"Example Output",id:"example-output",level:4},{value:"SESSION_CLOSE",id:"session_close",level:3},{value:"SESSION_FAIL",id:"session_fail",level:3},{value:"SESSION_BLOCK",id:"session_block",level:3},{value:"IDP Fields",id:"idp-fields",level:4},{value:"Anti-Virus Fields",id:"anti-virus-fields",level:4},{value:"Example Configurations",id:"example-configurations",level:2},{value:"Syslog Server Configuration",id:"syslog-server-configuration",level:3},{value:"Syslog Policy Configuration",id:"syslog-policy-configuration",level:3},{value:"Syslog Policy and Server Sample Configuration",id:"syslog-policy-and-server-sample-configuration",level:3}];function a(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.p,{children:"Many customers operate independent (third party) Security Event and Incident Management (SEIM) platforms, for aggregating and analyzing security events across vendors and devices in their network. SEIM tools support the needs of attack detection, investigation, response, and compliance solutions by:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Collecting security event logs and telemetry in real-time for threat detection and compliance use cases"}),"\n",(0,i.jsx)(s.li,{children:"Analyzing telemetry in real-time and over time to detect attacks and other activities of interest"}),"\n",(0,i.jsx)(s.li,{children:"Investigating incidents to determine their potential severity and impact on business"}),"\n",(0,i.jsx)(s.li,{children:"Producing reports on these activities"}),"\n",(0,i.jsx)(s.li,{children:"Storing relevant events and logs"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"SSR supports a structured, standardized syslog format to export the information off-box, in real time, and allows faster and easier integration with SIEM providers. Some of the information collected and exported for analysis are:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"System login details"}),"\n",(0,i.jsx)(s.li,{children:"Configuration Changes"}),"\n",(0,i.jsx)(s.li,{children:"Traffic Events"}),"\n",(0,i.jsx)(s.li,{children:"Sites blocked by URL filtering"}),"\n",(0,i.jsx)(s.li,{children:"Vulnerabilities reported by IDP, AV, and other L7 Security solutions"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"SEIM integration on the SSR allows you to:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Configure multiple syslog servers"}),"\n",(0,i.jsx)(s.li,{children:"Support UDP, TCP, and TLS as available transports per server"}),"\n",(0,i.jsx)(s.li,{children:"Configure the type of data to be exported to each syslog server"}),"\n",(0,i.jsx)(s.li,{children:"Export system login attempts"}),"\n",(0,i.jsx)(s.li,{children:"Export traffic events off box"}),"\n",(0,i.jsx)(s.li,{children:"Control the traffic event per policy"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"how-does-it-work",children:"How Does It Work?"}),"\n",(0,i.jsx)(s.p,{children:"There are three steps for SEIM integration:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Configure a syslog policy"}),"\n",(0,i.jsx)(s.li,{children:"Associate the policy with an access-policy"}),"\n",(0,i.jsx)(s.li,{children:"Configure the syslog server to receive the exported data"}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"configure-a-syslog-policy",children:"Configure a Syslog Policy"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.a,{href:"#syslog-policy-configuration",children:"Configure a syslog policy"}),". This identifies which messages are of interest."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"config\n  authority\n    syslog-policy target-syslog-policy\n      name target-syslog-policy\n      enabled true\n      close true\n      create false\n      error false\n      security true\n    exit\n"})}),"\n",(0,i.jsx)(s.h3,{id:"associate-the-syslog-policy-with-an-access-policy",children:"Associate the Syslog Policy with an Access Policy"}),"\n",(0,i.jsxs)(s.p,{children:["The syslog policy is associated with an access policy to indicate that messages should be produced when tennats access services. The ",(0,i.jsx)(s.code,{children:"access-policy server-access syslog"})," identifies only the name of the syslog policy being used."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"config authority service target-servers access-policy server-access syslog syslog-policy target-policy\n"})}),"\n",(0,i.jsx)(s.p,{children:"If you configure a syslog policy and an access policy, but do not reference the syslog policy from the access policy, then the information will not be logged."}),"\n",(0,i.jsx)(s.h3,{id:"configure-the-syslog-server",children:"Configure the Syslog Server"}),"\n",(0,i.jsxs)(s.p,{children:["A ",(0,i.jsx)(s.a,{href:"#syslog-server-configuration",children:"syslog server"})," must be in place to receive the data/messages, and must be identified in the SSR configuration. Additionally, a filter can be applied according to syslog standards, a match regex can be provided to further filter, and the protocol specified."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"config\n  authority\n    router target-router\n      name target-router\n      system\n        syslog\n          server 10.20.30.40 514\n            ip-address 10.20.30.40\n            port 514\n            protocol udp\n            filter kern\n              facility kern\n              severity notice\n            exit\n          exit\n"})}),"\n",(0,i.jsx)(s.h2,{id:"configuration-parameters",children:"Configuration Parameters"}),"\n",(0,i.jsx)(s.p,{children:"This section covers the parameters associated with SEIM syslog configuration."}),"\n",(0,i.jsx)(s.h3,{id:"syslog-server-configuration-parameters",children:"Syslog Server Configuration Parameters"}),"\n",(0,i.jsxs)(s.p,{children:["The existing syslog config under ",(0,i.jsx)(s.strong,{children:"authority > router > system > syslog"})," expands the support of facility, severity, transport and other relevant config parameters per server. The configuration on a per server will take precedence over the configuration at the syslog level."]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Name"}),(0,i.jsx)(s.th,{children:"Type"}),(0,i.jsx)(s.th,{children:"Default"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"protocol"}),(0,i.jsx)(s.td,{children:"enum: udp, tcp, tls"}),(0,i.jsx)(s.td,{children:"udp"}),(0,i.jsx)(s.td,{children:"Transport to use to connect to the server."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"filter"}),(0,i.jsx)(s.td,{children:"list"}),(0,i.jsx)(s.td,{children:"Empty"}),(0,i.jsx)(s.td,{children:"List of facility and severity to be configured for a server."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"filter > facility"}),(0,i.jsx)(s.td,{children:"enum"}),(0,i.jsx)(s.td,{children:"local0 (existing)"}),(0,i.jsxs)(s.td,{children:["The facility or the type of syslog message to be sent to the server. ",(0,i.jsx)("br",{})," For session and config-change events, SSR will use the auth facility as that\u2019s the convention for most firewall and gateway devices."]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"filter > severity"}),(0,i.jsx)(s.td,{children:"enum"}),(0,i.jsx)(s.td,{children:"error"}),(0,i.jsx)(s.td,{children:"The message is sent to the server using the configured log level for the facility, or a less severe level if applicable."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"filter > match"}),(0,i.jsx)(s.td,{children:"string"}),(0,i.jsx)(s.td,{children:"empty"}),(0,i.jsx)(s.td,{children:"Regex match that will be applied to the raw syslog message to filter specific messages for the configured facility and severity."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ocsp"}),(0,i.jsx)(s.td,{children:"Same as config > authority > router > system > syslog > ocsp"}),(0,i.jsx)(s.td,{children:"When protocol=tls"}),(0,i.jsx)(s.td,{})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"certificate"}),(0,i.jsx)(s.td,{children:"Same as config > authority > router > system > syslog > certificate"}),(0,i.jsx)(s.td,{children:"When protocol=tls"}),(0,i.jsx)(s.td,{})]})]})]}),"\n",(0,i.jsx)(s.h4,{id:"authentication-facility-considerations",children:"Auth(entication) Facility Considerations"}),"\n",(0,i.jsxs)(s.p,{children:["Syslog RFC5424 supports standard facility codes (see Section 6.2.1 of RFC). It is common industry practice to use ",(0,i.jsx)(s.code,{children:"auth facility"})," for sending flow related events. By default, the SSR uses the ",(0,i.jsx)(s.code,{children:"auth facility"})," for configuration change and session related events. The ",(0,i.jsx)(s.code,{children:"auth facility"})," in syslog also captures all the login/authentication style events. By default, when a user enables the ",(0,i.jsx)(s.code,{children:"auth facility"})," they also receive those events. For MIST users this might not be desirable. The SSR provides a filter to only allow the session events through."]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Name"}),(0,i.jsx)(s.th,{children:"Type"}),(0,i.jsx)(s.th,{children:"Default"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"authority > router > system > syslog > auth > include"}),(0,i.jsxs)(s.td,{children:["enum list with options ",(0,i.jsx)("br",{})," [all, login, session, config-change]"]}),(0,i.jsx)(s.td,{children:"all"}),(0,i.jsxs)(s.td,{children:["Since ",(0,i.jsx)(s.code,{children:"auth"})," contains many different types of events, this filter will allow the users to pick which changes should be sent to the remote server."]})]})})]}),"\n",(0,i.jsx)(s.h4,{id:"control-the-traffic-event-per-policy",children:"Control the Traffic Event per Policy"}),"\n",(0,i.jsx)(s.p,{children:"The config > authority > service > access-policy references a syslog-policy and allows the user to toggle the sending of syslog messages as well as control the types of messages generated for the service."}),"\n",(0,i.jsxs)(s.p,{children:["Path: ",(0,i.jsx)(s.strong,{children:"config > authority > syslog-policy"})]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Name"}),(0,i.jsx)(s.th,{children:"Type"}),(0,i.jsx)(s.th,{children:"Default"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"name"}),(0,i.jsx)(s.td,{children:"string"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Required"})}),(0,i.jsx)(s.td,{children:"The name by which this profile will be referenced."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"enabled"}),(0,i.jsx)(s.td,{children:"bool"}),(0,i.jsx)(s.td,{children:"true"}),(0,i.jsx)(s.td,{children:"Whether to send syslog messages for access policies referencing this policy."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"create"}),(0,i.jsx)(s.td,{children:"bool"}),(0,i.jsx)(s.td,{children:"false"}),(0,i.jsx)(s.td,{children:"Whether to send a syslog message on session creation."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"close"}),(0,i.jsx)(s.td,{children:"bool"}),(0,i.jsx)(s.td,{children:"true"}),(0,i.jsx)(s.td,{children:"Whether to send a syslog message session deletion."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"error"}),(0,i.jsx)(s.td,{children:"bool"}),(0,i.jsx)(s.td,{children:"true"}),(0,i.jsx)(s.td,{children:"Whether to send a syslog message on failure to create a session."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"security"}),(0,i.jsx)(s.td,{children:"bool"}),(0,i.jsx)(s.td,{children:"true"}),(0,i.jsx)(s.td,{children:"Whether to send a syslog message for any access-policy deny or block triggered by L7 security feature such as URL filtering, IDP or antivirus on this service."})]})]})]}),"\n",(0,i.jsxs)(s.p,{children:["Path: ",(0,i.jsx)(s.strong,{children:"config > authority > service > access-policy > syslog-policy"})]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Name"}),(0,i.jsx)(s.th,{children:"Type"}),(0,i.jsx)(s.th,{children:"Default"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"syslog-policy"}),(0,i.jsx)(s.td,{children:"string"}),(0,i.jsx)(s.td,{children:"null"}),(0,i.jsx)(s.td,{children:"A reference to the config > authority > syslog-policy to be used"})]})})]}),"\n",(0,i.jsx)(s.admonition,{type:"note",children:(0,i.jsx)(s.p,{children:"By default, the settings apply to all the child services. To disable or control the settings on the child service, assign a different access-policy than the parent."})}),"\n",(0,i.jsx)(s.h2,{id:"traffic-events-and-messages",children:"Traffic Events and Messages"}),"\n",(0,i.jsx)(s.p,{children:"The following system events can be logged and the resulting messages exported to the syslog server:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"#session_create",children:"SESSION_CREATE"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"#session_close",children:"SESSION_CLOSE"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"#session_block",children:"SESSION_BLOCK"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"#session_fail",children:"SESSION_FAIL"})}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"structured-syslog-format",children:"Structured Syslog Format"}),"\n",(0,i.jsx)(s.p,{children:"A standard structured syslog message takes the following format"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"<PRI>VERSION TIMESTAMP HOSTNAME APP-NAME PROCID MSGID [STRUCTURED-DATA] MESSAGE"})}),"\n",(0,i.jsx)(s.p,{children:"For example:"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"<134>1 2025-01-10T15:45:12.345Z mynode.myrouter SSR 1234 SESSION_CREATE [ssr@2636.1.0.0 key1=\u201dvalue1\u201d key2=\u201dvalue2\u201d]"})}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"}),(0,i.jsx)(s.th,{children:"SSR Value"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"<PRI>"})}),(0,i.jsx)(s.td,{children:"Priority value obtained by combining facility and severity values."}),(0,i.jsx)(s.td,{children:"Combination of the severity and facility values from data model."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"VERSION"}),(0,i.jsx)(s.td,{children:"Syslog version"}),(0,i.jsx)(s.td,{children:"1 (default for syslog)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"TIMESTAMP"}),(0,i.jsx)(s.td,{children:"Time of the event in UTC format UTC"}),(0,i.jsxs)(s.td,{children:["Timestamp in RFC3339 format ",(0,i.jsx)("br",{})," Example: 1970-01-01T00:00:00Z"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"HOSTNAME"}),(0,i.jsx)(s.td,{children:"Name of the generating entity."}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"<node-name>.<router-router>"})," from the configuration"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"APP-NAME"}),(0,i.jsx)(s.td,{children:"Name of the application generating the message."}),(0,i.jsx)(s.td,{children:"SSR"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"PROCID"}),(0,i.jsx)(s.td,{children:"The process-id of the application generating the message."}),(0,i.jsx)(s.td,{children:"128"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"MSGID"}),(0,i.jsx)(s.td,{children:"Unique identifier indicating the type of message being sent."}),(0,i.jsxs)(s.td,{children:["One of: ",(0,i.jsx)("br",{})," SESSION_CREATE ",(0,i.jsx)("br",{})," SESSION_CLOSE ",(0,i.jsx)("br",{})," SESSION_BLOCK ",(0,i.jsx)("br",{})," SESSION_FAIL"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"[STRUCTURED-DATA]"}),(0,i.jsx)(s.td,{children:"Vendor proprietary fields in the form name=value."}),(0,i.jsxs)(s.td,{children:["[ssr@2636.1.0.0 \u2026] ",(0,i.jsx)("br",{})," The ",(0,i.jsx)(s.code,{children:"ssr@2636.1.0.0"})," can be used to identify this message as SSR proprietary syslog message. ",(0,i.jsx)("br",{})," ssr \u2013 name of the vendor ",(0,i.jsx)("br",{})," 2636 \u2013 IANA assigned Juniper vendor-id ",(0,i.jsx)("br",{})," 1.0.0 \u2013 version of the message format."]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"MESSAGE"}),(0,i.jsx)(s.td,{children:"Optional string containing description or helpful information about the message."}),(0,i.jsx)(s.td,{children:"Left empty."})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"common-fields",children:"Common Fields"}),"\n",(0,i.jsx)(s.p,{children:"Each event message will contain common information as described below. Individual event messages contain additional information specific to the event."}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"session-id"}),(0,i.jsx)(s.td,{children:"UUID of the session."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"source-address"}),(0,i.jsx)(s.td,{children:"Source IP address of the packet that triggered the session creation."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"source-port"}),(0,i.jsx)(s.td,{children:"Source port of the packet that triggered the session creation."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"destination-address"}),(0,i.jsx)(s.td,{children:"Destination IP address of the packet that triggered the session creation."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"destination-port"}),(0,i.jsx)(s.td,{children:"Destination port of the packet that triggered the session creation."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"protocol-id"}),(0,i.jsx)(s.td,{children:"IANA assigned integer value of transport protocol of the packet that triggered the session creation; udp, tcp, tls, etc."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"protocol"}),(0,i.jsx)(s.td,{children:"Name of the protocol."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ingress-interface"}),(0,i.jsx)(s.td,{children:"Name of the network-interface which received the packet."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"tenant"}),(0,i.jsx)(s.td,{children:"Name of the tenant associated with the session."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"service"}),(0,i.jsx)(s.td,{children:"Name of the service associated with the session."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"policy"}),(0,i.jsx)(s.td,{children:"Name of the MIST policy associated with the session. For conductor-managed, the service name."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"session-source"}),(0,i.jsx)(s.td,{children:"Source of the session was received. Options are local, inter-node, inter-router."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"application"}),(0,i.jsx)(s.td,{children:"Name of the application and domain associated with this session. Displays \u201c-\u201c when none available."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"category"}),(0,i.jsx)(s.td,{children:"Name of the category associated with this session. Displays \u201c-\u201c when none available."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"sub-category"}),(0,i.jsx)(s.td,{children:"Name of the sub-category associated with this session. Displays \u201c-\u201c when none available."})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"session_create",children:"SESSION_CREATE"}),"\n",(0,i.jsx)(s.p,{children:"When SESSION_CREATE is enabled, messages are generated when a session is created. The messages will contain the following SESSION_CREATE specific information:"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"next-hop-type"}),(0,i.jsx)(s.td,{children:"The type of egress interface the session was routed to. Options are: local, inter-node, inter-router."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"next-hop-interface"}),(0,i.jsx)(s.td,{children:"The name of the egress network interface used for routing the session."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"source-nat-address"}),(0,i.jsxs)(s.td,{children:["For local breakout sessions, if source-nat is applied, the IP address is used as the source.",(0,i.jsx)("br",{})," For inter-router sessions, the source IP address is used for creating the waypoint port allocation for inter-router SVR sessions.",(0,i.jsx)("br",{})," When source-nat or waypoint is not applicable, value is set to \u201c-\u201c"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"source-nat-port"}),(0,i.jsxs)(s.td,{children:["For local breakout sessions, if source-nat is applied, the port is used as the source.",(0,i.jsx)("br",{})," For inter-router sessions, the source port is used for creating the waypoint port allocation for inter-router SVR sessions.",(0,i.jsx)("br",{})," When source-nat or waypoint is not applicable, value is set to \u201c-\u201c"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"source-nat-protocol-id"}),(0,i.jsxs)(s.td,{children:["For local breakout sessions, the session protocol-id is used.",(0,i.jsx)("br",{})," For inter-router sessions, protocol is used for SVR session.",(0,i.jsx)("br",{})," When the value is different from protocol-id, a transform is being applied.",(0,i.jsx)("br",{})," When source-nat or waypoint is not applicable, the value is set to the source protocol-id"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"source-nat-protocol"}),(0,i.jsx)(s.td,{children:"Name of protocol: udp, tcp"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"peer-name"}),(0,i.jsxs)(s.td,{children:["For inter-router sessions, the name of the remote peer where the session is routed.",(0,i.jsx)("br",{})," For other scenarios, the value is set to \u201c-\u201c"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"destination-nat-address"}),(0,i.jsxs)(s.td,{children:["When destination-nat is enabled, the destination IP address is used for routing this session. ",(0,i.jsx)("br",{})," For inter-router sessions, the destination IP is used for creating the waypoint port allocation for inter-router SVR sessions.",(0,i.jsx)("br",{})," When destination-nat is disabled, value is set to \u201c-\u201c"]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"destination-nat-port"}),(0,i.jsxs)(s.td,{children:["When destination-nat is enabled, the destination port is used for routing this session. ",(0,i.jsx)("br",{})," For inter-router sessions, the destination port is used for creating the waypoint port allocation for inter-router SVR sessions. ",(0,i.jsx)("br",{})," When destination-nat is disabled, value is set to \u201c-\u201c."]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"dscp"}),(0,i.jsx)(s.td,{children:"DSCP value used for the session on the egress flow."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"time-to-live"}),(0,i.jsx)(s.td,{children:"The amount of time (in seconds) left on the session to survive any network inactivity."})]})]})]}),"\n",(0,i.jsx)(s.h4,{id:"example-output",children:"Example Output"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:'<134>1 2025-01-10T15:45:12.345Z mynode.myrouter SSR 1234 SESSION_CREATE\n[ssr@2636.1.0.0 session-id="abcdabcd-ffff-ffff-ffff-ffffffffffff"\nsource-address="1.1.1.1" source-port="1234" destination-address="2.2.2.2"\ndestination-port="5678" protocol-id="6" protocol="tcp"\ningress-interface="lan-intf" tenant="corp-lan" service="web" policy="-"\nsession-source="PUBLIC" application="Facebook" category="SocialMedia"\nsub-category="SocialWeb-Facebook" next-hop-type="PUBLIC"\nnext-hop-interface="wan-intf" source-nat-address="20.20.20.20"\nsource-nat-port="10000" soure-nat-protocol-id="6" source-nat-protocol="tcp"\npeer-name="-" destination-nat-address="100.100.100.100"\ndestination-nat-port="20000" dscp="-" time-to-live="60"] \n'})}),"\n",(0,i.jsx)(s.h3,{id:"session_close",children:"SESSION_CLOSE"}),"\n",(0,i.jsx)(s.p,{children:"When SESSION_CLOSE is enabled, messages are generated when a session has been deleted from the SSR. This could be a result of a timeout in UDP, or an RST in TCP. The message indicates the cause of the session deletion. Please note that the SESSION_CLOSE is only generated in the cases where the session was previously successfully established; failures and other errors are captured in messages generated by other system events listed below."}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"close-reason"}),(0,i.jsx)(s.td,{children:"The reason for session deletion. Options are timeout, tcp-close, etc."})]})})]}),"\n",(0,i.jsx)(s.h3,{id:"session_fail",children:"SESSION_FAIL"}),"\n",(0,i.jsx)(s.p,{children:"When enabled, a SESSION_FAIL message is generated anytime the system is unable to successfully create a session. For example, when all provisioned interfaces for the service are unavailable, or when all waypoint ports are exhausted. The messages contain the information about the failure, along with the reason for the failure."}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"reason"}),(0,i.jsx)(s.td,{children:"The reason for session failure. This might include exceptions during session creation/modification."})]})})]}),"\n",(0,i.jsx)(s.h3,{id:"session_block",children:"SESSION_BLOCK"}),"\n",(0,i.jsx)(s.p,{children:"The SESSION_BLOCK message is triggered in the following (but not limited to) security scenarios:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Access-policy deny: A service denies access to a tenant(s)."}),"\n",(0,i.jsx)(s.li,{children:"URL Filtering block: A child-service blocks access to apps, domains, categories, or subcategories."}),"\n",(0,i.jsx)(s.li,{children:"IDP and AV: A service has advanced L7 security features such as IDP/AV enabled, and identifies a vulnerability."}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"The messages contain the following fields, including details on the reason for the session being blocked."}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"block-type"}),(0,i.jsx)(s.td,{children:"Either access-policy-deny, url-filtering, idp, or antivirus"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"reason"}),(0,i.jsxs)(s.td,{children:["For IDP and AV, the name of the vulnerability that triggered the block. ",(0,i.jsx)("br",{})," For others, value is set to \u201c-\u201c."]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"severity"}),(0,i.jsxs)(s.td,{children:["For IDP and AV, the severity of the vulnerability being detected. ",(0,i.jsx)("br",{})," For others, value is set to \u201c-\u201c."]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"start-time"}),(0,i.jsxs)(s.td,{children:["The timestamp when the sequence started. ",(0,i.jsx)("br",{})," - access-policy-block: When the first packet was received and buffering starts. ",(0,i.jsx)("br",{})," - url-filtering, idp, av: Time when the session creation packet was received."]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"count"}),(0,i.jsxs)(s.td,{children:["Number of packets represented by this block event. ",(0,i.jsx)("br",{})," - access-policy-block: Number of packets dropped since the start-time ",(0,i.jsx)("br",{})," - Others: Value is set to \u201c-\u201d."]})]})]})]}),"\n",(0,i.jsx)(s.h4,{id:"idp-fields",children:"IDP Fields"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"cve-id"}),(0,i.jsx)(s.td,{children:"Standardized reference ID for known threats."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"threat-severity"}),(0,i.jsx)(s.td,{children:"Severity of the threat: CRITICAL, LOW, MEDIUM, HIGH, INFO or UNDEFINED."})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"action"}),(0,i.jsx)(s.td,{children:"Action for the blocked event: DROP, CLOSE, CLOSE_SERVER, CLOSE_CLIENT."})]})]})]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Example of syslog IDP Event"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:'<38> Jun 5 12:10:07 node0.Spoke1 SSR 128 SESSION_BLOCK\n[ssr@2636.1.0.0 source-address="172.16.3.9" destination-address="10.73.3.11"\ncount="0" action="CLOSE" session-source="-"\nreason="HTTP:UNIX-FILE:ETC-PASSWD"\nsession-id="1db28fc8-65c5-430f-8345-f035a5add46a" source-port="58872"\ndestination-port="80" ingress-interface="ge-0/0/0.0"\ntenant="spoke1-to-traffic-gen" policy="localbreakout" category="-"\nprotocol="TCP" application="HTTP" severity="6" start-time="1749125403"\nthreat-severity="MEDIUM" egress-interface="ge-0/0/1.0" protocol-id="6"\nsub-category="-" service="localbreakout" block-type="idp" cve-id="N/A"] \n'})}),"\n",(0,i.jsx)(s.h4,{id:"anti-virus-fields",children:"Anti-Virus Fields"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"verdict-number"}),(0,i.jsx)(s.td,{children:"Threat score of the event."})]})})]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Example of Anti-Virus Event"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:'<38> Jun 5 11:59:35 node0.Spoke1 SSR 128 SESSION_BLOCK\n[ssr@2636.1.0.0 start-time="-" verdict-number="0"\nsession-id="a2f55654-b513-4c1a-b1ab-3ea76a771364" service="localbreakout"\npolicy="localbreakout" application="-" count="0" url="-" session-source="-"\nsource-address="172.16.3.9" tenant="spoke1-to-traffic-gen"\nblock-type="antivirus" protocol-id="-" category="-"\nreason="secure.eicar.org/eicar.com.txt:80" destination-port="80"\nprotocol="http" ingress-interface="-" sub-category="-" source-port="58868"\ndestination-address="10.73.3.11" severity="4"] ```\n'})}),"\n",(0,i.jsx)(s.h2,{id:"example-configurations",children:"Example Configurations"}),"\n",(0,i.jsx)(s.h3,{id:"syslog-server-configuration",children:"Syslog Server Configuration"}),"\n",(0,i.jsxs)(s.p,{children:["Syslog server configuration allows administrators to configure SSR interaction with external syslog services. The following example shows a syslog server configuration with filtering to select the messages received. Note that the default protocol is ",(0,i.jsx)(s.code,{children:"udp"}),". For more information about syslog server configuration and command parameters, see ",(0,i.jsx)(s.a,{href:"/docs/config_command_guide#configure-authority-router-system-syslog",children:(0,i.jsx)(s.code,{children:"configure authority router system syslog"})})]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"config\n  authority\n    router target-router\n      name target-router\n      system\n        syslog\n          server 11.21.31.40 514\n            ip-address 11.21.31.40\n            port 514\n            protocol udp\n            filter auth\n              facility auth\n              severity info\n            exit\n          exit\n        exit\n      exit\n    exit\n  exit\nexit\n"})}),"\n",(0,i.jsx)(s.h3,{id:"syslog-policy-configuration",children:"Syslog Policy Configuration"}),"\n",(0,i.jsxs)(s.p,{children:["The following is a syslog policy example with two servers (server 10.20.30.40 514, and server 11.21.31.40 514) where each is using filtering to select which messages it receives. It is associated with the access-policy ",(0,i.jsx)(s.code,{children:"lan"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["For configuration command and parameter information, see ",(0,i.jsx)(s.a,{href:"/docs/config_command_guide#configure-authority-syslog-policy",children:(0,i.jsx)(s.code,{children:"configure authority syslog-policy"})}),"."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"config\n  authority\n    syslog-policy target-syslog-policy\n      name target-syslog-policy\n      enabled true\n      close true\n      create false\n      error false\n      security true\n    exit\n    service internet\n      name internet\n      access-policy lan\n        source lan\n        syslog\n          syslog-policy target-syslog-policy\n        exit\n      exit\n    exit\n  exit\nexit\n"})}),"\n",(0,i.jsx)(s.h3,{id:"syslog-policy-and-server-sample-configuration",children:"Syslog Policy and Server Sample Configuration"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"config\n  authority\n    syslog-policy target-syslog-policy\n      name target-syslog-policy\n      enabled true\n      close true\n      create false\n      error false\n      security true\n    exit\n    service internet\n      name internet\n      access-policy lan\n        source lan\n        syslog\n          syslog-policy target-syslog-policy\n        exit\n      exit\n    exit\n    router target-router\n      name target-router\n      system\n        syslog\n          server 10.20.30.40 514\n            ip-address 10.20.30.40\n            port 514\n            protocol udp\n            filter kern\n              facility kern\n              severity notice\n            exit\n          exit\n          server 11.21.31.40 514\n            ip-address 11.21.31.40\n            port 514\n            protocol udp\n            filter auth\n              facility auth\n              severity info\n            exit\n          exit\n        exit\n      exit\n    exit\n  exit\nexit\n"})})]})}function h(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>o,x:()=>l});var i=t(96540);const n={},r=i.createContext(n);function o(e){const s=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),i.createElement(r.Provider,{value:s},e.children)}}}]);
"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[7237],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return g}});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=d(n),g=i,m=p["".concat(l,".").concat(g)]||p[g]||c[g]||r;return n?a.createElement(m,o(o({ref:t},u),{},{components:n})):a.createElement(m,o({ref:t},u))}));function g(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var d=2;d<r;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},98231:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},metadata:function(){return l},toc:function(){return d},default:function(){return c}});var a=n(87462),i=n(63366),r=(n(67294),n(3905)),o=["components"],s={title:"Configuring Audit Events",sidebar_label:"Audit Events"},l={unversionedId:"config_audit_event",id:"config_audit_event",isDocsHomePage:!1,title:"Configuring Audit Events",description:"The Session Smart Router can be configured to maintain a history of several different class of events in its event log , which can subsequently be used to support compliance audits, forensics on network issues related to configuration (misapplied or otherwise), and traceability. This document covers:",source:"@site/docs/config_audit_event.md",sourceDirName:".",slug:"/config_audit_event",permalink:"/docs/config_audit_event",version:"current",lastUpdatedAt:1638570597,formattedLastUpdatedAt:"12/3/2021",sidebar_label:"Audit Events",frontMatter:{title:"Configuring Audit Events",sidebar_label:"Audit Events"},sidebar:"docs",previous:{title:"Configuration Element Reference",permalink:"/docs/config_reference_guide"},next:{title:"Dynamic Host Configuration Protocol (DHCP)",permalink:"/docs/config_dhcp"}},d=[{value:"Event Types",id:"event-types",children:[{value:"Traffic Events",id:"traffic-events",children:[]},{value:"Administration Events",id:"administration-events",children:[]},{value:"System Events",id:"system-events",children:[]},{value:"Alarm Events",id:"alarm-events",children:[]},{value:"Provisioning Events",id:"provisioning-events",children:[]}]},{value:"Basic Configuration",id:"basic-configuration",children:[]},{value:"Sample Configuration",id:"sample-configuration",children:[{value:"Enable Basic Audit Logging",id:"enable-basic-audit-logging",children:[]},{value:"Storing Events for Short Durations",id:"storing-events-for-short-durations",children:[]},{value:"Sending Traffic Events to a Syslog Server",id:"sending-traffic-events-to-a-syslog-server",children:[]}]},{value:"Viewing the Audit Log",id:"viewing-the-audit-log",children:[]}],u={toc:d};function c(e){var t=e.components,n=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The Session Smart Router can be configured to maintain a history of several different class of events in its ",(0,r.kt)("em",{parentName:"p"},"event log")," , which can subsequently be used to support compliance audits, forensics on network issues related to configuration (misapplied or otherwise), and traceability. This document covers:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Types of events available on the router"),(0,r.kt)("li",{parentName:"ul"},"Enabling the Audit events (using the PCLI or the GUI)"),(0,r.kt)("li",{parentName:"ul"},"Using the Event Viewer in the GUI")),(0,r.kt)("h2",{id:"event-types"},"Event Types"),(0,r.kt)("p",null,"The events generated by the router are classified into the following categories:"),(0,r.kt)("h3",{id:"traffic-events"},"Traffic Events"),(0,r.kt)("p",null,"Traffic events are generated as sessions as created on the router. These include details such as the protocol, source address, source port, destination address and destination port. In addition, the success or failure status along with a reason code for failure cases are included in the event."),(0,r.kt)("h3",{id:"administration-events"},"Administration Events"),(0,r.kt)("p",null,"Various administration actions performed by a user such as SSH login generate this category of events. The events contain the details about the user action, whether or not the action was permitted, and the reason for any failures."),(0,r.kt)("h3",{id:"system-events"},"System Events"),(0,r.kt)("p",null,"Various system level events such as service and process restarts are generated by this event category. The details include information about the user and details about the underlying action."),(0,r.kt)("h3",{id:"alarm-events"},"Alarm Events"),(0,r.kt)("p",null,"All the 128T alarms generate an add event when the alarm is raised and a clear event when the alarm is cleared. The alarm events can be used to view the history of the events associated with the alarms. The alarm events are implicit events and cannot be disabled via configuration. More details on alarms and events can be found ",(0,r.kt)("a",{parentName:"p",href:"/docs/events_overview"},"here")," "),(0,r.kt)("h3",{id:"provisioning-events"},"Provisioning Events"),(0,r.kt)("p",null,"The provisioning events are generated for software download and upgrades as well as for configuration changes that are processed on the router. For configuration changes the event contains a diff of the configuration change that triggered the event. These are implicit events and cannot be disabled via configuration."),(0,r.kt)("h2",{id:"basic-configuration"},"Basic Configuration"),(0,r.kt)("p",null,"The configuration for audit logging is performed within the ",(0,r.kt)("inlineCode",{parentName:"p"},"system > audit")," branch within a ",(0,r.kt)("inlineCode",{parentName:"p"},"router")," hierarchy. In most cases, the only configuration required for enabling audit logging is adding it to the ",(0,r.kt)("inlineCode",{parentName:"p"},"router")," element for your Authority's conductor. For cases where a 128T router is not managed by a conductor, its audit logging configuration is similarly added to the ",(0,r.kt)("inlineCode",{parentName:"p"},"system > audit")," branch of its ",(0,r.kt)("inlineCode",{parentName:"p"},"router")," hierarchy."),(0,r.kt)("p",null,"128T version 5.1.0 introduces capabilities to provide additional control over persistence and storage duration of the various events listed above. The table below shows the various configuration options and the corresponding behavior pre- and post- 5.1.0 software."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"name"),(0,r.kt)("th",{parentName:"tr",align:null},"type"),(0,r.kt)("th",{parentName:"tr",align:null},"available version"),(0,r.kt)("th",{parentName:"tr",align:null},"default"),(0,r.kt)("th",{parentName:"tr",align:null},"description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"retention"),(0,r.kt)("td",{parentName:"tr",align:null},"duration"),(0,r.kt)("td",{parentName:"tr",align:null},"5.1.0"),(0,r.kt)("td",{parentName:"tr",align:null},"180 days"),(0,r.kt)("td",{parentName:"tr",align:null},"How long to persist the events listed above.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"traffic > enabled"),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},"all"),(0,r.kt)("td",{parentName:"tr",align:null},"false"),(0,r.kt)("td",{parentName:"tr",align:null},"Enable/disable the generation of traffic events.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"traffic > persist"),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},"5.1.0"),(0,r.kt)("td",{parentName:"tr",align:null},"false"),(0,r.kt)("td",{parentName:"tr",align:null},"If enabled, whether or not to persist the events to the local storage for the configured retention duration.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"administration > enabled"),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},"all"),(0,r.kt)("td",{parentName:"tr",align:null},"true"),(0,r.kt)("td",{parentName:"tr",align:null},"Enable/disable the generation of administration events.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"administration > persist"),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},"5.1.0"),(0,r.kt)("td",{parentName:"tr",align:null},"true"),(0,r.kt)("td",{parentName:"tr",align:null},"If enabled, whether or not to persist the events to the local storage for the configured retention duration.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"system > enabled"),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},"all"),(0,r.kt)("td",{parentName:"tr",align:null},"true"),(0,r.kt)("td",{parentName:"tr",align:null},"Enable/disable the generation of system events.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"system > persist"),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},"5.1.0"),(0,r.kt)("td",{parentName:"tr",align:null},"true"),(0,r.kt)("td",{parentName:"tr",align:null},"If enabled, whether or not to persist the events to the local storage for the configured retention duration.")))),(0,r.kt)("h2",{id:"sample-configuration"},"Sample Configuration"),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Configuration not related to audit logging has been filtered out for illustrative purposes."))),(0,r.kt)("h3",{id:"enable-basic-audit-logging"},"Enable Basic Audit Logging"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"config\n    authority\n        router  my-router\n            name    my-router\n            system\n                audit\n                    administration\n                        enabled  true\n                    exit\n                exit\n            exit\n        exit\n    exit\nexit\n")),(0,r.kt)("h3",{id:"storing-events-for-short-durations"},"Storing Events for Short Durations"),(0,r.kt)("p",null,"By default the 128T routers store all events except traffic events for up to six months on the local disk. In some cases it might be desirable to shorten the length of time for these events to minimize the impact on the local disk. This can be accomplished as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"config\n    authority\n        router my-router\n            system\n                audit\n                    retention 1d\n                exit\n            exit\n        exit\n    exit\nexit\n")),(0,r.kt)("p",null,"In the above example all the events available on the 128T router are only retained for one day. The ",(0,r.kt)("inlineCode",{parentName:"p"},"retention")," is of type duration and can take values in hours and days; for example, 24h or 1d."),(0,r.kt)("h3",{id:"sending-traffic-events-to-a-syslog-server"},"Sending Traffic Events to a Syslog Server"),(0,r.kt)("p",null,"Traffic events are disabled and not persisted by default because they can produce a large volume of data. However, in situations where the traffic events need to be sent off-box for storage, such as a syslog server, they can be enabled but not persisted to local storage. The following snippet provides an example of that configuration."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"config\n    authority\n        router my-router\n            system\n                audit\n                    traffic\n                        enabled true\n                        persist false\n                    exit\n                exit\n            exit\n        exit\n    exit\n")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"For in-depth explanations of how to configure the Monitoring Agent to handle audit events, refer to the ",(0,r.kt)("a",{parentName:"p",href:"/docs/plugin_monitoring_agent"},"128T Monitoring Agent")," documentation."))),(0,r.kt)("h4",{id:"basic-input-and-output-configurations"},"Basic Input and Output Configurations"),(0,r.kt)("p",null,"Use the following information to create basic Input and Output configurations."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Create an event collector input to capture the traffic events. An example input configuration is shown below.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-toml"},'[[inputs.t128_events]]\n    # It is a best practice to specify a custom index file location\n    index-file = "/var/lib/128t-monitoring/state/events.index"\n    topic = "events"\n    [inputs.t128_events.tagpass]\n        type = ["traffic"]\n')),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Define an output for where the events are to be sent. In this example, the events are sent to a syslog server.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-toml"},'[[outputs.syslog]]\n  address = "udp://<ip>:514"\n  default_sdid = "128T"\n')),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"The input and output are placed in the input and output directories respectively and tied together by the ",(0,r.kt)("a",{parentName:"li",href:"/docs/plugin_monitoring_agent#configuration"},"Monitoring Agent configuration"),". A sample monitoring agent configuration:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"enabled: true\n\ninputs:\n  - name: traffic-events\noutputs:\n  - name: my-syslog\n\n")),(0,r.kt)("p",null,"Once these configurations are in place, starting the Monitoring Agent will send events to syslog. "),(0,r.kt)("h2",{id:"viewing-the-audit-log"},"Viewing the Audit Log"),(0,r.kt)("p",null,"To view the contents of the audit log via the GUI (on the Conductor or Router as configured above)."),(0,r.kt)("p",null,"To view the contents of the audit log, navigate to the ",(0,r.kt)("strong",{parentName:"p"},"Tools")," page and choose ",(0,r.kt)("strong",{parentName:"p"},"Event History"),". The Event History viewer shows all of the events that this 128T has accumulated, including audit log events. Audit log events are of type ",(0,r.kt)("strong",{parentName:"p"},"ADMIN"),"; use the built-in filtering mechanism to limit the Event History search results to ADMIN type events."))}c.isMDXComponent=!0}}]);
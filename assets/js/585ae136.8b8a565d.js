"use strict";(self.webpackChunk_128t_docs=self.webpackChunk_128t_docs||[]).push([[9980],{3905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return h}});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(r),h=a,f=d["".concat(l,".").concat(h)]||d[h]||p[h]||o;return r?n.createElement(f,i(i({ref:t},u),{},{components:r})):n.createElement(f,i({ref:t},u))}));function h(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},35283:function(e,t,r){r.r(t),r.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return p}});var n=r(87462),a=r(63366),o=(r(67294),r(3905)),i=["components"],s={title:"DSCP Preservation",sidebar_label:"DSCP Preservation"},l=void 0,c={unversionedId:"config_dscp_preservation",id:"config_dscp_preservation",title:"DSCP Preservation",description:"DSCP values are commonly changed within network boundaries. In some situations it is important that the DSCP value received at the router are preserved through all SVR hops within the network. This feature allows the network administrator to preserve the original DSCP value across SVR hops.",source:"@site/docs/config_dscp_preservation.md",sourceDirName:".",slug:"/config_dscp_preservation",permalink:"/docs/config_dscp_preservation",draft:!1,tags:[],version:"current",lastUpdatedAt:1702666599,formattedLastUpdatedAt:"Dec 15, 2023",frontMatter:{title:"DSCP Preservation",sidebar_label:"DSCP Preservation"},sidebar:"docs",previous:{title:"Configuring DSCP Steering",permalink:"/docs/config_dscp_steering"},next:{title:"VRF Support",permalink:"/docs/config_vrf_learning"}},u={},p=[{value:"Configuration",id:"configuration",level:2},{value:"How it Works",id:"how-it-works",level:2},{value:"Handling HA Failover",id:"handling-ha-failover",level:3}],d={toc:p};function h(e){var t=e.components,r=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"DSCP values are commonly changed within network boundaries. In some situations it is important that the DSCP value received at the router are preserved through all SVR hops within the network. This feature allows the network administrator to preserve the original DSCP value across SVR hops."),(0,o.kt)("p",null,"When a new session is created, the DSCP value of the first packet received from the local LAN is recorded and included in the respective session's metadata. If DSCP values differ per packet within a session, the DSCP value from the first packet in the session will be used for each packet. This is different from traditional tunneled solutions where each packet is preserved in its entirety. "),(0,o.kt)("h2",{id:"configuration"},"Configuration"),(0,o.kt)("p",null,"When set to ",(0,o.kt)("inlineCode",{parentName:"p"},"true")," the ",(0,o.kt)("inlineCode",{parentName:"p"},"preserve-dscp")," command allows you to preserve dscp values that have been set in a service class or received on a LAN-Interface, over an SVR path. The default value is false. "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"authority my-network\n  router my-router\n    node router-node-1\n      device-interface 1\n        network-interface 1\n          preserve-dscp true\n")),(0,o.kt)("h2",{id:"how-it-works"},"How it Works"),(0,o.kt)("p",null,"In a network with an application or hardware that changes the value on the WAN and a session with a preserved value of 8, the value sent at each of the hops would be as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Client (DSCP: 8) -> SSR (DSCP: 8) -> WAN (DSCP: any) -> SSR (DSCP: 8) -> Server\n")),(0,o.kt)("p",null,"The reverse flow will do the same."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Server (DSCP: any) -> SSR (DSCP: any) -> WAN (DSCP: any) -> SSR (DSCP: 8) -> Client\n")),(0,o.kt)("p",null,"It is possible to enable this feature alongside ",(0,o.kt)("inlineCode",{parentName:"p"},"DSCP rewrite"),". When these features are combined, the value on the packet at ingress is recorded and included in the metadata as described above. However, when the packet enters the SVR session, it has its DSCP value rewritten based on the SSR\u2019s classification. When the packet egresses SVR, the value is restored to the original recorded value.\nTo use the example above with ",(0,o.kt)("inlineCode",{parentName:"p"},"rewrite-dscp")," enabled in the forward direction and a classification with a DSCP of 15:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Client (DSCP: 8) -> SSR (DSCP: 15) -> WAN (DSCP: any) -> SSR (DSCP:8) -> Server\n")),(0,o.kt)("h3",{id:"handling-ha-failover"},"Handling HA Failover"),(0,o.kt)("p",null,"In a situation where there is an HA failover, the DSCP value from the local LAN is recorded and compared against the previous value. If the values are different and the failover is on the ingress router, the new value is used. If the failover is on the egress router and the values are different, the known value from the ingress router is used."))}h.isMDXComponent=!0}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{116:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return a})),t.d(n,"metadata",(function(){return p})),t.d(n,"rightToc",(function(){return c})),t.d(n,"default",(function(){return u}));var o=t(2),r=t(6),i=(t(0),t(222)),a={title:"Configuring Dual PPPoE",sidebar_label:"Configuring Dual PPPoE"},p={unversionedId:"howto_config_PPPoE",id:"howto_config_PPPoE",isDocsHomePage:!1,title:"Configuring Dual PPPoE",description:"Configuration",source:"@site/docs/howto_config_PPPoE.md",slug:"/howto_config_PPPoE",permalink:"/docs/howto_config_PPPoE",version:"current",lastUpdatedAt:1621956596,sidebar_label:"Configuring Dual PPPoE",sidebar:"docs",previous:{title:"LTE and Dual LTE Configuration",permalink:"/docs/howto_lte"},next:{title:"Maintenance Mode",permalink:"/docs/howto_maintenance_mode"}},c=[{value:"Configuration",id:"configuration",children:[]},{value:"Reconnection Timer",id:"reconnection-timer",children:[]}],s={rightToc:c};function u(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(o.a)({},s,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("h3",{id:"configuration"},"Configuration"),Object(i.b)("p",null,"Support for multiple PPPoE interfaces on a single node is configured as follows."),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{}),"device-interface pppoe-dev-1\n    name pppoe-dev-1\n    type pppoe\n    target-interface dpdk3\n    pppoe\n        user-name user1\n        password passw0rd1\n        authentication-protocol chap\n    exit\n    network-interface pppoe-intf-1\n        name pppoe-intf-1\n        source-nat true\n    exit\nexit\ndevice-interface pppoe-dev-2\n    name pppoe-dev-2\n    type pppoe\n    target-interface dpdk4\n    pppoe\n        user-name user2\n        password passw0rd2\n        authentication-protocol chap\n    exit\n    network-interface pppoe-intf-2\n        name pppoe-intf-2\n        source-nat true\n    exit\nexit\n")),Object(i.b)("p",null,"In the event of a disconnection, the ",Object(i.b)("inlineCode",{parentName:"p"},"failure")," section of ",Object(i.b)("inlineCode",{parentName:"p"},"show device-interface")," displays the ",Object(i.b)("inlineCode",{parentName:"p"},"ppd-exit-code")," and the ",Object(i.b)("inlineCode",{parentName:"p"},"ppd-exit-reason"),". The example below shows an authentication failure."),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{}),"*admin@test1.Fabric128# show device-interface name pppoe-new\nFri 2020-05-15 17:29:02 UTC\n=========================================================================\n test1:pppoe-new\n=========================================================================\n Type:                pppoe\n Forwarding:          true\n Mode:                host\n MAC Address:         4e:b1:12:11:9e:fd\n Admin Status:        up\n Operational Status:  down\n Redundancy Status:   non-redundant\n Speed:               0\n Duplex:              unknown\n in-octets:                        2942\n in-unicast-pkts:                    44\n in-errors:                           0\n out-octets:                       1050\n out-unicast-pkts:                   25\n out-errors:                          0\n Error:\n   PPPoE State:\n     connection-status:ppp2 does not exist\n     failure:\n       attempt:       2\n       last-failure-time:Fri May 15 17:28:17 2020\n       next-retry-time:Fri May 15 17:33:17 2020\n       pppd-exit-code:19\n       pppd-exit-reason:We failed to authenticate ourselves to the peer.\nCompleted in 0.12 seconds \n")),Object(i.b)("h3",{id:"reconnection-timer"},"Reconnection Timer"),Object(i.b)("p",null,"In situations where there are several connection attempts (for example, consecutive authenication failures), logic is used to back off the reconnect attempts on specific failure codes. Failure codes and the intervals between reconnection attempts are configurable. Use the JSON file ",Object(i.b)("inlineCode",{parentName:"p"},"/var/lib/128technology/pppoe/{ppp<giid>}.init")," to specify the exit codes and adjust interval times. The defaults are shown in the example below. "),Object(i.b)("p",null,"After the first authentication failure (for pppd exit code 19), the intervals between each subsequent reconnect attempt will be 60s (1min), 300s (5min), 600s (10min), 1200s (20min), 2400s (40min), and 3600s (1hr). If the reconnect attempts continue after the sixth failure, the same interval time is used (3600s)."),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{}),'{\n    "backoff-intervals": [60, 300, 600, 1200, 2400, 3600],\n    "pppd-exit-codes": [19],\n}\n')),Object(i.b)("h4",{id:"connection-status-using-linux"},"Connection Status using Linux"),Object(i.b)("p",null,"When the 128T is not running and the PPPoE connection is managed by linux, a ",Object(i.b)("inlineCode",{parentName:"p"},"pppoe-state")," utility is used to return the connection status. To use the utility, run ",Object(i.b)("inlineCode",{parentName:"p"},"pppoe-state ppp<giid>")," as shown below."),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{}),'[root@t189-dut1 ~]# pppoe-state ppp2\n{\n    "PPPoE State": {\n        "RX-OK": "7",\n        "TX-OVR": "0",\n        "Iface": "ppp2",\n        "TX-OK": "7",\n        "prefix": "32",\n        "MTU": "1492",\n        "RX-ERR": "0",\n        "TX-DRP": "0",\n        "TX-ERR": "0",\n        "RX-DRP": "0",\n        "address": "172.16.100.2",\n        "peer": "172.16.100.1",\n        "Flags": "PPP, RUNNING, PROMISCUOUS, UP, NOARP",\n        "RX-OVR": "0"\n    }\n}\n')))}u.isMDXComponent=!0},222:function(e,n,t){"use strict";t.d(n,"a",(function(){return l})),t.d(n,"b",(function(){return b}));var o=t(0),r=t.n(o);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=r.a.createContext({}),u=function(e){var n=r.a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):p(p({},n),e)),t},l=function(e){var n=u(e.components);return r.a.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},f=r.a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,a=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),l=u(t),f=o,b=l["".concat(a,".").concat(f)]||l[f]||d[f]||i;return t?r.a.createElement(b,p(p({ref:n},s),{},{components:t})):r.a.createElement(b,p({ref:n},s))}));function b(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,a=new Array(i);a[0]=f;var p={};for(var c in n)hasOwnProperty.call(n,c)&&(p[c]=n[c]);p.originalType=e,p.mdxType="string"==typeof e?e:o,a[1]=p;for(var s=2;s<i;s++)a[s]=t[s];return r.a.createElement.apply(null,a)}return r.a.createElement.apply(null,t)}f.displayName="MDXCreateElement"}}]);
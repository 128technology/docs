<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-167298415-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="128T Docs" href="/opensearch.xml"><title data-react-helmet="true">Configuring In-Memory Metrics | 128T Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/config_in-memory_metrics"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Configuring In-Memory Metrics | 128T Docs"><meta data-react-helmet="true" name="description" content="Support for persisting in-memory 128T metrics allows you historical access to longer term system measurements. The feature also provides greater control over which combinations of those in-memory metrics should be persisted and for how long."><meta data-react-helmet="true" property="og:description" content="Support for persisting in-memory 128T metrics allows you historical access to longer term system measurements. The feature also provides greater control over which combinations of those in-memory metrics should be persisted and for how long."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.128technology.com/docs/config_in-memory_metrics"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/config_in-memory_metrics" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/config_in-memory_metrics" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.9ceca0cd.css">
<link rel="preload" href="/assets/js/runtime~main.f3773427.js" as="script">
<link rel="preload" href="/assets/js/main.1bde77d2.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">Session Smart</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.128technology.com/home" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Interchange<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://www.128technology.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deployment Considerations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Installation Process</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cloud Installations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Supporting Information - Appendix</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Administration</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Configuration</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_basics">Configuration Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_access_mgmt">Access Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_asset_connection_resiliency">Asset Connection Resiliency</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_bgp">Configuring BGP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ospf">OSPF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_vrf_learning">VRF Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_reference_guide">Element Reference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_audit_event">Audit Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dhcp">DHCP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dns_proxy">DNS Proxy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ldap">LDAP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_management_over_forwarding">Management over Forwarding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_domain-based_web_filter">Configuring Domain-based Web Filtering/Routing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_EthoSVR">Configuring Ethernet Over Secure Vector Routing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_service_health">Service Health Learning and Fault Avoidance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_gre_tunnel">Native GRE Tunnels</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/config_in-memory_metrics">In-Memory Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_wan_assurance">Configuring WAN Assurance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_transport_encryption">Transport Based Encryption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dscp_steering">Configuring DSCP Steering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_nat">NAT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_rate_limiting">Rate Limiting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_RBAC">Configuring Role-Based Access Control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_snmp">SNMP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_snmp_metrics">SNMP: User defined metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_static_hostname_mapping">Static Hostname Mappings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_STEP">Configuring Service and Topology Exchange Protocol (STEP)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_tenants">Tenants</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_templates">Configuration Templates</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">High Availability</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Security</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">How To</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Troubleshooting</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Events</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Best Practices</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CLI Reference</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Installer/Initializer Reference</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Plugins</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">REST APIs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Release Notes</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Configuring In-Memory Metrics</h1></header><p>Support for persisting in-memory 128T metrics allows you historical access to longer term system measurements. The feature also provides greater control over which combinations of those in-memory metrics should be persisted and for how long.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="metrics-profile">Metrics Profile<a aria-hidden="true" class="hash-link" href="#metrics-profile" title="Direct link to heading">​</a></h2><p>To use In-Memory Metrics, specify the metrics intended for persistence as part of a Metrics Profile. Profiles are configured at the Authority level and referenced by the relevant routers. Each Profile specifies a number of metrics and the desired parameter filters.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="metrics">Metrics<a aria-hidden="true" class="hash-link" href="#metrics" title="Direct link to heading">​</a></h3><p>An individual metric indicates one 128T metric to be part of the profile. Each profile must contain at least one metric to be valid. The metric’s ID matches the description in the REST API/Swagger documentation for the statistic.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="filters">Filters<a aria-hidden="true" class="hash-link" href="#filters" title="Direct link to heading">​</a></h3><p>Filters are optional, but are important in their ability to limit the resources consumed by the metrics subsystem. Filters allow you to indicate your interest in a particular interface or peer-path without the necessity to persist all of the instances of the metric. If no filters are indicated, all instances are persisted.</p><p>When using filters, the parameters and values must be relevant for all metrics in the profile. If one of the metrics does not have the specified parameter, or has none of the values, that metric will produce no data.</p><p>Example of Simple Grouping with Filtering:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        metrics-profile  internet-reachability-metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name    internet-reachability-metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            metric  /stats/highway/destination-reachability/icmp/time-to-establishment/max</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                id           /stats/highway/destination-reachability/icmp/time-to-establishment/max</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                description  &quot;Max ICMP time to establish&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            metric  /stats/highway/destination-reachability/tcp/time-to-establishment/max</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                id           /stats/highway/destination-reachability/tcp/time-to-establishment/max</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                description  &quot;Max TCP time to establish&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            metric  /stats/highway/destination-reachability/icmp/time-to-establishment/mean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                id           /stats/highway/destination-reachability/icmp/time-to-establishment/mean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                description  &quot;Avg ICMP time to establish&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            metric  /stats/highway/destination-reachability/tcp/time-to-establishment/mean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                id           /stats/highway/destination-reachability/tcp/time-to-establishment/mean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                description  &quot;Avg TCP time to establish&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            filter  service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                parameter  service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                value      internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            filter  traffic-class</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                parameter  traffic-class</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                value      best-effort</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>When the above profile is referenced by a router, the various reachability metrics are persisted but only for the <code>internet</code> service and <code>best-effort</code> traffic-class. These metrics are available as time-series from the GraphQL API or in the GUI.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="profile-references">Profile References<a aria-hidden="true" class="hash-link" href="#profile-references" title="Direct link to heading">​</a></h3><p>Once a profile is configured on the Authority, it is availble to the routers, and each router may reference any number of relevant profiles. With each reference to a profile, the router configuration must specify the retention for the profile. The Profile Retention value determines how long the profile’s metrics are retained.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="profile-retention">Profile Retention<a aria-hidden="true" class="hash-link" href="#profile-retention" title="Direct link to heading">​</a></h3><p>Profile Retention can be configured as any of four values: <strong>in-memory</strong>, <strong>short</strong>, <strong>intermediate</strong>, and <strong>long</strong>. </p><p>The current implementation of the <strong>in-memory</strong> retention value is limited. </p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Metrics cascade from one retention value to the next; the use of any one value implies all values before it are also in effect. For example, using <strong>intermediate</strong> implies that <strong>short</strong> is also used.</p></div></div><p>Configuring retention values for persisted metrics helps manage the amount of data stored over time. Three settings are configurable:</p><ul><li>short</li><li>intermediate</li><li>long</li></ul><p>Each setting has three configuration fields.</p><ul><li><strong>enabled</strong> (true/false): Activates/deactivates the retention setting, as well as the retention value(s) that follow. For example, disabling intermediate retention also disables long retention. Similarly, disabling the short retention disables all retention.</li><li><strong>interval</strong>: Time between data points for retention. </li><li><strong>duration</strong>: How long the data will be stored before being dropped from the data store. </li></ul><p>Retention Defaults</p><table><thead><tr><th>Retention</th><th>State</th><th>Interval</th><th>Duration</th></tr></thead><tbody><tr><td>short</td><td>Enabled: true</td><td>5 seconds</td><td>1 hour</td></tr><tr><td>intermediate</td><td>Enabled: true</td><td>5 minutes</td><td>1 day</td></tr><tr><td>long</td><td>Enabled: true</td><td>1 hour</td><td>180 days</td></tr></tbody></table><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Increasing the retention duration and/or decreasing the interval from the defaults has the potential to impact system overhead and should be carefully considered.</p></div></div><p>The following example shows metrics retention configured only for short retention with the default values:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">configure</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router        MyRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name   MyRouter </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                system</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        retention </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            short</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                enabled true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                interval 5s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                duration 1h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            intermediate </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                enabled false  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                interval 5m</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                duration 1d</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            long</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                enabled false  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                interval 1h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                duration 180d</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_31ik" id="example-profile">Example Profile<a aria-hidden="true" class="hash-link" href="#example-profile" title="Direct link to heading">​</a></h4><p>The following example configuration takes metrics specified in the <code>internet-reachability-metrics</code> profile and stores them through the <strong>intermediate</strong> retention time period.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">configure</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router           MyRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name MyRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            system</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    profile  internet-reachability-metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name       internet-reachability-metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        retention  intermediate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="in-memory-metrics-sample-configuration">In-Memory Metrics Sample Configuration<a aria-hidden="true" class="hash-link" href="#in-memory-metrics-sample-configuration" title="Direct link to heading">​</a></h3><p>The following example provides a sample configuration that makes use of several aspects of the Metrics Profile feature.</p><ul><li>Multiple metrics in the same profile</li><li>Filtered profile (peer-metrics)</li><li>Unfiltered profile (events)</li><li>Multiple profiles for the same router (MyRouter)</li><li>Different retention targets for different profiles (MyRouter)</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        metrics-profile  peer-metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name    peer-metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            metric  /stats/bfd/peer-path/async/sent/success</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                id  /stats/bfd/peer-path/async/sent/success</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            metric  /stats/bfd/peer-path/async/received/miss</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                id  /stats/bfd/peer-path/async/received/miss</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            filter  peer-name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                parameter  peer-name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                value      MyOtherRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        metrics-profile  events</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name    events</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            metric  /stats/audit/events/produced</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                id  /stats/audit/events/produced</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router           MyRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name MyRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            system</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    profile  events</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name       events</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        retention  long</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    profile  peer-metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name       peer-metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        retention  short</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router           MyConductor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name MyConductor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            system</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    profile  events</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name       events</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        retention  long</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                     exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-11-18T20:15:10.000Z">11/18/2021</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/config_gre_tunnel"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->Native GRE Tunnels</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/config_wan_assurance"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuring WAN Assurance<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#metrics-profile" class="table-of-contents__link toc-highlight">Metrics Profile</a><ul><li><a href="#metrics" class="table-of-contents__link toc-highlight">Metrics</a></li><li><a href="#filters" class="table-of-contents__link toc-highlight">Filters</a></li><li><a href="#profile-references" class="table-of-contents__link toc-highlight">Profile References</a></li><li><a href="#profile-retention" class="table-of-contents__link toc-highlight">Profile Retention</a></li><li><a href="#in-memory-metrics-sample-configuration" class="table-of-contents__link toc-highlight">In-Memory Metrics Sample Configuration</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f3773427.js"></script>
<script src="/assets/js/main.1bde77d2.js"></script>
</body>
</html>
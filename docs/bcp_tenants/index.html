<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">Tenancy Design | SSN Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/bcp_tenants"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Tenancy Design | SSN Docs"><meta data-react-helmet="true" name="description" content="The tenant is one of the foundational data model elements within the 128T Session Smart router, and represents a consumer of network services. Tenancy is the logical partitioning of a network’s resources, done in the interest of restricting access to network services to only the users and groups for which they’re intended."><meta data-react-helmet="true" property="og:description" content="The tenant is one of the foundational data model elements within the 128T Session Smart router, and represents a consumer of network services. Tenancy is the logical partitioning of a network’s resources, done in the interest of restricting access to network services to only the users and groups for which they’re intended."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.128technology.com/docs/bcp_tenants"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/bcp_tenants" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/bcp_tenants" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.21b25f22.css">
<link rel="preload" href="/assets/js/runtime~main.5c6849e0.js" as="script">
<link rel="preload" href="/assets/js/main.310752e1.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Session Smart</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Session Smart Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation_quickstart_aws">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation_installer">Supporting Install Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/config_basics">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bcp_att_avpn_configuration">AT&amp;T AVPN Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bcp_using_128T_as_ntp_server">Branch NTP Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bcp_conductor_deployment">Conductor Deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bcp_per-adjacency_traffic_engineering">Per Adjacency Traffic Engineering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bcp_qos_msft_expressroute">ExpressRoute QoS Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bcp_lte_peering">LTE Peering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bcp_monitoring_headends">Monitoring Head End Routers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bcp_salt_pillars">Saltstack at Scale With 128T</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bcp_sdwan_design_guide">SD-WAN Design Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bcp_service_and_service_policy_design">Service and Service Policy Design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/bcp_service-policy_defaults">Service Policy Baseline Defaults</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/bcp_tenants">Tenancy Design</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/plugin_intro">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/release_notes_128t_5.6">Release Notes</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Tenancy Design</h1></header><p>The <em>tenant</em> is one of the foundational data model elements within the 128T Session Smart router, and represents a consumer of network <em>services</em>. Tenancy is the logical partitioning of a network’s resources, done in the interest of restricting access to network services to only the users and groups for which they’re intended.</p><p>This document provides an overview of tenancy in the 128T router, how it is configured, and provides guidance for modeling the segmentation of a network using the 128T&#x27;s data modeling language.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="intended-audience">Intended Audience<a class="hash-link" href="#intended-audience" title="Direct link to heading">​</a></h2><p>This document is intended for network architects, to assist them in the fomulation of a design for a tenancy structure in their network. It is also intended as a reference guide for network administrators and network operations personnel, to help understand the principles behind 128T&#x27;s tenancy.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">​</a></h2><p>Tenancy is the logical partitioning of a network’s resources, done in the interest of restricting access to network services to only the users and groups for which they’re intended. Tenants are defined within an <em>authority</em>, and span each router within that authority. I.e., the services made available to that tenant can exist anywhere within the authority, irrespective of router, and the 128T solution propagates routing information throughout the tenant to advertise the service’s availability. At their core, tenants are intended to provide complete network segregation.</p><p>An example for how tenants could be used would be segregating two distinct user populations within an organization; e.g., &quot;developers&quot; from &quot;administrators.&quot; Another example would be multiple customers within the AWS infrastructure; in this case, each tenant would likely be organized by customer.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="basic-tenant-workflow">Basic Tenant Workflow<a class="hash-link" href="#basic-tenant-workflow" title="Direct link to heading">​</a></h3><p>To segment your network using tenants, you follow a simple, three step workflow:</p><ol><li>Define the tenants for your network. Strategies for how to define tenants are described later in this document, in the <em>Tenancy Strategies</em> section.</li><li>Assign the rules for how a router identifies inbound traffic as belonging to a tenant. This is described in the <em>Tenant Configuration</em> section below.</li><li>Selectively allow or deny tenants to your network&#x27;s <em>services</em> using <code>access-control</code> stanzas</li></ol><p>By following this workflow, you&#x27;ll grant access to your network&#x27;s services only to those that should be allowed access. This is the basis of 128 Technology&#x27;s approach to <em>Zero Trust Networking</em>: every <code>service</code> expressly identifies who (via tenancy) will have a route to it.</p><p>But the 128T approach to Zero Trust Networking does not make configuring all possible sources and destinations of network traffic onerous; through the use of <em>CIDR Services</em> (described in the <em>Services and Service Policies</em> documentation, and <em>Tenant Hierarchies</em> (described below), you can jumpstart your network implementation right away.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="tenant-assignment">Tenant Assignment<a class="hash-link" href="#tenant-assignment" title="Direct link to heading">​</a></h3><p>As new sessions arrive at a 128T router, the router will attempt to classify the source of that session request into one of its configured tenants. This classification is done in one of three ways:</p><ol><li>The session request arrives on an interface that has been designated as exclusively belonging to a single tenant; this is accomplished using the <em>per-interface tenancy</em> approach, described below</li><li>The session request arrives on an interface from a prefix that has been specified as belonging to a tenant (i.e., a single interface can be partitioned into separate tenants based upon subnet mask); this is accomplished using the <em>per-neighborhood tenancy</em> approach, described below</li><li>The session request arrives containing 128T metadata, supplied by an adjacent instance of the 128T router, which has already classified this packet as belonging to a specific tenant</li></ol><p>Should none of these result in a definitive determination on the tenant of the source of this session request, the session is associated with the <em>global tenant</em> (see the section on &quot;Special Tenants&quot; for more information on the global tenant). Once the tenant has been identified – either as a specific tenant, or as the global tenant – this acts as a filter into the 128T router’s FIB. Only the routes associated with that tenant are available to that user group. While this somewhat resembles the way a legacy router uses VRFs to create separate RIBs and FIBs, the segment by <em>tenant</em> is pervasive among all routers within an Authority by design, and is applied ubiquitously among all varieties of networks: public IP space, private, cloud, IPv4, IPv6, etc.</p><div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="viewing-a-routers-tenancy">Viewing a Router&#x27;s Tenancy<a class="hash-link" href="#viewing-a-routers-tenancy" title="Direct link to heading">​</a></h4><p>The PCLI command <code>show tenant members</code> is used to display the rules for tenant assignment on any router. For each interface on the target router you will see the tenant assignments based on the <em>source address</em> of the inbound packets.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.branch1# show tenant members</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Sun 2020-03-22 11:44:48 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node: node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============ ========= ============== ================= ================== =================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Device I/F   VLAN ID   Network I/F    Network I/F IP    Source IP Prefix   Tenant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============ ========= ============== ================= ================== =================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       eno1         0   internode      169.254.255.0     169.254.255.1/32   &lt;fabric&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       eno2        10   lan10          10.20.20.1        0.0.0.0/0          pos.acme</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       eno2        20   lan20          172.20.20.1       0.0.0.0/0          voice.acme</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       eno3         0   wan1           198.51.100.2      0.0.0.0/0          &lt;global&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     kni254         0   controlKniIf   169.254.127.126   0.0.0.0/0          _internal_</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="tenant-hierarchies">Tenant Hierarchies<a class="hash-link" href="#tenant-hierarchies" title="Direct link to heading">​</a></h3><p>The 128T data model includes the ability to construct hierarchical tenancies, where a “parent” tenant may have one or more “child” tenants. This hierarchical tenant model allows administrators to create arbitrary groups of tenants and apply policies to that group as a whole, rather than piecemeal. Creating groups of tenants affords the maximum flexibility and minimizes the amount of redundant configuration, as well as improving overall readability of the configuration.</p><p>The 128T system uses a dotted notation naming scheme for grouping hierarchies of tenants. For example, a tenant named <code>engineering.128technology</code> is a child of the tenant <code>128technology</code>. Wherever other configuration objects refer to tenants, the effective scope can be controlled by specifying only a portion of a tenant’s name. For example, a service that specifies <code>128technology</code> within an <code>access-policy</code> is available to <code>engineering.128technology</code>, <code>finance.128technology</code>, and <code>128technology</code>. However, the policy is applied in only one direction, from parent to child: a service accessible only to <code>engineering.128technology</code> will not be available to members of the general <code>128technology</code> tenant.</p><p>Tenant hierarchies are configured in virtually every 128T deployment. The most common implementation is to configure a top level enterprise tenant; this lets administrators easily grant access to corporate services to all tenants with a single <code>access-policy</code> assignment.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>It is not necessary for an administrator to explicitly create a “parent” tenant prior to creating a “child” tenant (the UI will perform validation and warn an administrator that their action of creating a child tenant will also create a parent tenant). The UI will prevent the deletion of a parent tenant if it has any child tenants.</p></div></div><p>Tenant hierarchies can have an unlimited number of tiers, although it is generally unnecessary to have more than two or three levels of parentage. For recommendations on tenancy and organizational tips, refer to the Tenant Strategies section below.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="tenant-configuration">Tenant Configuration<a class="hash-link" href="#tenant-configuration" title="Direct link to heading">​</a></h2><p>Each tenant configured on a 128T conductor is propagated to all managed assets, irrespective of whether that router has any configuration (via interface definition or neighborhood definition) to assign that tenant to inbound traffic. This is because a 128T router can receive Secure Vector Routing (SVR) sessions from a peer, identifying the origin as belonging to a permissible tenant.</p><p>For example, a branch router may segment its traffic into several, well-known tenants: employee workstations are in a tenant named <code>workstations.acme</code> and their VoIP phones are in a tenant named <code>voice.acme</code>. There are no employee workstations or VoIP phones at the corporate data center, but the head end router there needs to understand how to forward sessions for these traffic segments. Thus the head end is aware of the existence of these tenants for access control and traffic forwarding purposes.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="per-interface-tenancy">Per-interface Tenancy<a class="hash-link" href="#per-interface-tenancy" title="Direct link to heading">​</a></h3><p>Assigning a tenant to a <code>network-interface</code> will cause all traffic arriving on that interface to be considered part of the tenant. Consider the following configuration fragment:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.bernstein# show conf run auth router branch1 node node1 device lan network-interface lan20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router  branch1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name  branch1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            node  node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name              node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface  lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  lan20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name       lan20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        global-id  6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        vlan       20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        tenant     voice.acme</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address    172.20.20.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     172.20.20.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="per-neighborhood-tenancy">Per-neighborhood Tenancy<a class="hash-link" href="#per-neighborhood-tenancy" title="Direct link to heading">​</a></h3><p>Assigning tenant membership using neighborhoods requires two distinct, coordinated configuration elements. First, you define one or more neighborhoods within a network-interface. (Conceptually, a &quot;neighborhood&quot; is a named, Layer 3 routed network.) Second, within one or more <code>tenant</code> configurations you define which prefixes in that neighborhood are to be considered &quot;members&quot; of that tenant.</p><p>Here is a basic neighborhood configuration, as seen on our branch router:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.bernstein# show config run auth router branch1 node node1 device wan network-interface wan1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router  branch1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name  branch1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            node  node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name              node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface  wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  wan1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                   wan1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        global-id              3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        description            &quot;Broadband internet access&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        conductor              true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        neighborhood           internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name               internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            peer-connectivity  bidirectional</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            topology           spoke</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vector             broadband</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        inter-router-security  internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        source-nat             true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        dhcp                   v4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In this example we&#x27;ve used the neighborhood name &quot;internet&quot; on the WAN interface of the branch router. (This is a common, and recommended neighborhood name with 128T devices attached to the public internet.)</p><p>Here are several <code>tenant</code> definitions to illustrate how to define tenancy within that neighborhood:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tenant  CX.Oceania</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name         CX.Oceania</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            description  &quot;Christmas Island&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            member       internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                neighborhood  internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       5.62.60.89/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       5.62.60.90/31</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       5.62.62.85/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       5.62.62.86/31</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       45.12.70.54/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       45.12.71.54/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       104.224.54.0/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       203.119.12.0/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       203.119.84.0/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       203.171.248.0/23</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       203.171.250.0/25</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       203.171.251.0/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tenant  VA.Europe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name         VA.Europe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            description  &quot;Vatican City&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            member       internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                neighborhood  internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       5.62.61.208/30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       5.62.63.197/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       5.62.63.198/31</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       31.220.29.160/27</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       45.12.70.237/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       45.12.70.251/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       45.12.71.237/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       45.42.143.0/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       45.61.44.128/25</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       46.36.200.0/22</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       57.79.216.0/21</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       57.79.224.0/20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       176.31.103.102/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       185.17.220.0/22</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       185.152.68.0/22</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       185.238.190.250/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       193.43.102.0/23</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       193.43.128.0/22</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       194.50.92.0/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address       212.77.0.0/19</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We&#x27;ve created two tenants, <code>CX.Oceania</code> and <code>VA.Europe</code>, and within each tenant&#x27;s <code>member</code> block we&#x27;ve indicated that within the neighborhood (router Layer 3 network) named <code>internet</code>, the sets of IP addresses that are allocated for these two countries.</p><p>Thus, if an inbound session arrives from the IP address 212.77.0.128 on an interface that is &quot;in&quot; the <code>internet</code> neighborhood, it will be considered to be part of the <code>VA.Europe</code> tenant.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Yes, these are really the IP addresses associated with Christmas Island and Vatican City. No, you cannot fill out the rest of the world&#x27;s GeoIP addresses as tenant members. You&#x27;ll almost certainly run out of space in your tenant table (officially called the &quot;source tenant table&quot;). You can see how much room you have in your source tenant table as well as its current utilization by using the PCLI command <code>show capacity</code>.</p></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="special-tenants">Special Tenants<a class="hash-link" href="#special-tenants" title="Direct link to heading">​</a></h3><p>The 128T Session Smart software has several tenants it creates automatically. These tenants are used for specific software functions, and have special meaning described here.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="the-fabric-tenant">The Fabric Tenant<a class="hash-link" href="#the-fabric-tenant" title="Direct link to heading">​</a></h4><p>When combining two nodes into a highly available router (dual node high availability), it is commonplace – and recommended – to configure a &quot;fabric&quot; interface between them. A 128T router with a fabric interface will use install the special <code>&lt;fabric&gt;</code> tenant on the fabric interface. This is neither user-configurable nor user-modifiable. This tenant can be seen in the output of <code>show tenant members</code> as shown here:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.branch1# show tenant members</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Sun 2020-03-22 11:44:48 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node: node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============ ========= ================= ================= ================== ==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Device I/F   VLAN ID   Network I/F       Network I/F IP    Source IP Prefix   Tenant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============ ========= ================= ================= ================== ==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       eno1         0   internode         169.254.255.0     169.254.255.1/32   &lt;fabric&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="the-global-tenant">The Global Tenant<a class="hash-link" href="#the-global-tenant" title="Direct link to heading">​</a></h4><p>The &quot;global tenant&quot; is what a 128T router will use when it cannot determine the tenant of an inbound session, based on the configuration it has. This means three things must be true:</p><ul><li>The session is arriving on an interface with no tenant assigned; and</li><li>The session is arriving on an interface with no applicable per-neighborhood tenant; and</li><li>The session is not carrying metadata from a previous 128T instance that has a tenant identified</li></ul><p>Said another way, the global tenant &quot;fills in the holes&quot; in the tenancy on an interface without a tenant explicitly defined, and which uses neighborhood-based tenant assignations.</p><p>The global tenant is not user-modifiable, and administrators cannot create <code>access-policy</code> configuration stanzas that reference the global tenant. Instead, access to a service by the global tenant is controlled through the use of the <code>scope</code> toggle within a <code>service</code> configuration. Setting <code>scope</code> to <code>public</code> is semantically equivalent to having an <code>access-policy</code> that allows the global tenant. Setting <code>scope</code> to <code>private</code> will only allow tenants that have been explicitly granted access via <code>access-policy</code> configuration.</p><p>The global tenant can be seen in the output of <code>show tenant members</code> as shown here:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.branch1# show tenant members</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Sun 2020-03-22 11:44:48 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node: node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============ ========= ================= ================= ================== ==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Device I/F   VLAN ID   Network I/F       Network I/F IP    Source IP Prefix   Tenant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============ ========= ================= ================= ================== ==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       eno2         0   broadband         198.51.100.2      0.0.0.0/0          &lt;global&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="the-internal-tenant">The Internal Tenant<a class="hash-link" href="#the-internal-tenant" title="Direct link to heading">​</a></h4><p>The internal tenant (named <code>_internal_</code>), is arguably the most useful of all of the special tenants. It is immutably assigned to the built-in Kernel NIC Interface (KNI) named <code>kni254</code>, which is used for communication to and from the Linux host operating system on the platform on which the 128T software is running.</p><p>By adding an <code>access-policy</code> allowing (or denying) <code>_internal_</code> on your service, you can selectively permit processes running in Linux outbound network access. This is commonplace for &quot;host originated&quot; traffic, such as DNS queries, outbound SSH connections, SNMP traps, syslog, etc. The <code>_internal_</code> tenant is also critical to the success of <em>Conductor Host Services</em>, described in our documentation; this is because the outbound <code>salt-minion</code> and NETCONF or REST requests destined for the conductor are initiated within the Linux host operating system.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><blockquote><blockquote><blockquote><p>The <code>netconf</code> configuration is not applicable to version 5.3 and later. NETCONF controls have been replaced with REST API controls, with no loss of functionality.</p></blockquote></blockquote></blockquote></div></div><p>For more information on <code>kni254</code> and the <code>_internal_</code> tenant refer to the section in our documentation titled <em>Linux Host Networking</em>.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.branch1# show tenant members</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Sun 2020-03-22 11:44:48 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node: node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============ ========= ================= ================= ================== ==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Device I/F   VLAN ID   Network I/F       Network I/F IP    Source IP Prefix   Tenant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============ ========= ================= ================= ================== ==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     kni254         0   controlKniIf      169.254.127.126   0.0.0.0/0          _internal_</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="tenancy-strategies">Tenancy Strategies<a class="hash-link" href="#tenancy-strategies" title="Direct link to heading">​</a></h2><p>Designing a scalable, cohesive tenant strategy is one of the primary keys to success with a 128T-powered network. This section of the guide, assuming you are migrating an existing network to one powered by 128T, will help you perform the following tasks:</p><ul><li>Establish a basic tenancy framework for your network topology</li><li>Identify sources of existing segmentation data</li><li>Migrate data into the 128T data model</li><li>Refine and adapt the design</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="before-you-begin">Before You Begin<a class="hash-link" href="#before-you-begin" title="Direct link to heading">​</a></h3><p>There are several steps you can take at the outset of designing a tenancy strategy to improve your chances for success. These are:</p><ol><li>Assess the current security profile of your network. Because tenancy lets you segment (partition) your network, it will act as the guard rails around how consumers access network destinations.</li><li>Choose an appropriate baseline tenancy model.</li><li>Plan for a &quot;discovery process&quot; to identify the rules at each site to map to your baseline tenant structure.</li></ol><h4 class="anchor anchorWithStickyNavbar_y2LR" id="assess-the-current-profile">Assess the Current Profile<a class="hash-link" href="#assess-the-current-profile" title="Direct link to heading">​</a></h4><p>Assessing your current security profile entails identifying the unique categories of users/devices at all of your locations. We recommend to do one location &quot;type&quot; at a time; e.g., start with your similarly-equipped branch offices. For each of the different site types in your network, list out all of the different major categories devices on the network. For typical branch office deployments, this will include things such as:</p><ul><li>Employee workstations (including such things as point-of-sale systems, etc.)</li><li>Guest wifi</li><li>IP phones</li><li>Various &quot;things&quot; such as security cameras, printers, scanners, etc.</li><li>Application servers, DHCP servers, DNS servers, and other network services</li></ul><p>The objective for this profiling is to <em>group the devices into categories, where a category contains devices expected to have roughly equivalent network policy</em>. A tenant (network segment) carves off access for all of its devices equally; two devices belonging to the same tenant will have equal network access. Thus, it is important to categorize the devices based on which of them share common profiles.</p><p>To baseline your tenancy model, it is not necessary to perform exhaustive research, to identify (for example) what distinguishes a finance employee&#x27;s workstation from a developer&#x27;s workstation – we&#x27;ll get to that in future iterations of the tenancy design. For now, we&#x27;re just interested in establishing the basic framework.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="choose-a-baseline-model">Choose a Baseline Model<a class="hash-link" href="#choose-a-baseline-model" title="Direct link to heading">​</a></h4><p>A standard baseline for all tenancy models is to consider:</p><ul><li>Trusted devices: equipment that is generally given access to internal systems and applications hosted by the enterprise. While the equipment may have some access restrictions, it is generally trusted. E.g., employee workstations</li><li>Untrusted devices: equipment that is not trusted by default, and will typically only have access to the internet. E.g., guest wifi</li><li>Restricted devices: equipment that may be on a trusted network, but should ideally have limited network access based upon its type. This also includes limited function devices in your DMZ network); e.g., &quot;things&quot;</li></ul><p>Collate the different devices that you enumerated in your profiling exercise into these three categories. We will refine the model later, to provide differentiation between devices within each category.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="site-discovery">Site Discovery<a class="hash-link" href="#site-discovery" title="Direct link to heading">​</a></h4><p>Last is the process for site-specific discovery. For each of the major categories of devices at your site, understand how (or if) each site has rules in place for assigning devices today. Look for things such as:</p><ul><li>VLAN assignments. Usually sites will have distinct VLANs for trusted traffic, guest wifi, VoIP services, etc. Map each of the specific VLANs to your tenants. For VLANs that are entirely comprised of one variety of device (typical with guest wifi and voice), assign that tenant directly to the <code>network-interface</code> for that VLAN on your 128T</li><li>DHCP scopes/IPAM systems. How does the site issue out IP addresses? Does the DHCP server give out specific addresses to specific categories of equipment? Use the intelligence provisioned in the DHCP server to model that same configuration in the 128T. (And while you&#x27;re at it, consider moving DHCP services to the 128T.)</li><li>NAC. If your site has a NAC, presumably it has configuration rules in it that can identify how the equipment is deployed at that site.</li></ul><p>The goal for the site discovery is to <em>understand the rules for how IP addresses are assigned at the site and ensure the 128T model matches</em>. For environments where there is a lot of homogeneity in the site (e.g., financial institutions, retail, oil and gas, etc.), the rules for IP assignment are usually predictable and well known. Use that information to your advantage, to bootstrap the discovery process.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="refining-and-adapting-the-design">Refining and Adapting the Design<a class="hash-link" href="#refining-and-adapting-the-design" title="Direct link to heading">​</a></h3><p>Now that you have a basic design in place, consider each category to understand the similarities and differences with each of the items you&#x27;ve placed into that category. For example, you&#x27;ve identified employee workstations in the &quot;trusted&quot; category, but there are many types of employee workstations. There are workstations that are used by the finance team that have access to payroll systems and sensitive back office data. There are workstations used by your internal development team that have access to source code repositories and test harnesses. And there are workstations used by your IT team that need access to absolutely everything.</p><p>This is where you refine and adapt the design. For each category, establish the common policy associated with all of them. In our case, all of the workstations need access to the internet and to the corporate intranet. We will use the tenant <code>workstations</code> and apply it as the <code>access-policy</code> for the internet/intranet services.</p><p>We will create the child tenants for each subcategory (<code>finance.workstations</code>, <code>development.workstations</code>, <code>it.workstations</code>, etc.) to selectively allow/deny access to specific services needed by those user populations. Within each of these subcategories we can further differentiate between user personas or roles.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="general-considerations-and-best-practices">General Considerations and Best Practices<a class="hash-link" href="#general-considerations-and-best-practices" title="Direct link to heading">​</a></h3><p>Regardless of which baseline model you choose, there are some general considerations we recommend for all deployments.</p><ul><li>Make tenancy ubiquitous on LAN-side interfaces; everything entering into the LAN side interface of one of your 128T devices should have a tenant defined.</li><li>Create an enterprise-wide tenant to be used as the &quot;parent&quot; to quickly allow or deny network service access to your entire user population.</li><li>If you have a lab environment that can faithfully reproduce a branch location, create lab-specific prefixes for each of your baseline tenants as described in <em>Application Discovery on the 128T</em>.</li><li>Start with basic categorization, and don&#x27;t get too fancy out of the gates. We can (and inevitably will) refine the model over time, as we start to learn more about how the network works.</li><li>When in doubt about how to categorize your tenants, use a service-oriented approach. List the services you want to make available to each of your network constituents. When you find significant overlap between any subsets of these constituents, consider organizing them into hierarchies to simplify the configuration model.</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="use-case-retail-sd-wan">Use Case: Retail SD-WAN<a class="hash-link" href="#use-case-retail-sd-wan" title="Direct link to heading">​</a></h3><p>A nationwide retail franchise (&quot;Acme, Inc.&quot;) is adopting 128T across their environment to provide SD-WAN services. The retail franchise has three different types of sites:</p><ul><li>Legacy Acme stores</li><li>The &quot;green stores,&quot; a retail franchise acquired by Acme in 2012</li><li>The &quot;yellow stores&quot; acquired by Acme in 2018</li></ul><p>The Network Architecture team at Acme did site surveys of all of the equipment in place at all three site varieties and came up with the following list:</p><ul><li>Cash registers (point-of-sale systems), also responsible for inventory moves/adds/changes</li><li>Security cameras</li><li>Handheld barcode scanners</li><li>Employee wifi for BYOD</li><li>Guest wifi access points</li><li>VoIP phones</li><li>Printers</li></ul><p>The team categorized things as follows:</p><ul><li>Trusted: cash registers, barcode scanners, BYOD</li><li>Untrusted: guest wifi access points</li><li>Restricted: security cameras, VoIP phones, printers</li></ul><p>This lent itself to the following tenant model:</p><ul><li><code>acme</code>: the parent tenant for all devices at the retail locations</li><li><code>trusted.acme</code>: the parent tenant for all trusted devices, used for common network policy (such as internet offload, service function chaining, etc.)</li><li><code>byod.trusted.acme</code>: employee-owned BYOD</li><li><code>pos.trusted.acme</code>: the point-of-sale systems</li><li><code>handheld.trusted.acme</code>: the handheld scanners</li><li><code>guest.acme</code>: the guest wifi</li><li><code>voice.acme</code>: the voice equipment</li><li><code>restricted.acme</code>: security cameras, printers, etc.</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="notes-about-the-model">Notes about the Model<a class="hash-link" href="#notes-about-the-model" title="Direct link to heading">​</a></h4><p>The Network Architecture team realized they have a very simple network at each of their retail stores, and kept the model basic. They needed to make some tough decisions, and here was their thought process:</p><ol><li><strong>Decision</strong>: how to categorize BYOD? Employees frequently bring in their own smartphones and tablets to work with them, and modern employers embrace the gains in productivity. But these are not company-owned devices. Should they be considered untrusted or trusted? In the end they decided that the BYOD need access to a lot of core services common with the customer-managed POS systems, so they consider them as part of the <code>trusted</code> hierarchy. However, by breaking them out into their own category (<code>byod.trusted.acme</code>) they can add <code>access-policy</code> stanzas to <em>deny</em> the tenant from services that are too sensitive to trust to BYOD.<div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Key decision</h5></div><div class="admonition-content"><p>In the end they decided the overlap between BYOD and POS was greater than the overlap between BYOD and untrusted; thus, it is easier to selectively deny it access to sensitive services than to selectively permit it access to trusted services.</p></div></div></li><li><strong>Decision</strong>: why is voice its own category? Voice over IP uses networks in a peculiar way, with no predictable port usage, sessions initiating asymmetrically, and a mix of transport protocols. Also, in most deployments voice is broken out into its own VLAN. For services that are isolated and relegated to their own VLAN, it is simplest to carve out a top-level tenant for it.</li></ol><h4 class="anchor anchorWithStickyNavbar_y2LR" id="site-surveys">Site Surveys<a class="hash-link" href="#site-surveys" title="Direct link to heading">​</a></h4><p>The Architecture team then went through each of the three store types, to understand how to map the devices into these core tenants. They found that each of the three varieties of stores (legacy, green, yellow) used different IP allocation strategies for everything. Legacy stores had everything segmented by VLAN. This made the mapping exercise straightforward for the team: each VLAN could be mapped to a single tenant cleanly.</p><p>The green stores had a VLAN for voice, but used DHCP scoping to assign IP addresses to everything else based on role. The network team decided to keep this enforcement, and migrated the DHCP to the 128T using the same rules. The team then used per-neighborhood tenancy to segment the traffic. The yellow store design... well, that was a bit of a mess. There was very little control in place, with all traffic comingled on the same per-store <code>/24</code> network.</p><p>From the surveys, they created three configuration templates, segmenting the traffic according to the VLAN</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="conclusions">Conclusions<a class="hash-link" href="#conclusions" title="Direct link to heading">​</a></h4><p>In the end, the tenant model is flexible and there is no &quot;one correct way&quot; to organize your devices. <em>Do what works best for you and your network.</em> In the end, readability and the ability to easily document and train your hierarchy to your colleagues will outweigh a perfectly manicured, but hard-to-understand structure.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-07-07T17:35:09.000Z">7/7/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/bcp_service-policy_defaults"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Service Policy Baseline Defaults</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/cli_reference"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Command Line Reference</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#intended-audience" class="table-of-contents__link toc-highlight">Intended Audience</a></li><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#basic-tenant-workflow" class="table-of-contents__link toc-highlight">Basic Tenant Workflow</a></li><li><a href="#tenant-assignment" class="table-of-contents__link toc-highlight">Tenant Assignment</a></li><li><a href="#tenant-hierarchies" class="table-of-contents__link toc-highlight">Tenant Hierarchies</a></li></ul></li><li><a href="#tenant-configuration" class="table-of-contents__link toc-highlight">Tenant Configuration</a><ul><li><a href="#per-interface-tenancy" class="table-of-contents__link toc-highlight">Per-interface Tenancy</a></li><li><a href="#per-neighborhood-tenancy" class="table-of-contents__link toc-highlight">Per-neighborhood Tenancy</a></li><li><a href="#special-tenants" class="table-of-contents__link toc-highlight">Special Tenants</a></li></ul></li><li><a href="#tenancy-strategies" class="table-of-contents__link toc-highlight">Tenancy Strategies</a><ul><li><a href="#before-you-begin" class="table-of-contents__link toc-highlight">Before You Begin</a></li><li><a href="#refining-and-adapting-the-design" class="table-of-contents__link toc-highlight">Refining and Adapting the Design</a></li><li><a href="#general-considerations-and-best-practices" class="table-of-contents__link toc-highlight">General Considerations and Best Practices</a></li><li><a href="#use-case-retail-sd-wan" class="table-of-contents__link toc-highlight">Use Case: Retail SD-WAN</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.5c6849e0.js"></script>
<script src="/assets/js/main.310752e1.js"></script>
</body>
</html>
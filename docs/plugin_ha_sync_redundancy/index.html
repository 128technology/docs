<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-plugin_ha_sync_redundancy" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">HA Sync Redundancy Plugin | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/docs/plugin_ha_sync_redundancy"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="HA Sync Redundancy Plugin | SSN Docs"><meta data-rh="true" name="description" content="The HA Sync Redundancy plugin adds the ability to include an additional link in the team interface configured as described in Non-Forwarding HA Interfaces. Additionally, the plugin provides the ability to use the HA sync connection (single or dual-member) to send HA fabric traffic by creating a vlan sub-interface, and setting up a KNI interface in a bridge with this sub-interface."><meta data-rh="true" property="og:description" content="The HA Sync Redundancy plugin adds the ability to include an additional link in the team interface configured as described in Non-Forwarding HA Interfaces. Additionally, the plugin provides the ability to use the HA sync connection (single or dual-member) to send HA fabric traffic by creating a vlan sub-interface, and setting up a KNI interface in a bridge with this sub-interface."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/docs/plugin_ha_sync_redundancy"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/plugin_ha_sync_redundancy" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/plugin_ha_sync_redundancy" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.e30a7dc4.css">
<script src="/assets/js/runtime~main.ba908a42.js" defer="defer"></script>
<script src="/assets/js/main.1d489193.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cc_fips_titlepage">SSR Common Criteria Install and Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/install_conductor_overview">Conductor Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_bootable_media">Router Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_image">Image-Based Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported_cloud_platforms">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_upgrade_considerations">Upgrades and Rollback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_installer">Supporting Install Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/config_basics">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/plugin_intro">Plugins</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_bgp_community_services">BGP Community Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_cloud_ha">Cloud HA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_app_id">DNS App Id</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_cache">DNS Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_gre">GRE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/plugin_ha_sync_redundancy">HA Sync Redundancy Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_http_probe">HTTP Probe Reachability Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_icmp_reachability_detection">ICMP Reachability Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_ipsec_client">IPsec Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_loopback_static_routes">Loopback Static Routes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_m800_watchdog">M800 Watchdog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_monitoring_agent">Monitoring Agent Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_mosh">Mosh</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_set_hostname">Set Hostname</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_sip_alg">SIP ALG</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_wireguard">Wireguard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/release_notes_128t_6.2">Release Notes</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Plugins</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">HA Sync Redundancy Plugin</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>HA Sync Redundancy Plugin</h1></header><p>The HA Sync Redundancy plugin adds the ability to include an additional link in the team interface configured as described in <a href="/docs/config_non_forwarding_ha_interfaces">Non-Forwarding HA Interfaces</a>. Additionally, the plugin provides the ability to use the HA sync connection (single or dual-member) to send HA fabric traffic by creating a vlan sub-interface, and setting up a KNI interface in a bridge with this sub-interface.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-snippet">Configuration Snippet<a href="#configuration-snippet" class="hash-link" aria-label="Direct link to Configuration Snippet" title="Direct link to Configuration Snippet">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="redundant-ha-sync-interface">Redundant HA Sync Interface<a href="#redundant-ha-sync-interface" class="hash-link" aria-label="Direct link to Redundant HA Sync Interface" title="Direct link to Redundant HA Sync Interface">​</a></h3>
<p>The configuration sample below adds a Linux interface <code>enp0s14f1</code> to the HA sync team interface.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router  lshields</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name  lshields</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            node  lanner7573</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name                lanner7573</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ha-sync-redundancy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    redundant-interface    enp0s14f1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ha-fabric-over-ha-sync">HA Fabric Over HA Sync<a href="#ha-fabric-over-ha-sync" class="hash-link" aria-label="Direct link to HA Fabric Over HA Sync" title="Direct link to HA Fabric Over HA Sync">​</a></h3>
<p>The configuration sample below auto-generates HA fabric interfaces that leverage the existing HA sync connection to transit between the nodes.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router  lshields</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name  lshields</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ha-sync-redundancy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                generate-shared-fabric-interface    true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This auto-generates the configuration for a device-interface named <code>ha-fabric</code> on any nodes in the router, each with a network-interface named <code>ha-fabric-intf</code>. The addresses used on these interfaces will be from the network <code>169.254.252.0/30</code>. The network can be overridden by specifying a different network range for the option <code>fabric-network</code> within the <code>ha-sync-redundancy</code> container.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases">Use Cases<a href="#use-cases" class="hash-link" aria-label="Direct link to Use Cases" title="Direct link to Use Cases">​</a></h2>
<p>Within an HA router, the communication that occurs on the HA sync connection is vital to proper operation of the router. In many ways it should be thought of as akin to the backplane of a chassis-based router, despite the fact that it is provided through an Ethernet connection. Due to the importance of this connection to proper functionality, customers often wish to provide redundant connections for this traffic in case of cable or interface failure.</p>
<p>Additionally, there is typically a desire to minimize the number of cables running between two nodes in an HA router, possibly due to lack of physical ports available. This plugin provides the ability to leverage the existing HA sync connection for HA fabric traffic in order to limit the number of physical connections between the two nodes. This can either allow users to avoid the use of three cables when using a redundant HA connection or avoid using two when the hardware does not provide sufficient ports.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="config-auto-generation">Config Auto-Generation<a href="#config-auto-generation" class="hash-link" aria-label="Direct link to Config Auto-Generation" title="Direct link to Config Auto-Generation">​</a></h3>
<p>When enabling use of the shared fabric interface, this plugin auto-generates configuration for a kni host interface named <code>ha-fabric</code>. If expected configuration is not being generated, please check the following log on the conductor for errors.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/var/log/128technology/plugins/ha-sync-redundancy-generate-configuration.log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="plugin-state">Plugin State<a href="#plugin-state" class="hash-link" aria-label="Direct link to Plugin State" title="Direct link to Plugin State">​</a></h3>
<p>The <code>show plugin state</code> command provides useful information for troubleshooting proper performance of the plugin. The <code>summary</code> version of this command shows a simple table indicating the status of the team and/or bridge as well as their individual members. A sample output of a fully working plugin is shown below.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>If only using one of the two options in this plugin, the output will only contain information for either the team or bridge.</p></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor# show plugins state router router1 summary 128T-ha-sync-redundancy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Fri 2021-09-03 20:05:53 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Retrieving state data...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Target: node1.router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============== ======== ====== ================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Interface      Exists   Up     In Bridge/Team</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============== ======== ====== ================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> team-ens3      True     True   N/A</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ens3           True     True   True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ens4           True     True   True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ha-fabric-br   True     True   N/A</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> fabric         True     True   True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ha-fabric      True     True   True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Target: node2.router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============== ======== ====== ================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Interface      Exists   Up     In Bridge/Team</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============== ======== ====== ================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> team-ens3      True     True   N/A</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ens3           True     True   True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ens4           True     True   True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ha-fabric-br   True     True   N/A</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> fabric         True     True   True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ha-fabric      True     True   True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Retrieved state data.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 4.12 seconds</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If there is a <code>False</code> value for any of these fields, further investigation should be undertaken as outlined below.</p>
<p>The <code>show plugin state</code> command can also be issued with a <code>detail</code> option. This option reports the output of the Linux commands <code>brctl show</code> and <code>teamdctl &lt;team name&gt; state</code> which provide additional details of the status of the bridge and team interfaces.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>If only using one of the two options in this plugin, the output will only contain information for either the team or bridge.</p></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor# show plugins state router router1 detail 128T-ha-sync-redundancy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Fri 2021-09-03 20:17:21 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Retrieving state data...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> node1.router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Fabric Status:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> bridge name    bridge id               STP enabled     interfaces</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ha-fabric-br           8000.500000020001       no              fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                                        ha-fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Team Status:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     ports:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       ens3:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         ifinfo:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           dev_addr:                           50:00:00:02:00:01</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           dev_addr_len:                       6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           ifindex:                            3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           ifname:                             ens3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         link:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           duplex:                             full</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           speed:                              1000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           up:                                 True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         link_watches:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           list:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             link_watch_0:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               delay_down:                     0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               delay_up:                       0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               down_count:                     1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               name:                           ethtool</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               up:                             True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           up:                                 True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       ens4:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         ifinfo:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           dev_addr:                           50:00:00:02:00:01</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           dev_addr_len:                       6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           ifindex:                            4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           ifname:                             ens4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         link:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           duplex:                             full</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           speed:                              1000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           up:                                 True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         link_watches:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           list:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             link_watch_0:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               delay_down:                     0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               delay_up:                       0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               down_count:                     0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               name:                           ethtool</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               up:                             True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           up:                                 True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     runner:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       active_port:                            ens4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     setup:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       daemonized:                             False</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       dbus_enabled:                           True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       debug_level:                            0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       kernel_team_mode_name:                  activebackup</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       pid:                                    11070</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       pid_file:                               /var/run/teamd/team-ens3.pid</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       runner_name:                            activebackup</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       zmq_enabled:                            False</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     team_device:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       ifinfo:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         dev_addr:                             50:00:00:02:00:01</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         dev_addr_len:                         6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         ifindex:                              11</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         ifname:                               team-ens3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The sections below contain information on how the plugin orchestrates the setup of the team and bridge interfaces. This information can be used to troubleshoot proper operation of the plugin if these commands show issues with either the team or the bridge.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="plugin-configuration">Plugin Configuration<a href="#plugin-configuration" class="hash-link" aria-label="Direct link to Plugin Configuration" title="Direct link to Plugin Configuration">​</a></h3>
<p>When configuration is created for this plugin, the conductor creates a configuration file with the appropriate information on each node of the router. This file is located in the directory <code>/var/lib/128technology/plugins/ha-sync-redundancy/</code> and named <code>config.yaml</code>. A copy of this file named <code>config.yaml.current</code> can be found in this directory if the config was read correctly. This file is used to maintain the last state of the configuration to detect when changes are made so that interfaces no longer needed can be cleaned up. The contents of this file should look as follows (based on the configuration above).</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">redundant_interface</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;enp0s14f0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">ha_fabric_vlan</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1000&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>It can take several minutes after a commit from the conductor for this file to be generated.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-handling">Configuration Handling<a href="#configuration-handling" class="hash-link" aria-label="Direct link to Configuration Handling" title="Direct link to Configuration Handling">​</a></h3>
<p>Upon generation of the configuration file, a configuration handler is executed. This handler reads the configuration file, sets up the redundant team interface member, as well as setup a <a href="/docs/plugin_kni_namespace_scripts">KNI namespace script</a> configuration file to handle the vlan interface and bridge creation. This script writes errors to the log file <code>/var/log/128technology/plugins/ha-sync-redundancy.log</code>, providing details if issues arise. The config handler can also be executed manually by running <code>/usr/bin/t128-ha-sync-redundancy-config-handler</code>.</p>
<p>The contents of this file should look similar to what is shown below.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">vlan-interfaces</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">base-intf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> team</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">enp10s0f0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">vlan-id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">bridges</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ha</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">fabric</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">br</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">kni-intf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ha</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">target-intf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> fabric</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="kni-namespace-script">KNI Namespace Script<a href="#kni-namespace-script" class="hash-link" aria-label="Direct link to KNI Namespace Script" title="Direct link to KNI Namespace Script">​</a></h3>
<p>This portion is only relevant to the configuration of an HA Fabric VLAN.</p>
<p>After the configuration has been handled a configuration file for the namespace scripts is generated at <code>/var/lib/128technology/kni/host/ha-fabric.conf</code>. In addition, symbolic links should be created to the kni namespace scripts in the directory <code>/etc/128technology/plugins/network-scripts/host/ha-fabric</code> as shown below:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[root@lr202006003427 ha-fabric]# ll</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">total 20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lrwxrwxrwx 1 root root  69 Aug 30 20:26 init -&gt; /etc/128technology/plugins/network-scripts/default/kni_namespace/init</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rwxr-xr-x 1 root root 246 Aug 30 20:52 monitoring</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lrwxrwxrwx 1 root root  62 Aug 30 20:26 reinit -&gt; /etc/128technology/plugins/network-scripts/host/ha-fabric/init</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lrwxrwxrwx 1 root root  73 Aug 30 20:26 shutdown -&gt; /etc/128technology/plugins/network-scripts/default/kni_namespace/shutdown</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lrwxrwxrwx 1 root root  72 Aug 30 20:26 startup -&gt; /etc/128technology/plugins/network-scripts/default/kni_namespace/startup</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[root@lr202006003427 ha-fabric]#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If these scripts have errors, they will be shown in <code>/var/log/128technology/highway.log</code>. On occasion, setting the log-level to <code>debug</code> will provide additional details of how these scripts are run and errors they generate.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="release-notes">Release Notes<a href="#release-notes" class="hash-link" aria-label="Direct link to Release Notes" title="Direct link to Release Notes">​</a></h2>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>The plugin must be updated to version 1.1.0 or later prior to <a href="/docs/intro_upgrade_considerations#plugin-configuration-generation-changes">upgrading the conductor to SSR version 5.4.0.</a></p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-113">Release 1.1.3<a href="#release-113" class="hash-link" aria-label="Direct link to Release 1.1.3" title="Direct link to Release 1.1.3">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed">Issues Fixed<a href="#issues-fixed" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4>
<ul>
<li>
<p><strong>PLUGIN-2233</strong>  VLAN ID cannot be modified</p>
<p><em><strong>Resolution:</strong></em> Add new configuration field to modify the default VLAN ID used for the interface</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-112">Release 1.1.2<a href="#release-112" class="hash-link" aria-label="Direct link to Release 1.1.2" title="Direct link to Release 1.1.2">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-1">Issues Fixed<a href="#issues-fixed-1" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4>
<ul>
<li>
<p><strong>PLUGIN-1580</strong>  Communication through HA sync interface was broken after one HA node was rebooted</p>
<p><em><strong>Resolution:</strong></em> Set a priority on the teams interface so each node prefers the same interface as active</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-110">Release 1.1.0<a href="#release-110" class="hash-link" aria-label="Direct link to Release 1.1.0" title="Direct link to Release 1.1.0">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-2">Issues Fixed<a href="#issues-fixed-2" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4>
<ul>
<li>
<p><strong>PLUGIN-1451</strong>  Config generation for the plugin failing</p>
<p><em><strong>Resolution:</strong></em> Correctly handle the config generation for routers where the plugin is not enabled during config generation</p>
</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/plugin_gre"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">GRE</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/plugin_http_probe"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">HTTP Probe Reachability Detection</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configuration-snippet" class="table-of-contents__link toc-highlight">Configuration Snippet</a><ul><li><a href="#redundant-ha-sync-interface" class="table-of-contents__link toc-highlight">Redundant HA Sync Interface</a></li></ul></li><li><a href="#use-cases" class="table-of-contents__link toc-highlight">Use Cases</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li><li><a href="#release-notes" class="table-of-contents__link toc-highlight">Release Notes</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Juniper Networks, Inc.</div></div></div></footer></div>
</body>
</html>
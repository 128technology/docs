<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-enhanced-sec-key-mgmt" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Enhanced Security Key Management | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/docs/enhanced-sec-key-mgmt"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Enhanced Security Key Management | SSN Docs"><meta data-rh="true" name="description" content="Version History"><meta data-rh="true" property="og:description" content="Version History"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/docs/enhanced-sec-key-mgmt"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/enhanced-sec-key-mgmt" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/enhanced-sec-key-mgmt" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/kb/rss.xml" title="SSR Knowledge Base Articles RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/kb/atom.xml" title="SSR Knowledge Base Articles Atom Feed">
<link rel="alternate" type="application/json" href="/kb/feed.json" title="SSR Knowledge Base Articles JSON Feed"><link rel="stylesheet" href="/assets/css/styles.df1c9d6e.css">
<script src="/assets/js/runtime~main.a1925f99.js" defer="defer"></script>
<script src="/assets/js/main.520036c5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a class="navbar__item navbar__link" href="/kb">Knowledge Base</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_getting_started">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/release_notes_128t_7.0">Release Notes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported-devices-overview">Supported Hardware Platforms</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts-overview">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation">Installing Software Version 6.3.0 and Later</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported_cloud_platforms">Cloud / Hypervisor Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_legacy">Installing Software Versions Earlier than 6.3.0</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_upgrade_considerations">Upgrading the SSR</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bcp_sdwan_design_guide">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/config_basics">Administration Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/security-overview">Security</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/security-overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_access_mgmt">Access Management and Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/sec_adaptive_encrypt">Security</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sec_adaptive_encrypt">Adaptive Encryption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sec_firewall_filtering">Customizable Firewall Rules and Filters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sec_security_policy">Security Policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sec-config-seim-syslog">SEIM Syslog Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sec_hardening_guidelines">Security Hardening Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sec-ddos-resilience">Resilience Against DoS and DDoS Attacks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sec-usb-security">USB Boot and Storage Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sec-disable-console-output">Disable Console Output</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config-custom-certs">Configure Certificate Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/enhanced-sec-key-mgmt">Enhanced Security Key Management</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/concepts_ssr_idp">Intrusion Detection and Prevention</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/cc_fips_titlepage">SSR Common Criteria Install and Configuration - SSR V6.2.5</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/config_ha">High Availability</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/plugin_intro">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/ts_applications">Troubleshooting</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Security</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Security</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Enhanced Security Key Management</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Enhanced Security Key Management</h1></header><h4 class="anchor anchorWithStickyNavbar_LWe7" id="version-history">Version History<a href="#version-history" class="hash-link" aria-label="Direct link to Version History" title="Direct link to Version History">​</a></h4>
<table><thead><tr><th>Release</th><th>Modification</th></tr></thead><tbody><tr><td>7.0.1</td><td>Enhanced Security Key Management support added.</td></tr></tbody></table>
<p>Security is a critical component of <a href="https://www.juniper.net/us/en/products/routers/session-smart-router.html" target="_blank" rel="noopener noreferrer">SD-WAN (software-defined wide area network)</a> products in today’s market. <a href="/docs/about_128t">The SSR (Session Smart Router)</a> offers several means of ensuring the integrity of data transmitted through the router, such as encrypting application payload content, encrypting SVR (Secure Vector Routing) metadata, and authentication for metadata.</p>
<p>As an example, let&#x27;s look at the needs of a financial institution. They have to keep transaction traffic secure. If not, the results are catastrophic for both the instution and the individual/companies whose transaction gets hijacked. SSR technology uses SVR along with Enhanced Security Key Management, allowing you to configure unparalelled security without the increased packet size, fragmentation, and increased transaction time <a href="/docs/about_svr_savings">common with IPSec</a>. This design creates maximum scale, avoids mid-network re-encryption, and provides the ability to rotate keys as required.</p>
<p>The following diagrams show simple examples of how Enhanced Security Key Management can be deployed.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="conductor-hub-and-spoke">Conductor Hub and Spoke<a href="#conductor-hub-and-spoke" class="hash-link" aria-label="Direct link to Conductor Hub and Spoke" title="Direct link to Conductor Hub and Spoke">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Conductor behind" src="/assets/images/conductor-behind-svrv2-315092e4b081154561ce01badfcb99ea.png" width="1332" height="1276" class="img_ev3q"></p>
<p>In this example, green represents management traffic on TCP/930 and TCP/4505-4506. Blue represents SVR between the hub and spokes. The management traffic flows inside the SVR path to the hub. The hub then sends it over the LAN to the conductor. Management traffic can be configured to traverse SVR paths if required. Red represents customer traffic between the hub and spokes. For additional deployment information, see <a href="/docs/bcp_conductor_deployment#conductor-behind-ssr">Conductor Deployment - Conductor Behind SSR.</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="multi-hop-hub-and-spoke">Multi-hop Hub and Spoke<a href="#multi-hop-hub-and-spoke" class="hash-link" aria-label="Direct link to Multi-hop Hub and Spoke" title="Direct link to Multi-hop Hub and Spoke">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Multi-hop hub and spoke" src="/assets/images/hub-n-spoke-svrv2-03ab9166b436836cd7b4eeef8aed3692.png" width="846" height="986" class="img_ev3q"></p>
<p>This example shows a multi-hop hub and spoke deployment. Red represents customer traffic between the hubs and spoke, and out to a public network. Blue represents the SVR connection between spokes and the hub. The traffic flows inside the SVR path from spoke to hub or spoke to hub to spoke.</p>
<p>In a newly deployed network, Enhanced Security Key Management is more secure than the default security implementation of SVR, and far more secure than IPSec. Enhanced Security Key Management affords you the best security strength not only because of the encryption key exchange, and its unique per-session encryption keys, but through its ability to perform key rotations for any network topology.</p>
<p>Additionally, the flexiblity of SVR to choose a different physical path to satisfy SLA requirements is not found in traffic encrypted within an IPSec Tunnel. Traffic encrypted within an IPSec Tunnel always follows the same path, not allowing for different flows to have different SLA-driven physical paths.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="svrv2-and-ipsec">SVRv2 and IPSec<a href="#svrv2-and-ipsec" class="hash-link" aria-label="Direct link to SVRv2 and IPSec" title="Direct link to SVRv2 and IPSec">​</a></h2>
<p>To understand the value of Enhanced Security Key Management, we can draw some comparisons against IPSec.</p>
<table><thead><tr><th>Characteristic</th><th>IPSec/IKE</th><th>SVRv2</th></tr></thead><tbody><tr><td>Payload Encryption</td><td>ESP</td><td>Encrypted with per-Flow AES-CBC-256 payload key.</td></tr><tr><td>Encrypt Original IP SA/DA</td><td>ESP</td><td>Encrypted with AES-CBC-256 encrypted Metadata sent within first Payload packet using metadata key.</td></tr><tr><td>Secure Channel to exchange keys</td><td>IKEv2</td><td>Diffie-Hellman. DH provides 4096-bit Peer key used to encrypt BFD Metadata.</td></tr><tr><td>Confidentiality</td><td>Payload is encrypted with the IPSec Tunnel key; however, all individual sessions with the same IPSec tunnel share the same key. There is no confidentiality between sessions sharing the same source and destination address.</td><td>Payload encrypted with Per-Flow Payload key; SVR Metadata (containing the Per-Flow Payload key) is encrypted with the SVR Metadata Key. Because each session has a separate key, each session has confidentiality, even between the same source and destination address.</td></tr><tr><td>Integrity</td><td>ESP Authentication Header</td><td>HMAC SHA-384 signature signs all SVR Metadata and/or Payload in SVR packet.</td></tr><tr><td>Authentication</td><td>IKEv2 PSK or x.509v3 certificates</td><td>SSR-signed x.509v3 certificate through root of trust to Intermediate CA installed on SSR</td></tr><tr><td>Data Origin Authentication</td><td>HMAC-SHA-384</td><td>HMAC SHA-384 signature</td></tr><tr><td>Replay Protection</td><td>Yes</td><td>Nonce added for Replay Protection.</td></tr><tr><td>Perfect Forward Secrecy</td><td>Yes</td><td>Keys in DH are seeded by Salt.</td></tr><tr><td>IPv4 and IPv6</td><td>Yes</td><td>Yes</td></tr></tbody></table>
<p>The Enhanced Security Key Management provides a more secure, more flexible, and more efficient transport network. If you want securtiy across your network, this is the best option.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works">How It Works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How It Works" title="Direct link to How It Works">​</a></h2>
<p>The foundation of Enhanced Security Key Management is the ability to define peer-to-peer certificate-based security and key rotation within your SVR peer network. There are two ways you can provision this level of security.</p>
<p>When configured to used Enhanced Security Key Management, the SSR will automatically create a self-signed certificate. This allows you to configure peering between SSRs quickly, however because it is a self-signed certificate, it does not offer the same protections as a CA-signed certificate. To configure Enhanced Security Key Management using the self-signed certificate, use the <a href="#configuration">Configuration</a> procedure below.</p>
<p>To provide thorough, end-to-end security the use of a trusted and provisioned certificate and signing authority is supported. To take advantage of this feature, begin with <a href="/docs/config-custom-certs">Configuring Certificate Management</a>, and then return to the <a href="#configuration">Configuration</a> section below.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The user provided certificates and signing authority must be in place before configuring Enhanced Security Key Management. If they are NOT in place prior to configuration and are added afterwards, then the SSR service will need to be restarted in order to pick up the changes.</p></div></div>
<p>The following diagram provides a look at a typical SSR/SVR deployment.</p>
<p><img decoding="async" loading="lazy" alt="sample topology" src="/assets/images/ztna-sample-topo-665a52b75727f5c0e25b2ea2733f8eb4.png" width="1706" height="804" class="img_ev3q"></p>
<p>In this topology, the selected path through the network is: Host 1 – R2 – R3 – R4 – Host 5</p>
<p>The payload for the first flow - <code>Blue</code> - consists of data packets A, B, and C. Additional flows may have the same source and destination (Host 1/Host 5) but to satisfy SLA requirements they could take a different physical path through Router 6.</p>
<p>This illustrates an important difference between SVR and IPSec tunnels; traffic encrypted within an IPSec Tunnel always follows the same path, not allowing different flows to have different SLA-driven physical paths. SVR does not have this limitation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-rotation">Key Rotation<a href="#key-rotation" class="hash-link" aria-label="Direct link to Key Rotation" title="Direct link to Key Rotation">​</a></h3>
<p>Key rotation provides a high level of transport security. Configuring this feature creates a specific interval for the router to generate a new security key/payload key and distribute it across the network.</p>
<p>The security rekeying mechanism (key rotation) is configured on the conductor, at the Authority level, and requires that all routers and conductors are running the same version of software that supports this feature.</p>
<p>This enhanced level of security is enabled by setting <code>enhanced-security-key-management</code> to <code>true</code>, which triggers the router to generate <strong>a local metadata key</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ssr-keys">SSR Keys<a href="#ssr-keys" class="hash-link" aria-label="Direct link to SSR Keys" title="Direct link to SSR Keys">​</a></h3>
<p>The router sends the <strong>metadata key</strong> and other information to the peers, allowing peer authentication and the ability to encrypt and decrypt messages. The peers store this key until a new key is accepted as a replacement. This dynamic key generation and exchange provides the encryption of Secure Vector Routing (SVR) traffic.</p>
<ul>
<li>Metadata Key<!-- -->
<ul>
<li>Transmitted within BFD Metadata</li>
<li>Metadata Key is same for all peer router connections</li>
<li>Encrypts SVR TLVs</li>
</ul>
</li>
</ul>
<p>Routers generate their own <strong>peer keys</strong> based on X.509 certificates for encrypting metadata keys and distribute them to their peers by BFD metadata.</p>
<ul>
<li>Peer Key<!-- -->
<ul>
<li>Generated via DH from PKI</li>
<li>Encrypts BFD Metadata</li>
</ul>
</li>
</ul>
<p>Sessions are encrypted using <strong>payload keys</strong> generated on demand, encrypted, and distributed to the peer over SVR.</p>
<ul>
<li>Payload Key<!-- -->
<ul>
<li>Transmitted within SVR Metadata encrypted by the peer key</li>
<li>Encrypts Payload per-session</li>
</ul>
</li>
</ul>
<p>The following diagram illustrates the SSR Key Exchange process:</p>
<p><img decoding="async" loading="lazy" alt="Key Exchange" src="/assets/images/svr-ztna-key-exchange-c14417858c2c7985c0fec64d481ea1f6.png" width="1732" height="732" class="img_ev3q"></p>
<ol>
<li>SVR certificates are installed onto the SSR from the Conductor.</li>
</ol>
<ol start="2">
<li>
<p>The DH key exchange between routers creates a <strong>peer key</strong>.</p>
</li>
<li>
<p>Each router generates a <strong>metadata key</strong> and transmits this via BFD Metadata, encrypted using the Peer Key.</p>
<ul>
<li>Each Peer creates their own key.</li>
<li>The originating router encrypts SVR Metadata with the peer’s <strong>metadata key</strong>.</li>
</ul>
</li>
<li>
<p>Each router generates unique <strong>payload key</strong> per session, and transmits this key in the metadata TLV, encrypted using the <strong>metadata key</strong> on a router-to-router basis (end-to-end).</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="peer-key-and-key-rotation">Peer Key and Key Rotation<a href="#peer-key-and-key-rotation" class="hash-link" aria-label="Direct link to Peer Key and Key Rotation" title="Direct link to Peer Key and Key Rotation">​</a></h3>
<p>A single key is used for all paths between two routers. The key is saved and remains valid during network outages and path failures, until a new key is accepted as a replacement.</p>
<p>During the rekeying period the old key is used. A wait time of 30 seconds is added post key computation to prevent any retransmitted packets, delayed packets, or long latency packets not having a key ready for use.</p>
<p>If a peer sends a Key Request to a peer for which there is no valid key and receives no response, then the peer path remains out of service until there is a valid response.</p>
<p>The peer continues to resend requests at periodic intervals as defined in the configuration setting <code>authority &gt; security-key-management &gt; peer-key-retransmit-interval</code>. If there is no response after the time defined by <code>authority &gt; security-key-management &gt; peer-key-timeout</code>, the peer path is declared invalid and removed from service. Once the peer is taken out of service due to key timeout, it will continue to send rekey attempts at the <code>peer-key-timeout intervals</code>, or upon interface state change.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="certificate-replacement-or-revocation">Certificate Replacement or Revocation<a href="#certificate-replacement-or-revocation" class="hash-link" aria-label="Direct link to Certificate Replacement or Revocation" title="Direct link to Certificate Replacement or Revocation">​</a></h3>
<p>When a certificate is revoked, expired, or invalid, the SSR generates an alarm. Based upon the SSR configuration, it will either <code>fail-soft</code> (the default behavior) or <code>fail-hard</code>.</p>
<p><code>fail-soft</code> results in a notification that the certificate is no longer valid and that appropriate action must be taken.</p>
<p><code>fail-hard</code> results in a notification that the certificate is no longer valid, as well as the removal of all peering relationships. This severs the peer connection and stops the device from participating in SVR.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="peer-authentication">Peer Authentication<a href="#peer-authentication" class="hash-link" aria-label="Direct link to Peer Authentication" title="Direct link to Peer Authentication">​</a></h3>
<p>Peer validation is done whenever a new certificate is added, or peer configuration has changed. When a certificate is received, a cached validation response is used. If configured, the received certificate is validated against the <code>trusted-ca-certificate</code> list.</p>
<p>When receiving a certificate from a peer router and performing validation, the receiving router extracts and saves the peer router&#x27;s public key. This is used for validating the authenticity of any subsequent Peer Key/Rekey requests.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="requirements">Requirements<a href="#requirements" class="hash-link" aria-label="Direct link to Requirements" title="Direct link to Requirements">​</a></h3>
<p>SSR 7.0.1 is required on all devices participating in Enhanced Security Key Management. Any SSR running an older version of software that does not support this functionality will cause traffic to fail between those peers. In these cases, events will be generated when peering fails to establish.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h2>
<p>Configuration is performed on the conductor, at the Authority level, on a per router basis. To accept the default values for enhanced security key management:</p>
<ol>
<li>Set <code>enhanced-security-key-management</code> to <code>true</code>;</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        enhanced-security-key-management  true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Configure a <code>peering-common-name</code> on each router. In a secure environment, the router name should never be sent between routers as plaintext in BFD messages. The <code>peering-common-name</code> is an alias that identifies the router and is configured at the router level. When <code>enhanced-security-key-management</code> is configured, it is validated against the peering-common-name from the ceritficate, and integrated into the auto-generated adjacencies list for the peers of the router from the neighborhood configuration.</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router                            combo-east</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name                 combo-east</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            peering-common-name  second-fake-alias-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            location             usa</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            description          &quot;router 1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            inter-node-security  internal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The peer list of the router must also have the <code>peering-common-name</code> of that peer. If the peer list is not manually configured, it is auto-generated from the neighborhoods.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="rekeying-key-rotation-atttributes-and-default-values">Rekeying (Key Rotation) Atttributes and Default Values<a href="#rekeying-key-rotation-atttributes-and-default-values" class="hash-link" aria-label="Direct link to Rekeying (Key Rotation) Atttributes and Default Values" title="Direct link to Rekeying (Key Rotation) Atttributes and Default Values">​</a></h4>
<table><thead><tr><th>Configuration Attributes</th><th>Description</th></tr></thead><tbody><tr><td>key-exchange-algorithm</td><td>Configure Key Exchange Algorithm</td></tr><tr><td>payload-key-rekey-interval</td><td>Hours between payload security key regeneration. Range is 1-720, or never. Default is 24 hours.</td></tr><tr><td>peer-key-rekey-interval</td><td>Hours between security key regeneration for peer routers. Range is 1-720, or never. Default is 24 hours.</td></tr><tr><td>peer-key-retransmit-interval</td><td>Seconds between security key retransmission for peer routers, when peer key establishment has not been acknowledged. Range is 5-3600. Default is 30 seconds.</td></tr><tr><td>peer-key-timeout</td><td>Seconds before security key retransmission timeout for peer routers, when peer key establishment has not been acknowledged. Default is 3600 seconds.</td></tr></tbody></table>
<p>When rekeying is enabled on a newly initialized router that does NOT have a valid, signed certificate, an alarm is generated. A valid certificate must be obtained from a Certificate Authority before valid secure communication can take place. When a valid certificate is present, the router will create a public/private key pair (see [RFC8422] for addtional information).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="default-configuration-example">Default Configuration Example<a href="#default-configuration-example" class="hash-link" aria-label="Direct link to Default Configuration Example" title="Direct link to Default Configuration Example">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        security-key-management </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            payload-key-rekey-interval    24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            peer-key-rekey-interval       24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            peer-key-retransmit-interval  30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            peer-key-timeout              3600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            invalid-certificate-behavior  fail-soft</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In cases where you want to manually force key rotation on the routers, use the <code>security metadata-key regenerate</code> command to tell the active node to immediately regenerate the metadata key with an incremented rekey index. The active node will push the new metadata key to the peer node.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sample-default-configuration">Sample Default Configuration:<a href="#sample-default-configuration" class="hash-link" aria-label="Direct link to Sample Default Configuration:" title="Direct link to Sample Default Configuration:">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        enhanced-security-key-management  true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router                  RTR_EAST_CONDUCTOR</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name                RTR_EAST_CONDUCTOR</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            node                conductor-east-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name            conductor-east-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router                   combo-east</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name                 combo-east</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            peering-common-name  second-fake-alias-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            location             usa</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            description          &quot;router 1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            inter-node-security  internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router                   combo-west</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name                 combo-west</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            peering-common-name  second-fake-alias-3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            location             usa</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            inter-node-security  internal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<p>The following Events, Alarms, and Show commands are available to troubleshoot issues encountered with Enhanced Security Key Management.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="events-and-alarms">Events and Alarms<a href="#events-and-alarms" class="hash-link" aria-label="Direct link to Events and Alarms" title="Direct link to Events and Alarms">​</a></h3>
<p>The following alarms are generated by the router on any certificate it owns if the certificate is invalid, expired, or if the router is unable to authenticate the peer. Use the <code>show alarms</code> command to see details about the alarm.</p>
<ul>
<li>Expiring within a month (Minor)</li>
<li>Expiring within a week (Major)</li>
<li>Expired (Critical)</li>
<li>Revoked (Critical)</li>
<li>Unable to Authenticate Peer</li>
</ul>
<p>The following is an example of an alarm generated if the certificate state is invalid:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">=============== ===================== ============ ==================== ================ ======================================================================== </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      ID              Time              Severity    Source              Category        Message </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=============== ===================== ============ ==================== ================ ======================================================================== </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">combo-east-1:4   2025-01-28 19:07:00   MAJOR       INTERFACE                                DHCP address for interface [wan-intf] has not been resolved </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">combo-east-1:5   2025-01-28 19:07:00   MAJOR       INTERFACE                                DHCP address for interface [lan-intf] has not been resolved </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">combo-east-1:13  2025-01-28 19:12:21   CRITICAL    RTR_WEST_COMBO           PEER            Peer RTR_WEST_COMBO certificate is invalid: expired - testing-detail </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@combo-east-1.RTR_EAST_COMBO# show alarms id combo-east-1:13 </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Tue 2025-01-28 19:17:39 UTC </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">✔ Retrieving alarms... </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============================================================================================ </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">combo-east-1:13 </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============================================================================================ </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Time: 2025-01-28 19:12:21 </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Severity: CRITICAL </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Source: RTR_WEST_COMBO </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Category: PEER </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Process: stateMonitor </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Message: Peer RTR_WEST_COMBO certificate is invalid: expired - testing-detail </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.02 seconds </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="show-commands">Show Commands<a href="#show-commands" class="hash-link" aria-label="Direct link to Show Commands" title="Direct link to Show Commands">​</a></h3>
<p><code>show security key-status</code> provides the following additional information:</p>
<ul>
<li><code>metadata rekey index</code> - Index of the current rekey interval.</li>
<li><code>metadata last rekey</code> - Number of seconds since the last rekey occurred.</li>
<li><code>metadata next rekey</code> - Number of seconds until the next rekey occurs.</li>
<li><code>metadata manager status</code> - Indicates whether the current node is Active-Leader or Redundant-Peer, or displays inactive when the feature is not enabled.</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 N1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  Key Manager State:        Active Leader</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  Rekey Index:              189000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  Last Rekey:               0 hrs 20 min 24 sec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  Next Rekey:               1 hrs 2 min 56 sec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  Key Change Count:         5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  Config Key Change Count:  2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  Key Change Error:         key error</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  Config Key Change Error:  config error</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  Metadata Rekey Index:     199000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  Metadata Last Rekey:      0 hrs 20 min 25 sec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  Metadata Next Rekey:      1 hrs 2 min 57 sec</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>show peers security</code> includes the following information:</p>
<ul>
<li>Security state machine state</li>
<li>Local salt value</li>
<li>Peer salt value</li>
<li>Local metadata key index</li>
<li>Peer metadata key index</li>
<li>Whether a peer’s certificate has been received</li>
<li>Whether a local certificate has been acknowledged by peer</li>
<li>Whether a peer’s salt has been received</li>
<li>Whether a local salt has been acknowledged by peer</li>
<li>Whether a peer’s metadata key has been received</li>
<li>Whether a local metadata key has been acknowledged by peer</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@test1.headend# show peers security</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2025-07-21 20:28:18 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">✔ Retrieving peer paths...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Peer: branch</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Peer:               branch</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Node:               test1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Network Interface:  intf11</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Destination:        172.16.4.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Status:             up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Hostname:           unavailable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Path Mtu:           unavailable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Security Status:    MKEY_EXCH_COMP</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Salt:               3565600980</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Peer Salt:          1668479739</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Key Index:          5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Peer Ki:            253</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Cert Rec:           True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Cert Ack:           True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Salt Rec:           True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Salt Ack:           True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Key Rec:            True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Key Ack:            True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Peer: branch</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Peer:               branch</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Node:               test1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Network Interface:  intf12</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Destination:        172.16.4.7</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Status:             up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Hostname:           unavailable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Path Mtu:           unavailable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Security Status:    MKEY_EXCH_COMP</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Salt:               3565600980</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Peer Salt:          1668479739</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Key Index:          5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Peer Ki:            253</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Cert Rec:           True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Cert Ack:           True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Salt Rec:           True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Salt Ack:           True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Key Rec:            True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Key Ack:            True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.10 seconds</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@test1.headend#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>show security security-associations</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node0# show security security-associations</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Fri 2024-03-01 14:28:03 UTC Retrieving security associations...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============== =========== ======= =================== ================ ======== </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Peer           Peer Name   Node    Network Interface   Destination      Status</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============== =========== ======= =================== ================ ======== </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 0200019a8f31   Hub1        node0   ge-0-0              192.168.10.101   up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 0200019a8f31   Hub1        node0   ge-0-1              172.25.22.2      up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 0200019a8f31   Hub1        node1   ge-0-0              192.168.10.101   up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 0200019a8f31   Hub1        node1   ge-0-1              172.25.22.2      up</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>show security security-associations [peer-name] detail</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node0# show security security-associations Hub1 detail</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Fri 2024-03-01 14:28:03 UTC Retrieving security associations...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Peer Name: Hub1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">State: UP</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Peer Certificate: Valid</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Public Key: Valid</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Local salt: b869b3424513340a, Remote salt: 4cb3488cb19397c3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Peer Key Rekey In: 20 hrs 2 min 56 sec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Peer Rekey Count: 5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Metadata Key Rekey In: 2 hrs 13 min 12 sec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Local Metadata Key Index: 12 (2), Remote Metadata Key Index: 13 (1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/config-custom-certs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Configure Certificate Management</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/concepts_ssr_idp"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Intrusion Detection and Prevention</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#svrv2-and-ipsec" class="table-of-contents__link toc-highlight">SVRv2 and IPSec</a></li><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How It Works</a><ul><li><a href="#key-rotation" class="table-of-contents__link toc-highlight">Key Rotation</a></li><li><a href="#ssr-keys" class="table-of-contents__link toc-highlight">SSR Keys</a></li><li><a href="#peer-key-and-key-rotation" class="table-of-contents__link toc-highlight">Peer Key and Key Rotation</a></li><li><a href="#certificate-replacement-or-revocation" class="table-of-contents__link toc-highlight">Certificate Replacement or Revocation</a></li><li><a href="#peer-authentication" class="table-of-contents__link toc-highlight">Peer Authentication</a></li><li><a href="#requirements" class="table-of-contents__link toc-highlight">Requirements</a></li></ul></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#events-and-alarms" class="table-of-contents__link toc-highlight">Events and Alarms</a></li><li><a href="#show-commands" class="table-of-contents__link toc-highlight">Show Commands</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Juniper Networks, Inc.</div></div></div></footer></div>
</body>
</html>
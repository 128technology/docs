<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">AWS Transit Gateway Connect Plugin | SSN Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/plugin_aws_tgw_connect"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="AWS Transit Gateway Connect Plugin | SSN Docs"><meta data-react-helmet="true" name="description" content="The 128T-aws-transit-gateway-connect plugin provides integration between a 128T and a Transit Gateway. It does so with the use of BGP for sharing routes and GRE tunnels to encapsulate the BGP traffic as well as any other traffic to be sent to the Transit Gateway."><meta data-react-helmet="true" property="og:description" content="The 128T-aws-transit-gateway-connect plugin provides integration between a 128T and a Transit Gateway. It does so with the use of BGP for sharing routes and GRE tunnels to encapsulate the BGP traffic as well as any other traffic to be sent to the Transit Gateway."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.128technology.com/docs/plugin_aws_tgw_connect"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/plugin_aws_tgw_connect" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/plugin_aws_tgw_connect" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.21b25f22.css">
<link rel="preload" href="/assets/js/runtime~main.880b6c9b.js" as="script">
<link rel="preload" href="/assets/js/main.aff4260a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Session Smart</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.128technology.com/home" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Interchange<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation_aws">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation_installer">Supporting Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/config_basics">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/plugin_intro">Plugins</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/plugin_aws_tgw_connect">AWS Transit Gateway Connect</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_bgp_community_services">BGP Community Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_cloud_ha">Cloud HA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_app_id">DNS App Id</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_cache">DNS Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_gre">GRE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_ha_sync_redundancy">HA Sync Redundancy Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_http_probe">HTTP Probe Reachability Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_icmp_reachability_detection">ICMP Reachability Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_ipsec_client">IPsec Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_loopback_static_routes">Loopback Static Routes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_m800_watchdog">M800 Watchdog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_monitoring_agent">Monitoring Agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_mosh">Mosh</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_set_hostname">Set Hostname</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_sip_alg">SIP ALG</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_wireguard">Wireguard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/api_rest_4.2.0">REST APIs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/release_notes_128t_5.5">Release Notes</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>AWS Transit Gateway Connect Plugin</h1></header><p>The 128T-aws-transit-gateway-connect plugin provides integration between a 128T and a Transit Gateway. It does so with the use of BGP for sharing routes and GRE tunnels to encapsulate the BGP traffic as well as any other traffic to be sent to the Transit Gateway.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The instructions for installing and managing the plugin can be found <a href="/docs/plugin_intro#installation-and-management">here</a>.</p></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="version-restrictions">Version Restrictions<a class="hash-link" href="#version-restrictions" title="Direct link to heading">​</a></h2><p> The router configuration that is generated is only compatible with 128T versions which have <a href="/docs/config_gre_tunnel">native GRE support</a> (128T &gt;= 5.2.0).</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>The plugin is designed to operate on an AWS conductor. Installing the plugin on a non AWS environment can cause delay with config commits for up to 5 seconds. Please refer to the link <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/identify_ec2_instances.html" target="_blank" rel="noopener noreferrer">here</a> on how to identify EC2 linux instances.</p></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="terms">Terms<a class="hash-link" href="#terms" title="Direct link to heading">​</a></h3><p>General Terms:</p><ul><li>Transit Gateway - A cloud router which connects VPCs and on-premise networks through a central hub.</li><li>Virtual Private Cloud (VPC) - A logically isolated virtual network in AWS where resources exist.</li><li>Transit Gateway Attachment - How the Transit Gateway attaches to a network.</li></ul><p>Transit Gateway Connect Terms:</p><ul><li>Transit Gateway Connect - A logical unit containing the Connect Attachment, Transport Attachment, a Connect VPC, and the 128T.</li><li>Transit Gateway Connect Attachment - A new type of Transit Gateway Attachment which operates on top of an existing Transport Transit Gateway Attachment.</li><li>Transport Transit Gateway Attachment - An attachment on top of which a Connect Attachment is created. Must be either of type VPC or VPN.</li><li>Transit Gateway Connect Peer - A peer that communicates over GRE and with BGP to the Transit Gateway Connect. In our case, this is a 128T.</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="approach">Approach<a class="hash-link" href="#approach" title="Direct link to heading">​</a></h3><p>Configure the following components, in order:</p><ul><li><a href="https://docs.aws.amazon.com/vpc/latest/tgw/tgw-getting-started.html" target="_blank" rel="noopener noreferrer">Transit Gateway</a></li><li><a href="https://docs.aws.amazon.com/vpc/latest/tgw/tgw-vpc-attachments.html" target="_blank" rel="noopener noreferrer">Transport Transit Gateway Attachment</a></li><li><a href="https://docs.aws.amazon.com/vpc/latest/tgw/tgw-connect.html" target="_blank" rel="noopener noreferrer">Transit Gateway Connect Attachment</a></li><li>Additionally, the routing tables must be configured to transport the GRE traffic to the Transit Gateway network interface.</li></ul><p>The plugin interacts with the AWS APIs to identify an existing &quot;Connect Peer&quot; that applies to the given node. Matching is based on the network interface IP address and the Connect Peer&#x27;s peer address. If there is no existing Connect Peer, the plugin creates one on behalf of the user. The plugin chooses the first <code>available</code> Transit Gateway Connect Attachment to create the Transit Gateway Connect Peer.</p><p>This logic collects the necessary data for the plugin to generate the appropriate BGP and GRE configuration for connection.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="setup-credentials-on-the-conductor">Setup Credentials on the Conductor<a class="hash-link" href="#setup-credentials-on-the-conductor" title="Direct link to heading">​</a></h2><p>Use the following steps to configure the Conductor to query and create AWS objects. On each Conductor node:</p><ol><li><a href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2-linux.html" target="_blank" rel="noopener noreferrer">Install</a> the AWS CLI if not already installed.</li><li><a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-files.html" target="_blank" rel="noopener noreferrer">Configure</a> AWS CLI using <code>aws configure</code>. Be sure to specify the credentials, and <code>json</code> for the <code>output</code>.</li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="configuration-snippet">Configuration Snippet<a class="hash-link" href="#configuration-snippet" title="Direct link to heading">​</a></h2><p>To determine which nodes/interfaces are to be used to connect to the transit gateway, the plugin configuration datamodel needs a tagging mechanism on the <code>network-interface</code>&#x27;s <code>address</code> to let the plugin know which interfaces are to be used for peering.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        device-interface      base</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            network-interface   base-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    ip-address                   10.10.10.10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    prefix-length                24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    gateway                      10.10.10.11</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    aws-transit-gateway-connect</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        enable true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If the router you are tagging is in a different region than the conductor, you must configure the region of the router.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    aws-transit-gateway-connect</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        region us-west-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="restrictions">Restrictions<a class="hash-link" href="#restrictions" title="Direct link to heading">​</a></h2><ul><li>Due to the nature of tagging a specific <code>address</code> under the <code>network-interface</code>, this plugin only supports peering over an interface with a static IP address.</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="troubleshooting">Troubleshooting<a class="hash-link" href="#troubleshooting" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="configuration-generation">Configuration Generation<a class="hash-link" href="#configuration-generation" title="Direct link to heading">​</a></h3><p>The <code>/var/log/128technology/persistentDataManager.log</code> file at trace level will show whether the configuration generation was run, as well as output and return code.
Configuration generation logs can be found on the conductor under <code>/var/**log**/128technology/plugins/aws-transit-gateway-connect-generate-configuration.log</code>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="helpful-commands">Helpful Commands<a class="hash-link" href="#helpful-commands" title="Direct link to heading">​</a></h3><p>After the configuration is generated, the BGP peering status can be queried on the 128T side using the following commands on the router:</p><ul><li><code>show bgp</code></li><li><code>show bgp neighbors</code></li><li><code>show bgp summary</code></li></ul><p>On the AWS Portal, under <code>VPC</code> &gt; <code>Transit Gateway Attachments</code> &gt; <code>&lt;your connect attachments&gt;</code> &gt; <code>Connect peers</code>, there will be entries for the 128T as a connect peer and the BGP status.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="appendix">Appendix<a class="hash-link" href="#appendix" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="example-configuration-generation">Example Configuration Generation<a class="hash-link" href="#example-configuration-generation" title="Direct link to heading">​</a></h3><p>With the example configuration and the following AWS TGW connect peer</p><table><thead><tr><th>Field</th><th>Value</th></tr></thead><tbody><tr><td>TGW GRE IP</td><td>10.128.2.201</td></tr><tr><td>TGW BGP IP 1</td><td>169.254.192.26</td></tr><tr><td>TGW BGP IP 2</td><td>169.254.192.27</td></tr><tr><td>128T GRE IP</td><td>10.128.2.25</td></tr><tr><td>128T BGP IP</td><td>169.254.192.25</td></tr></tbody></table><p>The following config will be generated:</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The <code>base</code> device-interface already exists and the <code>gre</code> network-interface is generated under the <code>base</code> device-interface.</p></div></div><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        device-interface base</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            network-interface  gre</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name       gre</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                type       gre-tunnel</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                tunnel</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    destination  10.128.2.201</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    source</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        network-interface</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        device-interface  bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name               bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            description        &quot;Auto-generated host KNI interface for aws-transit-gateway-connect&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type               host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            network-interface  bgp-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name       bgp-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                type       external</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address    169.254.192.25</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    ip-address     169.254.192.25</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    prefix-length  29</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    routing              default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        type              default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        routing-protocol  bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type            bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            local-as        64512</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            router-id       169.254.192.25</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address-family  ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                afi-safi  ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighbor        169.254.192.26</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                neighbor-address  169.254.192.26</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                neighbor-as       64512</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                transport</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    local-address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        node       Node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        interface  bgp-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address-family    ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    afi-safi       ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    next-hop-self  true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighbor        169.254.192.27</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                neighbor-address  169.254.192.27</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                neighbor-as       64512</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                transport</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    local-address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        node       Node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        interface  bgp-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address-family    ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    afi-safi       ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    next-hop-self  true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            redistribute    connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                protocol  connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        static-route      169.254.192.26/32 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            destination-prefix  169.254.192.26/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            distance            1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            next-hop-interface  Node1 gre</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                node       Node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                interface  gre</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        static-route      169.254.192.27/32 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            destination-prefix  169.254.192.27/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            distance            1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            next-hop-interface  Node1 gre</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                node       Node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                interface  gre</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="release-notes">Release Notes<a class="hash-link" href="#release-notes" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="release-111">Release 1.1.1<a class="hash-link" href="#release-111" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="issues-fixed">Issues Fixed<a class="hash-link" href="#issues-fixed" title="Direct link to heading">​</a></h4><ul><li><p><strong>PLUGIN-1311</strong> Commit on conductor could take up to 2 minutes to complete with plugin installed when conductor is not runnning inside AWS, even if the plugin was unconfigured.</p></li><li><p><strong>PLUGIN-1343</strong> Unnecessary additional steps needed to set up AWS CLI to utilize TGW Connect APIs.</p></li><li><p><strong>PLUGIN-1322</strong> Assets would become stuck in connected state after uninstalling plugin.</p></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-03-28T15:15:29.000Z">3/28/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/plugin_intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/plugin_bgp_community_services"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">BGP Community Services</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#version-restrictions" class="table-of-contents__link toc-highlight">Version Restrictions</a><ul><li><a href="#terms" class="table-of-contents__link toc-highlight">Terms</a></li><li><a href="#approach" class="table-of-contents__link toc-highlight">Approach</a></li></ul></li><li><a href="#setup-credentials-on-the-conductor" class="table-of-contents__link toc-highlight">Setup Credentials on the Conductor</a></li><li><a href="#configuration-snippet" class="table-of-contents__link toc-highlight">Configuration Snippet</a></li><li><a href="#restrictions" class="table-of-contents__link toc-highlight">Restrictions</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#configuration-generation" class="table-of-contents__link toc-highlight">Configuration Generation</a></li><li><a href="#helpful-commands" class="table-of-contents__link toc-highlight">Helpful Commands</a></li></ul></li><li><a href="#appendix" class="table-of-contents__link toc-highlight">Appendix</a><ul><li><a href="#example-configuration-generation" class="table-of-contents__link toc-highlight">Example Configuration Generation</a></li></ul></li><li><a href="#release-notes" class="table-of-contents__link toc-highlight">Release Notes</a><ul><li><a href="#release-111" class="table-of-contents__link toc-highlight">Release 1.1.1</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.880b6c9b.js"></script>
<script src="/assets/js/main.aff4260a.js"></script>
</body>
</html>
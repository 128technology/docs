<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-install_qcow2_deployment" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Deployment Using QCOW2 | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/docs/install_qcow2_deployment"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deployment Using QCOW2 | SSN Docs"><meta data-rh="true" name="description" content="The SSR software can now be downloaded as a qcow2 image. Qcow2 is a storage format for virtual disks. The SSR qcow2 is a virtual hard disk image pre-installed with the SSR ISO. It includes cloud-init packages which can be used to automate instance deployment. Cloud-init can be used for linux network provisioning and for disk volume dynamic expansion on first boot."><meta data-rh="true" property="og:description" content="The SSR software can now be downloaded as a qcow2 image. Qcow2 is a storage format for virtual disks. The SSR qcow2 is a virtual hard disk image pre-installed with the SSR ISO. It includes cloud-init packages which can be used to automate instance deployment. Cloud-init can be used for linux network provisioning and for disk volume dynamic expansion on first boot."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/docs/install_qcow2_deployment"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/install_qcow2_deployment" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/install_qcow2_deployment" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/kb/rss.xml" title="SSR Knowledge Base Articles RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/kb/atom.xml" title="SSR Knowledge Base Articles Atom Feed">
<link rel="alternate" type="application/json" href="/kb/feed.json" title="SSR Knowledge Base Articles JSON Feed"><link rel="stylesheet" href="/assets/css/styles.b50a304b.css">
<script src="/assets/js/runtime~main.b979695c.js" defer="defer"></script>
<script src="/assets/js/main.b3b671fd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a class="navbar__item navbar__link" href="/kb">Knowledge Base</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cc_fips_titlepage">SSR Common Criteria Install and Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/install_conductor_overview">Conductor Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_bootable_media">Router Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_image">Image-Based Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported_cloud_platforms">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_upgrade_considerations">Upgrades and Rollback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/intro_installation_installer">Supporting Install Information - Appendix</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/intro_installation_installer">Manually Installing the SSR</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/install_qcow2_deployment">Deployment Using QCOW2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/legacy_OTP_install">Installing Using the Pre-5.0 Interactive ISO</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts_fib">Understanding the Forwarding Information Base</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/config_basics">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bcp_sdwan_design_guide">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/plugin_intro">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/release_notes_128t_6.2">Release Notes</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Supporting Install Information - Appendix</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Deployment Using QCOW2</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Deployment Using QCOW2</h1></header><p>The SSR software can now be downloaded as a qcow2 image. Qcow2 is a storage format for virtual disks. The SSR qcow2 is a virtual hard disk image pre-installed with the SSR ISO. It includes cloud-init packages which can be used to automate instance deployment. Cloud-init can be used for linux network provisioning and for disk volume dynamic expansion on first boot.</p>
<p>For successful SSR qcow2 deployment, a cloud-init (or nocloud) configuration <strong>must</strong> provide persistent network interface bindings on first boot of the VM; otherwise the SSR will not correlate virtual machine NICs to router interfaces, and they may change across VM reboots. Operation of SSR qcow2 without persistent NIC bindings is not supported at this time.</p>
<p>Download the qcow2 image using the link below:</p>
<p><a href="https://software.128technology.com/artifactory/list/generic-128t-images-release-local" target="_blank" rel="noopener noreferrer">https://software.128technology.com/artifactory/list/generic-128t-images-release-local</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-cloud-init-to-bootstrap-ssr-connection-to-conductor">Using cloud-init to bootstrap SSR connection to Conductor<a href="#using-cloud-init-to-bootstrap-ssr-connection-to-conductor" class="hash-link" aria-label="Direct link to Using cloud-init to bootstrap SSR connection to Conductor" title="Direct link to Using cloud-init to bootstrap SSR connection to Conductor">​</a></h2>
<p>The simplest method for onboarding a new SSR to an existing conductor is to initialize the system as a router node and provide the addresses for any conductor nodes. The manual initialization process can be automated by providing an <a href="/docs/initializer_preferences">initializer preferences</a> file. This can be automated through <code>cloud-init cloud-config</code> by providing a user-data to a cloud-init capable hypervisor similar to what is shown below.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#cloud-config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ssh_pwauth: True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write_files:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- path: /root/initializer-preferences.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  content: |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {&quot;node-role&quot;: &quot;combo&quot;, &quot;node-ip&quot;: &quot;127.0.0.1&quot;, &quot;node-name&quot;: &quot;dummy-node&quot;, &quot;router-name&quot;: &quot;dummy-router&quot;, &quot;admin-password&quot;: &quot;$6$W2wtGSOP7lT4vqLj$zG3eYb9/QAWD/0PqiN/I6vVLtDhBzhecx.aBpdweIx4D.0NJzxIUGVRRBQPmO9K8LlU/Jj8iBaL3OS7aa75KD1&quot;, &quot;conductor&quot;: {&quot;primary&quot;: {&quot;ip&quot;: &quot;10.10.10.10&quot;}}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">runcmd:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- initialize128t -p /root/initializer-preferences.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This causes this device&#x27;s salt-minion to attempt to connect to the Conductor at IP address <code>10.10.10.10</code>. The device, by default, will set its <code>asset-id</code> to match the hostname provided by the hypervisor&#x27;s cloud-init metadata. If this unique asset-id is associated with a node in the Conductor&#x27;s configuration, the Conductor&#x27;s Automated Provisioner process will reinitialize this device with the appropriate router and node name, allowing the system to pull a full configuration.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The example above assumes that the system will be able obtain an IP address via DHCP on the first network interface, which provides connectivity to the Conductor. If this is not the case, additional configuration can be provided to cloud-init to assist in provisioning network interfaces. However, these details are beyond the scope of this document. Please consult the official cloud-init documentation and the documentation for your particular hypervisor for further guidance.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-nocloud-to-provide-cloud-init-meta-data-user-data-and-network-config">Using NoCloud to provide cloud-init meta-data, user-data, and network-config<a href="#using-nocloud-to-provide-cloud-init-meta-data-user-data-and-network-config" class="hash-link" aria-label="Direct link to Using NoCloud to provide cloud-init meta-data, user-data, and network-config" title="Direct link to Using NoCloud to provide cloud-init meta-data, user-data, and network-config">​</a></h2>
<p>Even when using a hypervisor that does not directly provide a cloud-init metadata service, it is possible to use NoCloud to seed the required data to cloud-init. On first boot, if the cloud-init process finds an attached disk with the volume label <code>cidata</code>, it looks on this disk for configuration data that is typically provided by a hypervisor&#x27;s metadata service.</p>
<p>There are three specific configuration files that may be supplied for different purposes:</p>
<ul>
<li><code>meta-data</code></li>
<li><code>user-data</code></li>
<li><code>network-config</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="meta-data"><code>meta-data</code><a href="#meta-data" class="hash-link" aria-label="Direct link to meta-data" title="Direct link to meta-data">​</a></h3>
<p>Instance meta-data must be provided to sets the system hostname. By default it is used as the SSR&#x27;s asset-id. An example of this data is shown below.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">instance-id: ssr1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local-hostname: ssr1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-data"><code>user-data</code><a href="#user-data" class="hash-link" aria-label="Direct link to user-data" title="Direct link to user-data">​</a></h3>
<p>The user-data is very useful for automating the onboarding of the VM by a Conductor. Additional considerations should be made for persistent interface naming when using NoCloud. When network configuration is provided by a hypervisor&#x27;s metadata service, it maps the interface names to MAC addresses to provide this persistence. In scenarios where NoCloud is used for automation it is not feasible to have this information in advance. Instead, the NICs on the system should be mapped by PCI address to interface names. To obtain the list of PCI addresses of the NIC interfaces, use the following steps.</p>
<ol>
<li>Boot a sample VM containing all required interfaces for the deployment on the hypervisor.</li>
<li>As root, run the command <code>lshw -c net -businfo</code> on this VM to obtain this list of PCI addresses.</li>
<li>Using the example user-data below, substitute the PCI addresses using the naming convention <code>ge-0-X</code> as Linux will run into issues renaming the devices to the standard <code>ethX</code> naming convention.</li>
</ol>
<p>It may take some experimentation to identify which PCI address maps to the appropriate interface on the VM in the order they are added.</p>
<p>The example user-data below will achieve persistent interface mapping, as well as initialize a router to connect to a Conductor at address <code>10.10.10.10</code>. The subsequent initialization process is as follows:</p>
<ul>
<li>The file containing the configuration to map the new interface names to PCI address is written to /etc/udev/rules.d/70-persistent-net.rules.</li>
<li>The initializer preferences file is written to /root/initializer-preferences.json.</li>
<li>The system is initialized.</li>
<li>The legacy <code>ifcfg-eth0</code> file (that is no longer valid) is removed.</li>
<li>The system is rebooted and the new interface naming is applied.</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#cloud-config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ssh_pwauth: True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">write_files:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- path: /etc/udev/rules.d/70-persistent-net.rules</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  content: |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, DRIVERS==&quot;?*&quot;, KERNELS==&quot;0000:00:02.0&quot;, NAME:=&quot;ge-0-0&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, DRIVERS==&quot;?*&quot;, KERNELS==&quot;0000:00:03.0&quot;, NAME:=&quot;ge-0-1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, DRIVERS==&quot;?*&quot;, KERNELS==&quot;0000:00:04.0&quot;, NAME:=&quot;ge-0-2&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, DRIVERS==&quot;?*&quot;, KERNELS==&quot;0000:00:05.0&quot;, NAME:=&quot;ge-0-3&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, DRIVERS==&quot;?*&quot;, KERNELS==&quot;0000:00:06.0&quot;, NAME:=&quot;ge-0-4&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, DRIVERS==&quot;?*&quot;, KERNELS==&quot;0000:00:07.0&quot;, NAME:=&quot;ge-0-5&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, DRIVERS==&quot;?*&quot;, KERNELS==&quot;0000:00:08.0&quot;, NAME:=&quot;ge-0-6&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, DRIVERS==&quot;?*&quot;, KERNELS==&quot;0000:00:09.0&quot;, NAME:=&quot;ge-0-7&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- path: /root/initializer-preferences.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  content: |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {&quot;node-role&quot;: &quot;combo&quot;, &quot;node-ip&quot;: &quot;127.0.0.1&quot;, &quot;node-name&quot;: &quot;dummy-node&quot;, &quot;router-name&quot;: &quot;dummy-router&quot;, &quot;admin-password&quot;: &quot;$6$W2wtGSOP7lT4vqLj$zG3eYb9/QAWD/0PqiN/I6vVLtDhBzhecx.aBpdweIx4D.0NJzxIUGVRRBQPmO9K8LlU/Jj8iBaL3OS7aa75KD1&quot;, &quot;conductor&quot;: {&quot;primary&quot;: {&quot;ip&quot;: &quot;10.10.10.10&quot;}}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">runcmd:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- initialize128t -p /root/initializer-preferences.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- /bin/rm -f /etc/sysconfig/network-scripts/ifcfg-eth0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- /usr/bin/sync;/usr/bin/sync;/usr/sbin/shutdown -r</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-config"><code>network-config</code><a href="#network-config" class="hash-link" aria-label="Direct link to network-config" title="Direct link to network-config">​</a></h3>
<p>NoCloud supports optionally supplying network configuration via an additional <code>network-config</code> script, which can be used to configure interfaces.</p>
<p>On the initial boot, the system uses legacy interface naming. The <code>network-config</code> file provided below creates a basic configuration for eth0 that removes DHCP from the existing interface configuration. This may cause a delay in the initial boot. We also create a configuration for the interface after it is renamed on ensuing boots. The interface will not be found on the first boot and therefore will be skipped, but will apply to all ensuing boots. This example can be tweaked as needed to provide a different Linux networking configuration, including static addressing. Please consult the <code>cloud-init</code> documentation on <strong>network-config version 1</strong> for additional details.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">version: 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">config:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- type: physical</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: eth0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- type: physical</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name: ge-0-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  subnets:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  - type: dhcp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cidata"><code>cidata</code><a href="#cidata" class="hash-link" aria-label="Direct link to cidata" title="Direct link to cidata">​</a></h3>
<p>To create an ISO image containing these configuration files and the volume label <code>cidata</code> on a Linux system:</p>
<ol>
<li>Place the user-data in a file named <code>user-data</code>,</li>
<li>Place the meta-data in a file named <code>meta-data</code>, and</li>
<li>Place the network-config in a file named <code>network-config</code>.</li>
<li>Run the command <code>genisoimage -output cidata.iso -V cidata -r -J user-data meta-data network-config</code>.</li>
<li>Attach the ISO to the SSR VM. Please refer to your hypervisor documentation for these instructions.</li>
<li>The cloud-init process on the system will locate the data during first boot and perform the desired actions.</li>
</ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/intro_installation_installer"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Manually Installing the SSR</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/legacy_OTP_install"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Installing Using the Pre-5.0 Interactive ISO</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#using-cloud-init-to-bootstrap-ssr-connection-to-conductor" class="table-of-contents__link toc-highlight">Using cloud-init to bootstrap SSR connection to Conductor</a></li><li><a href="#using-nocloud-to-provide-cloud-init-meta-data-user-data-and-network-config" class="table-of-contents__link toc-highlight">Using NoCloud to provide cloud-init meta-data, user-data, and network-config</a><ul><li><a href="#meta-data" class="table-of-contents__link toc-highlight"><code>meta-data</code></a></li><li><a href="#user-data" class="table-of-contents__link toc-highlight"><code>user-data</code></a></li><li><a href="#network-config" class="table-of-contents__link toc-highlight"><code>network-config</code></a></li><li><a href="#cidata" class="table-of-contents__link toc-highlight"><code>cidata</code></a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Juniper Networks, Inc.</div></div></div></footer></div>
</body>
</html>
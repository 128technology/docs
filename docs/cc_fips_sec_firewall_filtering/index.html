<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cc_fips_sec_firewall_filtering" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Customizable Firewall Rules and Filters | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/docs/cc_fips_sec_firewall_filtering"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Customizable Firewall Rules and Filters | SSN Docs"><meta data-rh="true" name="description" content="As part of the security hardening and certification process, the SSR has implemented the following firewall features to provide a more secure platform for network traffic."><meta data-rh="true" property="og:description" content="As part of the security hardening and certification process, the SSR has implemented the following firewall features to provide a more secure platform for network traffic."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/docs/cc_fips_sec_firewall_filtering"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/cc_fips_sec_firewall_filtering" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/cc_fips_sec_firewall_filtering" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/kb/rss.xml" title="SSR Knowledge Base Articles RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/kb/atom.xml" title="SSR Knowledge Base Articles Atom Feed">
<link rel="alternate" type="application/json" href="/kb/feed.json" title="SSR Knowledge Base Articles JSON Feed"><link rel="stylesheet" href="/assets/css/styles.df1c9d6e.css">
<script src="/assets/js/runtime~main.4c8f90ce.js" defer="defer"></script>
<script src="/assets/js/main.a20b0505.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a class="navbar__item navbar__link" href="/kb">Knowledge Base</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_getting_started">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/release_notes_128t_6.3">Release Notes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported-devices-overview">Supported Hardware Platforms</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts-overview">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation">Installing Software Version 6.3.0 and Later</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported_cloud_platforms">Cloud / Hypervisor Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_legacy">Installing Software Versions Earlier than 6.3.0</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_upgrade_considerations">Upgrading the SSR</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bcp_sdwan_design_guide">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/config_basics">Administration Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/security-overview">Security</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/security-overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_access_mgmt">Access Management and Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/sec_adaptive_encrypt">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/concepts_ssr_idp">Intrusion Detection and Prevention</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/cc_fips_titlepage">SSR Common Criteria Install and Configuration - SSR V6.2.5</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_titlepage">SSR Common Criteria Installation and User Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_intro">Introduction - SSR Common Criteria Installation and Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_compliance_guidelines">Common Criteria Compliance Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_ssr_security_scope">SSR Security Scope</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_secure_deliver">Identifying Secure Product Delivery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_intro_installation">Secure Installation Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_downloading_iso">Downloading ISOs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_conductor_install">Conductor Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_otp_router_install">OTP Router Install Process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_install_quickstart_otpiso">QuickStart from the OTP ISO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_router_install">Router Interactive Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_access_mgmt">Access Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_config_ntp_auth">Configure NTP Client Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_config_password_policies">Username and Password Policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_config_audit_event">Audit Events and Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/cc_fips_sec_firewall_filtering">Customizable Firewall Rules and Filters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_banners">Configuring Banners</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_software_upgrades">Upgrades and Uninstallation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cc_fips_appendix">Appendix</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/config_ha">High Availability</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/plugin_intro">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/ts_applications">Troubleshooting</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Security</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">SSR Common Criteria Install and Configuration - SSR V6.2.5</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Customizable Firewall Rules and Filters</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Customizable Firewall Rules and Filters</h1></header><p>As part of the security hardening and certification process, the SSR has implemented the following firewall features to provide a more secure platform for network traffic.</p>
<p>The SSR implements a packet filtering firewall which allows you to define rules for filtering traffic. The rules may be defined for specific traffic or all  traffic.</p>
<p>When Firewall filtering rules are defined, the traffic identified in the traffic filtering rules is filtered. Traffic that is not identified in the firewall filtering rules is allowed to pass, but is subject to conditions configured as part of SSR services. Services can be configured using IP addresses, hostnames, CIDR block ranges, and optionally transport protocols and specific ports. In order for any traffic to pass through an SSR, it must be identified in a service - its source must be classified as belonging to a tenant, its destination needs to match a FIB entry for this tenant, and a next-hop must be available for this service traffic. If traffic arrives at the SSR and does not match the firewall filters or a service, that traffic is not allowed to pass. If no firewall rules are configured, traffic is subject to the SSR and Services configuration. Traffic that does not meet these criteria is dropped. For additional service information, see <a href="https://www.juniper.net/documentation/us/en/software/session-smart-router/docs/bcp_service_and_service_policy_design" target="_blank" rel="noopener noreferrer">Service and Service Policy Design.</a></p>
<p>Firewall rules may be applied to each network interface separately, and are applied in the order defined by the user. The SSR follows the rule base for each network connection and implements the first rule that matches the traffic. The SSR inspects each packet independently, and no residual information for previously inspected packets influences the inspection.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="packet-filtering">Packet Filtering<a href="#packet-filtering" class="hash-link" aria-label="Direct link to Packet Filtering" title="Direct link to Packet Filtering">​</a></h2>
<p>The SSR uses Berkeley Packet Filters (BPF) to create customizable firewall filters. This filtering solution can be a key tool to prevent packet level attacks and aid with intrusion detection and prevention. Using BPF, packets on the SSR can be filtered by any known packet field, and the order in which filters are applied can be set by the user.
Filters are configured and applied on the receiving network-interface.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h4>
<ol>
<li>
<p>At the Authority level, define the router, then the node, the device interface, and the network interface where the filters will be configured.</p>
</li>
<li>
<p>Under <code>filter-rule</code>, define:</p>
</li>
</ol>
<ul>
<li>The <code>action</code> - <code>deny</code> discards any packets matching the filter applied. <code>permit</code> allows packets that match the rule to bypass any additional rules, and passes the traffic.</li>
<li>The filter type - <code>bpf</code> (Berkeley Packet Filter) is currently the only option. This identifies the filter to be applied. Validation confirms proper BPF syntax.</li>
</ul>
<ol start="3">
<li>
<p>Configuration of permit rules follows the same process.</p>
</li>
<li>
<p>After the Filter Rule list has been created, you can reorder the rules using the <code>move</code> command. This list determines the order in which filter rules are applied.</p>
</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The number and complexity of rules will have an impact on forwarding performance.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-example">Configuration Example:<a href="#configuration-example" class="hash-link" aria-label="Direct link to Configuration Example:" title="Direct link to Configuration Example:">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor# configure authority router 128t-west</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (router[name=128t-west])# node 128t-west</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (node[name=128t-west])# device-interface bfp-test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (device-interface[name=bfp-test])# network-interface intf30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (network-interface[name=intf30])# filter-rule DropUDP_Port400</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (filter-rule[name=DropUDP_Port400])# action deny</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (filter-rule[name=DropUDP_Port400])# bpf &quot;udp port 400&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (filter-rule[name=DropUDP_Port400])# exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (network-interface[name=intf30])# filter-rule PermitIPaddress</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (filter-rule[name=PermitIPaddress])# action permit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (filter-rule[name=PermitIPaddress])# bpf &quot;host 192.168.0.0&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Rules can be moved using the <code>move</code> command:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (device-interface[name=bfp-test])# network-interface intf30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (network-interface[name=intf30])# move filter-rule DropUDP_Port400 after PermitIPaddress</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor (network-interface[name=intf30])# show</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">name         intf30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">filter-rule  PermitIPaddress</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name    PermitIPaddress</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bpf     &quot;host 192.168.0.0&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    action  permit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">filter-rule  DropUDP_Port400</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name    DropUDP_Port400</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bpf     &quot;udp port 400&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    action  deny</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Detailed information about Berkeley Packet Filters is outside of the scope of this documentation, but is readily available on the internet.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="icmp">ICMP<a href="#icmp" class="hash-link" aria-label="Direct link to ICMP" title="Direct link to ICMP">​</a></h2>
<p>Because ICMP can be an attack vector for a network or used to discover your network topology, ICMP attributes have been updated for firewall protection.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="icmp-type-as-a-session-attribute">ICMP Type as a Session Attribute<a href="#icmp-type-as-a-session-attribute" class="hash-link" aria-label="Direct link to ICMP Type as a Session Attribute" title="Direct link to ICMP Type as a Session Attribute">​</a></h3>
<p>By default, the SSR does not use ICMP codes as a session attribute. However, the SSR does match ICMP error packets with the sessions that generated them, and only accepts those ICMP packets when they match an existing session. For instance, to protect against ICMP attacks from using a barrage of <code>Destination Unreachable</code> messages, if a TCP packet generates a <code>Destination Unreachable</code>, upon receipt of the <code>Destination Unreachable</code> the SSR uses the code to interpret the packet and match it to an existing session. If a match is found, the packet is forwarded to the end host. If a match is not found, the packet is rejected.</p>
<p>To enable ICMP type as a session attribute:</p>
<ol>
<li>
<p>From the Authority level, configure <code>icmp-control</code>.</p>
</li>
<li>
<p>Set <code>icmp-async-reply</code> to <code>drop</code>.</p>
</li>
<li>
<p>Set <code>icmp-session-match</code> to <code>identifier and type</code>.</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-example-1">Configuration Example<a href="#configuration-example-1" class="hash-link" aria-label="Direct link to Configuration Example" title="Direct link to Configuration Example">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor# configure authority icmp-control icmp-async-reply drop</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor# configure authority icmp-control icmp-session-match identifier-and-type</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="discard-icmp-echo-replies-with-no-request">Discard ICMP Echo Replies With No Request<a href="#discard-icmp-echo-replies-with-no-request" class="hash-link" aria-label="Direct link to Discard ICMP Echo Replies With No Request" title="Direct link to Discard ICMP Echo Replies With No Request">​</a></h3>
<p>When you configure the ICMP Async Reply as <code>drop</code> (shown above), any ICMP Echo Replies that arrive at the SSR are dropped if no corresponding request has been seen. This helps to prevent DoS (Denial of Service) attacks such as an ICMP Ping flood.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ipv4-option-filtering">IPv4 Option Filtering<a href="#ipv4-option-filtering" class="hash-link" aria-label="Direct link to IPv4 Option Filtering" title="Direct link to IPv4 Option Filtering">​</a></h2>
<p>Attackers sometimes configure IPv4 options incorrectly, producing either incomplete or malformed fields. These malformed packets can be used to compromise hosts on the network. IPv4 Options Filtering provides a mechanism to determine what to do with network data packets based on the options field of the packets. The SSR will inspect the IPv4 header options, compare them to a user defined exclusiont list, and make necessary decisions whether the packets are allowed or dropped and logged.</p>
<p>By default, all IPv4 packets with options are allowed. To configure the dropping of specific IPv4 options, you must first enable <code>drop-all</code>. This reveals the Drop Exclusions list, where you can define IPv4 options to exclude from the drop action.</p>
<ol>
<li>
<p>At the Authority level, configure <code>ipv4-option-filter action drop-all</code>.</p>
</li>
<li>
<p>To configure allowed options, <code>ipv4-option-filter drop-exclusion 11</code>.</p>
</li>
<li>
<p>Enter the Option type/number from the <a href="https://www.iana.org/assignments/ip-parameters/ip-parameters.xhtml#ip-parameters-1" target="_blank" rel="noopener noreferrer">IPv4 Parameters</a>.</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-example-2">Configuration Example<a href="#configuration-example-2" class="hash-link" aria-label="Direct link to Configuration Example" title="Direct link to Configuration Example">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor# configure authority ipv4-option-filter action drop-all</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor# configure authority ipv4-option-filter drop-exclusion 11</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor# show config candidate authority ipv4-option-filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ipv4-option-filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            action          drop-all</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            drop-exclusion  11</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="broadcast-and-multicast-source-addresses">Broadcast and Multicast Source Addresses<a href="#broadcast-and-multicast-source-addresses" class="hash-link" aria-label="Direct link to Broadcast and Multicast Source Addresses" title="Direct link to Broadcast and Multicast Source Addresses">​</a></h3>
<p>To prevent DoS attacks, packets with broadcast or multicast source IP and MAC addresses are now dropped by default. Otherwise the traffic is propogated across the entire network, flooding the network.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="transport-state-enforcement">Transport State Enforcement<a href="#transport-state-enforcement" class="hash-link" aria-label="Direct link to Transport State Enforcement" title="Direct link to Transport State Enforcement">​</a></h2>
<p>This functionality sets the action on how the TCP state machine should process unexpected TCP packets. This is important because in some cases where these unexpected packets arrive, it may indicate a TCP Reset attack. By default, the SSR checks and follows the TCP sequence numbers of all the sessions passing through, and increments the associated metrics. Setting the Transport State Enforcement field to Strict ensures any packets in the TCP stream that fall outside of the sequence number stream will be dropped.</p>
<p>Any packets in the TCP stream that fall outside of the sequence number stream will be dropped. This will apply to any service that has this service policy configured.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-example-3">Configuration Example<a href="#configuration-example-3" class="hash-link" aria-label="Direct link to Configuration Example" title="Direct link to Configuration Example">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor# configure authority service-policy prefer-path-2 transport-</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">state-enforcement strict</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For a detailed description of Transport State Enforcement, refer to <a href="https://www.juniper.net/documentation/us/en/software/session-smart-router/docs/bcp_service_and_service_policy_design#transport-state-enforcement" target="_blank" rel="noopener noreferrer">Transport State Enforcement</a>. For additional configuration information, see the <a href="https://www.juniper.net/documentation/us/en/software/session-smart-router/docs/config_reference_guide#service-policy" target="_blank" rel="noopener noreferrer">transport-state-enforcement</a> parameter.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tcp-half-open-connection-limit">TCP Half-Open Connection Limit<a href="#tcp-half-open-connection-limit" class="hash-link" aria-label="Direct link to TCP Half-Open Connection Limit" title="Direct link to TCP Half-Open Connection Limit">​</a></h2>
<p>Half-open TCP connections are those where the handshake has started but not completed. An attacker will initiate the handshake in order to take over all available TCP connections, known as a SYN Flood attack or distributed denial of service  (DDoS) attack. This prevents service to legitimate traffic and potentially bring down the network.</p>
<p>The SSR provides the ability to configure a limit to these half-open TCP connections.</p>
<p>The connection limit is configured at the router level (Authority &gt; Router), and is unlimited by default. To set a limit, enter a numerical value in the <code>Half-Open Connection Limit</code> field in the Router Basic Information panel. When configured, the SSR tracks how many half-open sessions there are based on existing TCP session state <strong>and will deny any new TCP sessions once the limit has been reached</strong>.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>When the SSR approaches the configured limit of half-open TCP connections, the establishment of <strong>healthy</strong> TCP sessions may be significantly impacted. Please ensure that this value is set appropriately for your network. More importantly, attempt to identify the devices that are creating half-open sessions.</p></div></div>
<p>Additionally, if you require a limit for half-open TCP sessions, it may be helpful to consider the initial TCP session timeout value. The default timer is 10 seconds. If an application fails to establish a TCP socket, the sessions that are in that state will still remain on the SSR for that initial timeout.</p>
<p>An awareness of these two values (half-open limit and TCP session timer) may mitigate the impact of limiting the establishment of <strong>healthy</strong> TCP sessions.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-example-4">Configuration Example<a href="#configuration-example-4" class="hash-link" aria-label="Direct link to Configuration Example" title="Direct link to Configuration Example">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor#</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">*admin@conductor.conductor# configure authority router 128t-west half-open-connection-l</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">imit 100000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="firewall-audit-events">Firewall Audit Events<a href="#firewall-audit-events" class="hash-link" aria-label="Direct link to Firewall Audit Events" title="Direct link to Firewall Audit Events">​</a></h2>
<p>Use the <code>show events type traffic</code> to display the two types of traffic events.</p>
<p>Use the <code>show events type traffic.denied</code> or the <code>show events type traffic.permitted</code> to display the  firewall audit events.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@combo-east-a.combo-east# show events type traffic.denied</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2024-03-06 21:00:24 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">==================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 2024-03-06T21:00:23.956Z Traffic request violates access policy.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">==================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:               traffic.denied</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Node:               combo-east-a</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Denied Reason:      access</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Destination Address:172.16.2.40</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Destination Port:   1024</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Ingress Interface:  1.10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Ip Protocol:        udp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Permitted:          False</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Source Address:     172.16.1.40</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Source Port:        1024</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@combo-east-a.combo-east# show events type traffic.permitted</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2024-03-06 21:12:25 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 2024-03-06T21:11:18.014Z Traffic request permitted.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:               traffic.permitted</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Node:               combo-east-a</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Destination Address:172.16.1.40</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Destination Port:   1024</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Ingress Interface:  5.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Ip Protocol:        udp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Permitted:          True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Source Address:     172.16.2.40</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Source Port:        1024</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> 2024-03-06T21:08:57.335Z Traffic request permitted.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:               traffic.permitted</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Node:               combo-east-a</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Destination Address:172.16.1.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Icmp Type:          8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Ingress Interface:  1.10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Ip Protocol:        icmp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Permitted:          True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Source Address:     172.16.1.40</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To correlate an interface with a firewall audit event, use the internal ID of the interface to undrestand which interface generated the event. This is visible in the <code>show device-interface</code> command as the <code>Internal ID: 1</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@test1.Fabric128# show device-interface</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Fri 2023-10-27 10:06:30 EDT</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">✔ Retrieving device interface information...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">========================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> test1:LAN</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">========================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Internal ID:         1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> PCI Address:         0000:00:04.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         fa:16:3e:88:8d:c1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Provisional Status:  up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               10 Gb/s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Duplex:              full</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                         360</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:                     4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                          0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:                    0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                          0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Plugin Info:         unavailable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="discarded-traffic">Discarded Traffic<a href="#discarded-traffic" class="hash-link" aria-label="Direct link to Discarded Traffic" title="Direct link to Discarded Traffic">​</a></h3>
<p>When firewall filtering is enabled, and rules are configured, any traffic that does not match the configured policies will be discarded/dropped. Additionally, any traffic meeting the following conditions will be discarded:</p>
<ul>
<li>Any malformed packets.</li>
<li>If the source address of the network packet is defined as being on a broadcast network.</li>
<li>If the source address of the network packet is defined as being on a multicast network.</li>
<li>Any packets with the following IP options: Loose Source Routing, Strict Source Routing, or Record Route.</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/cc_fips_config_audit_event"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Audit Events and Logging</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/cc_fips_banners"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuring Banners</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#packet-filtering" class="table-of-contents__link toc-highlight">Packet Filtering</a></li><li><a href="#icmp" class="table-of-contents__link toc-highlight">ICMP</a><ul><li><a href="#icmp-type-as-a-session-attribute" class="table-of-contents__link toc-highlight">ICMP Type as a Session Attribute</a></li><li><a href="#discard-icmp-echo-replies-with-no-request" class="table-of-contents__link toc-highlight">Discard ICMP Echo Replies With No Request</a></li></ul></li><li><a href="#ipv4-option-filtering" class="table-of-contents__link toc-highlight">IPv4 Option Filtering</a><ul><li><a href="#broadcast-and-multicast-source-addresses" class="table-of-contents__link toc-highlight">Broadcast and Multicast Source Addresses</a></li></ul></li><li><a href="#transport-state-enforcement" class="table-of-contents__link toc-highlight">Transport State Enforcement</a></li><li><a href="#tcp-half-open-connection-limit" class="table-of-contents__link toc-highlight">TCP Half-Open Connection Limit</a></li><li><a href="#firewall-audit-events" class="table-of-contents__link toc-highlight">Firewall Audit Events</a><ul><li><a href="#discarded-traffic" class="table-of-contents__link toc-highlight">Discarded Traffic</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Juniper Networks, Inc.</div></div></div></footer></div>
</body>
</html>
<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-plugin_wireguard">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Wireguard Plugin | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/docs/plugin_wireguard"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Wireguard Plugin | SSN Docs"><meta data-rh="true" name="description" content="The wireguard plugin allows your SSR to peer with other endpoints using wireguard.  With this plugin you can securely connect endpoints to your SSR fabric, extending services and network tenancy."><meta data-rh="true" property="og:description" content="The wireguard plugin allows your SSR to peer with other endpoints using wireguard.  With this plugin you can securely connect endpoints to your SSR fabric, extending services and network tenancy."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/docs/plugin_wireguard"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/plugin_wireguard" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/plugin_wireguard" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8e1fdc51.css">
<link rel="preload" href="/assets/js/runtime~main.435f396f.js" as="script">
<link rel="preload" href="/assets/js/main.87753ec2.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Session Smart</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Session Smart Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/install_conductor_overview">Conductor Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_image">Image-Based Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported_cloud_platforms">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_upgrade_considerations">Upgrades and Rollback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_installer">Supporting Install Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/config_basics">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/plugin_intro">Plugins</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_aws_tgw_connect">AWS Transit Gateway Connect</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_bgp_community_services">BGP Community Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_cloud_ha">Cloud HA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_app_id">DNS App Id</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_cache">DNS Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_gre">GRE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_ha_sync_redundancy">HA Sync Redundancy Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_http_probe">HTTP Probe Reachability Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_icmp_reachability_detection">ICMP Reachability Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_ipsec_client">IPsec Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_loopback_static_routes">Loopback Static Routes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_m800_watchdog">M800 Watchdog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_monitoring_agent">Monitoring Agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_mosh">Mosh</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_set_hostname">Set Hostname</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_sip_alg">SIP ALG</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/plugin_wireguard">Wireguard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/release_notes_128t_6.0">Release Notes</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Plugins</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Wireguard</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Wireguard Plugin</h1></header><p>The wireguard plugin allows your SSR to peer with other endpoints using <a href="https://www.wireguard.com/" target="_blank" rel="noopener noreferrer">wireguard</a>.  With this plugin you can securely connect endpoints to your SSR fabric, extending services and network tenancy.</p><p><img loading="lazy" alt="Wireguard overview" src="/assets/images/plugin_wireguard_1-8d117d6e489cf7c0bf29195ce4da31da.png" width="400" height="322" class="img_ev3q"></p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>See instructions for <a href="/docs/plugin_intro#installation-and-management">installing and managing</a> plugins.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="wireguard-basics">Wireguard Basics<a href="#wireguard-basics" class="hash-link" aria-label="Direct link to Wireguard Basics" title="Direct link to Wireguard Basics">​</a></h2><p>Wireguard operates using <a href="https://www.wireguard.com/#cryptokey-routing" target="_blank" rel="noopener noreferrer">cryptokey routing</a>, which provides device-to-edge security with an SSR service centric fabric. For any wireguard peer to securely communicate with another, a <a href="https://tools.ietf.org/html/rfc7748" target="_blank" rel="noopener noreferrer">Curve25519</a> public/private keypair is generated. Each endpoint wishing to form a peering relationship must be configured minimally with the public key of the peer, and the prefixes that are allowed to be sent to the peer.</p><p>When an SSR is configured for wireguard, it will generate a public key which can be configured in remote endpoints that are to peer with it. Additionally service prefixes that should be sent to the SSR by a wireguard peer, can be configured as allowed IPs. More information on wireguard configuration can be found <a href="https://www.wireguard.com/quickstart/" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-configuration">Basic Configuration<a href="#basic-configuration" class="hash-link" aria-label="Direct link to Basic Configuration" title="Direct link to Basic Configuration">​</a></h2><p>To configure your SSR for wireguard peering, you first create a wireguard profile on the router. For example, the following defines a profile called <code>wg-profile-1</code>. Each wireguard endpoint will use a unique address from the prefix <code>10.10.10.0/24</code> as defined in the profile and the router wireguard instance will use the first address of <code>10.10.10.1</code>.:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    router             r1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      wireguard-profile    wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name             wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        private-network</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood  remote</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address       10.10.10.1/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With a profile configured, the next step is to reference the wireguard profile on a network-interface address that you want to use for wireguard peering. For example, this sets <code>eth1-net</code> address <code>192.168.128.1</code> to function as a wireguard peering endpoint:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    router             r1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      node                 node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        device-interface  eth1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          network-interface  eth1-net</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address     192.168.128.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              wireguard-profile wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With the profile configured and set on an interface, the router will install the required components for wireguard peering.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="version-history">Version History<a href="#version-history" class="hash-link" aria-label="Direct link to Version History" title="Direct link to Version History">​</a></h4><table><thead><tr><th>Release</th><th>Modification</th></tr></thead><tbody><tr><td>2.1.0</td><td>Support for DHCP interfaces is introduced</td></tr></tbody></table><p>Wireguard profile can be configured on DHCP enabled network interfaces:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    router             r1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      node                 node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        device-interface  eth1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          network-interface  eth1-net</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            dhcp            v4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            wireguard-profile wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="services-and-tenants-with-wireguard">Services and Tenants with Wireguard<a href="#services-and-tenants-with-wireguard" class="hash-link" aria-label="Direct link to Services and Tenants with Wireguard" title="Direct link to Services and Tenants with Wireguard">​</a></h2><p>Configuration of a wireguard profile on an SSR interface does <strong>not</strong> provide access to network services. It simply allows the endpoint to connect to the router using wireguard for secure transport, and all sessions will still be subject to the rules of <a href="/docs/concepts_glossary#service-layer">tenants and services</a>. To facilitate network tenancy being given to traffic coming from wireguard peers, a profile is configured with a neighborhood. The neighborhood in the wireguard profile will function as a named Layer 3 network, and used in defining <a href="/docs/bcp_tenants#per-neighborhood-tenancy">neighborhood based tenancy</a> to provide access to services.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>If you do not have a pre-defined tenant to use for wireguard endpoints, you can optionally configure a <code>tenant</code> in the profile, and one will be automatically generated for you.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-remote-endpoints">Connecting Remote Endpoints<a href="#connecting-remote-endpoints" class="hash-link" aria-label="Direct link to Connecting Remote Endpoints" title="Direct link to Connecting Remote Endpoints">​</a></h2><p>You have devices that are remote from your SSR fabric, but you want to give them network tenancy and access to services. In this example use case, assume you have two datacenter routers <code>dc1</code> and <code>dc2</code>, hosting services for <code>172.16.1.0/24</code> and <code>172.16.2.0/24</code> respectively. You want your remote devices to connect directly to each datacenter for these services, and be given a tenant called <code>remote</code>. <code>dc1</code> has a network-interface address of <code>1.1.1.1</code>, and <code>dc2</code> has a network-interface address of <code>2.2.2.2</code> that will be used to allow wireguard peers to connect.</p><p><img loading="lazy" alt="Wireguard remote endpoints" src="/assets/images/plugin_wireguard_2-ecce2bc126cd93e9845df9687d5579f4.png" width="771" height="406" class="img_ev3q"></p><p>Each peer is assigned an address out of a <code>10.10.10.0/24</code> private network, which they can use when sending sessions on to the fabric. Also every peer will end up having a public/private wirguard keypair. For this use case example, each peers have the following info assigned to them:</p><table><thead><tr><th>peer</th><th>private address</th><th>public key</th></tr></thead><tbody><tr><td>p1</td><td><code>10.10.10.2</code></td><td><code>cScVKF4nTbdDcGoZgbkNMRFhSEC0dVqdufIBBnCNvCk=</code></td></tr><tr><td>p2</td><td><code>10.10.10.3</code></td><td><code>4uXibv7XeeTxYhc5clp0G4cIYicvY03RQGxLwDNCCEY=</code></td></tr><tr><td>p3</td><td><code>10.10.10.4</code></td><td><code>lqvXPuopoYfVcVgpUEtF8Y6BXn8n6YXXAhRGhS50vU8=</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="profile-configuration">Profile Configuration<a href="#profile-configuration" class="hash-link" aria-label="Direct link to Profile Configuration" title="Direct link to Profile Configuration">​</a></h3><p>The following config sets up profiles on each of the <code>dc1</code> and <code>dc2</code> routers, and provisions each peer.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="router-dc1">Router dc1<a href="#router-dc1" class="hash-link" aria-label="Direct link to Router dc1" title="Direct link to Router dc1">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    router             dc1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      wireguard-profile    wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name             wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        private-network</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood  remote</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address       10.10.10.1/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             p1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name        p1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            public-key  cScVKF4nTbdDcGoZgbkNMRFhSEC0dVqdufIBBnCNvCk=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            allowed-ip  10.10.10.2/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             p2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name        p2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            public-key  4uXibv7XeeTxYhc5clp0G4cIYicvY03RQGxLwDNCCEY=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            allowed-ip  10.10.10.3/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             p3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name        p3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            public-key  lqvXPuopoYfVcVgpUEtF8Y6BXn8n6YXXAhRGhS50vU8=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            allowed-ip  10.10.10.4/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      node                 node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        device-interface  eth1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          network-interface  eth1-net</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address     1.1.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              wireguard-profile wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="router-dc2">Router dc2<a href="#router-dc2" class="hash-link" aria-label="Direct link to Router dc2" title="Direct link to Router dc2">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    router             dc2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      wireguard-profile    wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name             wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        private-network</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood  remote</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address       10.10.10.1/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             p1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name        p1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            public-key  cScVKF4nTbdDcGoZgbkNMRFhSEC0dVqdufIBBnCNvCk=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            allowed-ip  10.10.10.2/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             p2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name        p2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            public-key  4uXibv7XeeTxYhc5clp0G4cIYicvY03RQGxLwDNCCEY=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            allowed-ip  10.10.10.3/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             p3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name        p3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            public-key  lqvXPuopoYfVcVgpUEtF8Y6BXn8n6YXXAhRGhS50vU8=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            allowed-ip  10.10.10.4/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    node                 node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      device-interface  eth1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface  eth1-net</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          address     2.2.2.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            wireguard-profile wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With this config committed, wireguard will be installed and set up on <code>dc1</code> and <code>dc2</code>, and it will generate a wireguard keypair automatically. Once the interface is fully installed, you can view the public wireguard key of the profile by using the CLI command <code>show device-interface router &lt;router_name&gt; name &lt;profile_name&gt;</code>. Example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.dev-conductor# show device-interface router dc1 name wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2020-08-05 16:46:41 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">===================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> node1.dc1:wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">===================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Mode:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         6a:ca:96:7b:e3:4c</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               1 Gb/s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Duplex:              full</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                       99768</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:                  1653</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                      67788</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:                 1614</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                          0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> wireguard:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   interface:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     listening port:  12800</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     name:            wg0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     public key:      lV8egtiC8AKNh+DawkSM6G8t4x6BMFCsz8m48ToxHyA=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   number of peers:   3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   peers:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#1 - p1:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.2/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  cScVKF4nTbdDcGoZgbkNMRFhSEC0dVqdufIBBnCNvCk=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#2 - p2:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.3/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  4uXibv7XeeTxYhc5clp0G4cIYicvY03RQGxLwDNCCEY=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#3 - p3:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.4/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  lqvXPuopoYfVcVgpUEtF8Y6BXn8n6YXXAhRGhS50vU8=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.27 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="remote-endpoint-configuration">Remote Endpoint Configuration<a href="#remote-endpoint-configuration" class="hash-link" aria-label="Direct link to Remote Endpoint Configuration" title="Direct link to Remote Endpoint Configuration">​</a></h3><p>Now the remote peer endpoints can be configured to peer with the <code>dc1</code> and <code>dc2</code> routers at their respective interface addresses, and route the corresponding service prefixes of <code>172.16.1.0/24</code> and <code>172.16.2.0/24</code> to each. For example, a wireguard config for peer <code>p1</code> might look like the following:</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>See <a href="https://www.wireguard.com/quickstart/" target="_blank" rel="noopener noreferrer">wireguard documentation</a> for more on configuring wireguard on other endpoints.</p></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Interface]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># p1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Address = 10.10.10.2/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PrivateKey = kLbzfaAMMn1Nen3zZ+LreKCglYJuBgdvy/fFNgIZxHk=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Peer]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># dc1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PublicKey = lV8egtiC8AKNh+DawkSM6G8t4x6BMFCsz8m48ToxHyA=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">AllowedIPs = 172.16.1.0/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Endpoint = 1.1.1.1:12800</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Peer]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># dc2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PublicKey = uB/YI6A/UZtLCLsnOuoWI+lopiwBO0/QdbdN5ryBsm4=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">AllowedIPs = 172.16.2.0/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Endpoint = 2.2.2.2:12800</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-tenant-for-endpoints">Network Tenant For Endpoints<a href="#network-tenant-for-endpoints" class="hash-link" aria-label="Direct link to Network Tenant For Endpoints" title="Direct link to Network Tenant For Endpoints">​</a></h3><p>In the remote endpoint example, traffic coming from endpoints will be transported to the appropriate SSR <code>dc1</code> or <code>dc2</code> routers using wireguard, and then be sent into the fabric sourced from each endpoint&#x27;s assigned private address in the <code>10.10.10.0/24</code> network. To assign these endpoints a tenant, thus giving them access to services, the profile is configured with a <code>neighborhood</code> of <code>remote</code>. Based on this, you can define tenant membership for each endpoint in the private network.</p><p>For example, the following could be used to give endpoints in the network a tenant of <code>remote-worker</code> (including <code>p1</code> and <code>p2</code>), but give just <code>p3</code> tenant <code>engineering</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    tenant             remote-worker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      name    remote-worker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      member  remote</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          neighborhood  remote</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          address       10.10.10.0/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    tenant             engineering</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      name    engineering</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      member  remote</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          neighborhood  remote</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          address       10.10.10.4/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="remote-service-agent">Remote Service Agent<a href="#remote-service-agent" class="hash-link" aria-label="Direct link to Remote Service Agent" title="Direct link to Remote Service Agent">​</a></h2><p>You have a remote device that needs to be accessed as an agent of a service in your SSR network. In this example use case you have a remote IoT device that hosts a <code>thing</code> service with address <code>128.128.128.128/32</code>, which must be accessed by a tenant <code>technician</code>.</p><p>A remote IoT device has a wireguard peer with a public key of <code>Jihom426SSceUCPpS1147NSNzZcY1wl40Sf+OQ1rjGU=</code>. It will be given an address of <code>10.10.10.2</code> from the private network, and it will peer with the SSR <code>r1</code> on the  <code>1.1.1.1</code> network-interface address.</p><p><img loading="lazy" alt="Wireguard service agent" src="/assets/images/plugin_wireguard_3-e84322f7e06be8206d02132a36825bf5.png" width="668" height="165" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="profile-configuration-1">Profile Configuration<a href="#profile-configuration-1" class="hash-link" aria-label="Direct link to Profile Configuration" title="Direct link to Profile Configuration">​</a></h3><p>The following configuration sets up the wireguard profile, along with the IoT device wireguard peer:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    router             r1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      wireguard-profile    wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name             wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        private-network</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          neighborhood  remote</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          address       10.10.10.1/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             iot-dev-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          name        iot-dev-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          public-key  Jihom426SSceUCPpS1147NSNzZcY1wl40Sf+OQ1rjGU=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          allowed-ip  10.10.10.2/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      node                 node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        device-interface  eth1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          network-interface  eth1-net</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address     1.1.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              wireguard-profile wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="remote-endpoint-configuration-1">Remote Endpoint Configuration<a href="#remote-endpoint-configuration-1" class="hash-link" aria-label="Direct link to Remote Endpoint Configuration" title="Direct link to Remote Endpoint Configuration">​</a></h3><p>The wireguard configuration on the IoT device might look like the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Interface]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># IoT device</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Address = 10.10.10.2/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PrivateKey = MEAtlWq4Ou7++yxjYGtTa85gzDj3mbbCy76J5oWPaG8=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Peer]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># r1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PublicKey = lV8egtiC8AKNh+DawkSM6G8t4x6BMFCsz8m48ToxHyA=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">AllowedIPs = 0.0.0.0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Endpoint = 1.1.1.1:12800</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PersistentKeepalive = 30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>If wireguard is hosted on a DHCP enabled interface, the peer&#x27;s <code>Endpoint</code> address needs to be configured with the latest IP address assigned.</p></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>The <code>PersistentKeepalive</code> in this wireguard configuration causes the peer to keep the connection to the peer alive by sending periodic traffic. This has the effect of allowing the SSR to originate sessions to the peer at any time. See <a href="https://www.wireguard.com/quickstart/" target="_blank" rel="noopener noreferrer">wireguard documentation</a> for more on configuring wireguard on other endpoints.</p></div></div><p>With the profile and peer configured on the SSR <code>r1</code>, and wireguard configured on the remote IoT device, you can verify the device is keeping the connection alive by reviewing the <code>latest handshake</code> output of <code>show device-interface router &lt;router_name&gt; name &lt;profile_name&gt;</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.dev-conductor# show device-interface router r1 name wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2020-08-05 23:33:02 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">===================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> node1.r1:wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">===================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Mode:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         6a:ca:96:7b:e3:4c</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               1 Gb/s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Duplex:              full</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                      493467</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:                  7115</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                     356373</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:                 7218</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                          0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> wireguard:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   interface:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     listening port:  12800</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     name:            wg0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     public key:      lV8egtiC8AKNh+DawkSM6G8t4x6BMFCsz8m48ToxHyA=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   number of peers:   4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   peers:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#1 - iot-dev-1:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.2/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         endpoint:    192.168.128.222:42948</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         latest handshake: 21 seconds ago</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  Jihom426SSceUCPpS1147NSNzZcY1wl40Sf+OQ1rjGU=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         transfer:    17.96 KiB received, 67.58 KiB sent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.25 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="service-routing">Service Routing<a href="#service-routing" class="hash-link" aria-label="Direct link to Service Routing" title="Direct link to Service Routing">​</a></h3><p>Finally the <code>thing</code> service must be routed to the remote wireguard peer.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="service">Service<a href="#service" class="hash-link" aria-label="Direct link to Service" title="Direct link to Service">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    service            thing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      name           thing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      description    &quot;IoT sensor data service&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      address        128.128.128.128/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      access-policy  technician</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        source      technician</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        permission  allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="service-route">Service-route<a href="#service-route" class="hash-link" aria-label="Direct link to Service-route" title="Direct link to Service-route">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    router             r1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      service-route        static-thing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name          static-thing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service-name  thing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        nat-target    10.10.10.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        next-hop      node1 wg-profile-1-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          node-name   node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          interface   wg-profile-1-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          gateway-ip  169.254.140.129</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>The <code>interface</code> and <code>gateway-ip</code> in this configuration are automatically generated as part of the profile configuration on the router, and can be seen with <code>show network-interface</code>.</p></div></div><p>With this configuration, sessions sent from the <code>technician</code> tenant to <code>128.128.128.128</code> will be given access as part of the <code>thing</code> service, and routed with a destination NAT to the wireguard interface of <code>10.10.10.2</code> on the IoT device peer.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-reference">Configuration Reference<a href="#configuration-reference" class="hash-link" aria-label="Direct link to Configuration Reference" title="Direct link to Configuration Reference">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="wireguard-profile">wireguard-profile<a href="#wireguard-profile" class="hash-link" aria-label="Direct link to wireguard-profile" title="Direct link to wireguard-profile">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="path">Path<a href="#path" class="hash-link" aria-label="Direct link to Path" title="Direct link to Path">​</a></h4><p>authority &gt; router &gt; wireguard-profile</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description">Description<a href="#description" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>A profile describing an instance of wireguard on the router.</p><table><thead><tr><th>Element</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>name</code></td><td>string</td><td>A string identifier for wireguard profile. This identifier is used as a device interface name in the host, therefore it can only use alphanumerics, underscores, or dashes, and cannot exceed 12 characters.</td></tr><tr><td><code>description</code></td><td>string</td><td>A description about the wireguard profile.</td></tr><tr><td><code>loopback-address</code></td><td>ipv4-prefix</td><td>An internal address prefix for KNI connectivity between wireguard and the data plane.</td></tr><tr><td><code>port</code></td><td>l4-port</td><td>The UDP port for the wireguard instance to recieve connections on.</td></tr><tr><td><code>inactivity-timeout</code></td><td>milliseconds</td><td>Inactivity timeout for wireguard sessions. By default this uses 180000 ms UDP timeout value. If customized to a non-default value, a new session-type will be automatically generated.</td></tr><tr><td><code>service-class</code></td><td>string</td><td>The service-class to associate with the generated session-type for this wireguard profile. Wireguard sessions arriving at the router will be given this service-class.</td></tr><tr><td><code>access-policy</code></td><td>access-policy</td><td>List of access policies for the wireguard service. Packets allowed by this access policy will additionally be subject to wireguard security validation. See <a href="/docs/config_reference_guide#access-policy-service">service access policy</a>.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="private-network">private-network<a href="#private-network" class="hash-link" aria-label="Direct link to private-network" title="Direct link to private-network">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="path-1">Path<a href="#path-1" class="hash-link" aria-label="Direct link to Path" title="Direct link to Path">​</a></h4><p>authority &gt; router &gt; wireguard-profile &gt; private-network</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-1">Description<a href="#description-1" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>A network to be associated with router the wireguard network-interface. This network handles packets after they have been decrypted from a wireguard peer connection, or prior to being encrypted and sent to a wireguard peer connection. The router wireguard instance will use the address given, and other peers can send or receive sessions using the remaining addresses in the network.</p><table><thead><tr><th>Element</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>neighborhood</code></td><td>neighborhood-id</td><td>Neighborhood to be associated with the wireguard network. Addresses assigned to peers can be made members of an appropriate existing tenant based on this neighborhood.</td></tr><tr><td><code>tenant-name</code></td><td>string</td><td>A tenant to be associated with addresses in the network. If configured, a tenant will be automatically generated with the addresses in the neighborhood set as members. If not configured, no tenant will be generated, and peer addresses in the network will need to be defined as members of existing tenants.</td></tr><tr><td><code>address</code></td><td>ip prefix</td><td>The address and prefix associated with the wireguard profile. The wireguard interface created on the router will use the address defined, and other peers can send or receive sessions using the remaining addresses in the network.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="peer">peer<a href="#peer" class="hash-link" aria-label="Direct link to peer" title="Direct link to peer">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="path-2">Path<a href="#path-2" class="hash-link" aria-label="Direct link to Path" title="Direct link to Path">​</a></h4><p>authority &gt; router &gt; wireguard-profile &gt; peer</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-2">Description<a href="#description-2" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>Set of allowed wireguard peers.</p><table><thead><tr><th>Element</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>name</code></td><td>string</td><td>Name identifier for the peer.</td></tr><tr><td><code>public-key</code></td><td>string</td><td>The peer&#x27;s base64 encoded 32 byte Curve25519 public wireguard key.</td></tr><tr><td><code>preshared-key</code></td><td>string</td><td>The peer&#x27;s optional base64 encoded 32 byte Curve25519 pre-shared wireguard key.</td></tr><tr><td><code>persistent-keepalive</code></td><td>seconds</td><td>Interval in seconds at which to send keepalive messages to the peer. Keepalives are optional. No configuration or a setting of &#x27;0&#x27; disables keepalives.</td></tr><tr><td><code>allowed-ip</code></td><td>ip prefix</td><td>The prefixes that are allowed to be sent to the peer. When the peer is an endpoint, typically the allowed-ip is the /32 of the peer&#x27;s wireguard interface. If the peer is a gateway device, the allowed-ip list would include any prefixes reachable as services via the peer, or prefixes from which traffic may be sourced.</td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Disabled keepalives on the router does not mean keepalives cannot be generated by the remote peer. If keepalives are desired, a typical configuration is to have keepalives disabled on the router, but enabled on the remote peer.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="endpoint">endpoint<a href="#endpoint" class="hash-link" aria-label="Direct link to endpoint" title="Direct link to endpoint">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="path-3">Path<a href="#path-3" class="hash-link" aria-label="Direct link to Path" title="Direct link to Path">​</a></h4><p>authority &gt; router &gt; wireguard-profile &gt; peer &gt; endpoint</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-3">Description<a href="#description-3" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>IP and port of the endpoint. If not set, the endpoint of the peer will establish dynamically based on the source address discovered during the wireguard handshake.</p><table><thead><tr><th>Element</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>ip</code></td><td>ip address</td><td>Static IP address where the peer can be reached to connect.</td></tr><tr><td><code>port</code></td><td>port number</td><td>Port at which the peer can be reached to connect.</td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>If an endpoint is configured, wireguard on the SSR may attempt to send outbound sessions to the IP and port defined. The sessions will originate from the profile loopback-address. A tenant and service must be created to route the outbound wireguard session to the defined peer endpoint.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="interface-status">Interface status<a href="#interface-status" class="hash-link" aria-label="Direct link to Interface status" title="Direct link to Interface status">​</a></h4><p>To view the status of a wireguard interface, and its peers, use the following PCLI command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">show device-interface router &lt;router_name&gt; name &lt;profile_name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.dev-conductor# show device-interface router r1 name wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Fri 2020-08-07 13:35:22 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">===================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> node1.r1:wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">===================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Mode:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         6a:ca:96:7b:e3:4c</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               1 Gb/s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Duplex:              full</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                     4349806</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:                 50978</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                    4793736</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:                63193</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                          0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> wireguard:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   interface:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     listening port:  12800</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     name:            wg0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     public key:      lV8egtiC8AKNh+DawkSM6G8t4x6BMFCsz8m48ToxHyA=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   number of peers:   5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   peers:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#1 - iot-dev-1:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.5/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         endpoint:    192.168.128.222:42948</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         latest handshake:1 minute, 2 seconds ago</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  Jihom426SSceUCPpS1147NSNzZcY1wl40Sf+OQ1rjGU=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         transfer:    368.22 KiB received, 177.72 KiB sent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#2 - p1:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.2/32, 192.168.8.0/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         endpoint:    192.168.128.30:58608</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         latest handshake:11 hours, 35 minutes, 38 seconds ago</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  cScVKF4nTbdDcGoZgbkNMRFhSEC0dVqdufIBBnCNvCk=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         transfer:    775.50 KiB received, 771.83 KiB sent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#3 - p2:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.3/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  4uXibv7XeeTxYhc5clp0G4cIYicvY03RQGxLwDNCCEY=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#4 - p3:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.4/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  lqvXPuopoYfVcVgpUEtF8Y6BXn8n6YXXAhRGhS50vU8=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="interface-and-profile-configuration-logging">Interface and profile configuration logging<a href="#interface-and-profile-configuration-logging" class="hash-link" aria-label="Direct link to Interface and profile configuration logging" title="Direct link to Interface and profile configuration logging">​</a></h4><p>Logging of new configuration sent to the router can be viewed in the Linux shell using the system journal.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -u 128T-handle-wireguard-config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[t128@dev-fitlet ~]$ sudo journalctl -u 128T-handle-wireguard-config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- Logs begin at Sun 2012-01-01 00:37:26 UTC, end at Fri 2020-08-07 13:38:00 UTC. --</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet systemd[1]: Starting Handler for 128T wireguard config...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote&#x27; does not exist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote&#x27; created</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/init&#x27; does not exist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/reinit&#x27; does not exist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/shutdown&#x27; does not exist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/startup&#x27; does not exist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/init&#x27; symlink to &#x27;/etc/128technology/plugins/network-scripts/default/kni_namespace/init&#x27; created</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/reinit&#x27; symlink to &#x27;/etc/128technology/plugins/network-scripts/default/kni_namespace/reinit&#x27; created</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/shutdown&#x27; symlink to &#x27;/etc/128technology/plugins/network-scripts/default/kni_namespace/shutdown&#x27; created</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/startup&#x27; symlink to &#x27;/etc/128technology/plugins/network-scripts/default/kni_namespace/startup&#x27; created</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="peer-configuration-logging">Peer configuration logging<a href="#peer-configuration-logging" class="hash-link" aria-label="Direct link to Peer configuration logging" title="Direct link to Peer configuration logging">​</a></h4><p>Looging of peer configuration handling can be viewed in the Linux shell using the system journal.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -u 128T-handle-wireguard-peer-config@&lt;profile_name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[t128@dev-fitlet ~]$ sudo journalctl -u 128T-handle-wireguard-peer-config@wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-- Logs begin at Sun 2012-01-01 00:37:26 UTC, end at Fri 2020-08-07 13:36:42 UTC. --</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Aug 05 14:32:40 dev-fitlet systemd[1]: Starting Handler for wireguard peer and network config wg/profile/1...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Aug 05 14:32:40 dev-fitlet node[32315]: &#x27;/etc/128technology/plugins/network-scripts/host/wg-profile-1/wg0.conf&#x27; written</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="wireguard-not-installed-on-the-router">Wireguard not installed on the router<a href="#wireguard-not-installed-on-the-router" class="hash-link" aria-label="Direct link to Wireguard not installed on the router" title="Direct link to Wireguard not installed on the router">​</a></h4><p>In some cases, it is possible that the version of SSR software is not compatible with wireguard. In such a case you will see the log messages like below in the journal</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dec 18 20:56:03 t211-dut2.openstacklocal python3.6[28707]: __main__ - Could not validate wireguard packages: Could not query package kmod-wireguard, Command &#x27;[&#x27;rpm&#x27;, &#x27;-q&#x27;, &#x27;kmod-wireguard&#x27;]&#x27; returned non-zero exit status 1.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In some upgrade and rollback scenarios, it is possible that an older version of the module is installed on the router but that version is not compatible. Typically in such scenarios, a new version will be installed by the conductor but in some scenarios a compatible version might not be available. The following log messages in the journal can help troubleshoot these errors.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dec 18 20:56:03 t211-dut2.openstacklocal python3.6[26711]: __main__ - Running startup check commands for ns: wg-profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dec 18 20:56:03 t211-dut2.openstacklocal python3.6[26711]: __main__ - Executing command: [&#x27;/usr/libexec/wireguard/startup-check&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dec 18 20:56:03 t211-dut2.openstacklocal python3.6[28707]: __main__ - Could not validate wireguard packages: Invalid kmod-wireguard for kernel version 3.10.0-1160.el7</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dec 18 20:56:03 t211-dut2.openstacklocal python3.6[26711]: __main__ - not starting wg-profile-1: startup check error: Command &#x27;[&#x27;/usr/libexec/wireguard/startup-check&#x27;]&#x27; returned non-zero exit status 1.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="release-notes">Release Notes<a href="#release-notes" class="hash-link" aria-label="Direct link to Release Notes" title="Direct link to Release Notes">​</a></h2><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>The plugin must be updated to version 2.0.3 or later prior to <a href="/docs/intro_upgrade_considerations#plugin-config-generation-changes">upgrading the conductor to SSR version 5.4.0.</a></p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-212">Release 2.1.2<a href="#release-212" class="hash-link" aria-label="Direct link to Release 2.1.2" title="Direct link to Release 2.1.2">​</a></h3><p><strong>Release Date:</strong> Dec 08, 2022</p><p><strong>Router Version</strong></p><ul><li>128T-wireguard-router-2.1.6-3</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-features-and-improvements">New Features and Improvements<a href="#new-features-and-improvements" class="hash-link" aria-label="Direct link to New Features and Improvements" title="Direct link to New Features and Improvements">​</a></h4><ul><li><strong>PLUGIN-1839</strong> Reduce time to apply salt states in large scale deployments</li></ul><p>By using Saltstack data files, the time to apply high states across all assets is significantly reduced.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed">Issues Fixed<a href="#issues-fixed" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><p><strong>PLUGIN-1771</strong> Missing neighborhood config on router breaks the config for other routers</p><p><em><strong>Resolution:</strong></em> The plugin will validate the missing configuration and prevent a failure on one router from impacting others.</p></li><li><p><strong>PLUGIN-1947</strong> Wireguard plugin fails to operate on certain DHCP enabled interfaces</p><p><em><strong>Resolution:</strong></em> The plugin handles the DHCP address in the presence of a neighborhood configuration more gracefully.</p></li><li><p><strong>PLUGIN-1954</strong> Wireguard plugin fails to run on SSR-5.5.5 and higher</p><p><em><strong>Resolution:</strong></em> The wireguard plugin was extended to support newer kernel versions required for SSR-5.5.5 and above.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-211">Release 2.1.1<a href="#release-211" class="hash-link" aria-label="Direct link to Release 2.1.1" title="Direct link to Release 2.1.1">​</a></h3><p><strong>Release Date:</strong> Jun 16, 2022</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-1">Issues Fixed<a href="#issues-fixed-1" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><p><strong>PLUGIN-1505</strong> Wireguard config does not allow reference to an existing tenant</p><p><em><strong>Resolution:</strong></em> The config generation logic for the plugin will allow references to existing tenants.</p></li><li><p><strong>PLUGIN-1753</strong> Disabling wireguard plugin can cause the SSR manifest to be removed</p><p><em><strong>Resolution:</strong></em> When disabling the plugin, the kernel modules and SSR manifest are no longer removed.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-210">Release 2.1.0<a href="#release-210" class="hash-link" aria-label="Direct link to Release 2.1.0" title="Direct link to Release 2.1.0">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-features-and-improvements-1">New Features and Improvements<a href="#new-features-and-improvements-1" class="hash-link" aria-label="Direct link to New Features and Improvements" title="Direct link to New Features and Improvements">​</a></h4><ul><li><strong>PLUGIN-1429</strong>  Support wireguard on DHCP interfaces<ul><li>The feature adds support for configuring wireguard profile on the network interface level when DHCP is enabled.</li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-2">Issues Fixed<a href="#issues-fixed-2" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><p><strong>PLUGIN-1469</strong>  Add support for kernel version <code>4.18.0-305.19.1</code>.</p></li><li><p><strong>PLUGIN-1480</strong> Large configuration was causing plugin config generation to fail</p><p><em><strong>Resolution:</strong></em> The config generation logic for the plugin will handle config with long lines correctly</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-203">Release 2.0.3<a href="#release-203" class="hash-link" aria-label="Direct link to Release 2.0.3" title="Direct link to Release 2.0.3">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-3">Issues Fixed<a href="#issues-fixed-3" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><p><strong>PLUGIN-1443</strong>  Config generation for the plugin failing</p><p><em><strong>Resolution:</strong></em> Correctly handle the config generation for routers where the DNS cache plugin is not enabled during config generation</p></li><li><p><strong>PLUGIN-1220</strong>  Add support for kernel version <code>3.10.0-1160.21.1</code>.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-202-122">Release 2.0.2, 1.2.2<a href="#release-202-122" class="hash-link" aria-label="Direct link to Release 2.0.2, 1.2.2" title="Direct link to Release 2.0.2, 1.2.2">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-4">Issues Fixed<a href="#issues-fixed-4" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><strong>PLUGIN-1089</strong> Add support for kernel version <code>3.10.0-1160.11.1</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-201-121">Release 2.0.1, 1.2.1<a href="#release-201-121" class="hash-link" aria-label="Direct link to Release 2.0.1, 1.2.1" title="Direct link to Release 2.0.1, 1.2.1">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-5">Issues Fixed<a href="#issues-fixed-5" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><strong>PLUGIN-1072</strong> Allow wireguard to start when the required version of <code>kmod-wireguard</code> is installed along with versions not used by the active kernel.</li><li><strong>PLUGIN-611</strong> Added support for plugin state. Plugin state information can be accessed on the PCLI using <code>show plugins state [router &lt;router&gt;] [node &lt;node&gt;] [{detail | summmary}] 128T-wireguard</code></li><li><strong>PLUGIN-768</strong> Support the Wireguard plugin on conductors running SSR versions <code>5.1.0</code> and greater.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="caveat">Caveat<a href="#caveat" class="hash-link" aria-label="Direct link to Caveat" title="Direct link to Caveat">​</a></h3><ul><li><strong>I95-38622</strong> The plugin is not supported on routers running SSR version <code>5.1.0</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-120">Release 1.2.0<a href="#release-120" class="hash-link" aria-label="Direct link to Release 1.2.0" title="Direct link to Release 1.2.0">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-6">Issues Fixed<a href="#issues-fixed-6" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><strong>PLUGIN-922</strong> Support multiple kernel versions for SSR Wireguard plugin and allow for graceful upgrade and rollback of the SSR software releases. The enhancement currently supports the following kernel versions: <code>3.10.0-1062.9.1</code>, <code>3.10.0-1127.18.2</code>, <code>3.10.0-1160</code>, and <code>3.10.0-1160.6.1</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="caveat-1">Caveat<a href="#caveat-1" class="hash-link" aria-label="Direct link to Caveat" title="Direct link to Caveat">​</a></h3><ul><li><strong>PLUGIN-987</strong> An SSR software downgrade might fail when the currently installed wireguard kernel module and the new kernel being downgraded to are not compatible. The following procedure may be used to work around this issue</li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>The process below will cause the wireguard tunnels to be torn down and the peers to disconnect. Please perform the operations during a maintenance window only.</p></div></div><ul><li>Create a backup of the current running configuration to be restored later.</li><li>Before rolling back the SSR version, remove all references to <code>wireguard-profile</code> from <code>authority &gt; router &gt; device-interface &gt; network-interface &gt; address</code>. Once these changes are committed, the wireguard rpms will be removed from the router.</li><li>Rollback the SSR software to the desired version.</li><li>Restore the backup created in the first step. Once the changes are committed, the correct wireguard rpm&#x27;s will be installed on the router.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-110">Release 1.1.0<a href="#release-110" class="hash-link" aria-label="Direct link to Release 1.1.0" title="Direct link to Release 1.1.0">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-7">Issues Fixed<a href="#issues-fixed-7" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><strong>PLUGIN-863</strong> A kernel panic condition occurs when running Wireguard with the kernel version <code>3.10.0-1127.18.2</code> or above.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-03-02T18:16:51.000Z">Mar 2, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/plugin_sip_alg"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SIP ALG</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/plugin_kni_namespace_scripts"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">KNI Namespace Scripts</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#wireguard-basics" class="table-of-contents__link toc-highlight">Wireguard Basics</a></li><li><a href="#basic-configuration" class="table-of-contents__link toc-highlight">Basic Configuration</a></li><li><a href="#services-and-tenants-with-wireguard" class="table-of-contents__link toc-highlight">Services and Tenants with Wireguard</a></li><li><a href="#connecting-remote-endpoints" class="table-of-contents__link toc-highlight">Connecting Remote Endpoints</a><ul><li><a href="#profile-configuration" class="table-of-contents__link toc-highlight">Profile Configuration</a></li><li><a href="#remote-endpoint-configuration" class="table-of-contents__link toc-highlight">Remote Endpoint Configuration</a></li><li><a href="#network-tenant-for-endpoints" class="table-of-contents__link toc-highlight">Network Tenant For Endpoints</a></li></ul></li><li><a href="#remote-service-agent" class="table-of-contents__link toc-highlight">Remote Service Agent</a><ul><li><a href="#profile-configuration-1" class="table-of-contents__link toc-highlight">Profile Configuration</a></li><li><a href="#remote-endpoint-configuration-1" class="table-of-contents__link toc-highlight">Remote Endpoint Configuration</a></li><li><a href="#service-routing" class="table-of-contents__link toc-highlight">Service Routing</a></li></ul></li><li><a href="#configuration-reference" class="table-of-contents__link toc-highlight">Configuration Reference</a><ul><li><a href="#wireguard-profile" class="table-of-contents__link toc-highlight">wireguard-profile</a></li><li><a href="#private-network" class="table-of-contents__link toc-highlight">private-network</a></li><li><a href="#peer" class="table-of-contents__link toc-highlight">peer</a></li><li><a href="#endpoint" class="table-of-contents__link toc-highlight">endpoint</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li><li><a href="#release-notes" class="table-of-contents__link toc-highlight">Release Notes</a><ul><li><a href="#release-212" class="table-of-contents__link toc-highlight">Release 2.1.2</a></li><li><a href="#release-211" class="table-of-contents__link toc-highlight">Release 2.1.1</a></li><li><a href="#release-210" class="table-of-contents__link toc-highlight">Release 2.1.0</a></li><li><a href="#release-203" class="table-of-contents__link toc-highlight">Release 2.0.3</a></li><li><a href="#release-202-122" class="table-of-contents__link toc-highlight">Release 2.0.2, 1.2.2</a></li><li><a href="#release-201-121" class="table-of-contents__link toc-highlight">Release 2.0.1, 1.2.1</a></li><li><a href="#caveat" class="table-of-contents__link toc-highlight">Caveat</a></li><li><a href="#release-120" class="table-of-contents__link toc-highlight">Release 1.2.0</a></li><li><a href="#caveat-1" class="table-of-contents__link toc-highlight">Caveat</a></li><li><a href="#release-110" class="table-of-contents__link toc-highlight">Release 1.1.0</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.435f396f.js"></script>
<script src="/assets/js/main.87753ec2.js"></script>
</body>
</html>
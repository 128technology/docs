<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-167298415-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="128T Docs" href="/opensearch.xml"><title data-react-helmet="true">Wireguard Plugin | 128T Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Wireguard Plugin | 128T Docs"><meta data-react-helmet="true" name="description" content="The wireguard plugin allows your 128T router to peer with other endpoints using wireguard.  With this plugin you can securely connect endpoints to your 128T fabric, extending services and network tenancy."><meta data-react-helmet="true" property="og:description" content="The wireguard plugin allows your 128T router to peer with other endpoints using wireguard.  With this plugin you can securely connect endpoints to your 128T fabric, extending services and network tenancy."><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/plugin_wireguard"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://docs.128technology.com/docs/plugin_wireguard"><link rel="stylesheet" href="/styles.9a832058.css">
<link rel="preload" href="/styles.9d9f1195.js" as="script">
<link rel="preload" href="/runtime~main.61b629c8.js" as="script">
<link rel="preload" href="/main.4174e6aa.js" as="script">
<link rel="preload" href="/1.d7531bbb.js" as="script">
<link rel="preload" href="/2.159762e9.js" as="script">
<link rel="preload" href="/128.2c9fac13.js" as="script">
<link rel="preload" href="/131.acb7d52c.js" as="script">
<link rel="preload" href="/20ac7829.ae2cfb24.js" as="script">
<link rel="preload" href="/17896441.89dd6768.js" as="script">
<link rel="preload" href="/c5ae1959.4afcefcd.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title">Technology</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.128technology.com/home" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Interchange</a><a href="https://www.128technology.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title">Technology</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Docs</a></li><li class="menu__list-item"><a href="https://community.128technology.com/home" target="_blank" rel="noopener noreferrer" class="menu__link">Interchange</a></li><li class="menu__list-item"><a href="https://www.128technology.com/" target="_blank" rel="noopener noreferrer" class="menu__link">Company</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_128t">128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_releases">128T Releases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_support_policy">Software Support Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_supported_platforms">Platform Support Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_certified_platforms">Certified Platforms</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_security_policy">Security Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_svr_savings">SVR Savings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/CONTRIBUTING">Contributing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_getting_started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation">Installation Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_system_reqs">Hardware Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_prepare_OS">Operating System Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_installer">Manually Installing the 128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_downloading_iso">Downloading ISOs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_bootable_media">Installing From ISO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_creating_bootable_usb">Creating Bootable USB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_otp_iso">Installing From OTP ISO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_ztp">QuickStart from a Bootable ISO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_aws">Installing in AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_quickstart_aws">QuickStart Installation in AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_azure">Installing in Azure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_upgrading">Upgrading</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_rollback">Rollback</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_application_discovery">Application Discovery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_appid">Application Identification</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_ha_theoryofoperation">HA - Theory of Operation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_interface_types">Interface Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_kni">Kernel Network Interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_linux_host_networking">Linux Host Networking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_network_planes">Forwarding Planes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_metadata">128T Metadata</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_metrics">Metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_machine_communication">Machine Communication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_pcli">PCLI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_session_timer">Session Timers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_waypoint_ports">Waypoints</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_glossary">Glossary</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Administration</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_asset_connection_resiliency">Asset Connection Resiliency</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_basics">Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_bgp">BGP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_reference_guide">Element Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_audit_log">Audit Log</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_dhcp">DHCP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_dns_proxy">DNS Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_dual_router_ha">High Availability (Dual Router)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_ldap">LDAP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_ha">High Availability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_management_over_forwarding">Management over Forwarding</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_adding_interfaces_to_ha_team">Adding Interfaces to HA Team Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_transition_standalone_to_ha">Transitioning a Conductor from Standalone to HA</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_nat">NAT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_ospf">OSPF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_rate_limiting">Rate Limiting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_snmp">SNMP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_snmp_metrics">SNMP: User defined metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_static_hostname_mapping">Static Hostname Mappings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_tenants">Tenants</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_templates">Configuration Templates</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">How To</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_conductor_migration">Conductor Migration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_extend_gui_nav">Extending GUI Nav</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_lte">LTE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_maintenance_mode">Maintenance Mode</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_ms365">Microsoft 365</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_trusted_ca_certificate">Adding a Trusted Certificate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_tune_bfd">Tuning BFD</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_applications">Application Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_ap_salt_minion">AP: Salt Minion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_cpu_spikes">CPU Spikes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_connecting_to_routers">Connecting to Routers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_forwarding_resource_pools">Forwarding Plane Resource Pools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_logs">Logs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_mac_uniqueness">MAC Address Uniqueness</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_packet_capture">PCLI Packet Capture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_t1_troubleshooting">T1 Troubleshooting</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Events</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_overview">Alarm and Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_alarms">Alarms</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_events">Events</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Best Practices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_att_avpn_configuration">AT&amp;T AVPN Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_conductor_deployment">Conductor Deployment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_qos_msft_expressroute">ExpressRoute QoS Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_lte_peering">LTE Peering</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_monitoring_headends">Monitoring Head End Routers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_salt_pillars">Saltstack at Scale With 128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_sdwan_design_guide">SD-WAN Design Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_service_and_service_policy_design">Service and Service Policy Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_service-policy_defaults">Service Policy Baseline Defaults</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_tenants">Tenancy Design</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CLI Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli_reference">Command Line Reference</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_app_id">DNS App Id</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_cache">DNS Cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_gre">GRE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_icmp_reachability_detection">ICMP Reachability Detection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_ipsec_client">IPsec Client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_loopback_static_routes">Loopback Static Routes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_m800_watchdog">M800 Watchdog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_monitoring_agent">Monitoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_mosh">Mosh</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_sip_alg">SIP ALG</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/plugin_wireguard">Wireguard</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">REST APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api_rest_4.2.0">128T-4.2.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Release Notes</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.5">4.5</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.4">4.4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.3">4.3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.2">4.2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.1">4.1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.0">4.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T Installer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.6">2.6</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.5">2.5</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.4">2.4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.3">2.3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.2">2.2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.1">2.1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T SIP ALG</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_sip_alg_2.1">2.1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T ZScaler</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_zscaler_1.1">1.1</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Wireguard Plugin</h1></header><div class="markdown"><p>The wireguard plugin allows your 128T router to peer with other endpoints using <a href="https://www.wireguard.com/" target="_blank" rel="noopener noreferrer">wireguard</a>.  With this plugin you can securely connect endpoints to your 128T fabric, extending services and network tenancy.</p><p><img src="/img/plugin_wireguard_1.png" alt="Wireguard overview"></p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>See instructions for <a href="/docs/plugin_intro#installation-and-management">installing and managing</a> plugins.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="wireguard-basics"></a>Wireguard Basics<a aria-hidden="true" tabindex="-1" class="hash-link" href="#wireguard-basics" title="Direct link to heading">#</a></h2><p>Wireguard operates using <a href="https://www.wireguard.com/#cryptokey-routing" target="_blank" rel="noopener noreferrer">cryptokey routing</a>, which provides device-to-edge security with a 128T service centric fabric. For any wireguard peer to securely communicate with another, a <a href="https://tools.ietf.org/html/rfc7748" target="_blank" rel="noopener noreferrer">Curve25519</a> public/private keypair is generated. Each endpoint wishing to form a peering relationship must be configured minimally with the public key of the peer, and the prefixes that are allowed to be sent to the peer.</p><p>When a 128T router is configured for wireguard, it will generate a public key which can be configured in remote endpoints that are to peer with it. Additionally service prefixes that should be sent to the 128T router by a wireguard peer, can be configured as allowed IPs. More information on wireguard configuration can be found <a href="https://www.wireguard.com/quickstart/" target="_blank" rel="noopener noreferrer">here</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="basic-configuration"></a>Basic Configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#basic-configuration" title="Direct link to heading">#</a></h2><p>To configure your 128T router for wireguard peering, you first create a wireguard profile on the router. For example, the following defines a profile called <code>wg-profile-1</code>. Each wireguard endpoint will use a unique address from the prefix <code>10.10.10.0/24</code> as defined in the profile and the router wireguard instance will use the first address of <code>10.10.10.1</code>.:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    router             r1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      wireguard-profile    wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name             wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        private-network</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood  remote</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address       10.10.10.1/24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div></div></div><p>With a profile configured, the next step is to reference the wireguard profile on a network-interface address that you want to use for wireguard peering. For example, this sets <code>eth1-net</code> address <code>192.168.128.1</code> to function as a wireguard peering endpoint:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    router             r1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      node                 node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        device-interface  eth1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          network-interface  eth1-net</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address     192.168.128.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              wireguard-profile wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div></div></div><p>With the profile configured and set on an interface, the router will install the required components for wireguard peering.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="services-and-tenants-with-wireguard"></a>Services and Tenants with Wireguard<a aria-hidden="true" tabindex="-1" class="hash-link" href="#services-and-tenants-with-wireguard" title="Direct link to heading">#</a></h2><p>Configuration of a wireguard profile on a 128T router interface does <strong>not</strong> provide access to network services. It simply allows the endpoint to connect to the router using wireguard for secure transport, and all sessions will still be subject to the rules of <a href="/docs/concepts_glossary#service-layer">tenants and services</a>. To facilitate network tenancy being given to traffic coming from wireguard peers, a profile is configured with a neighborhood. The neighborhood in the wireguard profile will function as a named Layer 3 network, and used in defining <a href="/docs/bcp_tenants#per-neighborhood-tenancy">neighborhood based tenancy</a> to provide access to services.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>If you do not have a pre-defined tenant to use for wireguard endpoints, you can optionally configure a <code>tenant</code> in the profile, and one will be automatically generated for you.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="connecting-remote-endpoints"></a>Connecting Remote Endpoints<a aria-hidden="true" tabindex="-1" class="hash-link" href="#connecting-remote-endpoints" title="Direct link to heading">#</a></h2><p>You have devices that are remote from your 128T fabric, but you want to give them network tenancy and access to services. In this example use case, assume you have two datacenter routers <code>dc1</code> and <code>dc2</code>, hosting services for <code>172.16.1.0/24</code> and <code>172.16.2.0/24</code> respectively. You want your remote devices to connect directly to each datacenter for these services, and be given a tenant called <code>remote</code>. <code>dc1</code> has a network-interface address of <code>1.1.1.1</code>, and <code>dc2</code> has a network-interface address of <code>2.2.2.2</code> that will be used to allow wireguard peers to connect.</p><p><img src="/img/plugin_wireguard_2.png" alt="Wireguard remote endpoints"></p><p>Each peer is assigned an address out of a <code>10.10.10.0/24</code> private network, which they can use when sending sessions on to the fabric. Also every peer will end up having a public/private wirguard keypair. For this use case example, each peers have the following info assigned to them:</p><table><thead><tr><th>peer</th><th>private address</th><th>public key</th></tr></thead><tbody><tr><td>p1</td><td><code>10.10.10.2</code></td><td><code>cScVKF4nTbdDcGoZgbkNMRFhSEC0dVqdufIBBnCNvCk=</code></td></tr><tr><td>p2</td><td><code>10.10.10.3</code></td><td><code>4uXibv7XeeTxYhc5clp0G4cIYicvY03RQGxLwDNCCEY=</code></td></tr><tr><td>p3</td><td><code>10.10.10.4</code></td><td><code>lqvXPuopoYfVcVgpUEtF8Y6BXn8n6YXXAhRGhS50vU8=</code></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="profile-configuration"></a>Profile Configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#profile-configuration" title="Direct link to heading">#</a></h3><p>The following config sets up profiles on each of the <code>dc1</code> and <code>dc2</code> routers, and provisions each peer.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="router-dc1"></a>Router dc1<a aria-hidden="true" tabindex="-1" class="hash-link" href="#router-dc1" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    router             dc1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      wireguard-profile    wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name             wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        private-network</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood  remote</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address       10.10.10.1/24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             p1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name        p1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            public-key  cScVKF4nTbdDcGoZgbkNMRFhSEC0dVqdufIBBnCNvCk=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            allowed-ip  10.10.10.2/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             p2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name        p2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            public-key  4uXibv7XeeTxYhc5clp0G4cIYicvY03RQGxLwDNCCEY=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            allowed-ip  10.10.10.3/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             p3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name        p3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            public-key  lqvXPuopoYfVcVgpUEtF8Y6BXn8n6YXXAhRGhS50vU8=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            allowed-ip  10.10.10.4/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      node                 node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        device-interface  eth1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          network-interface  eth1-net</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address     1.1.1.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              wireguard-profile wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="router-dc2"></a>Router dc2<a aria-hidden="true" tabindex="-1" class="hash-link" href="#router-dc2" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    router             dc2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      wireguard-profile    wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name             wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        private-network</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood  remote</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address       10.10.10.1/24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             p1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name        p1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            public-key  cScVKF4nTbdDcGoZgbkNMRFhSEC0dVqdufIBBnCNvCk=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            allowed-ip  10.10.10.2/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             p2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name        p2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            public-key  4uXibv7XeeTxYhc5clp0G4cIYicvY03RQGxLwDNCCEY=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            allowed-ip  10.10.10.3/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             p3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name        p3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            public-key  lqvXPuopoYfVcVgpUEtF8Y6BXn8n6YXXAhRGhS50vU8=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            allowed-ip  10.10.10.4/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    node                 node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      device-interface  eth1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface  eth1-net</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          address     2.2.2.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            wireguard-profile wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div></div></div><p>With this config committed, wireguard will be installed and set up on <code>dc1</code> and <code>dc2</code>, and it will generate a wireguard keypair automatically. Once the interface is fully installed, you can view the public wireguard key of the profile by using the CLI command <code>show device-interface router &lt;router_name&gt; name &lt;profile_name&gt;</code>. Example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.dev-conductor# show device-interface router dc1 name wg-profile-1                                                                                                               </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2020-08-05 16:46:41 UTC</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===================================================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> node1.dc1:wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===================================================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                host</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Mode:                host</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         6a:ca:96:7b:e3:4c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  up</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               1 Gb/s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Duplex:              full</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                       99768</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:                  1653</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                      67788</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:                 1614</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                          0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> wireguard:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   interface:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     listening port:  12800</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     name:            wg0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     public key:      lV8egtiC8AKNh+DawkSM6G8t4x6BMFCsz8m48ToxHyA=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   number of peers:   3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   peers:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#1 - p1:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.2/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  cScVKF4nTbdDcGoZgbkNMRFhSEC0dVqdufIBBnCNvCk=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#2 - p2:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.3/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  4uXibv7XeeTxYhc5clp0G4cIYicvY03RQGxLwDNCCEY=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#3 - p3:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.4/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  lqvXPuopoYfVcVgpUEtF8Y6BXn8n6YXXAhRGhS50vU8=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.27 seconds</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="remote-endpoint-configuration"></a>Remote Endpoint Configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#remote-endpoint-configuration" title="Direct link to heading">#</a></h3><p>Now the remote peer endpoints can be configured to peer with the <code>dc1</code> and <code>dc2</code> routers at their respective interface addresses, and route the corresponding service prefixes of <code>172.16.1.0/24</code> and <code>172.16.2.0/24</code> to each. For example, a wireguard config for peer <code>p1</code> might look like the following:</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>See <a href="https://www.wireguard.com/quickstart/" target="_blank" rel="noopener noreferrer">wireguard documentation</a> for more on configuring wireguard on other endpoints.</p></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[Interface]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># p1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Address = 10.10.10.2/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PrivateKey = kLbzfaAMMn1Nen3zZ+LreKCglYJuBgdvy/fFNgIZxHk=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[Peer]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># dc1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PublicKey = lV8egtiC8AKNh+DawkSM6G8t4x6BMFCsz8m48ToxHyA=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">AllowedIPs = 172.16.1.0/24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Endpoint = 1.1.1.1:12800</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[Peer]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># dc2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PublicKey = uB/YI6A/UZtLCLsnOuoWI+lopiwBO0/QdbdN5ryBsm4=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">AllowedIPs = 172.16.2.0/24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Endpoint = 2.2.2.2:12800</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="network-tenant-for-endpoints"></a>Network Tenant For Endpoints<a aria-hidden="true" tabindex="-1" class="hash-link" href="#network-tenant-for-endpoints" title="Direct link to heading">#</a></h3><p>In the remote endpoint example, traffic coming from endpoints will be transported to the appropriate 128T <code>dc1</code> or <code>dc2</code> routers using wireguard, and then be sent into the fabric sourced from each endpoint&#x27;s assigned private address in the <code>10.10.10.0/24</code> network. To assign these endpoints a tenant, thus giving them access to services, the profile is configured with a <code>neighborhood</code> of <code>remote</code>. Based on this, you can define tenant membership for each endpoint in the private network.</p><p>For example, the following could be used to give endpoints in the network a tenant of <code>remote-worker</code> (including <code>p1</code> and <code>p2</code>), but give just <code>p3</code> tenant <code>engineering</code>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    tenant             remote-worker</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      name    remote-worker</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      member  remote</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          neighborhood  remote</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          address       10.10.10.0/24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    tenant             engineering</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      name    engineering</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      member  remote</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          neighborhood  remote</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          address       10.10.10.4/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="remote-service-agent"></a>Remote Service Agent<a aria-hidden="true" tabindex="-1" class="hash-link" href="#remote-service-agent" title="Direct link to heading">#</a></h2><p>You have a remote device that needs to be accessed as an agent of a service in your 128T network. In this example use case you have a remote IoT device that hosts a <code>thing</code> service with address <code>128.128.128.128/32</code>, which must be accessed by a tenant <code>technician</code>. </p><p>A remote IoT device has a wireguard peer with a public key of <code>Jihom426SSceUCPpS1147NSNzZcY1wl40Sf+OQ1rjGU=</code>. It will be given an address of <code>10.10.10.2</code> from the private network, and it will peer with the 128T router <code>r1</code> on the  <code>1.1.1.1</code> network-interface address.</p><p><img src="/img/plugin_wireguard_3.png" alt="Wireguard service agent"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="profile-configuration-1"></a>Profile Configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#profile-configuration-1" title="Direct link to heading">#</a></h3><p>The following configuration sets up the wireguard profile, along with the IoT device wireguard peer:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    router             r1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      wireguard-profile    wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name             wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        private-network</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          neighborhood  remote</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          address       10.10.10.1/24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        peer             iot-dev-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          name        iot-dev-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          public-key  Jihom426SSceUCPpS1147NSNzZcY1wl40Sf+OQ1rjGU=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          allowed-ip  10.10.10.2/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      node                 node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        device-interface  eth1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          network-interface  eth1-net</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address     1.1.1.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              wireguard-profile wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="remote-endpoint-configuration-1"></a>Remote Endpoint Configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#remote-endpoint-configuration-1" title="Direct link to heading">#</a></h3><p>The wireguard configuration on the IoT device might look like the following:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[Interface]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># IoT device</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Address = 10.10.10.2/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PrivateKey = MEAtlWq4Ou7++yxjYGtTa85gzDj3mbbCy76J5oWPaG8=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[Peer]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># r1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PublicKey = lV8egtiC8AKNh+DawkSM6G8t4x6BMFCsz8m48ToxHyA=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">AllowedIPs = 0.0.0.0/0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Endpoint = 1.1.1.1:12800</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PersistentKeepalive = 30</span></div></div></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The <code>PersistentKeepalive</code> in this wireguard configuration causes the peer to keep the connection to the peer alive by sending periodic traffic. This has the effect of allowing the 128T to originate sessions to the peer at any time. See <a href="https://www.wireguard.com/quickstart/" target="_blank" rel="noopener noreferrer">wireguard documentation</a> for more on configuring wireguard on other endpoints.</p></div></div><p>With the profile and peer configured on the 128T router <code>r1</code>, and wireguard configured on the remote IoT device, you can verify the device is keeping the connection alive by reviewing the <code>latest handshake</code> output of <code>show device-interface router &lt;router_name&gt; name &lt;profile_name&gt;</code>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.dev-conductor# show device-interface router r1 name wg-profile-1                                                                                                                                                                                   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2020-08-05 23:33:02 UTC</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===================================================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> node1.r1:wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===================================================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                host</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Mode:                host</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         6a:ca:96:7b:e3:4c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  up</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               1 Gb/s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Duplex:              full</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                      493467</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:                  7115</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                     356373</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:                 7218</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                          0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> wireguard:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   interface:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     listening port:  12800</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     name:            wg0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     public key:      lV8egtiC8AKNh+DawkSM6G8t4x6BMFCsz8m48ToxHyA=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   number of peers:   4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   peers:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#1 - iot-dev-1:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.2/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         endpoint:    192.168.128.222:42948</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         latest handshake: 21 seconds ago</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  Jihom426SSceUCPpS1147NSNzZcY1wl40Sf+OQ1rjGU=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         transfer:    17.96 KiB received, 67.58 KiB sent</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.25 seconds</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="service-routing"></a>Service Routing<a aria-hidden="true" tabindex="-1" class="hash-link" href="#service-routing" title="Direct link to heading">#</a></h3><p>Finally the <code>thing</code> service must be routed to the remote wireguard peer. </p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="service"></a>Service<a aria-hidden="true" tabindex="-1" class="hash-link" href="#service" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    service            thing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      name           thing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      description    &quot;IoT sensor data service&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      address        128.128.128.128/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      access-policy  technician</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        source      technician</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        permission  allow</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="service-route"></a>Service-route<a aria-hidden="true" tabindex="-1" class="hash-link" href="#service-route" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    router             r1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      service-route        static-thing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name          static-thing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        service-name  thing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        nat-target    10.10.10.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        next-hop      node1 wg-profile-1-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          node-name   node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          interface   wg-profile-1-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          gateway-ip  169.254.140.129</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The <code>interface</code> and <code>gateway-ip</code> in this configuration are automatically generated as part of the profile configuration on the router, and can be seen with <code>show network-interface</code>.</p></div></div><p>With this configuration, sessions sent from the <code>technician</code> tenant to <code>128.128.128.128</code> will be given access as part of the <code>thing</code> service, and routed with a destination NAT to the wireguard interface of <code>10.10.10.2</code> on the IoT device peer.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="configuration-reference"></a>Configuration Reference<a aria-hidden="true" tabindex="-1" class="hash-link" href="#configuration-reference" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="wireguard-profile"></a>wireguard-profile<a aria-hidden="true" tabindex="-1" class="hash-link" href="#wireguard-profile" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="path"></a>Path<a aria-hidden="true" tabindex="-1" class="hash-link" href="#path" title="Direct link to heading">#</a></h4><p>authority &gt; router &gt; system &gt; wireguard-profile</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="description"></a>Description<a aria-hidden="true" tabindex="-1" class="hash-link" href="#description" title="Direct link to heading">#</a></h4><p>A profile describing an instance of wireguard on the router.</p><table><thead><tr><th>Element</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>name</code></td><td>string</td><td>A string identifier for wireguard profile. This identifier is used as a device interface name in the host, therefore it can only use alphanumerics, underscores, or dashes, and cannot exceed 12 characters.</td></tr><tr><td><code>description</code></td><td>string</td><td>A description about the wireguard profile.</td></tr><tr><td><code>loopback-address</code></td><td>ipv4-prefix</td><td>An internal address prefix for KNI connectivity between wireguard and the data plane.</td></tr><tr><td><code>port</code></td><td>l4-port</td><td>The UDP port for the wireguard instance to recieve connections on.</td></tr><tr><td><code>inactivity-timeout</code></td><td>milliseconds</td><td>Inactivity timeout for wireguard sessions. By default this uses 180000 ms UDP timeout value. If customized to a non-default value, a new session-type will be automatically generated.</td></tr><tr><td><code>service-class</code></td><td>string</td><td>The service-class to associate with the generated session-type for this wireguard profile. Wireguard sessions arriving at the router will be given this service-class.</td></tr><tr><td><code>access-policy</code></td><td>access-policy</td><td>List of access policies for the wireguard service. Packets allowed by this access policy will additionally be subject to wireguard security validation. See <a href="/docs/config_reference_guide#access-policy-service">service access policy</a>.</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="private-network"></a>private-network<a aria-hidden="true" tabindex="-1" class="hash-link" href="#private-network" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="path-1"></a>Path<a aria-hidden="true" tabindex="-1" class="hash-link" href="#path-1" title="Direct link to heading">#</a></h4><p>authority &gt; router &gt; system &gt; wireguard-profile &gt; private-network</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="description-1"></a>Description<a aria-hidden="true" tabindex="-1" class="hash-link" href="#description-1" title="Direct link to heading">#</a></h4><p>A network to be associated with router the wireguard network-interface. This network handles packets after they have been decrypted from a wireguard peer connection, or prior to being encrypted and sent to a wireguard peer connection. The router wireguard instance will use the address given, and other peers can send or receive sessions using the remaining addresses in the network.</p><table><thead><tr><th>Element</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>neighborhood</code></td><td>neighborhood-id</td><td>Neighborhood to be associated with the wireguard network. Addresses assigned to peers can be made members of an appropriate existing tenant based on this neighborhood.</td></tr><tr><td><code>tenant-name</code></td><td>string</td><td>A tenant to be associated with addresses in the network. If configured, a tenant will be automatically generated with the addresses in the neighborhood set as members. If not configured, no tenant will be generated, and peer addresses in the network will need to be defined as members of existing tenants.</td></tr><tr><td><code>address</code></td><td>ip prefix</td><td>The address and prefix associated with the wireguard profile. The wireguard interface created on the router will use the address defined, and other peers can send or receive sessions using the remaining addresses in the network.</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="peer"></a>peer<a aria-hidden="true" tabindex="-1" class="hash-link" href="#peer" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="path-2"></a>Path<a aria-hidden="true" tabindex="-1" class="hash-link" href="#path-2" title="Direct link to heading">#</a></h4><p>authority &gt; router &gt; system &gt; wireguard-profile &gt; peer</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="description-2"></a>Description<a aria-hidden="true" tabindex="-1" class="hash-link" href="#description-2" title="Direct link to heading">#</a></h4><p>Set of allowed wireguard peers.</p><table><thead><tr><th>Element</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>name</code></td><td>string</td><td>Name identifier for the peer.</td></tr><tr><td><code>public-key</code></td><td>string</td><td>The peer&#x27;s base64 encoded 32 byte Curve25519 public wireguard key.</td></tr><tr><td><code>preshared-key</code></td><td>string</td><td>The peer&#x27;s optional base64 encoded 32 byte Curve25519 pre-shared wireguard key.</td></tr><tr><td><code>persistent-keepalive</code></td><td>seconds</td><td>Interval in seconds at which to send keepalive messages to the peer. Keepalives are optional. No configuration or a setting of &#x27;0&#x27; disables keepalives.</td></tr><tr><td><code>allowed-ip</code></td><td>ip prefix</td><td>The prefixes that are allowed to be sent to the peer. When the peer is an endpoint, typically the allowed-ip is the /32 of the peer&#x27;s wireguard interface. If the peer is a gateway device, the allowed-ip list would include any prefixes reachable as services via the peer, or prefixes from which traffic may be sourced.</td></tr></tbody></table><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Disabled keepalives on the router does not mean keepalives cannot be generated by the remote peer. If keepalives are desired, a typical configuration is to have keepalives disabled on the router, but enabled on the remote peer.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="endpoint"></a>endpoint<a aria-hidden="true" tabindex="-1" class="hash-link" href="#endpoint" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="path-3"></a>Path<a aria-hidden="true" tabindex="-1" class="hash-link" href="#path-3" title="Direct link to heading">#</a></h4><p>authority &gt; router &gt; system &gt; wireguard-profile &gt; peer &gt; endpoint</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="description-3"></a>Description<a aria-hidden="true" tabindex="-1" class="hash-link" href="#description-3" title="Direct link to heading">#</a></h4><p>IP and port of the endpoint. If not set, the endpoint of the peer will establish dynamically based on the source address discovered during the wireguard handshake.</p><table><thead><tr><th>Element</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>ip</code></td><td>ip address</td><td>Static IP address where the peer can be reached to connect.</td></tr><tr><td><code>port</code></td><td>port number</td><td>Port at which the peer can be reached to connect.</td></tr></tbody></table><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If an endpoint is configured, wireguard on the 128T may attempt to send outbound sessions to the IP and port defined. The sessions will originate from the profile loopback-address. A tenant and service must be created to route the outbound wireguard session to the defined peer endpoint.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="troubleshooting"></a>Troubleshooting<a aria-hidden="true" tabindex="-1" class="hash-link" href="#troubleshooting" title="Direct link to heading">#</a></h2><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="interface-status"></a>Interface status<a aria-hidden="true" tabindex="-1" class="hash-link" href="#interface-status" title="Direct link to heading">#</a></h4><p>To view the status of a wireguard interface, and its peers, use the following PCLI command:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">show device-interface router &lt;router_name&gt; name &lt;profile_name&gt;</span></div></div></div></div></div><p>Example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.dev-conductor# show device-interface router r1 name wg-profile-1                                                                                                                                                                                   </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Fri 2020-08-07 13:35:22 UTC</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===================================================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> node1.r1:wg-profile-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===================================================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                host</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Mode:                host</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         6a:ca:96:7b:e3:4c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  up</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               1 Gb/s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Duplex:              full</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                     4349806</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:                 50978</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                    4793736</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:                63193</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                          0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> wireguard:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   interface:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     listening port:  12800</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     name:            wg0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     public key:      lV8egtiC8AKNh+DawkSM6G8t4x6BMFCsz8m48ToxHyA=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   number of peers:   5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   peers:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#1 - iot-dev-1:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.5/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         endpoint:    192.168.128.222:42948</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         latest handshake:1 minute, 2 seconds ago</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  Jihom426SSceUCPpS1147NSNzZcY1wl40Sf+OQ1rjGU=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         transfer:    368.22 KiB received, 177.72 KiB sent</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#2 - p1:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.2/32, 192.168.8.0/24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         endpoint:    192.168.128.30:58608</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         latest handshake:11 hours, 35 minutes, 38 seconds ago</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  cScVKF4nTbdDcGoZgbkNMRFhSEC0dVqdufIBBnCNvCk=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         transfer:    775.50 KiB received, 771.83 KiB sent</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#3 - p2:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.3/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  4uXibv7XeeTxYhc5clp0G4cIYicvY03RQGxLwDNCCEY=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       peer#4 - p3:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         allowed ips: 10.10.10.4/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         public key:  lqvXPuopoYfVcVgpUEtF8Y6BXn8n6YXXAhRGhS50vU8=</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="interface-and-profile-configuration-logging"></a>Interface and profile configuration logging<a aria-hidden="true" tabindex="-1" class="hash-link" href="#interface-and-profile-configuration-logging" title="Direct link to heading">#</a></h4><p>Logging of new configuration sent to the router can be viewed in the Linux shell using the system journal.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -u 128T-handle-wireguard-config</span></div></div></div></div></div><p>Example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[t128@dev-fitlet ~]$ sudo journalctl -u 128T-handle-wireguard-config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Logs begin at Sun 2012-01-01 00:37:26 UTC, end at Fri 2020-08-07 13:38:00 UTC. --</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet systemd[1]: Starting Handler for 128T wireguard config...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote&#x27; does not exist</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote&#x27; created</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/init&#x27; does not exist</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/reinit&#x27; does not exist</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/shutdown&#x27; does not exist</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/startup&#x27; does not exist</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/init&#x27; symlink to &#x27;/etc/128technology/plugins/network-scripts/default/kni_namespace/init&#x27; created</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/reinit&#x27; symlink to &#x27;/etc/128technology/plugins/network-scripts/default/kni_namespace/reinit&#x27; created</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/shutdown&#x27; symlink to &#x27;/etc/128technology/plugins/network-scripts/default/kni_namespace/shutdown&#x27; created</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jul 30 02:06:25 dev-fitlet node[2602]: &#x27;/etc/128technology/plugins/network-scripts/host/remote/startup&#x27; symlink to &#x27;/etc/128technology/plugins/network-scripts/default/kni_namespace/startup&#x27; created</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="peer-configuration-logging"></a>Peer configuration logging<a aria-hidden="true" tabindex="-1" class="hash-link" href="#peer-configuration-logging" title="Direct link to heading">#</a></h4><p>Looging of peer configuration handling can be viewed in the Linux shell using the system journal.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -u 128T-handle-wireguard-peer-config@&lt;profile_name&gt;</span></div></div></div></div></div><p>Example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[t128@dev-fitlet ~]$ sudo journalctl -u 128T-handle-wireguard-peer-config@wg-profile-1 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Logs begin at Sun 2012-01-01 00:37:26 UTC, end at Fri 2020-08-07 13:36:42 UTC. --</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Aug 05 14:32:40 dev-fitlet systemd[1]: Starting Handler for wireguard peer and network config wg/profile/1...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Aug 05 14:32:40 dev-fitlet node[32315]: &#x27;/etc/128technology/plugins/network-scripts/host/wg-profile-1/wg0.conf&#x27; written</span></div></div></div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-08-24T16:32:30.000Z" class="docLastUpdatedAt_217_">8/24/2020</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/plugin_kni_namespace_scripts"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Kernel Network Namespace Scripts</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/api_rest_4.2.0"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">128T-4.2.0 Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#wireguard-basics" class="table-of-contents__link">Wireguard Basics</a></li><li><a href="#basic-configuration" class="table-of-contents__link">Basic Configuration</a></li><li><a href="#services-and-tenants-with-wireguard" class="table-of-contents__link">Services and Tenants with Wireguard</a></li><li><a href="#connecting-remote-endpoints" class="table-of-contents__link">Connecting Remote Endpoints</a><ul><li><a href="#profile-configuration" class="table-of-contents__link">Profile Configuration</a></li><li><a href="#remote-endpoint-configuration" class="table-of-contents__link">Remote Endpoint Configuration</a></li><li><a href="#network-tenant-for-endpoints" class="table-of-contents__link">Network Tenant For Endpoints</a></li></ul></li><li><a href="#remote-service-agent" class="table-of-contents__link">Remote Service Agent</a><ul><li><a href="#profile-configuration-1" class="table-of-contents__link">Profile Configuration</a></li><li><a href="#remote-endpoint-configuration-1" class="table-of-contents__link">Remote Endpoint Configuration</a></li><li><a href="#service-routing" class="table-of-contents__link">Service Routing</a></li></ul></li><li><a href="#configuration-reference" class="table-of-contents__link">Configuration Reference</a><ul><li><a href="#wireguard-profile" class="table-of-contents__link">wireguard-profile</a></li><li><a href="#private-network" class="table-of-contents__link">private-network</a></li><li><a href="#peer" class="table-of-contents__link">peer</a></li><li><a href="#endpoint" class="table-of-contents__link">endpoint</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link">Troubleshooting</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>Copyright Â© 2020 128 Technology, Inc.</div></div></div></footer></div>
<script src="/styles.9d9f1195.js"></script>
<script src="/runtime~main.61b629c8.js"></script>
<script src="/main.4174e6aa.js"></script>
<script src="/1.d7531bbb.js"></script>
<script src="/2.159762e9.js"></script>
<script src="/128.2c9fac13.js"></script>
<script src="/131.acb7d52c.js"></script>
<script src="/20ac7829.ae2cfb24.js"></script>
<script src="/17896441.89dd6768.js"></script>
<script src="/c5ae1959.4afcefcd.js"></script>
</body>
</html>
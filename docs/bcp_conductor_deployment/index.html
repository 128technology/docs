<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">Conductor Deployment Patterns | 128T Docs</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="128T Docs"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="The 128T conductor is the centralized orchestration platform within a 128T Authority, and maintains (many) persistent connections to each router and its constituent node(s). This document discusses the various  options for deploying the 128T conductor, discussing the relative strengths and drawbacks of each."><meta data-react-helmet="true" property="og:description" content="The 128T conductor is the centralized orchestration platform within a 128T Authority, and maintains (many) persistent connections to each router and its constituent node(s). This document discusses the various  options for deploying the 128T conductor, discussing the relative strengths and drawbacks of each."><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/bcp_conductor_deployment">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.8d924258.css">


<link rel="preload" href="/styles.8119cba2.js" as="script">

<link rel="preload" href="/runtime~main.6e3666d9.js" as="script">

<link rel="preload" href="/main.0faefc0c.js" as="script">

<link rel="preload" href="/1.dbbcbb7c.js" as="script">

<link rel="preload" href="/2.7d249ed6.js" as="script">

<link rel="preload" href="/27.6fb8134c.js" as="script">

<link rel="preload" href="/20ac7829.c390b3ec.js" as="script">

<link rel="preload" href="/17896441.9dbe2e15.js" as="script">

<link rel="preload" href="/fa10e3f3.bba00875.js" as="script">

</head>
<body>

<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong></strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://community.128technology.com/home">Interchange</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://www.128technology.com/">Company</a><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Docs</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://community.128technology.com/home">Interchange</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://www.128technology.com/">Company</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/img/128t_black.png" alt="128 Technology Logo"><strong></strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Release Notes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/release_notes_4.2.0">4.2.0 Release Notes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/release_notes_4.2.1">4.2.1 Release Notes</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/CONTRIBUTING">Contributing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_downloading">Downloading</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Getting Started</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_glossary">Glossary</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Administration</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/config_basics">Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_audit_log">Audit Log</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/ts_connecting_to_routers">Connecting to Routers</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Events</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/events">Alarms and Events</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Best Practics</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/bcp_conductor_deployment">Conductor Deployment</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_lte_peering">LTE Peering</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CLI Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/cli_reference">Reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/monitoring_agent">Monitoring</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/apis_rest">REST</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apis_netconf">NETCONF</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Conductor Deployment Patterns</h1></header><div class="markdown"><p>The 128T conductor is the centralized orchestration platform within a 128T Authority, and maintains (many) persistent connections to each router and its constituent node(s). This document discusses the various  options for deploying the 128T conductor, discussing the relative strengths and drawbacks of each.</p><p>All of the design patterns contained within this document are supported configurations; however, certain designs are discouraged due to their complexity, the number of limitations it imposes on your network design, the functional caveats it imposes, etc. These will be explicitly noted within each section accordingly.</p><p>For each topic, we will discuss items such as:</p><ul><li>Any resource requirements (e.g., public internet addresses)</li><li>All corresponding 128T or Linux OS configuration requirements</li><li>When the design pattern is encouraged or discouraged</li><li>Its flexibility and scale</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="universal-considerations"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#universal-considerations" title="Direct link to heading">#</a>Universal Considerations</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="pod-design"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#pod-design" title="Direct link to heading">#</a>POD Design</h3><p>The conductor is the single point of configuration for an array of managed routers; as such, its configuration can grow to be quite large. As the configuration grows larger, the processing time for new configuration moves, adds, and changes grows accordingly. 128 Technology recommends that network deployments be sized to a ratio of 2,000 assets per conductor (where an asset is a single instance of 128T software). I.e., either 1,000 highly available routers comprised of two nodes each, 2,000 standalone nodes, or any combination thereof.</p><p>For large scale deployments exceeding 2,000 assets, the conventional approach is to subdivide the network into PODs – independently managed networks.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="linux-os-tuning"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#linux-os-tuning" title="Direct link to heading">#</a>Linux OS Tuning</h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="configuring-firewalld"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#configuring-firewalld" title="Direct link to heading">#</a>Configuring firewalld</h4><p>When deploying conductor on theInternet, 128 Technology recommends limiting access to the system using <em>firewalld</em>. The basic premise is to restrict inbound access to the public-facing addresses to only allow ports 4505/TCP, 4506/TCP, and 930/TCP. This is generally done by:</p><ol><li>Creating a specific firewalld <strong>zone</strong>; e.g., <code>conductor</code></li><li>Creating a firewalld <strong>service</strong> for the conductor&#x27;s salt master, containing TCP ports 4505, 4506; e.g., <code>salt-master</code></li><li>Creating a firewalld <strong>service</strong> for the conductor&#x27;s NETCONF connection, containing TCP port 930; e.g., <code>netconf</code></li><li>Adding the &quot;salt-master&quot; and &quot;netconf&quot; services to the <code>conductor</code> zone</li><li>Set the public address to be in the <code>conductor</code> zone</li></ol><p>128 Technology has developed some salt states to assist with these common configuration steps. Refer to our <a href="https://github.com/128technology/salt-states/blob/master/setup-firewalld-t128-zone.sls">public Github repo</a> for some samples you can use to tune your system accordingly.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="hyperthreading"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#hyperthreading" title="Direct link to heading">#</a>Hyperthreading</h4><p>128 Technology recommends enabling hyperthreading for systems operating as conductors, as it may improve performance.</p><div class="admonition admonition-note"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>Because 128 Technology <em>does not</em> recommend hyperthreading for nodes running 128T software as a router, please be aware when repurposing a host from conductor to router that hyperthreading should be disabled.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="about-conductor-host-services"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#about-conductor-host-services" title="Direct link to heading">#</a>About <em>Conductor Host Services</em></h3><p><em>Conductor Host Services</em> refers to the built-in feature within the 128T software that will generate configuration to simplify the connectivity between routers and their conductor(s). By configuring the <code>conductor-address</code> field within the 128T&#x27;s data model, and by indicating which interface(s) on a manged router should be used to connect to conductor, the conductor will automatically generate the supporting configuration infrastructure. This includes:</p><ul><li>The <code>_conductor_</code> service (which will have a trailing sequence number; e.g., <code>_conductor_1</code>)</li><li>A <code>service-route</code> for each <code>network-interface</code> on each router that has <code>conductor</code> set to <code>true</code></li></ul><p>The Conductor Host Services feature forms the basis for the majority of the conductor design patterns described in this document, and should be leveraged whenever possible.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="addressing"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#addressing" title="Direct link to heading">#</a>Addressing</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="public-conductor"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#public-conductor" title="Direct link to heading">#</a>Public Conductor</h3><p>The most conventional deployment model is where the conductor is reachable on a public IPv4 address, and all managed nodes have direct access to it via one or more WAN connections. This is the simplest of all deployment schemes, as it allows you to leverage the global <code>conductor-address</code> fields within the 128T data model to unambiguously define the conductor targets across the entire population of router nodes.</p><p>This deployment model is recommended when possible.</p><p>Configuration required:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config auth conductor-address [public address of conductor]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config auth router r1 node n1 device-interface WAN network-interface WAN0 conductor true</span></div></code></pre></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="public-conductor-behind-nat"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#public-conductor-behind-nat" title="Direct link to heading">#</a>Public Conductor Behind NAT</h3><p>Another common model is a deployment where the conductor is behind a static NAT/firewall, which is forwarding to a private address assigned to the conductor. When placing the conductor behind a static NAT/firewall (effectively giving it a public IP address), be mindful of whether the NAT/firewall supports &quot;hairpinning.&quot; (Hairpinning is when a device sends packets to the public IP address of a NAT that it sits behind.) This is because a conductor&#x27;s salt-minion will connect to its own salt master, and will attempt to do so at the same IP address that all external minions connect to. If the NAT does not support hairpinning, then follow the steps outlined below in the section on <em>Split Horizon Conductor</em>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="port-forwarding"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#port-forwarding" title="Direct link to heading">#</a>Port Forwarding</h4><p>When deploying a conductor behind a firewall, open 930/TCP (used for NETCONF) and 4505-4506/TCP (used for salt) to allow a conductor to communicate to managed routers. Open 443/TCP for the web UI, and 22/TCP for remote SSH.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="split-horizon-conductor"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#split-horizon-conductor" title="Direct link to heading">#</a>Split Horizon Conductor</h3><p>A &quot;split horizon&quot; conductor is one that has IP presence on more than one broadcast domain, and where it is contacted on multiple IP addresses by different subsets of the overall population. (E.g., when a conductor resides in a data center coresident with head end routers, and external routers address the conductor on a public IP address while the data center routers address it using a LAN or management IP address.)</p><p>When deploying a split horizon conductor, there are two options: use the 128T&#x27;s native <em>Conductor Host Services</em> using the public conductor&#x27;s address (with some exceptions, as noted below), or manually define conductor services. Each of these will be defined further here.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="using-conductor-host-services"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-conductor-host-services" title="Direct link to heading">#</a>Using Conductor Host Services</h4><p>Despite the router population having multiple distinct targets for a single conductor, it is nevertheless possible to use authority-wide, fixed addresses in the 128T configuration, yet have the routers forward to different targets. This leverages the Linux <em>firewalld</em> process.</p><p>This design is recommended when the majority of the router population uses one address (typically a public address), and a minority of the router population access the same conductor at a second address (typically a private address). In this design, you should configure the authority-wide <code>conductor-address</code> as the address that is to be used by the majority of the routers. For the subset of routers that will use a second address, we&#x27;ll perform a NAT function.</p><p>Within each Linux host on the minority set of routers, use the following <code>firewall-cmd</code> command (all on one line):</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">firewall-cmd --permanent --direct --add-rule ipv4 nat OUTPUT 0 -d &lt;public IP&gt; -j</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    DNAT --to-destination &lt;private IP&gt;</span></div></code></pre></div><p>This command will set a persistent <code>firewalld</code> rule that will translate packets sent from <code>&lt;public IP&gt;</code> on output, and instead send them to <code>&lt;private IP&gt;</code>. The application(s) (i.e., <code>persistentDataManager</code> and <code>salt-minion</code>) will believe they&#x27;re sending packets to <code>&lt;public IP&gt;</code>, but <code>firewalld</code> will rewrite them and send them to <code>&lt;private IP&gt;</code> instead.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="manually-defining-conductor-services"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#manually-defining-conductor-services" title="Direct link to heading">#</a>Manually Defining Conductor Services</h4><p>Rather than use the built-in conductor services feature, you can &quot;roll your own&quot; conductor services by manually defining a conductor service. For the purposes of this example, we&#x27;ll assume your conductor has two appearances: one on the public internet, and a second on a LAN. We&#x27;ll need to define a <code>conductor</code> service that contains both IP addresses, and the various ports used for the routers to connect to it.</p><div class="admonition admonition-tip"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>tip</h5></div><div class="admonition-content"><p>It is possible to split the conductor service into separate services for each address, and set the <code>applies-to</code> for the service to the various populations. E.g., all of your data center routers can be in a <code>router-group</code> named &quot;dc-routers&quot; and your branch locations can be in a <code>router-group</code> named &quot;branch&quot;. Then you can have a <code>service</code> defined for the local address with <code>applies-to</code> set to <code>dc-routers</code>, and a second <code>service</code> defined for the public address with <code>applies-to</code> set to <code>branch</code>.</p></div></div><p>Once the services are defined, you&#x27;ll also need to create <code>service-route</code> configuration for each router, to reach the conductor service.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="linux-configuration"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#linux-configuration" title="Direct link to heading">#</a>Linux Configuration</h5><p>Each of the routers using the manually-defined conductor service will need to be initialized with the appropriate conductor address. (This will set the <code>/etc/128technology/global.init</code> and <code>/etc/salt/minion</code> files to their appropriate values.)</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="conductor-redundancy"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#conductor-redundancy" title="Direct link to heading">#</a>Conductor Redundancy</h2><p>Most production deployments include redundant conductor nodes. When deployed as a highly available pair, conductor nodes are always run as <em>active/active</em>, with all managed routers connecting to both. Unlike highly available routers, there is no notion of interface takeover with conductors; each conductor node is given a unique IP address reachable by all devices at all times.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="geographic-redundancy"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#geographic-redundancy" title="Direct link to heading">#</a>Geographic Redundancy</h3><p>Highly available conductors run as active/active, and have ongoing needs for state synchronization between one another. For this reason, 128 Technology requires that the network between geographically separated conductors have <em>latency of no more than 100ms</em>, and <em>packet loss no greater than 1%</em>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="conductor-access-router-design"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#conductor-access-router-design" title="Direct link to heading">#</a>Conductor Access (Router Design)</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="jekyllhyde-access"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#jekyllhyde-access" title="Direct link to heading">#</a>Jekyll/Hyde Access</h3><p>A critical design consideration when configuring 128T routers to talk to the conductor is referred to as the &quot;Jekyll/Hyde&quot; problem: the system daemons that require connectivity to the 128T conductor must have persistent access whether the 128T router application is running or not. As starting the 128T application will typically have an (intentional) impact on that host platform&#x27;s routing behavior, administrators must be aware of two distinct behaviors: the routing configuration in Linux while 128T is stopped (&quot;Dr. Jekyll&quot;), and the routing configuration in Linux while 128T is running (&quot;Mr. Hyde&quot;). Fortunately, the 128T software has facilities to create most, if not all of the requisite configuration.</p><p>When using <em>Conductor Host Services</em> to create your configuration for a router to reach the conductor, the 128T configuration generator will create all of the necessary infrastructure (within both 128T as well as the host platform) to connect to the conductor on the interfaces you&#x27;ve specified. It does so by creating a <em>KNI</em> (Kernel Network Interface), which is a network interface that connects between the Linux kernel and the 128T software.</p><div class="admonition admonition-important"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>important</h5></div><div class="admonition-content"><p>You must also specify <code>conductor=true</code> on one of your network-interface configuration elements, in order for the 128T to recognize which egress path(s) to use.</p></div></div><p>The KNI (named <code>kni254</code>) shuttles packets back and forth between the Linux processses (salt, secureCommunicationManager) and the 128T routing domain. Conductor Host Services will install specific, /32 routes to one or two conductor addresses, using the local KNI address (169.254.127.126) as its next-hop. Those will be sent &quot;up&quot; to the 128T routing domain, where they will match the generated <code>_conductor_</code> service(s), and follow the service-route out of the specified interface.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="in-band-management"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#in-band-management" title="Direct link to heading">#</a>In-Band Management</h3><p>The term <em>in-band management</em> in the context of conductor connectivity refers to the use of a forwarding interface by a router node for reaching the conductor. I.e., there is no dedicated interface specifically for the conductor to &quot;manage&quot; the node. As most 128T deployments separate the remote sites from the conductor over a WAN, it is exceedingly common to leverage in-band management between a remote node and a conductor. For SDWAN deployments, in-band management is <em>strongly recommended</em>, for the branch locations. For head end systems that are colocated with the conductors, out-of-band management is preferable, assuming there are sufficent free interfaces on the chosen head end hardware platform.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="out-of-band-management"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#out-of-band-management" title="Direct link to heading">#</a>Out-of-Band Management</h3><p>Routing nodes are said to leverage <em>out-of-band management</em> when they have a dedicated interface for the traffic to reach the conductor. Out-of-band management is generally only feasible when a conductor is colocated with the routing nodes, as is commonly the case at a head end data center.</p><div class="admonition admonition-note"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>It is possible to have a dedicated out-of-band management interface on branch locations, but this connection will almost certainly ultimately ride over the same device&#x27;s WAN connection to the conductor. I.e., the management traffic will egress one interface on the device and be sent back to another interface on the same device. As such, the in-band management model is more suitable, as it avoids unnecessary hops.</p></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/128technology/docs/tree/master/docs/bcp_conductor_deployment.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-02-28T05:12:35.000Z" class="docLastUpdatedAt_1sqk">2/28/2020</time> by <strong>rstidolph</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/events"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« Alarms and Events</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/bcp_lte_peering"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">LTE Peering »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#universal-considerations" class="contents__link">Universal Considerations</a><ul><li><a href="#pod-design" class="contents__link">POD Design</a></li><li><a href="#linux-os-tuning" class="contents__link">Linux OS Tuning</a></li><li><a href="#about-conductor-host-services" class="contents__link">About <em>Conductor Host Services</em></a></li></ul></li><li><a href="#addressing" class="contents__link">Addressing</a><ul><li><a href="#public-conductor" class="contents__link">Public Conductor</a></li><li><a href="#public-conductor-behind-nat" class="contents__link">Public Conductor Behind NAT</a></li><li><a href="#split-horizon-conductor" class="contents__link">Split Horizon Conductor</a></li></ul></li><li><a href="#conductor-redundancy" class="contents__link">Conductor Redundancy</a><ul><li><a href="#geographic-redundancy" class="contents__link">Geographic Redundancy</a></li></ul></li><li><a href="#conductor-access-router-design" class="contents__link">Conductor Access (Router Design)</a><ul><li><a href="#jekyllhyde-access" class="contents__link">Jekyll/Hyde Access</a></li><li><a href="#in-band-management" class="contents__link">In-Band Management</a></li><li><a href="#out-of-band-management" class="contents__link">Out-of-Band Management</a></li></ul></li></ul></div></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center">Copyright © 2020 128 Technology, Inc.</div></div></footer>
</div>

<script src="/styles.8119cba2.js"></script>

<script src="/runtime~main.6e3666d9.js"></script>

<script src="/main.0faefc0c.js"></script>

<script src="/1.dbbcbb7c.js"></script>

<script src="/2.7d249ed6.js"></script>

<script src="/27.6fb8134c.js"></script>

<script src="/20ac7829.c390b3ec.js"></script>

<script src="/17896441.9dbe2e15.js"></script>

<script src="/fa10e3f3.bba00875.js"></script>


</body>
</html>
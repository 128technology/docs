<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-config_ha">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Configuring Dual Node High Availability | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/docs/config_ha"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Configuring Dual Node High Availability | SSN Docs"><meta data-rh="true" name="description" content="The SSR provides significant flexibility for high availability configurations. The SSR can deploy multiple software instances (referred to as nodes) within the same single installation, providing high availability across router nodes. And like traditional routers, the SSR software can also be deployed as a single router instance on multiple platforms, with high availability configured in a dual router configuration."><meta data-rh="true" property="og:description" content="The SSR provides significant flexibility for high availability configurations. The SSR can deploy multiple software instances (referred to as nodes) within the same single installation, providing high availability across router nodes. And like traditional routers, the SSR software can also be deployed as a single router instance on multiple platforms, with high availability configured in a dual router configuration."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/docs/config_ha"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/config_ha" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/config_ha" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8e1fdc51.css">
<link rel="preload" href="/assets/js/runtime~main.df335f7d.js" as="script">
<link rel="preload" href="/assets/js/main.3b0d8498.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Session Smart</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Session Smart Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/install_conductor_overview">Conductor Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_image">Image-Based Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported_cloud_platforms">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_upgrade_considerations">Upgrades and Rollback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_installer">Supporting Install Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/config_basics">Administration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_basics">Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/howto_tune_bfd">Optimizing Routing Protocols</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/config_ha">High Availability</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/config_ha">Dual Node High Availability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dual_router_ha">Dual Router High Availability using iBGP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ha_vrrp">Dual Router High Availability and VRRP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_non_forwarding_ha_interfaces">Non-Forwarding HA Interfaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_adding_interfaces_to_ha_team">Adding Interfaces to an HA Team Interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_transition_standalone_to_ha">Transitioning a Conductor from Standalone to HA</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_access_mgmt">Access Management and Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_ntp_auth">NTP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/sec_adaptive_encrypt">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/concepts_ssr_idp">Intrusion Detection and Prevention</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_STEP">Service and Topology Exchange Protocol (STEP)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/how_to_use_app_summary">How To</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/ts_applications">Troubleshooting</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/plugin_intro">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/release_notes_128t_6.0">Release Notes</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Administration</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">High Availability</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Dual Node High Availability</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Configuring Dual Node High Availability</h1></header><p>The SSR provides significant flexibility for high availability configurations. The SSR can deploy multiple software instances (referred to as nodes) within the same single installation, providing high availability across router nodes. And like traditional routers, the SSR software can also be deployed as a single router instance on multiple platforms, with high availability configured in a dual router configuration.  </p><p>This document contains the steps for configuring support for configuration of dual-node high availability. In addtion to the shared MAC interface method of dual node high availability, the release of the 5.4 software includes <a href="#high-availability-using-vrrp">VRRP as a configuration option</a>. </p><p>A new service route parameter introduced in version 5.4, <a href="#service-route-redundancy"><code>enable-failover</code></a>, provides stateful failover on the dual node HA configuration.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="requirements">Requirements<a href="#requirements" class="hash-link" aria-label="Direct link to Requirements" title="Direct link to Requirements">​</a></h2><p>Configuring high availability in a shared-interface configuration requires that two SSR routing nodes have at least one device-interface that is shared between them. Shared interfaces are configured on both nodes, but are active on only one node at a time. These shared interfaces <strong>must</strong> be in the same L2 broadcast domain; this is because the SSR uses gratuitous ARP messages to announce an interface failover, so that it may receive packets in place of its counterpart.</p><p>The two SSR router nodes that make up a high availability pair must be collocated due to latency sensitivities for the information that they synchronize between themselves.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="before-you-begin">Before You Begin<a href="#before-you-begin" class="hash-link" aria-label="Direct link to Before You Begin" title="Direct link to Before You Begin">​</a></h2><p>There are several things to be mindful of before configuring HA; the two nodes must be informed that they are part of a high availability set, and they must have a dedicated interface between themselves for synchronizing state information about active sessions. These steps will be covered in this section.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-change-operations">Configuration Change Operations<a href="#configuration-change-operations" class="hash-link" aria-label="Direct link to Configuration Change Operations" title="Direct link to Configuration Change Operations">​</a></h3><p>For High Availability (HA) configurations, all configuration edit and commit operations must be done on <strong>only</strong> one node. A severe, but very rare race condition may occur if changes to the configuration are made concurrently on both nodes of the HA router or conductor; the generated configuration will be lost upon commit. This applies to all methods of editing: PCLI, Web GUI, or external API’s (NETCONF or REST). </p><p><img loading="lazy" alt="Edit HA Configuration" src="/assets/images/config_HA_interactive-b4b60af1287e950c36fd1097726db276.gif" width="853" height="480" class="img_ev3q"></p><p>To avoid this situation, designate one node as the edit node. For example, in an HA configuration with two nodes, DataCenter Node A and DataCenter Node B, designate DataCenter Node A as the edit node. All configuration changes are made on Node A. All other commands can be run on Node B, but no configuration changes or commits, whether from the GUI, PCLI, or an API, are made from Node B.</p><p>This issue is resolved in release 5.3.0, but affects all prior releases. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="exporting-the-candidate-configuration">Exporting the Candidate Configuration<a href="#exporting-the-candidate-configuration" class="hash-link" aria-label="Direct link to Exporting the Candidate Configuration" title="Direct link to Exporting the Candidate Configuration">​</a></h3><p>The Candidate configuration is not synchronized between nodes and is not stored on disk.</p><p>Configuration changes are always made to a candidate configuration. In earlier releases the candidate configuration was stored on disk and would persist through product reboots. Beginning with 5.3, the candidate configuration is not saved to disk and will not persistent through reboot. </p><p>Additionally, the candidate configuration is no longer synchronized between HA nodes. Beginning with 5.3, only the running configuration is synchronized between nodes. </p><p>It is recommended that you use the <a href="/docs/cli_reference#export-config"><code>export config</code></a> command to save your configuration changes while working, especially if you are performing multiple changes. Changes to the running configuration are only be made when the configuration is committed.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="clock-synchronization">Clock Synchronization<a href="#clock-synchronization" class="hash-link" aria-label="Direct link to Clock Synchronization" title="Direct link to Clock Synchronization">​</a></h3><p>Because highly available nodes synchronize time-series data, it is critical that the two nodes that comprise an HA pair have synchronized clocks. It is sufficient to manually synchronize the clocks until SSR software is installed, after which point NTP (Network Time Protocol) can be used to automatically synchronize the clocks.</p><p>Within the SSR configuration, you should configure NTP servers within <code>authority &gt; router &gt; system &gt; ntp</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="confirm-ntp">Confirm NTP<a href="#confirm-ntp" class="hash-link" aria-label="Direct link to Confirm NTP" title="Direct link to Confirm NTP">​</a></h3><p>To confirm that you have NTP configured, use the command <code>show config running</code> as shown here:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@labsystem2.newton# show config running authority router newton system ntp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router  newton</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name    newton</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            system</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ntp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    server  time.nist.gov</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        ip-address  time.nist.gov</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To confirm that NTP is synchronized, use the <code>show ntp</code> command and confirm that at least one NTP server is in the <code>active</code> state (some columns have been removed for display purposes):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@labsystem2.newton# show ntp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Sat 2019-01-26 06:54:29 EST</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Node: labsystem2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">======== ================== ========= ========= ====== ======== ======== ========</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Status   Time Source        Ref. ID   Stratum   Poll    Delay   Offset   Jitter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">======== ================== ========= ========= ====== ======== ======== ========</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> active   *time-b-wwv.nist   .NIST.          1   1024   68.905   -0.981    2.524</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.19 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="migrating-from-standalone-to-ha">Migrating from Standalone to HA<a href="#migrating-from-standalone-to-ha" class="hash-link" aria-label="Direct link to Migrating from Standalone to HA" title="Direct link to Migrating from Standalone to HA">​</a></h2><p>For an established standalone router of one node, converting it to be highly available requires configuring a second node within the SSR configuration (PCLI or GUI).</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Converting an existing router from standalone to HA will require downtime, and is therefore only to be undertaken during a maintenance window, as applicable.</p></div></div><p>Adding a second node requires configuring another <em>node</em> container within the router. This node will contain one or more <em>shared interfaces</em>, which will protect the router from failure modes when interfaces, links, or a node fails. Configuring shared interfaces is covered later in this document.</p><p>Follow the setps in <a href="/docs/config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a> in order to provision an interface to connect between peer SSR nodes.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-the-shared-interfaces">Configuring the Shared Interface(s)<a href="#configuring-the-shared-interfaces" class="hash-link" aria-label="Direct link to Configuring the Shared Interface(s)" title="Direct link to Configuring the Shared Interface(s)">​</a></h2><p>For systems configured prior to release 5.4, Dual Node High Availability can be configured using a shared MAC interface, and is described below. For systems configured on release 5.4 and later, High Availability can be configured using VRRP. See <a href="#high-availability-using-vrrp">High Availability Using VRRP</a> for information about using VRRP for dual-node failover.</p><p>A highly available router is comprised of exactly two routing nodes within the same <em>router</em> container. (Configuring two routers, each comprised of one node, cannot be made highly available.) Additionally, the routers must have at least one shared interface in common.</p><p>Configuring the basic properties of the two nodes is described elsewhere in this documentation. For high availability, the crucial step is identifying the interfaces that are to be shared between them. This is done by establishing a common Layer 2 address, known as a MAC address, that is maintained by the active node in the pair. For example, when node1 of the pair has active control over the interface, it responds to ARP requests for the addresses on the interface with the shared MAC address, whereas node2 will not. The configuration element for this MAC address is the <em>shared-phys-address</em>, within the device-interface element.</p><p>The shared-phys-address is simply a series of six octets, that is unique on a given broadcast domain. (The SSR Conductor also enforces that the shared-phys-address be unique among all routers within an Authority.) There are no hard and fast rules for creating &quot;globally unique&quot; MAC addresses; there are, however, many websites available that will generate random values. Again, since these MAC addresses are only used on a broadcast domain, they do not need to be globally unique to suit the SSR router&#x27;s needs. The shared-phys-address is configured using the format &quot;00:00:00:00:00:00.&quot;</p><div class="theme-admonition theme-admonition-important alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>When configuring shared-MAC failover, it is important to use a <strong>locally administered MAC address</strong>. The use of a universally administered MAC causes inconsistent session establishment issues. These can be difficult to troubleshoot. </p><p>For more information about locally and universally administered MAC addresses, please see <!-- -->[MAC Addresses.]<!-- -->(<a href="https://en.wikipedia.org/wiki/MAC_address#Universal_vs._local_(U/L_bit)" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/MAC_address#Universal_vs._local_(U/L_bit)</a></p></div></div><p>Configuring the same shared-phys-address on two different interfaces (one per node in the high availability pair) informs the SSR that you wish to have the interfaces protect one another. This in turn causes the SSR to assign all corresponding pairs of network-interfaces that belong to this shared interface the same common <em>global ID</em>. (I.e., each network-interface on a node will have a unique global ID, but each counterpart network-interface on a highly available node will have the same global ID.) The global ID is an internal identifier, used by the SSR, to refer to the shared interface.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-the-global-id">About the Global ID<a href="#about-the-global-id" class="hash-link" aria-label="Direct link to About the Global ID" title="Direct link to About the Global ID">​</a></h3><p>Each network-interface within a SSR configuration has a global ID assigned to it. The term &quot;global&quot; refers to the value being global across two nodes of a router; it is not uniquely global across an Authority. Each router within an authority can share the same global ID.  When two nodes share an interface for high availability, each network-interface pair, one per node, that fails over to another network-interface on the paired node is assigned the same global ID.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.router1 (device-interface[name=wan])# show</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">name                 wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">description          &quot;WAN interface, port 0&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type                 ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pci-address          0000:00:14.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">link-settings        auto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">enabled              true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">forwarding           true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">shared-phys-address  12:81:28:00:00:AA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">network-interface    vlan0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name                   vlan0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    global-id              1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This value is also present in the output of <code>show rib</code>, where it is the trailing value within each RIB entry:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.router1# show rib</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2019-01-07 10:53:19 EST</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Codes: K - kernel route, C - connected, S - static, R - RIP,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       O - OSPF, I - IS-IS, B - BGP, E - EIGRP, N - NHRP,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       T - Table, v - VNC, V - VNC-Direct, A - Babel, D - SHARP,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       F - PBR,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       &gt; - selected route, * - FIB route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 10.0.128.0/17 is directly connected, g2, 00:46:05</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">C * 169.254.127.126/31 is directly connected, g4294967293, 00:43:58</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 169.254.127.126/31 is directly connected, g4294967294, 00:46:06</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 169.254.255.2/31 is directly connected, g3, 00:44:15</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 192.0.2.0/24 is directly connected, g1, 00:46:05</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <em>g1</em> value in the line above refers to the interface assigned with global-id value 1.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-interface-consistency">Network Interface Consistency<a href="#network-interface-consistency" class="hash-link" aria-label="Direct link to Network Interface Consistency" title="Direct link to Network Interface Consistency">​</a></h3><p>When configuring shared interfaces, it is crucial that the network-interface elements within a shared device-interface are identical. This is to prevent any behavioral changes when ownership of a shared interface changes from one node to its counterpart. The configuration validation step prevents committing configuration changes when the network-interface elements are not identical.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="confirming-that-interfaces-are-shared">Confirming that Interfaces are Shared<a href="#confirming-that-interfaces-are-shared" class="hash-link" aria-label="Direct link to Confirming that Interfaces are Shared" title="Direct link to Confirming that Interfaces are Shared">​</a></h3><p>Once you have configured two device-interface elements on individual nodes within a router for high availability, the <code>show device-interface summary</code> command will identify which devices are redundant (shared) within the pair, as well as whether the interface is <em>active</em> or <em>standby</em> (or <em>non-redundant</em>, for interfaces that do not have a counterpart).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.router1# show device-interface summary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2019-01-07 10:45:11 EST</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">================= ============== ============= =================== ===================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Name              Admin Status   Oper Status   Redundancy Status   MAC Address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">================= ============== ============= =================== ===================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> node1:wan         up             up            active              00:90:0b:54:f6:86</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> node1:lan         up             up            active              00:90:0b:54:f6:87</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.36 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this sample output, the interfaces on <code>node1</code> are active from a redundancy standpoint. Adding the optional argument <code>node all</code> to the command will show all interfaces on the nodes that comprise the router:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.router1# show device-interface node all summary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2019-01-07 10:49:09 EST</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">================= ============== ============= =================== ===================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Name              Admin Status   Oper Status   Redundancy Status   MAC Address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">================= ============== ============= =================== ===================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> node1:wan         up             up            active              00:90:0b:54:f6:86</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> node1:lan         up             up            active              00:90:0b:54:f6:87</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> node2:wan         up             up            standby             00:90:0b:73:88:40</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> node2:lan         up             up            standby             00:90:0b:73:88:41</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.66 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-the-fabric-interface">Configuring the Fabric Interface<a href="#configuring-the-fabric-interface" class="hash-link" aria-label="Direct link to Configuring the Fabric Interface" title="Direct link to Configuring the Fabric Interface">​</a></h2><p>An optional, but common inclusion in highly available routers is a fabric interface, also known as a &quot;dogleg&quot; interface. Named to evoke the imagery of a fabric backplane or midplane of a chassis-based router, the fabric interface is a forwarding interface between two nodes in a router, and is used when the ingress interface and egress interface for a given session are active on different nodes.</p><p>Fabric interfaces are not required for simple active/standby deployments where the two nodes are mirror images of one another (e.g., each WAN interface and LAN interface is protected using shared interfaces). It does offer an additional protection against failure even in these active/standby setups: the double failure of a LAN port on node 1 and a WAN port on node 2. For deployments where Ethernet ports are not at a premium, a fabric interface is strongly recommended.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    device-interface  internode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name               internode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        description        &quot;Direct connect between nodes, port 2&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        type               ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        pci-address        0000:00:14.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        forwarding         true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface  fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name         fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            global-id    3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            description  &quot;Fabric link between nodes&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type         fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address      169.254.255.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ip-address     169.254.255.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                prefix-length  31</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-redundancy-groups">Configuring Redundancy Groups<a href="#configuring-redundancy-groups" class="hash-link" aria-label="Direct link to Configuring Redundancy Groups" title="Direct link to Configuring Redundancy Groups">​</a></h2><p>Redundancy groups are sets of interfaces that <em>share fate</em>, such that if one of the interfaces in the group fails, leadership of all interfaces in the group will be relinquished to the counterpart node in the router. Redundancy groups are required when the two nodes in a router do not have a fabric interface between them. If this were the case, the potential exists for a situation where the active LAN interface is on node 1 and the active WAN interface is on node 2, with no way to transmit packets from node 1 to node 2.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>When configuring high availability using VRRP, redundancy groups are not configured/needed.</p></div></div><p>While redundancy groups are most commonly found in legacy deployments (i.e., those that predate the SSR&#x27;s introduction of the fabric interface), they are still useful in simple HA deployments. Furthermore, the redundancy group affords administrators the ability to assert a preference for which node is active in an HA pair in the &quot;sunny day&quot; scenario where no interfaces are administratively or operationally down.</p><p>Generally, you will configure two nodes that each have a set of forwarding interfaces (for illustrative purposes, assume an interface on an internal network named <em>lan</em> and an interface on an external network named <em>wan</em>). Each node requires a <em>redundancy-group</em> that containing a pair of internal and external interfaces, as is seen in the following example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">redundancy-group      grp-node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name      grp-node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    member    node1 wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        node       node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        device-id  wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    member    node1 lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        node       node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        device-id  lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    priority  50</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">redundancy-group      grp-node2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name      grp-node2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    member    node2 wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        node       node2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        device-id  wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    member    node2 lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        node       node2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        device-id  lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    priority  25</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this example, our two redundant nodes (node1 and node2) each have two interfaces contained within part of the <code>redundancy-group</code>. Note that each group collects the interfaces for a node, <em>not interfaces that share a global-id</em>.</p><p>It is considered a best practice to configure different priority values on each redundancy group. The group with the higher <code>priority</code> value is active, or primary. When configuring redundancy-groups the failover of the systems is “revertive”; the group with the higher priority is active unless it experiences a failure. When that failure is restored it becomes active again.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p> If two redundancy-groups are configured with the same <em>priority</em> value, the SSR router will select an active member using an internal election algorithm, which is not guaranteed to be revertive in the event of a failure. </p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="service-route-redundancy">Service Route Redundancy<a href="#service-route-redundancy" class="hash-link" aria-label="Direct link to Service Route Redundancy" title="Direct link to Service Route Redundancy">​</a></h2><p>Available with SSR Version 5.4 and higher.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="enable-failover-on-the-service-route"><code>enable-failover</code> on the <code>service-route</code>:<a href="#enable-failover-on-the-service-route" class="hash-link" aria-label="Direct link to enable-failover-on-the-service-route" title="Direct link to enable-failover-on-the-service-route">​</a></h4><p>Service routes are used to influence traffic destinations for services. By enabling failover on the service route, failover includes the existing sessions, eliminating the lag time previously encountered as those sessions were re-established. Service route redundancy is not exclusive to dual node, high availability configurations. It is configured as shown below.</p><p>To enable existing sessions to failover between the nodes, <code>enable-failover</code> is configured on both the service-routes <code>test-1_intf13_route-0</code> and <code>test-2_intf113_route-0</code>. Any generated peer service-routes will inherit this property as well. </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route             test-1_intf13_route-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name                    test-1_intf13_route-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name            east-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                vector                  primary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                enable-failover         true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                next-hop                test-1 intf13</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name   test-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface   intf13</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    gateway-ip  172.16.4.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                reachability-detection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    enabled               true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    enforcement           true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    detection-window      10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    hold-down             60</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    reachability-profile  profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    probe-type            always</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    probe                 foo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                foo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        enabled             true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        icmp-probe-profile  icmp-profile-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route             test-2_intf113_route-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name                    test-2_intf113_route-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name            east-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                vector                  secondary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                enable-failover         true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                next-hop                test-2 intf113</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name   test-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface   intf113</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    gateway-ip  172.16.4.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                reachability-detection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    enabled               true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    enforcement           true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    detection-window      10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    hold-down             60</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    reachability-profile  profile-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    probe-type            always</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    probe                 foo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                foo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        enabled             true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        icmp-probe-profile  icmp-profile-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-vector-to-define-the-primary-node">Using <code>vector</code> to Define the Primary Node<a href="#using-vector-to-define-the-primary-node" class="hash-link" aria-label="Direct link to using-vector-to-define-the-primary-node" title="Direct link to using-vector-to-define-the-primary-node">​</a></h3><p>The use of a <code>vector</code> is not exclusive to dual node, high availability configurations. It is configured as shown below.</p><p>To define the primary and standby <strong>nodes</strong> in the HA configuration, configure a <code>vector</code> on the <code>service-route</code> and a priority on the <code>service-policy</code>. </p><ul><li><code>vector</code> - configured on the service route </li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">service-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name            wan1-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    service-name    wan-service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      vector        red</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      priority      100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    next-hop</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        node        node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        interface   wan1-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>The <code>priority</code> value of the <code>vector</code> defined in the <code>service-policy</code>:</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">service-policy  netcat-policy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name                 netcat-policy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-class        netcat-class</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            lb-strategy          hunt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            vector               red</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name             red</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                priority         100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            vector               blue</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name             blue</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                priority         90</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The vector and the associated priority can then be assigned to one or more next hops within the service route, providing a primary and secondary path for failover and high availablity. </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name    wan1-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    service-name wan-service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    next-hop</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        vector      red</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        node        node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        interface   wan1-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    next-hop</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        vector      blue</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        node        node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        interface   wan2-int</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-availability-using-vrrp">High Availability Using VRRP<a href="#high-availability-using-vrrp" class="hash-link" aria-label="Direct link to High Availability Using VRRP" title="Direct link to High Availability Using VRRP">​</a></h2><p>To facilitate a seamless failover, you can now configure VRRP on a dual node HA configuration. This reduces failover time and when configured with service-route failover, the sessions are preserved. </p><p>Configure VRRP on the <code>wan</code> and <code>lan</code> interfaces of node 1. In this example node 1 is set as the active node (set with the higher priority), and node 2 is configured as the standby node. </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                node                  node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name              node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    description       &quot;Node 1 of HA pair&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-interface  wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                 wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        description          &quot;WAN interface, port 0&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type                 ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        pci-address          0000:00:14.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        link-settings        auto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        enabled              true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        forwarding           true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        vrrp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            enabled                 true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vrid                    128</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            priority                100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            advertisement-interval  250</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        network-interface    vlan0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name                   vlan0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            global-id              1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-interface  lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                 lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        description          &quot;LAN interface, port 1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type                 ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        pci-address          0000:00:14.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        link-settings        auto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        enabled              true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        forwarding           true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        vrrp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            enabled                 true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vrid                    95</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            priority                100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            advertisement-interval  250</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        network-interface    vlan100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name                   vlan100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            global-id              2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vlan                   100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            type                   external</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            inter-router-security  internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Node 2 lan and wan interfaces are configured similarly, however the priority is lower to indicate it is the standby node. </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                node                  node2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name              node2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    description       &quot;Node 2 of the HA pair&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-interface  wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                 wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        description          &quot;WAN interface, port 0&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type                 ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        pci-address          0000:00:14.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        link-settings        auto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        enabled              true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        forwarding           true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        vrrp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            enabled                 true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vrid                    128</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            priority                99</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            advertisement-interval  250</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        network-interface    vlan0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name                   vlan0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            global-id              1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-interface  lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                 lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        description          &quot;LAN interface, port 1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type                 ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        pci-address          0000:00:14.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        link-settings        auto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        enabled              true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        forwarding           true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        vrrp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            enabled                 true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vrid                    95</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            priority                99</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            advertisement-interval  250</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        network-interface    vlan100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name                   vlan100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            global-id              2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vlan                   100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            type                   external</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            inter-router-security  internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-considerations">Configuration Considerations<a href="#configuration-considerations" class="hash-link" aria-label="Direct link to Configuration Considerations" title="Direct link to Configuration Considerations">​</a></h3><ul><li>VRRP can be enabled only on one of the vlans, but the state of VRRP run on that vlan affects the whole device interface. The vrrp vlan will default to <code>vlan 0</code>, but is user configurable to a different vlan.</li><li>VRRP cannot be enabled on a vlan that has DHCP.</li><li>If DHCP needs to be supported on a VRRP enabled device interface, then VRRP must be enabled on another vlan with a static IP.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="shared-mac-failover-sample-configuration">Shared-MAC Failover Sample Configuration<a href="#shared-mac-failover-sample-configuration" class="hash-link" aria-label="Direct link to Shared-MAC Failover Sample Configuration" title="Direct link to Shared-MAC Failover Sample Configuration">​</a></h2><p>Below is a sample, minimal configuration for which shows the inclusion of both a fabric interfaces as well as redundancy-groups. This topology consists of 4 interfaces per node.  1 LAN, 1 WAN, 1 Fabric dog-leg, and 1 Fabric forwarding interface.</p><div class="theme-admonition theme-admonition-important alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>When configuring shared-MAC failover, it is important to use a <strong>locally administered MAC address</strong>, as shown in the updated configuration below. The use of a universally administered MAC causes inconsistent session establishment issues. These can be difficult to troubleshoot.</p><p>For more information about locally and universally administered MAC addresses, please see <!-- -->[MAC Addresses.]<!-- -->(<a href="https://en.wikipedia.org/wiki/MAC_address#Universal_vs._local_(U/L_bit)" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/MAC_address#Universal_vs._local_(U/L_bit)</a></p></div></div><p>This is an example of a <strong>pre-5.4 configuration</strong> using the shared-mac failover. </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name              128technology</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            dynamic-hostname  interface-{interface-id}.{router-name}.{authority-name}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            router            router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name                  router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                location-coordinates  +42.35972+116.17917/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                description           &quot;HA branch office router, Lanner 7573B&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                system</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    contact    admin@128technology.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    log-level  info</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    ntp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        server  132.163.97.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address  132.163.97.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                node                  node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name              node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    description       &quot;Node 1 of HA pair&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-interface  wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                 wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        description          &quot;WAN interface, port 0&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type                 ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        pci-address          0000:00:14.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        link-settings        auto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        enabled              true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        forwarding           true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        shared-phys-address  12:81:28:00:00:AA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        network-interface    vlan0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name                   vlan0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            global-id              1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            neighborhood           internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                name      internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                topology  spoke</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            inter-router-security  internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            address                192.0.2.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                ip-address     192.0.2.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-interface  lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                 lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        description          &quot;LAN interface, port 1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type                 ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        pci-address          0000:00:14.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        link-settings        auto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        enabled              true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        forwarding           true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        shared-phys-address  12:81:28:00:00:BB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        network-interface    vlan100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name                   vlan100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            global-id              2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vlan                   100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            type                   external</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            inter-router-security  internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            address                10.0.128.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                ip-address     10.0.128.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                prefix-length  17</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-interface  internode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name               internode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        description        &quot;Direct connect between nodes, port 2&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type               ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        pci-address        0000:00:14.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        forwarding         true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        network-interface  fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name         fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            global-id    3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            description  &quot;Fabric link between nodes&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            type         fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            address      169.254.255.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                ip-address     169.254.255.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                prefix-length  31</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-interface          ha-fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name               ha-fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type               ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        pci-address        0000:00:14.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        forwarding         false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        network-interface  peer-fabric-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name       peer-fabric-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            type       fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            address    172.16.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                ip-address     172.16.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                node                  node2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name              node2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    description       &quot;Node 2 of the HA pair&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-interface  wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                 wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        description          &quot;WAN interface, port 0&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type                 ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        pci-address          0000:00:14.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        link-settings        auto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        enabled              true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        forwarding           true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        shared-phys-address  12:81:28:00:00:AA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        network-interface    vlan0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name                   vlan0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            global-id              1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            neighborhood           internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                name      internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                topology  spoke</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            inter-router-security  internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            address                192.0.2.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                ip-address     192.0.2.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-interface  lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                 lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        description          &quot;LAN interface, port 1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type                 ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        pci-address          0000:00:14.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        link-settings        auto</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        enabled              true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        forwarding           true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        shared-phys-address  12:81:28:00:00:BB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        network-interface    vlan100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name                   vlan100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            global-id              2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vlan                   100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            type                   external</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            inter-router-security  internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            address                10.0.128.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                ip-address     10.0.128.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                prefix-length  17</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-interface  internode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name               internode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        description        &quot;Direct connect between nodes, port 2&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type               ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        pci-address        0000:00:14.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        forwarding         true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        network-interface  fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name         fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            global-id    3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            description  &quot;Fabric link between nodes&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            type         fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            address      169.254.255.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                ip-address     169.254.255.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                prefix-length  31</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface          ha-fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               ha-fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    type               ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    pci-address        0000:00:14.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    forwarding         false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  peer-fabric-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name       peer-fabric-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type       fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address    172.16.1.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     172.16.1.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                redundancy-group      grp-node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name      grp-node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    member    node1 wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        node       node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        device-id  wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    member    node1 lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        node       node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        device-id  lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    priority  50</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                redundancy-group      grp-node2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name      grp-node2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    member    node2 wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        node       node2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        device-id  wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    member    node2 lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        node       node2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        device-id  lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    priority  25</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-route         rte_default-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name              rte_default-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    service-name      default-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    next-hop      node1 vlan0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        node-name  node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        interface  vlan0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service           default-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name         default-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                description  &quot;Default route&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                scope        public</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address      0.0.0.0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-04-14T18:11:12.000Z">Apr 14, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/config_bfd"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">BFD with BGP and OSPF</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/config_dual_router_ha"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Dual Router High Availability using iBGP</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#requirements" class="table-of-contents__link toc-highlight">Requirements</a></li><li><a href="#before-you-begin" class="table-of-contents__link toc-highlight">Before You Begin</a><ul><li><a href="#configuration-change-operations" class="table-of-contents__link toc-highlight">Configuration Change Operations</a></li><li><a href="#exporting-the-candidate-configuration" class="table-of-contents__link toc-highlight">Exporting the Candidate Configuration</a></li><li><a href="#clock-synchronization" class="table-of-contents__link toc-highlight">Clock Synchronization</a></li><li><a href="#confirm-ntp" class="table-of-contents__link toc-highlight">Confirm NTP</a></li></ul></li><li><a href="#migrating-from-standalone-to-ha" class="table-of-contents__link toc-highlight">Migrating from Standalone to HA</a></li><li><a href="#configuring-the-shared-interfaces" class="table-of-contents__link toc-highlight">Configuring the Shared Interface(s)</a><ul><li><a href="#about-the-global-id" class="table-of-contents__link toc-highlight">About the Global ID</a></li><li><a href="#network-interface-consistency" class="table-of-contents__link toc-highlight">Network Interface Consistency</a></li><li><a href="#confirming-that-interfaces-are-shared" class="table-of-contents__link toc-highlight">Confirming that Interfaces are Shared</a></li></ul></li><li><a href="#configuring-the-fabric-interface" class="table-of-contents__link toc-highlight">Configuring the Fabric Interface</a></li><li><a href="#configuring-redundancy-groups" class="table-of-contents__link toc-highlight">Configuring Redundancy Groups</a></li><li><a href="#service-route-redundancy" class="table-of-contents__link toc-highlight">Service Route Redundancy</a><ul><li><a href="#using-vector-to-define-the-primary-node" class="table-of-contents__link toc-highlight">Using <code>vector</code> to Define the Primary Node</a></li></ul></li><li><a href="#high-availability-using-vrrp" class="table-of-contents__link toc-highlight">High Availability Using VRRP</a><ul><li><a href="#configuration-considerations" class="table-of-contents__link toc-highlight">Configuration Considerations</a></li></ul></li><li><a href="#shared-mac-failover-sample-configuration" class="table-of-contents__link toc-highlight">Shared-MAC Failover Sample Configuration</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.df335f7d.js"></script>
<script src="/assets/js/main.3b0d8498.js"></script>
</body>
</html>
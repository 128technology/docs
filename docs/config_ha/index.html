<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">Configuring High Availability (128T Router) | 128T Docs</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="128T Docs"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="This document contains the steps required for configuring support for high availability (HA) on a 128T router. Unlike traditional routers, where deploying high availability involved deploying two separate routers and using a protocol such as VRRP or HSRP to provide failover protection, the 128T deploys software instances (referred to as &quot;nodes&quot;) in pairs, but are collectively referred to as a single, logical router."><meta data-react-helmet="true" property="og:description" content="This document contains the steps required for configuring support for high availability (HA) on a 128T router. Unlike traditional routers, where deploying high availability involved deploying two separate routers and using a protocol such as VRRP or HSRP to provide failover protection, the 128T deploys software instances (referred to as &quot;nodes&quot;) in pairs, but are collectively referred to as a single, logical router."><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/config_ha">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.71d4e6da.css">


<link rel="preload" href="/styles.ff9f8d17.js" as="script">

<link rel="preload" href="/runtime~main.fee6521f.js" as="script">

<link rel="preload" href="/main.7c766fad.js" as="script">

<link rel="preload" href="/1.9ae0b019.js" as="script">

<link rel="preload" href="/2.f831cf59.js" as="script">

<link rel="preload" href="/67.f6605959.js" as="script">

<link rel="preload" href="/20ac7829.07a3fdb5.js" as="script">

<link rel="preload" href="/17896441.0ce484ff.js" as="script">

<link rel="preload" href="/527b551c.32faa3fe.js" as="script">

</head>
<body>

<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title"></strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://community.128technology.com/home">Interchange</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://www.128technology.com/">Company</a><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Docs</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://community.128technology.com/home">Interchange</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://www.128technology.com/">Company</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/img/128t_black.png" alt="128 Technology Logo"><strong></strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/about_128t">128T</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/CONTRIBUTING">Contributing</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Release Notes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/release_notes_4.2.0">4.2.0 Release Notes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/release_notes_4.2.1">4.2.1 Release Notes</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_downloading_iso">Downloading ISOs</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation_installer">Installing 128T</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation_bootable_media">Installing From ISO</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation_aws">Installing in AWS</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_ztp">QuickStart</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_creating_bootable_usb">Creating Bootable USB</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_upgrading">Upgrading</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_rollback">Rollback</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_application_discovery">Application Discovery</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_ha_theoryofoperation">HA - Theory of Operation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_interface_types">Interface Types</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_linux_host_networking">Linux Host Networking</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_network_planes">Forwarding Planes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_machine_communication">Machine Communication</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_session_timer">Session Timers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_glossary">Glossary</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Administration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/config_basics">Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_audit_log">Audit Log</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_dns_proxy">DNS Proxy</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_ldap">LDAP</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/config_ha">High Availability</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_adding_interfaces_to_ha_team">Adding Interfaces to HA Team Interface</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_transition_standalone_to_ha">Transitioning a Conductor from Standalone to HA</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_nat">NAT</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_snmp">SNMP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_snmp_metrics">SNMP: User defined metrics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_tenants">Tenants</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">How To</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/howto_bgp">BGP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/howto_maintenance_mode">Maintenance Mode</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/howto_trusted_ca_certificate">Adding a Trusted Certificate</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/ts_applications">Application Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_ap_salt_minion">AP: Salt Minion</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_cpu_spikes">CPU Spikes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_connecting_to_routers">Connecting to Routers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_forwarding_resource_pools">Forwarding Plane Resource Pools</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_logs">Logs</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_mac_uniqueness">MAC Address Uniqueness</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Events</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/events_overview">Alarm and Events</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/events_alarms">Alarms</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/events_events">Events</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Best Practices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_conductor_deployment">Conductor Deployment</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_lte_peering">LTE Peering</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_service_and_service_policy_design">Service and Service Policy Design</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_tenants">Tenancy Design</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CLI Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/cli_reference">Reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/plugin_monitoring_agent">Monitoring</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/plugin_gre">GRE Plugin</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/apis_rest">REST</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apis_netconf">NETCONF</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Configuring High Availability (128T Router)</h1></header><div class="markdown"><p>This document contains the steps required for configuring support for high availability (HA) on a 128T router. Unlike traditional routers, where deploying high availability involved deploying two separate routers and using a protocol such as VRRP or HSRP to provide failover protection, the 128T deploys software instances (referred to as &quot;nodes&quot;) in pairs, but are collectively referred to as a single, logical router.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="requirements"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#requirements" title="Direct link to heading">#</a>Requirements</h2><p>Configuring high availability requires that two 128T routing nodes have at least one device-interface that is shared between them (referred to in this document as a <em>shared interface</em>). Shared interfaces are configured on both nodes, but are active on only one node at a time. These shared interfaces <strong>must</strong> be in the same L2 broadcast domain; this is because the 128T uses gratuitous ARP messages to announce an interface failover, so that it may receive packets in place of its counterpart.</p><p>The two 128T router nodes that make up a high availability pair must be collocated due to latency sensitivities for the information that they synchronize between themselves.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="before-you-begin"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#before-you-begin" title="Direct link to heading">#</a>Before You Begin</h2><p>There are several things to be mindful of before configuring HA; the two nodes must be informed that they are part of a high availability set, and they must have a dedicated interface between themselves for synchronizing state information about active sessions. These steps will be covered in this section.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="clock-synchronization"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#clock-synchronization" title="Direct link to heading">#</a>Clock Synchronization</h3><p>Because highly available nodes synchronize time-series data, it is critical that the two nodes that comprise an HA pair have synchronized clocks. It is sufficient to manually synchronize the clocks until 128T software is installed, after which point NTP (Network Time Protocol) can be used to automatically synchronize the clocks.</p><p>Within the 128T configuration, you should configure NTP servers within <code>authority &gt; router &gt; system &gt; ntp</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="confirm-ntp"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#confirm-ntp" title="Direct link to heading">#</a>Confirm NTP</h3><p>To confirm that you have NTP configured, use the command <code>show config running</code> as shown here:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@labsystem2.newton# show config running authority router newton system ntp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router  newton</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name    newton</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            system</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ntp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    server  time.nist.gov</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        ip-address  time.nist.gov</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></code></pre></div><p>To confirm that NTP is synchronized, use the <code>show ntp</code> command and confirm that at least one NTP server is in the <code>active</code> state (some columns have been removed for display purposes):</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@labsystem2.newton# show ntp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Sat 2019-01-26 06:54:29 EST</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Node: labsystem2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">======== ================== ========= ========= ====== ======== ======== ========</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Status   Time Source        Ref. ID   Stratum   Poll    Delay   Offset   Jitter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">======== ================== ========= ========= ====== ======== ======== ========</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> active   *time-b-wwv.nist   .NIST.          1   1024   68.905   -0.981    2.524</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.19 seconds</span></div></code></pre></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="migrating-from-standalone-to-ha"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#migrating-from-standalone-to-ha" title="Direct link to heading">#</a>Migrating from Standalone to HA</h2><p>For an established standalone router of one node, converting it to be highly available requires configuring a second node within the 128T configuration (PCLI or GUI) at the outset.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>Converting an existing router from standalone to HA will require downtime, and is therefore only to be undertaken during a maintenance window, as applicable.</p></div></div><p>Adding a second node is simply a matter of configuring another <em>node</em> container within the router. Eventually, this node will contain one or more <em>shared interfaces</em>, which will protect the router from failure modes if/when interfaces, links or a node fails. Configuring shared interfaces is covered later in this document.</p><p>Follow the setps in <a href="config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a> in order to provision an interface to connect between peer 128T nodes.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="configuring-the-shared-interfaces"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#configuring-the-shared-interfaces" title="Direct link to heading">#</a>Configuring the Shared Interface(s)</h2><p>A highly available router is comprised of exactly two routing nodes within the same <em>router</em> container. (Configuring two routers, each comprised of one node, cannot be made highly available.) Additionally, as mentioned previously, these routers must have at least one shared interface in common.</p><p>Configuring the basic properties of the two nodes is described elsewhere in this documentation. For high availability, the crucial step is identifying to the 128T the interfaces that are to be shared between them. This is done by establishing a common Layer 2 address, known as a MAC address, that is maintained by the active node in the pair. (I.e., when node1 of the pair has active control over the interface, it will respond to ARP requests for the addresses on that interface with the shared MAC address, whereas node2 will not.) The configuration element for this MAC address is the <em>shared-phys-address</em>, within the device-interface element.</p><p>The shared-phys-address is simply a series of six octets, where the only requirement is that it is unique on a given broadcast domain. (The 128T Conductor also enforces that the shared-phys-address be unique among all routers within an Authority.) There are no hardfast rules for creating &quot;globally unique&quot; MAC addresses; there are, however, many websites available that will generate random values. Again, since these MAC addresses are only used on a broadcast domain, they do not need to be globally unique to suit the 128T router&#x27;s needs. Irrespective of how you choose to generate the value, the shared-phys-address is configured using the format &quot;00:00:00:00:00:00.&quot;</p><p>Configuring the same shared-phys-address on two different interfaces (one per node in the high availability pair) informs the 128T that you wish to have the interfaces protect one another. This in turn causes the 128T to assign all corresponding pairs of network-interfaces that belong to this shared interface the same common <em>global ID</em>. (I.e., each network-interface on a node will have a unique global ID, but each counterpart network-interface on a highly available node will have the same global ID.) The global ID is an internal identifier, used by the 128T, to refer to the shared interface.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="about-the-global-id"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#about-the-global-id" title="Direct link to heading">#</a>About the Global ID</h3><p>Each network-interface within a 128T configuration has a global ID assigned to it. The term &quot;global&quot; refers to the value being global across two nodes of a router; it is not uniquely global across an Authority. Each router within an authority can share the same global ID.  When two nodes share an interface for high availability, each network-interface pair, one per node, that fails over to another network-interface on the paired node is assigned the same global ID.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.router1 (device-interface[name=wan])# show</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">name                 wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">description          &quot;WAN interface, port 0&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">type                 ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pci-address          0000:00:14.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">link-settings        auto</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">enabled              true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">forwarding           true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">shared-phys-address  00:00:5e:00:00:00</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">network-interface    vlan0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name                   vlan0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    global-id              1</span></div></code></pre></div><p>This value is also present in the output of <code>show rib</code>, where it is the trailing value within each RIB entry:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.router1# show rib</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2019-01-07 10:53:19 EST</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Codes: K - kernel route, C - connected, S - static, R - RIP,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       O - OSPF, I - IS-IS, B - BGP, E - EIGRP, N - NHRP,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       T - Table, v - VNC, V - VNC-Direct, A - Babel, D - SHARP,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       F - PBR,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       &gt; - selected route, * - FIB route</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 10.0.128.0/17 is directly connected, g2, 00:46:05</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C * 169.254.127.126/31 is directly connected, g4294967293, 00:43:58</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 169.254.127.126/31 is directly connected, g4294967294, 00:46:06</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 169.254.255.2/31 is directly connected, g3, 00:44:15</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 192.0.2.0/24 is directly connected, g1, 00:46:05</span></div></code></pre></div><p>The <em>g1</em> value in the line above refers to the interface assigned with global-id value 1.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="network-interface-consistency"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#network-interface-consistency" title="Direct link to heading">#</a>Network Interface Consistency</h3><p>When configuring shared interfaces, it is crucial that the network-interface elements within a shared device-interface are mirror images of one another. This is to prevent any behavioral changes when ownership of a shared interface changes from one node to its counterpart. The configuration validation step will prevent committing configuration changes when the network-interface elements are not identical.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="confirming-that-interfaces-are-shared"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#confirming-that-interfaces-are-shared" title="Direct link to heading">#</a>Confirming that Interfaces are Shared</h3><p>Once you&#x27;ve configured two device-interface elements on individual nodes within a router for high availability, the <code>show device-interface summary</code> command will identify which devices are redundant (shared) within the pair, as well as whether the interface is <em>active</em> or <em>standby</em> (or <em>non-redundant</em>, for interfaces that do not have a counterpart).</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.router1# show device-interface summary</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2019-01-07 10:45:11 EST</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">================= ============== ============= =================== ===================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Name              Admin Status   Oper Status   Redundancy Status   MAC Address</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">================= ============== ============= =================== ===================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> node1:wan         up             up            active              00:90:0b:54:f6:86</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> node1:lan         up             up            active              00:90:0b:54:f6:87</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.36 seconds</span></div></code></pre></div><p>In this sample output, the interfaces on <code>node1</code> are active from a redundancy standpoint. Adding the optional argument <code>node all</code> to the command will show all interfaces on the nodes that comprise the router:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.router1# show device-interface node all summary</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2019-01-07 10:49:09 EST</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">================= ============== ============= =================== ===================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Name              Admin Status   Oper Status   Redundancy Status   MAC Address</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">================= ============== ============= =================== ===================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> node1:wan         up             up            active              00:90:0b:54:f6:86</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> node1:lan         up             up            active              00:90:0b:54:f6:87</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> node2:wan         up             up            standby             00:90:0b:73:88:40</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> node2:lan         up             up            standby             00:90:0b:73:88:41</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.66 seconds</span></div></code></pre></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="configuring-the-fabric-interface"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#configuring-the-fabric-interface" title="Direct link to heading">#</a>Configuring the Fabric Interface</h2><p>An optional, but common inclusion in highly available routers is a fabric interface, also known as a &quot;dogleg&quot; interface. Named to evoke the imagery of a fabric backplane or midplane of a chassis-based router, the fabric interface is a forwarding interface between two nodes in a router, and is used when the ingress interface and egress interface for a given session are active on different nodes.</p><p>Fabric interfaces are not required for simple active/standby deployments where the two nodes are mirror images of one another (e.g., each WAN interface and LAN interface is protected using shared interfaces). It does offer an additional protection against failure even in these active/standby setups: the double failure of a LAN port on node 1 and a WAN port on node 2. For deployments where Ethernet ports are not at a premium, a fabric interface is strongly recommended.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    device-interface  internode</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name               internode</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        description        &quot;Direct connect between nodes, port 2&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        type               ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        pci-address        0000:00:14.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        forwarding         true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface  fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name         fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            global-id    3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            description  &quot;Fabric link between nodes&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            type         fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address      169.254.255.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ip-address     169.254.255.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                prefix-length  31</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div></code></pre></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="configuring-redundancy-groups"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#configuring-redundancy-groups" title="Direct link to heading">#</a>Configuring Redundancy Groups</h2><p>Redundancy groups are sets of interfaces that <em>share fate</em>, such that if one of the interfaces in the group fails, mastership of all interfaces in the group will be relinquished to the counterpart node in the router. Redundancy groups are required when the two nodes in a router do not have a fabric interface between them; otherwise, you could end up in a situation where the active LAN interface is on node 1 and the active WAN interface is on node 2, with no way to transit packets from node 1 to node 2.</p><p>While redundancy groups are most commonly found in legacy deployments (i.e., those that predate 128 Technology&#x27;s introduction of the fabric interface), they are still useful in simple HA deployments. Furthermore, the redundancy group affords administrators the ability to assert a preference for which node is active in an HA pair in the &quot;sunny day&quot; scenario where no interfaces are administratively or operationally down.</p><p>Generally, you will configure two nodes that each has a set of forwarding interfaces (for illustrative purposes, assume an interface on an internal network named <em>lan</em> and an interface on an external network named <em>wan</em>). Each node will require a <em>redundancy-group</em> that contains its pair of internal and external interfaces, as is seen in the following example:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">redundancy-group      grp-node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name      grp-node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    member    node1 wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        node       node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        device-id  wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    member    node1 lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        node       node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        device-id  lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    priority  50</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">redundancy-group      grp-node2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name      grp-node2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    member    node2 wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        node       node2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        device-id  wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    member    node2 lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        node       node2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        device-id  lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    priority  25</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></code></pre></div><p>In this example, our two redundant nodes (node1 and node2) each have two interfaces contained within part of the <code>redundancy-group</code>. Note that each group collects the interfaces for a node, <em>not interfaces that share a global-id</em>.</p><p>The <em>priority</em> value indicates, all things being otherwise equal, an administrative preference for which group should be active. When configuring two redundancy-groups with differing <em>priority</em> values, the failover of the systems is said to be “revertive” – that is, the group with the higher priority will be active unless it experiences a failure, but when that failure is restored it will become active again.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>When configuring two redundancy-groups with the same <em>priority</em> value, the 128T router will select an active member using an internal election algorithm, which is not guaranteed to be revertive in the event of a failure – but is neither guaranteed to be non-revertive. For this reason, it is suggested that you configure redundancy-group elements with different <em>priority</em> values.</p></div></div><p>##Sample Configuration
Below is a sample, minimal configuration which shows the inclusion of both a fabric interfaces as well as redundancy-groups.  This topology consists of 4 interfaces per node.  1 LAN, 1 WAN, 1 Fabric dog-leg, and 1 Fabric forwarding interface.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name              128technology</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        dynamic-hostname  interface-{interface-id}.{router-name}.{authority-name}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router            router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name                  router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            location-coordinates  +42.35972+116.17917/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            description           &quot;HA branch office router, Lanner 7573B&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            system</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                contact    admin@128technology.com</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                log-level  info</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ntp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    server  132.163.97.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        ip-address  132.163.97.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            node                  node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name              node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                description       &quot;Node 1 of HA pair&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface  wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    name                 wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    description          &quot;WAN interface, port 0&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    type                 ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    pci-address          0000:00:14.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    link-settings        auto</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    enabled              true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    forwarding           true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    shared-phys-address  00:00:5e:00:00:00</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface    vlan0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                   vlan0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        global-id              1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        neighborhood           internet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            name      internet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            topology  spoke</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        inter-router-security  internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        address                192.0.2.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     192.0.2.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface  lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    name                 lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    description          &quot;LAN interface, port 1&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    type                 ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    pci-address          0000:00:14.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    link-settings        auto</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    enabled              true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    forwarding           true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    shared-phys-address  00:00:5e:00:00:01</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface    vlan100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                   vlan100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        global-id              2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        vlan                   100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        type                   external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        inter-router-security  internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        address                10.0.128.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     10.0.128.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  17</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface  internode</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               internode</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    description        &quot;Direct connect between nodes, port 2&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    type               ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    pci-address        0000:00:14.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    forwarding         true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        name         fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        global-id    3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        description  &quot;Fabric link between nodes&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        type         fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        address      169.254.255.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     169.254.255.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  31</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface          ha-fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               ha-fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    type               ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    pci-address        0000:00:14.3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    forwarding         false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  peer-fabric-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        name       peer-fabric-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        type       fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        address    172.16.1.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     172.16.1.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            node                  node2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name              node2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                description       &quot;Node 2 of the HA pair&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface  wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    name                 wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    description          &quot;WAN interface, port 0&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    type                 ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    pci-address          0000:00:14.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    link-settings        auto</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    enabled              true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    forwarding           true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    shared-phys-address  00:00:5e:00:00:00</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface    vlan0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                   vlan0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        global-id              1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        neighborhood           internet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            name      internet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            topology  spoke</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        inter-router-security  internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        address                192.0.2.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     192.0.2.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface  lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    name                 lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    description          &quot;LAN interface, port 1&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    type                 ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    pci-address          0000:00:14.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    link-settings        auto</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    enabled              true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    forwarding           true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    shared-phys-address  00:00:5e:00:00:01</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface    vlan100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                   vlan100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        global-id              2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        vlan                   100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        type                   external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        inter-router-security  internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        address                10.0.128.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     10.0.128.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  17</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface  internode</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               internode</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    description        &quot;Direct connect between nodes, port 2&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    type               ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    pci-address        0000:00:14.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    forwarding         true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        name         fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        global-id    3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        description  &quot;Fabric link between nodes&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        type         fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        address      169.254.255.3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     169.254.255.3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  31</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            device-interface          ha-fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name               ha-fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                type               ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                pci-address        0000:00:14.3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                forwarding         false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                network-interface  peer-fabric-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    name       peer-fabric-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    type       fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    address    172.16.1.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        ip-address     172.16.1.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        prefix-length  24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            redundancy-group      grp-node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name      grp-node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                member    node1 wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    node       node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-id  wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                member    node1 lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    node       node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-id  lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                priority  50</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            redundancy-group      grp-node2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name      grp-node2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                member    node2 wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    node       node2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-id  wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                member    node2 lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    node       node2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    device-id  lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                priority  25</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route         rte_default-route</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name          rte_default-route</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  default-route</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                next-hop      node1 vlan0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name  node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface  vlan0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        service           default-route</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name         default-route</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            description  &quot;Default route&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            scope        public</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address      0.0.0.0/0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></code></pre></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/128technology/docs/tree/master/docs/config_ha.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-03-12T19:51:29.000Z" class="docLastUpdatedAt_1sqk">3/12/2020</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/config_ldap"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« LDAP</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/config_non_forwarding_ha_interfaces"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Non-forwarding HA Interfaces »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#requirements" class="contents__link">Requirements</a></li><li><a href="#before-you-begin" class="contents__link">Before You Begin</a><ul><li><a href="#clock-synchronization" class="contents__link">Clock Synchronization</a></li><li><a href="#confirm-ntp" class="contents__link">Confirm NTP</a></li></ul></li><li><a href="#migrating-from-standalone-to-ha" class="contents__link">Migrating from Standalone to HA</a></li><li><a href="#configuring-the-shared-interfaces" class="contents__link">Configuring the Shared Interface(s)</a><ul><li><a href="#about-the-global-id" class="contents__link">About the Global ID</a></li><li><a href="#network-interface-consistency" class="contents__link">Network Interface Consistency</a></li><li><a href="#confirming-that-interfaces-are-shared" class="contents__link">Confirming that Interfaces are Shared</a></li></ul></li><li><a href="#configuring-the-fabric-interface" class="contents__link">Configuring the Fabric Interface</a></li><li><a href="#configuring-redundancy-groups" class="contents__link">Configuring Redundancy Groups</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>Copyright © 2020 128 Technology, Inc.</div></div></div></footer>
</div>

<script src="/styles.ff9f8d17.js"></script>

<script src="/runtime~main.fee6521f.js"></script>

<script src="/main.7c766fad.js"></script>

<script src="/1.9ae0b019.js"></script>

<script src="/2.f831cf59.js"></script>

<script src="/67.f6605959.js"></script>

<script src="/20ac7829.07a3fdb5.js"></script>

<script src="/17896441.0ce484ff.js"></script>

<script src="/527b551c.32faa3fe.js"></script>


</body>
</html>
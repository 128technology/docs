<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-plugin_cloud_ha" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Cloud High Availability Plugin | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/docs/plugin_cloud_ha"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Cloud High Availability Plugin | SSN Docs"><meta data-rh="true" name="description" content="The SSR-cloud-ha plugin provides High Availability (HA) functionality for the SSR Networking Platform deployed in the cloud. HA for SSR routers in a non-cloud environment uses traditional techniques such as VRRP and GARP which both rely on a virtual MAC and virtual IP. In cloud environments such as AWS, Azure, etc., any techniques that rely on broadcast and multicast are not supported. This plugin uses node health metrics sent over SVR, as well as cloud API interactions to perform failovers in these cloud environments."><meta data-rh="true" property="og:description" content="The SSR-cloud-ha plugin provides High Availability (HA) functionality for the SSR Networking Platform deployed in the cloud. HA for SSR routers in a non-cloud environment uses traditional techniques such as VRRP and GARP which both rely on a virtual MAC and virtual IP. In cloud environments such as AWS, Azure, etc., any techniques that rely on broadcast and multicast are not supported. This plugin uses node health metrics sent over SVR, as well as cloud API interactions to perform failovers in these cloud environments."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/docs/plugin_cloud_ha"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/plugin_cloud_ha" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/plugin_cloud_ha" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/kb/rss.xml" title="SSR Knowledge Base Articles RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/kb/atom.xml" title="SSR Knowledge Base Articles Atom Feed">
<link rel="alternate" type="application/json" href="/kb/feed.json" title="SSR Knowledge Base Articles JSON Feed"><link rel="stylesheet" href="/assets/css/styles.b50a304b.css">
<script src="/assets/js/runtime~main.275a8a12.js" defer="defer"></script>
<script src="/assets/js/main.5baa852b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a class="navbar__item navbar__link" href="/kb">Knowledge Base</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cc_fips_titlepage">SSR Common Criteria Install and Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_upgrade_considerations">Upgrading the SSR</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation">Pre-Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_univ-iso">SSR Universal ISO Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported_cloud_platforms">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_legacy">Legacy Install Information</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts_fib">Understanding the Forwarding Information Base</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/config_basics">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bcp_sdwan_design_guide">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/plugin_intro">Plugins</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_bgp_community_services">BGP Community Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/plugin_cloud_ha">Cloud HA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_app_id">DNS App Id</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_cache">DNS Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_gre">GRE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_ha_sync_redundancy">HA Sync Redundancy Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_http_probe">HTTP Probe Reachability Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_icmp_reachability_detection">ICMP Reachability Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_ipsec_client">IPsec Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_loopback_static_routes">Loopback Static Routes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_m800_watchdog">M800 Watchdog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_monitoring_agent">Monitoring Agent Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_mosh">Mosh</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_set_hostname">Set Hostname</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_sip_alg">SIP ALG</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_wireguard">Wireguard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/release_notes_128t_6.3">Release Notes</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Plugins</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Cloud HA</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Cloud High Availability Plugin</h1></header><p>The SSR-cloud-ha plugin provides High Availability (HA) functionality for the SSR Networking Platform deployed in the cloud. HA for SSR routers in a non-cloud environment uses traditional techniques such as VRRP and GARP which both rely on a virtual MAC and virtual IP. In cloud environments such as AWS, Azure, etc., any techniques that rely on broadcast and multicast are not supported. This plugin uses node health metrics sent over SVR, as well as cloud API interactions to perform failovers in these cloud environments.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The instructions for installing and managing the plugin can be found <a href="/docs/plugin_intro#installation-and-management">here</a>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="supported-solutions">Supported Solutions<a href="#supported-solutions" class="hash-link" aria-label="Direct link to Supported Solutions" title="Direct link to Supported Solutions">​</a></h2>
<table><thead><tr><th>Solution Name</th><th><code>solution-type</code></th><th>Available In Version</th></tr></thead><tbody><tr><td>Azure VNET</td><td><code>azure-vnet</code></td><td>2.0.0</td></tr><tr><td>Azure Loadbalancer</td><td><code>azure-lb</code></td><td>2.0.0</td></tr><tr><td>Alicloud VPC</td><td><code>alicloud-vpc</code></td><td>3.0.0</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="version-restrictions">Version Restrictions<a href="#version-restrictions" class="hash-link" aria-label="Direct link to Version Restrictions" title="Direct link to Version Restrictions">​</a></h2>
<p>The router component can only be installed on versions of SSR which support provisional state on <em>device interfaces</em>. This is necessary for the plugin to be able to prevent asymmetrical routing.
The versions of SSR that support this feature have a <code>Provides: 128T-device-interface-api(1.0)</code>, so it can be checked ahead of time by performing a <code>rpm -q --whatprovides 128T-device-interface-api(1.0)</code> to see if the currently installed 128T satisfies this requirement or <code>dnf list --whatprovides 128T-device-interface-api(1.0)</code> to see all versions of SSR that satisfy this requirement.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="plugin-behavior">Plugin Behavior<a href="#plugin-behavior" class="hash-link" aria-label="Direct link to Plugin Behavior" title="Direct link to Plugin Behavior">​</a></h2>
<p><img decoding="async" loading="lazy" alt="architecture" src="/assets/images/cloud-ha-architecture-347bc488da8f21bedb0da9f1cd562a8f.png" width="1401" height="906" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-agent">Monitoring Agent<a href="#monitoring-agent" class="hash-link" aria-label="Direct link to Monitoring Agent" title="Direct link to Monitoring Agent">​</a></h3>
<p>The job of the Monitoring Agent is to produce and transmit health status messages. The Monitoring Agent collects the administrative status, operational status, and mac address of all of the configured redundant interfaces and additional interfaces at one second intervals. The health status is then sent via an HTTP POST to the IP address of the <code>cloud-ha</code> interface where the HA Agent is listening on port 12800.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ha-agent">HA Agent<a href="#ha-agent" class="hash-link" aria-label="Direct link to HA Agent" title="Direct link to HA Agent">​</a></h3>
<p>The job of the HA Agent is to process the health status messages from the the local Monitoring Agent and determine the health status for performing failover operations. For an interface to be healthy, it must be administratively and operationally up. For a node to be healthy, it must have at least one healthy <code>redundant-interface</code>. If there are additional interfaces configured, then the node must have at least one healthy <code>additional-interface</code>.</p>
<p>The following flow diagram summarizes the process followed by the HA Agent using information supplied by the Monitoring Agent, and resulting in interactions with the API Agent.</p>
<p><img decoding="async" loading="lazy" alt="HA Agent Flow Diagram" src="/assets/images/cloud-ha-ha-agent-flow-diagram-1508de7b8a95497ed25571e40b41451d.png" width="406" height="901" class="img_ev3q"></p>
<p>An HA Agent configured with a priority of 1 will be defined as the Primary node; a priority of 2 becomes the Secondary node.</p>
<ul>
<li>Primary: This node is preferred to be active except when the local node is unhealthy.</li>
<li>Secondary: This node is preferred to become active only when the local node is healthy and the remote node is unhealthy or unreachable.</li>
</ul>
<p>The internal state machines wait for the value set in seconds in <code>up-holddown-timeout</code> before considering a node healthy. If at any point during that wait the HA Agent receives an unhealthy status, the timeout will be reset and the node is considered unhealthy.</p>
<p>The internal state machines wait for the <code>peer-reachability-timeout</code> after every health status before considering the node unreachable. The timer is reset if a health report is processed before the timeout expires.</p>
<p>When the HA Agent determines that a node must become active, the first active redundant interface&#x27;s MAC address and the list of configured prefixes are sent to the API Agent&#x27;s appropriate REST endpoint. The HA Agent changes the provisional status of the configured <code>redundant-interface</code> to <strong>Up</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-agents">API Agents<a href="#api-agents" class="hash-link" aria-label="Direct link to API Agents" title="Direct link to API Agents">​</a></h3>
<p>The job of the API Agent is to perform failover actions specific to the cloud provider and the chosen solution.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="azure-loadbalancer">Azure Loadbalancer<a href="#azure-loadbalancer" class="hash-link" aria-label="Direct link to Azure Loadbalancer" title="Direct link to Azure Loadbalancer">​</a></h4>
<p>A <code>solution-type</code> of <code>azure-lb</code> can be used to enable the Azure Loadbalancer API agent. This solution requires an <a href="https://docs.microsoft.com/en-us/azure/load-balancer/load-balancer-overview" target="_blank" rel="noopener noreferrer">Azure Loadbalancer</a> to be configured using an HTTP probe on the <code>probe-port</code> with backend pools pointing towards the redundant interfaces.</p>
<p>Probe example:</p>
<p><img decoding="async" loading="lazy" alt="Azure Loadblancer Probe Configuration" src="/assets/images/cloud-ha-azure-lb-probe-config-2797db24e4678a45df16de5e2d8dcda7.png" width="1268" height="217" class="img_ev3q"></p>
<p>Backend Pool example:</p>
<p><img decoding="async" loading="lazy" alt="Azure Loadblancer Backend Pool Configuration" src="/assets/images/cloud-ha-azure-lb-backend-pool-config-fec533861724cfbc1c723bbca45b332e.png" width="1297" height="220" class="img_ev3q"></p>
<p>The Azure Loadbalancer sends a health probe to the redundant SSR&#x27;s redundant interfaces. These probes are routed through the <code>cloud-ha</code> interface, through a <code>128T-azure-lb-nginx</code> instance, and down to the Azure Loadbalancer API Agent.</p>
<p>The Azure Loadbalancer API Agent responds to the probes with a <code>200</code> status code when the current node is active and a <code>500</code> code when its inactive. A probe to the inactive node will not reach the SSR when the redundant interfaces are set provisionally down.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="azure-vnet">Azure VNET<a href="#azure-vnet" class="hash-link" aria-label="Direct link to Azure VNET" title="Direct link to Azure VNET">​</a></h4>
<p>A <code>solution-type</code> of <code>azure-vnet</code> can be used to enable the Azure VNET API agent. It requires an Azure Route Table setup on the same VNET as the redundant interfaces. The Virtual Machines where these members are running must be granted the following permissions in order for the route updates to work correctly:</p>
<ul>
<li>Microsoft.Network/routeTables/read</li>
<li>Microsoft.Network/networkInterfaces/read</li>
<li>Microsoft.Network/routeTables/routes/*/write</li>
<li>Microsoft.Network/routeTables/routes/read</li>
<li>Microsoft.Compute/virtualMachines/read</li>
<li>Microsoft.Network/virtualNetworks/read</li>
</ul>
<p>The agent finds all of the route tables within the VNET using the Azure REST APIs. When a redundant interface becomes active, the agent updates the route tables for all the configured prefixes to point to that interface. The solution is designed to be idempotent, so the peer member&#x27;s redundant interface will now be inactive. There is no update to the route table needed when becoming inactive.</p>
<p><code>Microsoft.Network/virtualNetworks/read</code> is only necessary when the plugin should discover and modify peer VNET route tables. This feature can be enabled by configuring <code>include-peer-vnets</code> to <code>true</code>.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>To prevent routing loops, the solution will not update the Azure Route Tables assigned to a subnet that has an activating node&#x27;s <em>network interface</em>.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="alicloud-vpc">Alicloud VPC<a href="#alicloud-vpc" class="hash-link" aria-label="Direct link to Alicloud VPC" title="Direct link to Alicloud VPC">​</a></h4>
<p>A <code>solution-type</code> of <code>alicloud-vpc</code> can be used to enable the Alicloud VPC API agent. It requires an Alicloud Route Table setup on the same VNET as the redundant interfaces.</p>
<p>Since the deployment of Juniper SDWAN HA requires granting RAM role permissions, you need to add a RAM username for this under your current Alicloud account and grant the following permissions. The Virtual Machines where these members are running must be granted with the RAM role with following permissions in order for the route updates to work correctly:</p>
<ul>
<li>AliyunECSFullAccess</li>
<li>AliyunVPCFullAccess</li>
</ul>
<p>The agent finds all of the route tables within the Alicloud VPC using the Alicloud REST APIs. When a redundant interface becomes active, the agent updates the route tables for all the configured prefixes to point to that interface. The solution is designed to be idempotent, so the peer member&#x27;s redundant interface will now be inactive. There is no update to the route table needed when becoming inactive.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>To prevent routing loops, the solution will not update the Alicloud Route Tables assigned to a subnet that has an activating node&#x27;s <em>network interface</em>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scenarios">Scenarios<a href="#scenarios" class="hash-link" aria-label="Direct link to Scenarios" title="Direct link to Scenarios">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="both-healthy">Both Healthy<a href="#both-healthy" class="hash-link" aria-label="Direct link to Both Healthy" title="Direct link to Both Healthy">​</a></h3>
<p>In the case where both members are healthy, the primary node is preferred and set to active. The secondary node is inactive. The redundant interface on the secondary node is set provisionally down and the API Agent steers traffic towards the primary node.</p>
<p><img decoding="async" loading="lazy" alt="both-healthy-scenario" src="/assets/images/cloud-ha-both-healthy-scenario-da33d383ca2729425f2f21b2fde4561a.png" width="771" height="369" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="primary-failure">Primary Failure<a href="#primary-failure" class="hash-link" aria-label="Direct link to Primary Failure" title="Direct link to Primary Failure">​</a></h3>
<p>When the <strong>primary node</strong> becomes unhealthy and the redundant interfaces are operationally down, the Monitoring Agent sends an unhealthy status to the local HA Agent. When the <strong>local node</strong> is deemed unhealthy, the local HA Agent sends an unhealthy message to the remote HA Agent, and notifies the internal state machine. When the <strong>primary node</strong> recognizes it is no longer fit to process traffic, it becomes inactive. The <strong>secondary node</strong> recognizes the primary node is not processing traffic, and the <strong>secondary node</strong> is healthy so the secondary node becomes active.</p>
<p><img decoding="async" loading="lazy" alt="primary-failure-scenario" src="/assets/images/cloud-ha-primary-failure-scenario-61a5bfef1e2d2b36299756e0d1eda755.png" width="771" height="369" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="primary-recovery">Primary Recovery<a href="#primary-recovery" class="hash-link" aria-label="Direct link to Primary Recovery" title="Direct link to Primary Recovery">​</a></h3>
<p>Now something causes the primary node to recover and the <code>redundant-interface</code> becomes healthy again. The healthy statuses will propagate to the primary and secondary HA Agents and they will update their internal state machines which will determine that they are back to the Both Healthy Scenario. The primary node will become active and the secondary node will become inactive.</p>
<p><img decoding="async" loading="lazy" alt="both-healthy-scenario" src="/assets/images/cloud-ha-both-healthy-scenario-da33d383ca2729425f2f21b2fde4561a.png" width="771" height="369" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="secondary-failure">Secondary Failure<a href="#secondary-failure" class="hash-link" aria-label="Direct link to Secondary Failure" title="Direct link to Secondary Failure">​</a></h3>
<p>Now let us consider after recovering, the secondary node becomes unhealthy. The primary node will recognize that it is still healthy so it will not do anything and continue to process traffic. The secondary node will also realize that it is unfit to process traffic so it will also not do anything and continue sit idle.</p>
<p><img decoding="async" loading="lazy" alt="secondary-failure-scenario" src="/assets/images/cloud-ha-secondary-failure-scenario-01c12db4240126767aa1e7e16297b507.png" width="691" height="369" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="secondary-recovery">Secondary Recovery<a href="#secondary-recovery" class="hash-link" aria-label="Direct link to Secondary Recovery" title="Direct link to Secondary Recovery">​</a></h3>
<p>If the problem with the secondary node resolves, then the HA Agents will update their internal state, but again since traffic is preferred to flow the same as before, both the primary and secondary will not perform any API calls to the API Agents.</p>
<p><img decoding="async" loading="lazy" alt="secondary-recovery-scenario" src="/assets/images/cloud-ha-secondary-recovery-scenario-2852dbcd653070aadcf15d69d5432652.png" width="691" height="369" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="primary-shutdown">Primary Shutdown<a href="#primary-shutdown" class="hash-link" aria-label="Direct link to Primary Shutdown" title="Direct link to Primary Shutdown">​</a></h3>
<p>This scenario is what will occur if the primary node were to be taken down for maintenance or failed completely. The primary node&#x27;s HA Agent (and Monitoring Agent and API Agent) will be shutdown when SSR is shutdown, so it will not perform any failover operations. The secondary node will wait for <code>peer-reachability-timeout</code> seconds of not hearing from the primary node to determine that the secondary node is unreachable. Once the primary node is determined unreachable, the secondary HA Agent will take over and become active since it does not know if the primary node is shutdown or unreachable.</p>
<p><img decoding="async" loading="lazy" alt="primary-shutdown-scenario" src="/assets/images/cloud-ha-primary-shutdown-scenario-044f8017a5b506aead38404306b3e0e8.png" width="809" height="446" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="secondary-shutdown">Secondary Shutdown<a href="#secondary-shutdown" class="hash-link" aria-label="Direct link to Secondary Shutdown" title="Direct link to Secondary Shutdown">​</a></h3>
<p>If the secondary node is shutdown while the primary is healthy, the primary HA Agent will deteremine the secondary node unreachable. Similar to the the Secondary Failure scenario, since the primary node is preferred, it will not do anything and continue to process traffic.</p>
<p><img decoding="async" loading="lazy" alt="secondary-shutdown-scenario" src="/assets/images/cloud-ha-secondary-shutdown-scenario-0e31057330e473ab41d153fdf72abacd.png" width="753" height="435" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="split-brain">Split Brain<a href="#split-brain" class="hash-link" aria-label="Direct link to Split Brain" title="Direct link to Split Brain">​</a></h3>
<p>This is slightly distinct from the Primary Shutdown or Secondary Shutdown because both nodes and HA Agents are up and running, but the peer link between the nodes is down. In this case, both HA Agents determine that the other HA Agent is unreachable. This is indistinguisable from the other node being shutdown, so both HA Agents will determine they are in the position to take control of traffic, so whichever node was not already active will become active. This means that both nodes will have their <code>redundant-interface</code>s provisionally up. For the <code>azure-vnet</code> solution, there will still only be one node that the route tables are pointing their routes towards due to the nature of the solution. For the <code>azure-lb</code> solution, both nodes will respond to the probes so traffic will be split according to the Azure Loadbalancer configuration. This situation can cause asymmetrical routing where if branch traffic comes in on the node that the solution is not pointed towards, then traffic will be sent into Azure through that node and come back in through the other node.</p>
<p>The split brain scenario can be identified if the peers can&#x27;t reach each other which will be captured with alarms:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># show alarms</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">========================= ===================== ========== ======== =========== =======================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ID                        Time                  Severity   Source   Category    Message</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">========================= ===================== ========== ======== =========== =======================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> router.node:11            2020-12-16 05:40:40   CRITICAL   router2    PEER      Peer router2 is not reachable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> router2.node2:10          2020-12-16 05:40:42   CRITICAL   router     PEER      Peer router is not reachable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Another indicator of a split brain scenario is having the <code>remote-status</code> be <code>unreachable</code> for the <a href="#state-fields">state output</a> for both members.</p>
<p><img decoding="async" loading="lazy" alt="split-brain-scenario" src="/assets/images/cloud-ha-split-brain-scenario-84ab365c12b5b6b7f17163bb9b9e4d3f.png" width="731" height="369" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="split-brain-resolution">Split Brain Resolution<a href="#split-brain-resolution" class="hash-link" aria-label="Direct link to Split Brain Resolution" title="Direct link to Split Brain Resolution">​</a></h3>
<p>Once the health statuses are able to flow between the two nodes, the unreachable status that each Cloud HA Agent has for the other node will resolve to healthy or unhealthy. Even if the determination of whether the node is the same as it was before, each HA Agent will still set the provisional statuses and make the appropriate HTTP call on API Agent. This is because each node does not know what calls the other node made while the split brain was occurring, so it is safer to make calls even if it may not be necessary. Consider the scenario where the primary node is active and the secondary node is inactive before a split brain. When the split brain occurs, the secondary will then become active. If this is with a solution like <code>azure-vnet</code>, the last node to hit the API Agent will be the one that the solution point to. Thus the secondary node will be the active node from the Azure Route Table&#x27;s perspective. Once the split brain is resolved, without the extra API calls, the primary would stay active without making any API calls and the secondary would become inactive. The problem with this is that the last node to trigger the API Agent was the secondary node so all branch bound traffic would be sent into interfaces that are provisionally down. The plugin solves this by reperforming API calls when it detects that the remote node goes from unreachable to not unreachable.</p>
<p><img decoding="async" loading="lazy" alt="both-healthy-scenario" src="/assets/images/cloud-ha-both-healthy-scenario-da33d383ca2729425f2f21b2fde4561a.png" width="771" height="369" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="groups">Groups<a href="#groups" class="hash-link" aria-label="Direct link to Groups" title="Direct link to Groups">​</a></h3>
<p>A group is a collection of nodes which all share the same settings such as the solution type. In the below configuration snippet, there is an example of each of the supported solution types with the solution-specific configuration explicitly configured with their defaults. <code>group1</code> has all of the solution-agnostic configuration settings explicitly configured with their defaults.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cloud-redundandy-group group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        enabled true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        solution-type azure-lb</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        additional-branch-prefix 1.1.1.1/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        additional-branch-prefix 2.2.2.2/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        up-holddown-timeout 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        peer-reachability-timeout 10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        remote-health-network 169.254.180.0/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        health-interval 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cloud-redundandy-group group2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name group2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        solution-type azure-vnet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        include-peer-vnets false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th>Element</th><th>Type</th><th>Properties</th><th>Description</th><th></th></tr></thead><tbody><tr><td>name</td><td>string</td><td>key</td><td>The name of the group to be referenced in other places.</td><td></td></tr><tr><td>enabled</td><td>boolean</td><td>default: true</td><td>Whether the group is enabled.</td><td></td></tr><tr><td>solution-type</td><td>enum</td><td>required</td><td>The solution to use on member nodes.  Value can be one of the values in #Supported Solutions.</td><td></td></tr><tr><td>additional-branch-prefix</td><td>list: ip-prefix</td><td></td><td>Additional ip prefixes that the member routers will control.</td><td></td></tr><tr><td>up-holddown-timeout</td><td>int</td><td>default: 2</td><td>The number of seconds to wait before declaring a member up.</td><td></td></tr><tr><td>peer-reachability-timeout</td><td>int</td><td>default: 10</td><td>The number of seconds to wait before declaring a peer unreachable. This field must be at least twice the value of <code>health-interval</code>.</td><td></td></tr><tr><td>health-interval</td><td>int</td><td>default: 2</td><td>The interval in seconds for health reports to be collected.</td><td></td></tr><tr><td>remote-health-network</td><td>ip-prefix</td><td>default: 169.254.180.0/24</td><td>The ip prefix to use for inter-member health status messages.</td><td></td></tr><tr><td>include-peer-vnets</td><td>boolean</td><td>if: solution-type = azure-vnet, default: false</td><td>Whether to include peer VNETs as part of the route table discovery algorithm.</td><td></td></tr><tr><td>probe-port</td><td>port</td><td>if: solution-type = azure-lb, default: 12801</td><td>The port that the Azure Loadbalancer will be sending the HTTP probes on.</td><td></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="membership">Membership<a href="#membership" class="hash-link" aria-label="Direct link to Membership" title="Direct link to Membership">​</a></h3>
<p>Membership is how a node declares that it is part of a group. The configuration for a membership exists under the node and is where the node-specific configuration exists.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cloud-redundancy-plugin-network 169.254.137.0/30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cloud-redundancy-membership group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        cloud-redundancy-group group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        priority 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        redundant-interface private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        redundant-interface private2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        additional-interface public1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        additional-interface public2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        log-level</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ha-agent info</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            api-agent info</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cloud-redundancy-membership group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        cloud-redundancy-group group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        priority 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        redundant-interface private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th>Element</th><th>Type</th><th>Properties</th><th>Description</th></tr></thead><tbody><tr><td>cloud-redundancy-plugin-network</td><td>ip-network</td><td>default: 169.254.137.0/30</td><td>The ip network to use for internal networking. This should only be configured when the default value conflicts with a different service in the configuration.</td></tr><tr><td>cloud-redundancy-group</td><td>reference</td><td>required</td><td>The group that this member belongs to.</td></tr><tr><td>priority</td><td>int</td><td>min-value: 1, max-value:2</td><td>The priority of the member where lower priority has higher preference.</td></tr><tr><td>redundant-interface</td><td>list: reference</td><td>min-number: 1</td><td>The <em>device interfaces</em> that will be redundant with the <code>redundant-interfaces</code> on the peer members.</td></tr><tr><td>additional-interface</td><td>list: reference</td><td></td><td>The <em>device interfaces</em> that will be considered for node health, but not considered for redundant operations.</td></tr><tr><td>log-level/ha-agent</td><td>log-level</td><td>default: info</td><td>The log level for the HA Agent.</td></tr><tr><td>log-level/api-agent</td><td>log-level</td><td>default: info</td><td>The log level for the active API Agent.</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Nodes can only be members of one group.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="address-prefixes">Address Prefixes<a href="#address-prefixes" class="hash-link" aria-label="Direct link to Address Prefixes" title="Direct link to Address Prefixes">​</a></h3>
<p>Certain prefixes can be configured to be controlled by the Cloud HA SSR by tagging services with groups. The services that are tagged with a certain group will have all of their <code>address</code> fields added to the list of configured prefixes.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address 3.3.3.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address 4.4.4.4/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cloud-redundancy-group group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cloud-redundancy-group azure-vnet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Any additional prefixes that should be included in the controlled prefix list can be configured as <code>additional-branch-prefix</code>s under the group.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="generated-ssr-configuration">Generated SSR Configuration<a href="#generated-ssr-configuration" class="hash-link" aria-label="Direct link to Generated SSR Configuration" title="Direct link to Generated SSR Configuration">​</a></h2>
<p>To see a full blown configuration and the configuration it generates, look at <code>Complete Example Configuration</code> in the <code>Appendix</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="validation">Validation<a href="#validation" class="hash-link" aria-label="Direct link to Validation" title="Direct link to Validation">​</a></h3>
<p>The following criteria need to be met in order for the cloud-ha plugin to take effect for a specific group:</p>
<ul>
<li>Priorities across all members in a group are unique.</li>
<li>IP Network fields such as <code>remote-health-network</code> and <code>cloud-redundancy-plugin-network</code> are validated to be an acceptable prefix size.</li>
<li>The <code>peer-reachability-timeout</code> for a group must be at least twice the amount of time as the <code>health-interval</code>.</li>
</ul>
<p>Please check <code>/var/log/128technology/plugins/cloud-ha-config-generation.log</code> on the Conductor for the errors causing the config to be invalid.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-assumptions">Configuration Assumptions<a href="#configuration-assumptions" class="hash-link" aria-label="Direct link to Configuration Assumptions" title="Direct link to Configuration Assumptions">​</a></h3>
<p>The components that are assumed to be setup already:</p>
<ul>
<li>There is at least one functioning forwarding <em>device interface</em> on each of the member nodes.</li>
<li>There is peering between member nodes if the member nodes are not under the same router.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-ha-loopback-interface">Cloud HA Loopback Interface<a href="#cloud-ha-loopback-interface" class="hash-link" aria-label="Direct link to Cloud HA Loopback Interface" title="Direct link to Cloud HA Loopback Interface">​</a></h3>
<p>An interface with the name <code>cloud-ha</code> is generated for each node that is a member of an enabled group. This interface is used for the solution to communicate with the other group members and any other outside entities such as a load balancer.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="health-status-transport">Health Status Transport<a href="#health-status-transport" class="hash-link" aria-label="Direct link to Health Status Transport" title="Direct link to Health Status Transport">​</a></h3>
<p>To facilitate the transport of the health status between members of the same group, the plugin generates services and service routes. Services are generated to classify the health summaries that each member sends to its peers. The address that they use is an address from the network defined in <code>remote-health-network</code> under the group config. If the two nodes are under different routers in the configuration, then peer service routes will be generated.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-load-balancer-config-generation">Azure Load Balancer Config Generation<a href="#azure-load-balancer-config-generation" class="hash-link" aria-label="Direct link to Azure Load Balancer Config Generation" title="Direct link to Azure Load Balancer Config Generation">​</a></h3>
<p>If the <code>solution-type</code> of a group is <code>azure-lb</code>, then the plugin will generate services and service routes to route the http probes down into the <code>cloud-ha</code> interface for the Azure Load Balancer API Agent to respond.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-generation">Configuration Generation<a href="#configuration-generation" class="hash-link" aria-label="Direct link to Configuration Generation" title="Direct link to Configuration Generation">​</a></h3>
<p>The <code>/var/log/128technology/persistentDataManager.log</code> file at trace level will hold whether the configuration generation was run as well as output and return code.
Configuration generation logs can be found on the conductor under <code>/var/log/128technology/plugins/cloud-ha-config-generation.log</code>.</p>
<p>Additional configuration validation is done without causing a traditional validation error. These validation rules will cause the configuration generation to fail for just that group. If the configuration generation is not generating what is expected, then check <code>/var/log/128technology/plugins/cloud-ha-config-generation.log</code> for validation errors similar to these:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">2020-10-09 19:54:21,190: ERROR - Validation errors occurred:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Group group1 does not have unique priorities across members: {&#x27;node2 router2&#x27;: &#x27;2&#x27;, &#x27;node1 router1&#x27;: &#x27;2&#x27;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="logging">Logging<a href="#logging" class="hash-link" aria-label="Direct link to Logging" title="Direct link to Logging">​</a></h3>
<p>The different services on the router all log to the files captured by the glob <code>/var/log/128technology/plugins/cloud-ha-*.log</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcli-enhancements">PCLI Enhancements<a href="#pcli-enhancements" class="hash-link" aria-label="Direct link to PCLI Enhancements" title="Direct link to PCLI Enhancements">​</a></h3>
<p>To check the state of the Cloud HA solution running on the router, the plugin adds output to the  <code>show device-interface</code> command for the <code>cloud-ha</code> interface. This state information is also accessible from the SSR&#x27;s public REST API with a <code>GET</code> on <code>/api/v1/router/&lt;router&gt;/node/&lt;node&gt;/cloud-ha/state</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="state-fields">State Fields<a href="#state-fields" class="hash-link" aria-label="Direct link to State Fields" title="Direct link to State Fields">​</a></h4>
<table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td>is-active</td><td>Whether the HA Agent considers itself active.</td></tr><tr><td>last-activity-change</td><td>The timestamp of the last time the node called the became active or became inactive API on the API Agent.</td></tr><tr><td>first-active-interface</td><td>The name of the first interface from the list of <code>redundant-interface</code>s that is healthy.</td></tr><tr><td>first-active-mac-address</td><td>The mac address of the first interface from the list of <code>redundant-interface</code>s that is healthy.</td></tr><tr><td>prefixes</td><td>The list of configured prefixes. See <code>Address Prefixes</code>.</td></tr><tr><td>local-status</td><td>The understood state of the local node.</td></tr><tr><td>remote-status</td><td>The understood state of the remote node.</td></tr></tbody></table>
<p>Example output for the <code>azure-vnet</code> solution:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># show device-interface name cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">======================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> node1.router1:cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">======================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Mode:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         92:39:db:ab:fa:e4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               1 Gb/s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Duplex:              full</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                     5653457</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:                 57794</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                    5648738</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:                57863</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                          0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Cloud HA:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     is-active:       True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     last-activity-change:Mon 2020-10-05 19:07:42 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     first-active-interface:private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     first-active-mac-address:00:0d:3a:4e:17:b7</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     prefixes:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     local-status:    healthy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     remote-status:   healthy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 1.67 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example output for the <code>azure-lb</code> solution:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># show device-interface name cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">======================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> node1.router1:cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">======================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Mode:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         92:39:db:ab:fa:e4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               1 Gb/s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Duplex:              full</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                     6126820</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:                 62630</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                    6120618</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:                62701</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                          0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Cloud HA:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     is-active:       True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     last-activity-change:Mon 2020-10-05 20:18:15 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     first-active-interface:private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     first-active-mac-address:00:0d:3a:4e:17:b7</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     prefixes:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     local-status:    healthy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     remote-status:   healthy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 1.72 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example output for the <code>alicloud-vpc</code> solution:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># show device-interface name cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2022-09-21 10:31:57 CST</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">✔ Retrieving device interface information...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">======================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> AlicloudSDWAN-HA-Router01:cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">======================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Mode:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         ca:4d:38:ac:9b:5c</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Provisional Status:  up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               1 Gb/s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Duplex:              full</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                  1059977756</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:              10915259</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                 1053204137</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:             10915347</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                          0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Cloud HA:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     is-active:       True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     last-activity-change:Fri 2022-09-09 10:31:15 CST</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     first-active-interface:LAN</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     first-active-mac-address:00:16:3e:10:a9:34</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     prefixes:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       10.0.0.0/8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       172.16.0.0/12</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     local-status:    healthy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     remote-status:   healthy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.04 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="systemd-services">Systemd Services<a href="#systemd-services" class="hash-link" aria-label="Direct link to Systemd Services" title="Direct link to Systemd Services">​</a></h3>
<ul>
<li><code>128T-telegraf@cloud_ha_health</code>: the instance of the monitoring agent that produces the health statuses</li>
<li><code>128T-cloud-ha</code>: the decision making Cloud HA Agent</li>
<li><code>128T-azure-lb</code> and <code>128T-azure-lb-nginx</code>: the <code>azure-lb</code> specific services</li>
<li><code>128T-azure-api</code>: the <code>azure-vnet</code> specific service</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="manual-failover">Manual Failover<a href="#manual-failover" class="hash-link" aria-label="Direct link to Manual Failover" title="Direct link to Manual Failover">​</a></h3>
<p>This should only be done in an emergency, but if the plugin is not behaving as expected, there is a script to manually set the activity status of the nodes. First you need to disable the HA Agents by running <code>/usr/bin/t128_cloud_ha_controller disable</code> on both nodes. This step disables the automatic API calls of the HA Agent to ensure that the following manual changes will not be overridden. Then you can run <code>/usr/bin/t128_cloud_ha_controller become-active</code> to become active and <code>/usr/bin/t128_cloud_ha_controller become-inactive</code> to become inactive. The commands should be done together at the most similar time as possible to minimize convergence time. It is better to perform the <code>become-active</code> first to allow traffic and then <code>become-inactive</code> second to disallow traffic. The HA Agents can be re-enabled with the command <code>/usr/bin/t128_cloud_ha_controller enable</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="alarms">Alarms<a href="#alarms" class="hash-link" aria-label="Direct link to Alarms" title="Direct link to Alarms">​</a></h3>
<p>If the Cloud HA Agent does not come up cleanly or fails for a prolonged period of time, the <code>cloud-ha</code> interface will become operationally down. An alarm will be created when this happens.</p>
<p>Example output when the agent did not come up cleanly:</p>
<div class="language-admin@combo-west.RTR_WEST_COMBO# language-admin@combo-west.rtr_west_combo# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-admin@combo-west.rtr_west_combo# codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Tue 2020-10-09 16:42:50 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============== ===================== ========== ============= =========== ======================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ID             Time                  Severity   Source        Category    Message</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============== ===================== ========== ============= =========== ======================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> combo-west:8   2020-06-30 16:32:42   critical   unavailable   interface   Intf cloud-ha (4) operationally down</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">There are 0 shelved alarms</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.10 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="router-version-incompatibility">Router Version Incompatibility<a href="#router-version-incompatibility" class="hash-link" aria-label="Direct link to Router Version Incompatibility" title="Direct link to Router Version Incompatibility">​</a></h3>
<p>As mentioned in the <code>Version Restrictions</code> section, the router component of the plugin will only install on SSR versions which support the provisional device interface state. This will be apparent to the user if the router component is not being setup and <code>show assets</code> indicates an error similar to:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Error:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Problem: conflicting requests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    - nothing provides 128T-device-interface-api(1.0) needed by 128T-cloud-ha-router-1.1.0-1.x86_64</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The router will need to be upgraded to a compatible version. Compatible versions can be listed with  <code>dnf list --whatprovides 128T-device-interface-api(1.0)</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="appendix">Appendix<a href="#appendix" class="hash-link" aria-label="Direct link to Appendix" title="Direct link to Appendix">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="health-status-transport-1">Health Status Transport<a href="#health-status-transport-1" class="hash-link" aria-label="Direct link to Health Status Transport" title="Direct link to Health Status Transport">​</a></h3>
<p>With the example configuration, we will generate the services below:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">service                 cloud-ha-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name                  cloud-ha-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    applies-to            router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        type         router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router-name  router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router-name  router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    security              internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address               169.254.180.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    access-policy         cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        source      cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        permission  allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    share-service-routes  false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service                 cloud-ha-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name                  cloud-ha-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    applies-to            router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        type         router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router-name  router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router-name  router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    security              internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address               169.254.180.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    access-policy         cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        source      cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        permission  allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    share-service-routes  false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Corresponding service routes to route them into the <code>cloud-ha</code> interface will be generated.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    service-route        cloud-ha-service-route-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name          cloud-ha-service-route-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service-name  cloud-ha-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        nat-target    169.254.137.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    service-route        cloud-ha-service-route-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name          cloud-ha-service-route-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service-name  cloud-ha-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        nat-target    169.254.137.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the two nodes are under different routers in the configuration, this would produce service routes:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    service-route        cloud-ha-peer-service-route-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name          cloud-ha-peer-service-route-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service-name  cloud-ha-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        peer          router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    service-route        cloud-ha-peer-service-route-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name          cloud-ha-peer-service-route-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service-name  cloud-ha-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        peer          router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-loadbalancer-configuration-generation">Azure Loadbalancer Configuration Generation<a href="#azure-loadbalancer-configuration-generation" class="hash-link" aria-label="Direct link to Azure Loadbalancer Configuration Generation" title="Direct link to Azure Loadbalancer Configuration Generation">​</a></h3>
<p>With the example configuration, this would result in the following services being generated:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">service                 cloud-ha-lb-probe-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name                  cloud-ha-lb-probe-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    applies-to            router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        type         router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router-name  router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    security              internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    transport             tcp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        protocol    tcp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        port-range  12801</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            start-port  12801</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address               1.1.1.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    access-policy         private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        source      private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        permission  allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    share-service-routes  false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service                 cloud-ha-lb-probe-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name                  cloud-ha-lb-probe-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    applies-to            router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        type         router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router-name  router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    security              internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    transport             tcp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        protocol    tcp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        port-range  12801</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            start-port  12801</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address               1.1.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    access-policy         private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        source      private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        permission  allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    share-service-routes  false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There would also be corresponding service routes generated:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    service-route        cloud-ha-lb-probe-service-route-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name          cloud-ha-lb-probe-service-route-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service-name  cloud-ha-lb-probe-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        nat-target    169.254.137.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    service-route        cloud-ha-lb-probe-service-route-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name          cloud-ha-lb-probe-service-route-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service-name  cloud-ha-lb-probe-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        nat-target    169.254.137.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="complete-example-configuration-1-for-azure-lb">Complete Example Configuration #1 for azure-lb<a href="#complete-example-configuration-1-for-azure-lb" class="hash-link" aria-label="Direct link to Complete Example Configuration #1 for azure-lb" title="Direct link to Complete Example Configuration #1 for azure-lb">​</a></h3>
<p>Below is an example of a complete, but minimal configuration entered by the user.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>This example configuration is good to understand all of the concepts but should not be used on a system as is.</p></div></div>
<p>This example uses <code>azure-lb</code> since it results in a superset of the configuration generated <code>azure-vnet</code>. If you are interested in <code>azure-vnet</code>, then ignore the probe-specific services and service routes in the generated config.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tenant private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        cloud-redundandy-group group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            solution-type azure-lb</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router               router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            node node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface          private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  privateintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name          privateintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        tenant        private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address       1.1.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     1.1.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            gateway        1.1.1.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface          intracloud</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               intracloud</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  intracloudintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name          intracloudintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        inter-router-security internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        neighborhood intracloud</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name intracloud</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            topology mesh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address       2.2.2.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     2.2.2.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            gateway        2.2.2.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                cloud-redundancy-membership group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    cloud-redundancy-group group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    priority 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    redundant-interface private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router               router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            node node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface          private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  privateintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name          privateintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        tenant        private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address       1.1.1.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     1.1.1.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            gateway        1.1.1.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface          intracloud</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               intracloud</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  intracloudintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name          intracloudintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        inter-router-security internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        neighborhood intracloud</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name intracloud</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            topology mesh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address       2.2.2.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     2.2.2.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            gateway        2.2.2.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                cloud-redundancy-membership group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    cloud-redundancy-group group1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    priority 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    redundant-interface private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Upon commit, the plugin will generate other configuration as shown below:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tenant                  cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name         cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            description  &quot;Auto-generated tenant for cloud ha&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            node node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface             cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    description        &quot;Auto-generated host KNI interface for cloud ha&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    type               host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  cloud-ha-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name        cloud-ha-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type        external</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        tenant      cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        source-nat  true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address     169.254.137.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     169.254.137.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            gateway        169.254.137.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route        cloud-ha-service-route-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name          cloud-ha-service-route-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  cloud-ha-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                nat-target    169.254.137.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route        cloud-ha-peer-service-route-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name          cloud-ha-peer-service-route-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  cloud-ha-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                peer          router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route        cloud-ha-lb-probe-service-route-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name          cloud-ha-lb-probe-service-route-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  cloud-ha-lb-probe-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                nat-target    169.254.137.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            node node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface             cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    description        &quot;Auto-generated host KNI interface for cloud ha&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    type               host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  cloud-ha-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name        cloud-ha-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type        external</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        tenant      cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        source-nat  true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address     169.254.137.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     169.254.137.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            gateway        169.254.137.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route        cloud-ha-service-route-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name          cloud-ha-service-route-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  cloud-ha-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                nat-target    169.254.137.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route        cloud-ha-peer-service-route-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name          cloud-ha-peer-service-route-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  cloud-ha-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                peer          router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route        cloud-ha-lb-probe-service-route-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name          cloud-ha-lb-probe-service-route-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  cloud-ha-lb-probe-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                nat-target    169.254.137.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service                 cloud-ha-lb-probe-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name                  cloud-ha-lb-probe-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            applies-to            router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                type         router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                router-name  router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            security              internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            transport             tcp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                protocol    tcp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                port-range  12801</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    start-port  12801</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address               1.1.1.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy         private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                source      private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                permission  allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            share-service-routes  false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service                 cloud-ha-lb-probe-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name                  cloud-ha-lb-probe-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            applies-to            router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                type         router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                router-name  router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            security              internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            transport             tcp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                protocol    tcp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                port-range  12801</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    start-port  12801</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address               1.1.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy         private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                source      private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                permission  allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            share-service-routes  false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service                 cloud-ha-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name                  cloud-ha-service-group1-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            applies-to            router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                type         router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                router-name  router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                router-name  router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            security              internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address               169.254.180.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy         cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                source      cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                permission  allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            share-service-routes  false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service                 cloud-ha-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name                  cloud-ha-service-group1-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            applies-to            router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                type         router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                router-name  router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                router-name  router2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            security              internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address               169.254.180.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy         cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                source      cloud-ha</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                permission  allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            share-service-routes  false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-of-example-configuration-2-for-alicloud-vpc-after-auto-generation">Part of Example Configuration #2 for alicloud-vpc after auto generation.<a href="#part-of-example-configuration-2-for-alicloud-vpc-after-auto-generation" class="hash-link" aria-label="Direct link to Part of Example Configuration #2 for alicloud-vpc after auto generation." title="Direct link to Part of Example Configuration #2 for alicloud-vpc after auto generation.">​</a></h3>
<p>Below is a sample running configuration for a node and a service.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The following configuration is an example only - It is not for use on a system.</p></div></div>
<p>node                                AlicloudSDWAN-HA-Router01
name              AlicloudSDWAN-HA-Router01
asset-id          iZwz96to20bbnnb</p>
<p>device-interface  WAN
name               WAN
pci-address        0000:00:04.0</p>
<p>network-interface  WAN
name                   WAN
global-id              17</p>
<p>neighborhood           ChinaUnicom
name                  ChinaUnicom
external-nat-address  119.23.200.200
vector                wan1</p>
<p>path-mtu-discovery
enabled  true
exit
exit
inter-router-security  internal
dhcp                   v4
exit
exit</p>
<p>device-interface  LAN
name               LAN
pci-address        0000:00:05.0
enabled            true</p>
<p>network-interface  LAN
name                   LAN
global-id              18</p>
<p>neighborhood           ALICLOUD
name  ALICLOUD
exit
inter-router-security  internal
dhcp                   v4
exit
exit</p>
<p>device-interface  farbic
name               farbic
pci-address        0000:00:06.0</p>
<p>network-interface  fabric
name                   fabric
global-id              19</p>
<p>neighborhood           intracloud
name                intracloud
topology            mesh</p>
<p>path-mtu-discovery
enabled  true
exit
exit
inter-router-security  internal
dhcp                   v4
exit
exit</p>
<p>device-interface  cloud-ha
name               cloud-ha
description        &quot;Auto generated device interface cloud-ha&quot;
type               host</p>
<p>network-interface  cloud-ha-intf
name        cloud-ha-intf
global-id   27
type        external
tenant      cloud-ha
source-nat  true</p>
<p>address     169.254.137.1
ip-address     169.254.137.1
prefix-length  30
gateway        169.254.137.2
exit
exit
exit
exit</p>
<p>service-route                       Alicloud-HA-test
name          Alicloud-HA-test
service-name  Alicloud-HA-test
vector        peer1</p>
<p>next-hop      AlicloudSDWAN-HA-Router01 LAN
node-name  AlicloudSDWAN-HA-Router01
interface  LAN
vector     peer1
exit
exit</p>
<p>service-route                       AliCloud-HA-test2
name          AliCloud-HA-test2
service-name  Alicloud-HA-test
vector        peer2
peer          AlicloudSDWAN-HA-Router02
exit</p>
<p>service-route                       cloud-ha-service-route-alicloud-1
name          cloud-ha-service-route-alicloud-1
service-name  cloud-ha-service-alicloud-1
nat-target    169.254.137.2
exit</p>
<p>service-route                       cloud-ha-peer-service-route-alicloud-2
name          cloud-ha-peer-service-route-alicloud-2
service-name  cloud-ha-service-alicloud-2
peer          AlicloudSDWAN-HA-Router02
exit
exit</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="release-notes">Release Notes<a href="#release-notes" class="hash-link" aria-label="Direct link to Release Notes" title="Direct link to Release Notes">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-400">Release 4.0.0<a href="#release-400" class="hash-link" aria-label="Direct link to Release 4.0.0" title="Direct link to Release 4.0.0">​</a></h3>
<p>Image based install and upgrade (IBU) support for SSR 6.3.0.</p>
<p><strong>Release Date:</strong> Sep 30, 2024</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-300">Release 3.0.0<a href="#release-300" class="hash-link" aria-label="Direct link to Release 3.0.0" title="Direct link to Release 3.0.0">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed">Issues Fixed<a href="#issues-fixed" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4>
<ul>
<li><strong>PLUGIN-768</strong> Support the Cloud HA plugin in SSR versions <code>5.1.0</code> and greater.</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/plugin_bgp_community_services"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">BGP Community Services</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/plugin_dns_app_id"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">DNS App Id</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#supported-solutions" class="table-of-contents__link toc-highlight">Supported Solutions</a></li><li><a href="#version-restrictions" class="table-of-contents__link toc-highlight">Version Restrictions</a></li><li><a href="#plugin-behavior" class="table-of-contents__link toc-highlight">Plugin Behavior</a><ul><li><a href="#monitoring-agent" class="table-of-contents__link toc-highlight">Monitoring Agent</a></li><li><a href="#ha-agent" class="table-of-contents__link toc-highlight">HA Agent</a></li><li><a href="#api-agents" class="table-of-contents__link toc-highlight">API Agents</a></li></ul></li><li><a href="#scenarios" class="table-of-contents__link toc-highlight">Scenarios</a><ul><li><a href="#both-healthy" class="table-of-contents__link toc-highlight">Both Healthy</a></li><li><a href="#primary-failure" class="table-of-contents__link toc-highlight">Primary Failure</a></li><li><a href="#primary-recovery" class="table-of-contents__link toc-highlight">Primary Recovery</a></li><li><a href="#secondary-failure" class="table-of-contents__link toc-highlight">Secondary Failure</a></li><li><a href="#secondary-recovery" class="table-of-contents__link toc-highlight">Secondary Recovery</a></li><li><a href="#primary-shutdown" class="table-of-contents__link toc-highlight">Primary Shutdown</a></li><li><a href="#secondary-shutdown" class="table-of-contents__link toc-highlight">Secondary Shutdown</a></li><li><a href="#split-brain" class="table-of-contents__link toc-highlight">Split Brain</a></li><li><a href="#split-brain-resolution" class="table-of-contents__link toc-highlight">Split Brain Resolution</a></li></ul></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#groups" class="table-of-contents__link toc-highlight">Groups</a></li><li><a href="#membership" class="table-of-contents__link toc-highlight">Membership</a></li><li><a href="#address-prefixes" class="table-of-contents__link toc-highlight">Address Prefixes</a></li></ul></li><li><a href="#generated-ssr-configuration" class="table-of-contents__link toc-highlight">Generated SSR Configuration</a><ul><li><a href="#validation" class="table-of-contents__link toc-highlight">Validation</a></li><li><a href="#configuration-assumptions" class="table-of-contents__link toc-highlight">Configuration Assumptions</a></li><li><a href="#cloud-ha-loopback-interface" class="table-of-contents__link toc-highlight">Cloud HA Loopback Interface</a></li><li><a href="#health-status-transport" class="table-of-contents__link toc-highlight">Health Status Transport</a></li><li><a href="#azure-load-balancer-config-generation" class="table-of-contents__link toc-highlight">Azure Load Balancer Config Generation</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#configuration-generation" class="table-of-contents__link toc-highlight">Configuration Generation</a></li><li><a href="#logging" class="table-of-contents__link toc-highlight">Logging</a></li><li><a href="#pcli-enhancements" class="table-of-contents__link toc-highlight">PCLI Enhancements</a></li><li><a href="#systemd-services" class="table-of-contents__link toc-highlight">Systemd Services</a></li><li><a href="#manual-failover" class="table-of-contents__link toc-highlight">Manual Failover</a></li><li><a href="#alarms" class="table-of-contents__link toc-highlight">Alarms</a></li><li><a href="#router-version-incompatibility" class="table-of-contents__link toc-highlight">Router Version Incompatibility</a></li></ul></li><li><a href="#appendix" class="table-of-contents__link toc-highlight">Appendix</a><ul><li><a href="#health-status-transport-1" class="table-of-contents__link toc-highlight">Health Status Transport</a></li><li><a href="#azure-loadbalancer-configuration-generation" class="table-of-contents__link toc-highlight">Azure Loadbalancer Configuration Generation</a></li><li><a href="#complete-example-configuration-1-for-azure-lb" class="table-of-contents__link toc-highlight">Complete Example Configuration #1 for azure-lb</a></li><li><a href="#part-of-example-configuration-2-for-alicloud-vpc-after-auto-generation" class="table-of-contents__link toc-highlight">Part of Example Configuration #2 for alicloud-vpc after auto generation.</a></li></ul></li><li><a href="#release-notes" class="table-of-contents__link toc-highlight">Release Notes</a><ul><li><a href="#release-400" class="table-of-contents__link toc-highlight">Release 4.0.0</a></li><li><a href="#release-300" class="table-of-contents__link toc-highlight">Release 3.0.0</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Juniper Networks, Inc.</div></div></div></footer></div>
</body>
</html>
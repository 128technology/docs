<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">High Availability - Theory of Operation | SSN Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/concepts_ha_theoryofoperation"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="High Availability - Theory of Operation | SSN Docs"><meta data-react-helmet="true" name="description" content="This document describes the most common set of deployment models for taking two instances of 128T routing software (referred to as “nodes”) and deploying those nodes together to provide high availability. The 128T routing software presents several deployment options for high availability, including:"><meta data-react-helmet="true" property="og:description" content="This document describes the most common set of deployment models for taking two instances of 128T routing software (referred to as “nodes”) and deploying those nodes together to provide high availability. The 128T routing software presents several deployment options for high availability, including:"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.128technology.com/docs/concepts_ha_theoryofoperation"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/concepts_ha_theoryofoperation" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/concepts_ha_theoryofoperation" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.21b25f22.css">
<link rel="preload" href="/assets/js/runtime~main.c265b5dd.js" as="script">
<link rel="preload" href="/assets/js/main.bf52851a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Session Smart</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Session Smart Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation_aws">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation_installer">Supporting Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/concepts_application_discovery">Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_application_discovery">Application Discovery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_appid">Application Identification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_EthOverSVR">Ethernet Over Secure Vector Routing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/concepts_ha_theoryofoperation">HA - Theory of Operation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_interface_types">Interface Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_kni">Kernel Network Interfaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_linux_host_networking">Linux Host Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_learning_VRF_routes">Learning VRF Routes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_network_planes">Forwarding Planes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_metadata">128T Metadata</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_metrics">Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_machine_communication">Machine Communication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_pcli">PCLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_session_timer">Session Timers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_STEP">Service and Topology Exchange Protocol (STEP)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_waypoint_ports">Waypoints</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts_glossary">Glossary</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/config_basics">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/plugin_intro">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/release_notes_128t_5.5">Release Notes</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>High Availability - Theory of Operation</h1></header><p>This document describes the most common set of deployment models for taking two instances of 128T routing software (referred to as “nodes”) and deploying those nodes together to provide high availability. The 128T routing software presents several deployment options for high availability, including:</p><ul><li><strong>Dual node high availability</strong>: where two nodes form one logical router, with shared state and a &quot;fabric&quot; backplane between them.</li><li><strong>Dual router high availability</strong>: where two nodes form two logical routers, with no shared state. This is a familiar approach to administrators accustomed to deploying pairs of legacy routing platforms.</li></ul><p>This document will describe the benefits and caveats of each of these models, as well as delving into other architectural decisions that should be considered when deploying highly available systems.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="intended-audience">Intended Audience<a class="hash-link" href="#intended-audience" title="Direct link to heading">​</a></h2><p>This document is intended for network architects, and is to be used as a guideline during the network design phase of deployment.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>High availability (or “HA”) is the practice of deploying additional network elements for traffic resiliency, to account for link or system downtime. In general, 128 Technology, Inc. encourages the deployment of highly available routers and conductors, as this will provide service continuity in the event of network failures, software faults, or hardware downtime (both scheduled and unscheduled).</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>There are other types of protection afforded 128T-powered networks, including path protection (via peer path selection) and link impairment protection (via session resiliency features, packet duplication, packet retransmitions, etc.), but these are not a consequence of supplying two nodes to mitigate the impact of failures.</p></div></div><p>This document will define the terms used to describe the 128T router’s implementation of high availability, describe the various configurable elements associated with high availability, and how they can be set and/or tuned in order to afford maximal protection against failures. It also presents various common topologies, to assist in selecting the best model for any given deployment.</p><p>In general, the configurations presented in this document will be presented in a “vanilla” fashion – without undue service configuration, tenant configuration, traffic policies, etc. – except where necessary to illustrate specific use cases relevant to high availability behavior.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="theory-of-operation">Theory of Operation<a class="hash-link" href="#theory-of-operation" title="Direct link to heading">​</a></h2><p>Deploying a highly available solution offers protection from failures or maintenance operations that could impact service. Generally speaking, the protections that high availability offers can be grouped in to several categories:</p><ul><li><strong>Software protection</strong>: the software components on a node can stop (due to upgrade, software fault, reboot, etc.) the companion components on a highly available counterpart can resume operation.</li><li><strong>Hardware protection</strong>: the platform on which the software runs can stop (due to replacement, hardware failure, power failure, etc.) while the companion highly available platform assumes control of all shared interfaces. Note that for the purposes of this document, Virtual Machines (VM) will be treated as hardware components unless specifically called out otherwise.</li><li><strong>Link protection</strong>: a single link can fail and not interrupt service, if there are shared forwarding interfaces and/or fabric interfaces (more on this later).</li></ul><p>The 128T offers all three types of protections listed above in each of its HA models. It does so by deploying two nodes that operate in concert (as either one logical router or as two logical routers) to provide service continuity in the event of failure. Each of the nodes contains a full set of software processes necessary for forwarding traffic, running routing protocols, communicating with its peers and management systems, etc. This allows a 128T to run independently in the event that its HA counterpart is unavailable.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="dual-node-high-availability">Dual Node High Availability<a class="hash-link" href="#dual-node-high-availability" title="Direct link to heading">​</a></h3><p>The <em>dual node high availability</em> design is a longstanding deployment model supported by the 128T. In this design two nodes share one common set of state; because the 128T is stateful (i.e., it retains some residual information about each active session for the lifetime of that session) it must share this information with its counterpart to protect active sessions in the event of any impairment. This model is exemplified by using a <em>redundancy link</em>, a dedicated connection between the two systems where session state is exchanged.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="redundancy-link">Redundancy Link<a class="hash-link" href="#redundancy-link" title="Direct link to heading">​</a></h4><p>Configured within the 128T software (and implemented as a <em>team interface</em> in Linux), this is typically implemented as a cross connect cable between two colocated systems. The &quot;cross connect cable&quot; is a logical concept and also includes connections between virtual machines. Also, the cross connect cable may be implemented between geographically diverse locations.</p><p>For more information about configuring redundant interfaces see <a href="/docs/config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a>.</p><p>The 128T configuration model only supports one redundancy link to be configured. However, it is possible to configure a second redundancy link manually. For instructions, refer to the guide <a href="/docs/config_adding_interfaces_to_ha_team">Adding Interfaces to HA Team Interface</a> for configuring additional redundancy links.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="about-state-synchronization">About State Synchronization<a class="hash-link" href="#about-state-synchronization" title="Direct link to heading">​</a></h4><p>This state sharing occurs via a high-performance database that is available to both nodes. As sessions are established through a 128T node, the receiving node consults this database to determine whether this session had previously been established via its counterpart. If it does not find any information, it processes this session as new, and it inserts state information into the shared database. In this way, session continuity is preserved irrespective of which node is active at the outset of an established session.</p><p>For 128T routers, session state synchronization for a session will occur only after a number of packets have been exchanged bi-directionally. This is to avoid the overhead of state synchronization for short-lived sessions (fewer than twelve packets), where a client reinitiating the session anew is as efficient as recovery.</p><p>128T conductors also leverage the redundancy link for state synchronization, to checkpoint the status of connected systems, configuration updates, and alarms.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="leader-election">Leader Election<a class="hash-link" href="#leader-election" title="Direct link to heading">​</a></h4><p>In addition to state synchronization, the 128T software also uses the redundancy link for <em>leader election</em> – the term used to describe the negotiation between the two systems for determining which is more fit for active duty. Because the 128T software is comprised of a number of discrete software processes (daemons), there are actually multiple &quot;leaders&quot; for each dual node HA system simultaneously. Below is the sample output of the command <code>show system processes node all</code> from a highly available system:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@BEACON00128A.BEACON00128# show sys proc node all</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Fri 2020-02-28 10:47:26 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============== ============================= ========= ========= =======</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Node           Process                       Status    Primary   Role</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============== ============================= ========= ========= =======</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   accessManager                 running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   analyticsReporter             running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   applicationFrameworkManager   running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   conflux                       running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   databaseQueryCoordinator      running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   dynamicPeerUpdateManager      running   N         combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   fastLane                      running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   highwayManager                running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   nodeMonitor                   running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   persistentDataManager         running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   redisServerManager            running   N         combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   routingManager                running   Y         combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   secureCommunicationManager    running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   securityKeyManager            running   N         combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   snmpTrapAgent                 running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   stateMonitor                  running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128A   systemServicesCoordinator     running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   accessManager                 running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   analyticsReporter             running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   applicationFrameworkManager   running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   conflux                       running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   databaseQueryCoordinator      running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   dynamicPeerUpdateManager      running   Y         combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   fastLane                      running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   highwayManager                running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   nodeMonitor                   running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   persistentDataManager         running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   redisServerManager            running   Y         combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   routingManager                running   N         combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   secureCommunicationManager    running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   securityKeyManager            running   Y         combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   snmpTrapAgent                 running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   stateMonitor                  running             combo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> BEACON00128B   systemServicesCoordinator     running             combo</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This is a list of the system processes that make up a 128T router. (There is a similar, but different set that exists on a 128T conductor.) The fourth column in the output shows whether a process is primary (has leadership) or not. As you can see in this output, it is not unusual for one node to be leader for some processes and not others; for example, <code>BEACON00128A</code> is the leader for <code>routingManager</code>, whereas <code>BEACON00128B</code> is the leader for <code>securityKeyManager</code>.</p><p>Each of the processes indicated with a <code>Y</code> or <code>N</code> undergo leader election and remain in constant communication with one another, whereas the processes that do not have any indicator will run on both systems autonomously. Failure events will oftentimes re-trigger a leader election process to ensure the fittest system is in control.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="dual-router-high-availability">Dual Router High Availability<a class="hash-link" href="#dual-router-high-availability" title="Direct link to heading">​</a></h3><p>The <em>dual router high availability</em> design is where two individual 128T software instances are coupled together to provide continuity in the event of a failure. While there is no state synchronized between the two devices (since there is no redundancy link), they are redundant to one another by upstream 128T devices detecting a failure and routing around it. Note that &quot;detecting a failure&quot; entails routing protocol convergence and/or SVR path failure determination.</p><p>The dual router high availability design has some distinct advantages over the dual node design:</p><ul><li>Fewer port requirements.</li><li>Fewer moving parts. Because there is no dependency on synchronizing a shared database, electing leaders between paired nodes, or sharing state, the implementation is more resilient.</li></ul><p>It does come with some tradeoffs, however:</p><ul><li>More rigid restrictions on the network topology (IGP/EGP).</li><li>Certain 128T features are not usable and/or must be disabled, notably source NAT and TCP state enforcement.</li><li>Shared interfaces cannot be used.</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="terminology">Terminology<a class="hash-link" href="#terminology" title="Direct link to heading">​</a></h2><p><strong>Dual Node High Availability</strong>: a deployment model where two instances (nodes) of 128T software are coupled as a single, logical router.</p><p><strong>Dual Router High Availability</strong>: a deployment model where two instances (nodes) of 128T software are coupled as distinct, single node routers.</p><p><strong>Fabric link</strong>: a connection between two nodes in a dual node high availability deployment. This link is used for forwarding traffic between the two nodes, analogous to a backplane &quot;fabric&quot; on a chassis-based router. This is also sometimes referred to as an <em>inter-node link</em> or a &quot;dogleg.&quot;</p><p><strong>Inter-router link</strong>: a connection between two routers in a dual router high availability deployment. This link is used for forwarding traffic between the two routers much in the same way as a fabric link does between nodes. Generally we run iBGP as an IGP over this inter-router link.</p><p><strong>Redundancy link</strong>: a connection between two nodes in a dual node high availability deployment, used exclusively for synchronizing state between them. (No traffic is forwarded on this link.)</p><p><strong>Redundancy group</strong>: a configuration construct for combining interfaces into a collection that <em>shares fate</em>, such that if one interface goes down, the other interface(s) in the group are administratively failed over along with it. This is useful in deployments where two nodes are configured as mirror images of one another in an &quot;active/standby&quot; configuration.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="modeling">Modeling<a class="hash-link" href="#modeling" title="Direct link to heading">​</a></h2><p>In general terms, high availability is an expense incurred to guard against failure scenarios; typically, high availability models are <em>not</em> intended to protect against all possible failure scenarios, but the most common ones (e.g., software failure, hardware failure, circuit failure). It is impractical, and in some cases impossible, to guard against multiple concurrent failures. Thus, a tolerance profile should be constructed to include the failure scenarios that are most common, most impactful, or both.</p><p>When deploying a high availability 128T router, there are several options available depending on (Ethernet) port availability, and the tolerance profile. The two main considerations when designing a high availability 128T router are interface failure protections and platform protections (inclusive of hardware and software).</p><p>Interface protections allow for service continuity when an interface fails, or is otherwise disabled. Each interface that is to be protected has presence on both nodes in an HA couplet, which will have ramifications on the hardware platform that is selected. In a simple example, two nodes each have a single LAN and WAN interface, and these are protected. Adding a second WAN provider will incur an additional Ethernet interface on one node, but protecting it requires an additional Ethernet interface on its counterpart. Alternatively, you could deploy two independent WAN connections on each node (e.g., ISP 1 and ISP 2 on one node, ISP 3 and ISP 4 on the other node) and consume the same number of ports, but without any specific protection around any interface or ISP failure.</p><p>While the 128T platform affords you many flexibilities in your modeling, let&#x27;s start with some simple assumptions and build upon them.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="activestandby-model">Active/Standby Model<a class="hash-link" href="#activestandby-model" title="Direct link to heading">​</a></h3><p>The simplest model is the active/standby model, where both nodes are configured as mirror images of one another. The LAN and WAN interfaces are protected, and there is a redundancy link between the two nodes to synchronize state. In this model, you will need to configure a set of <code>redundancy-group</code> configurations, one for each node.</p><p>This configuration protects against a LAN interface failure, a WAN interface failure, and a platform failure.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="activestandby-model-with-fabric-interface">Active/Standby Model with Fabric Interface<a class="hash-link" href="#activestandby-model-with-fabric-interface" title="Direct link to heading">​</a></h3><p>This model builds upon the previous by adding a fabric interface. The fabric interface between the nodes gives them a path to reach the active LAN or WAN interface, should packets arrive that need forwarding but the local LAN/WAN interface is unusable.</p><p>In the Active/Standby Model with Fabric Interface, the <code>redundancy-group</code> configuration is no longer mandatory; it can be used to govern administrative preference over which node in a pair is active when all interfaces are usable across the router. A <code>redundancy-group</code> can also be used to put both LAN and WAN traffic on a single node when there is only one interface impaired, but this is strictly administrative preference.</p><p>This model is advantaged over the standard active/standby model, in that it protects against the failure mode where dissimilar links are down on each system (e.g., the LAN interface on node 1 is down and the WAN interface on node 2 is down). This comes at the cost of one additional Ethernet port on each node, to account for the fabric link.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="activeactive-model">Active/Active Model<a class="hash-link" href="#activeactive-model" title="Direct link to heading">​</a></h3><p>The Active/Active model is one where each node in the router has (at least) one unique interface per node that is not represented on its counterpart. Generally speaking, this model has a protected LAN interface and dissimilar WAN interfaces (e.g., node 1 uses ISP 1, node 2 uses ISP 2). Just as with the Active/Standby model, you can elect to add a fabric interface – and in fact it is quite common to do so. (Without a fabric interface, only one ISP can be used at a time and it is arguably equivalent to an Active/Standby model.) With a fabric interface in place, the router will use the appropriate egress ISP based on the policies provisioned in the 128T, assuming all ISPs are active, which may mean that traffic arrives on one node and egresses via a separate node.</p><p>This model is advantaged over Active/Standby in that you get the benefit of &quot;SD-WAN,&quot; able to leverage the best ISP path for a given type of traffic at any point in time. Yet if any platform failure occurs, each node has the ability to continue processing traffic to the array of ISPs available to it.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="activeactive-with-no-shared-interfaces">Active/Active with no Shared Interfaces<a class="hash-link" href="#activeactive-with-no-shared-interfaces" title="Direct link to heading">​</a></h4><p>There are certain features which may be unavailable when not using shared interfaces, including:</p><ul><li><em>source-nat</em> – when there&#x27;s no shared interface, there&#x27;s no way to synchronize dynamically allocated source ports.</li><li><em>transport-state-enforcement</em> – this feature will not work without synchronizing data between systems.</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="hybrid-models">Hybrid Models<a class="hash-link" href="#hybrid-models" title="Direct link to heading">​</a></h3><p>Hybrid models include multiple LAN interfaces and multiple WAN interfaces, some or all of which may be protected. (These deployments may include <code>redundancy-group</code> configurations, to ensure the coupled interfaces are always co-active on the same node.) Hybrid models should include a fabric interface between the nodes.</p><p>This model is used when there are multiple LAN interfaces, and one or more need protection. It requires the maximum number of Ethernet interfaces, and is the most complex configuration model.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-04-27T15:51:46.000Z">4/27/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/concepts_EthOverSVR"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Ethernet Over Secure Vector Routing</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/concepts_interface_types"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Interface Types</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#intended-audience" class="table-of-contents__link toc-highlight">Intended Audience</a></li><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#theory-of-operation" class="table-of-contents__link toc-highlight">Theory of Operation</a><ul><li><a href="#dual-node-high-availability" class="table-of-contents__link toc-highlight">Dual Node High Availability</a></li><li><a href="#dual-router-high-availability" class="table-of-contents__link toc-highlight">Dual Router High Availability</a></li></ul></li><li><a href="#terminology" class="table-of-contents__link toc-highlight">Terminology</a></li><li><a href="#modeling" class="table-of-contents__link toc-highlight">Modeling</a><ul><li><a href="#activestandby-model" class="table-of-contents__link toc-highlight">Active/Standby Model</a></li><li><a href="#activestandby-model-with-fabric-interface" class="table-of-contents__link toc-highlight">Active/Standby Model with Fabric Interface</a></li><li><a href="#activeactive-model" class="table-of-contents__link toc-highlight">Active/Active Model</a></li><li><a href="#hybrid-models" class="table-of-contents__link toc-highlight">Hybrid Models</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c265b5dd.js"></script>
<script src="/assets/js/main.bf52851a.js"></script>
</body>
</html>
<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-167298415-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="128T Docs" href="/opensearch.xml"><title data-react-helmet="true">Network Address Translation (NAT) | 128T Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Network Address Translation (NAT) | 128T Docs"><meta data-react-helmet="true" name="description" content="Source NAT"><meta data-react-helmet="true" property="og:description" content="Source NAT"><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/config_nat"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://docs.128technology.com/docs/config_nat"><link rel="stylesheet" href="/styles.9a832058.css">
<link rel="preload" href="/styles.c3d814b8.js" as="script">
<link rel="preload" href="/runtime~main.e3d5150e.js" as="script">
<link rel="preload" href="/main.c993cd9a.js" as="script">
<link rel="preload" href="/1.e48c6587.js" as="script">
<link rel="preload" href="/2.0b9f4486.js" as="script">
<link rel="preload" href="/124.866c24a0.js" as="script">
<link rel="preload" href="/127.c5fb5cb6.js" as="script">
<link rel="preload" href="/20ac7829.d2166c4c.js" as="script">
<link rel="preload" href="/17896441.20f74e96.js" as="script">
<link rel="preload" href="/24fe8a40.bb17aa58.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title">Technology</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.128technology.com/home" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Interchange</a><a href="https://www.128technology.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">⌘</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title">Technology</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Docs</a></li><li class="menu__list-item"><a href="https://community.128technology.com/home" target="_blank" rel="noopener noreferrer" class="menu__link">Interchange</a></li><li class="menu__list-item"><a href="https://www.128technology.com/" target="_blank" rel="noopener noreferrer" class="menu__link">Company</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_128t">128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_releases">128T Releases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_support_policy">Software Support Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_supported_platforms">Platform Support Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_security_policy">Security Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_svr_savings">SVR Savings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/CONTRIBUTING">Contributing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_getting_started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_downloading_iso">Downloading ISOs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_installer">Installing 128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_bootable_media">Installing From ISO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_aws">Installing in AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_otp_iso">Installing From OTP ISO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_quickstart_aws">QuickStart installation in AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_azure">Installing in Azure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_ztp">QuickStart</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_creating_bootable_usb">Creating Bootable USB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_upgrading">Upgrading</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_rollback">Rollback</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_application_discovery">Application Discovery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_appid">Application Identification</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_ha_theoryofoperation">HA - Theory of Operation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_interface_types">Interface Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_kni">Kernel Network Interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_linux_host_networking">Linux Host Networking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_network_planes">Forwarding Planes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_metadata">128T Metadata</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_metrics">Metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_machine_communication">Machine Communication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_pcli">PCLI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_session_timer">Session Timers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_glossary">Glossary</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Administration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_asset_connection_resiliency">Asset Connection Resiliency</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_basics">Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_bgp">BGP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_reference_guide">Element Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_audit_log">Audit Log</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dhcp">DHCP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dns_proxy">DNS Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dual_router_ha">High Availability (Dual Router)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ldap">LDAP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ha">High Availability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_management_over_forwarding">Management over Forwarding</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_adding_interfaces_to_ha_team">Adding Interfaces to HA Team Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_transition_standalone_to_ha">Transitioning a Conductor from Standalone to HA</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/config_nat">NAT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ospf">OSPF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_rate_limiting">Rate Limiting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_snmp">SNMP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_snmp_metrics">SNMP: User defined metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_static_hostname_mapping">Static Hostname Mappings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_tenants">Tenants</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_templates">Configuration Templates</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">How To</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_conductor_migration">Conductor Migration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_extend_gui_nav">Extending GUI Nav</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_lte">LTE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_maintenance_mode">Maintenance Mode</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_ms365">Microsoft 365</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_trusted_ca_certificate">Adding a Trusted Certificate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_tune_bfd">Tuning BFD</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_applications">Application Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_ap_salt_minion">AP: Salt Minion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_cpu_spikes">CPU Spikes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_connecting_to_routers">Connecting to Routers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_forwarding_resource_pools">Forwarding Plane Resource Pools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_logs">Logs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_mac_uniqueness">MAC Address Uniqueness</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_packet_capture">PCLI Packet Capture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_t1_troubleshooting">T1 Troubleshooting</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Events</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_overview">Alarm and Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_alarms">Alarms</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_events">Events</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Best Practices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_att_avpn_configuration">AT&amp;T AVPN Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_conductor_deployment">Conductor Deployment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_qos_msft_expressroute">ExpressRoute QoS Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_lte_peering">LTE Peering</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_monitoring_headends">Monitoring Head End Routers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_salt_pillars">Saltstack at Scale With 128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_sdwan_design_guide">SD-WAN Design Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_service_and_service_policy_design">Service and Service Policy Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_service-policy_defaults">Service Policy Baseline Defaults</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_tenants">Tenancy Design</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CLI Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli_reference">Command Line Reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_dns_app_id">DNS App Id</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_dns_cache">DNS Cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_gre">GRE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_icmp_reachability_detection">ICMP Reachability Detection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_ipsec_client">IPsec Client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_loopback_static_routes">Loopback Static Routes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_m800_watchdog">M800 Watchdog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_monitoring_agent">Monitoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_mosh">Mosh</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_sip_alg">SIP ALG</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_wireguard">Wireguard</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">REST APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api_rest_4.2.0">128T-4.2.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Release Notes</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.5">4.5</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.4">4.4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.3">4.3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.2">4.2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.1">4.1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.0">4.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T Installer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.6">2.6</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.5">2.5</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.4">2.4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.3">2.3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.2">2.2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.1">2.1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T SIP ALG</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_sip_alg_2.1">2.1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T ZScaler</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_zscaler_1.1">1.1</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Network Address Translation (NAT)</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="source-nat"></a>Source NAT<a aria-hidden="true" tabindex="-1" class="hash-link" href="#source-nat" title="Direct link to heading">#</a></h2><p>Source NAT can be enabled on <code>authority &gt; router &gt; node &gt; network-interface</code>. When enabling <code>source-nat</code> on a network-interface, all traffic egressing the interface will be network address and port translated (NAPT) to that of the address on the interface.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The port range is not configurable and ranges between 16384 to 65534, allowing for 49,150 concurrent sessions per interface.</p></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@gouda.novigrad# show config running authority router novigrad node gouda device-interface wan network-interface wan-interface </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router  novigrad</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name  novigrad</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            node  gouda</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name              gouda</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface  wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               wan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  wan-interface</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        name                    wan-interface</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        global-id               1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        vlan                    0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        type                    external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        conductor               false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        neighborhood            internet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            name  internet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        inter-router-security   interfabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        prioritization-mode     local</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        source-nat              true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        mtu                     1500</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        enforced-mss            disabled</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        icmp                    allow</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        hostname                gouda.novigrad.net</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        multicast-listeners     automatic</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        multicast-report-proxy  false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        dhcp                    v4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div></div></div><p>If support for more than 49,150 concurrent sessions per interface is needed, you can configure a <em>NAT Pool</em> or add additional <code>address</code>es to the network-interface, expanding the source NAT capacity.</p><p>When multiple addresses are configured, utilizing <code>source-nat</code>, the second address configured will only be utilized once the first is fully exhausted; so on and so forth.  Once the next configured address starts being utilized, it will remain in use until exhausted.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="destination-nat"></a>Destination NAT<a aria-hidden="true" tabindex="-1" class="hash-link" href="#destination-nat" title="Direct link to heading">#</a></h2><p>Static desination network address translation can be performed by configuring a <code>service-route &gt; nat-target</code>. It is common to leverage the public address of the router for internal services, such as VPN. Traffic destined to the 128T, configured as a <em>service</em> with an <em>address</em> that matches that of the public-facing network-interface is then NATed to an internal private address on the LAN for the application. This setting only performs address translation and does not modify the port.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="nat-pools"></a>NAT Pools<a aria-hidden="true" tabindex="-1" class="hash-link" href="#nat-pools" title="Direct link to heading">#</a></h2><p>NAT pools are a construct that allow for the use of IP and port ranges to be shared across one or more network-interfaces for either source or destination NATing capabilies.</p><p>The 128T has the following NATing capabilities:</p><ol><li><p>Static Source NAT bindings</p><p>This setting only performs address translation, leaving ports unchanged.</p></li><li><p>Dynamic Source NAT bindings</p><p>A dynamic source NAT binding NATs the original source IP to the configured IP address. Additionally, it requires the original source port to be translated. There are several use cases for needing a dynamic source nat. Some examples are:</p></li></ol><ul><li>Supporting more than 49,150 source NAT sessions</li><li>Translating LAN traffic to a single IP on the WAN interface, different from the network-interface address</li></ul><ol start="3"><li><p>Static Destination NAT bindings</p><p>Destination NAT changes the destination address of packets passing through the router. It also offers the option to perform the port translation in transport headers. Destination NAT is mainly used to redirect incoming packets with an external address or port destination to an internal IP address or port inside the network.</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="static-nat-bindings"></a>Static NAT bindings<a aria-hidden="true" tabindex="-1" class="hash-link" href="#static-nat-bindings" title="Direct link to heading">#</a></h3><p>A static NAT binding can be configured by creating a <code>authority &gt; router &gt; nat-pool</code> object and assigning it to a network-interface.  Be sure to set the pool-type to <code>static</code>. The following rules and constraints will apply to this configuration:</p><ul><li>The <em>nat-pool</em> prefix is used to create a N:M mapping. Where each source IP (from ingress interface) is hashed to an IP address in the nat pool.</li><li>The static <em>nat-pool</em> can only be configured as:<ul><li><em>ingress-nat-pool</em> on a <em>network-interface</em> when peering with another 128T router</li><li>egress-nat-pool on a <em>network-interface</em> when not performing SVR</li><li><em>destination-nat-pool</em> on a <em>service-route / next-hop</em></li></ul></li><li>128T software will not reply to ARP requests on the pool prefix on the associated interface.  Therefore the 128T relies on the pool to be routed to the 128T gateway interface by another mechanism (e.g. static-routes, BGP, etc.) by the <em>next-hop</em> in the network.</li><li>Changes to the pool configuration will not affect the existing sessions as it has the potential of cascading effect on the network. These changes will resolve over time as the existing sessions naturally expire.</li></ul><p>The static NAT pool will simply hash the source IP address of incoming packets to the corresponding IP address in the pool.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">nat-pool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name static-pool-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type static</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address-pool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address 10.10.10.10/31</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">network-interface</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name    test-lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ip-address 192.168.10.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        prefix-length 24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ingress-source-nat-pool static-pool-1</span></div></div></div></div></div><p>In the configuration snippet above, the <em>192.168.10.0/24</em> network for the <code>test-lan</code> will be source NAT’d to <code>10.10.10.10/31</code>. Traffic from an endpoint of source address 192.168.10.10 will be source NAT’d to 10.10.10.10; 192.168.10.11 will be source NAT’d to 10.10.10.11 and so on. Since the NAT in the model relies on a N:M mapping this can only be configured as an <em>ingress-source-nat-pool</em> (on <em>network-interface</em>) or as a destination-nat-pool (on <em>service-route / next-hop</em>).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="dynamic-nat-bindings"></a>Dynamic NAT bindings<a aria-hidden="true" tabindex="-1" class="hash-link" href="#dynamic-nat-bindings" title="Direct link to heading">#</a></h3><p>A dynamic NAT binding can be configured by setting a pool-type as <code>dynamic</code>. When configuring a dynamic NAT pool, a range of NAT ports must also be specified in addition to IP address(es). Some of the rules &amp; constraints around this configuration are:</p><ul><li>Non-overlapping IP and port ranges must be configured for different NAT pools</li><li>A dynamic nat-pool can only be referenced as <em>network-interface / egress-source-nat-pool</em> or as a <em>service-route / next-hop / source-nat-pool</em></li><li>Each NAT allocation is on a per session basis and both IP and port can change for different sessions from the same user endpoint</li><li>128T software will not reply to ARP on the pool prefix on this interface; thus relies on the pool to be routed to the 128T gateway interface through other mechanism (static-routes, BGP, etc.) by the <em>next-hop</em> in the network.</li><li>Changes to the pool configuration will not affect the existing sessions as it has potential of cascading effect on the network. These changes will resolve over time as the existing sessions naturally expire.</li></ul><p>A dynamic NAT pool works very much the same way as source NAT pools. Each IP address and port range provides the ability to source NAT the IP tuple of the incoming flow to a unique non-overlapping IP tuple towards the egress network.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">nat-pool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name dynamic-pool-1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type dynamic</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address-pool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        address 10.10.10.0/24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        port-range</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            start-port 10000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            end-port 11000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">network-interface</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name    test-lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ip-address 192.168.10.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        prefix-length 24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    egress-source-nat-pool dynamic-pool-1</span></div></div></div></div></div><p>In the above example, the configured NAT pool can accommodate 254,000 combinations of IP and ports for source NAT as opposed to the default of 50,000. Each IP address in the 10.10.10.0/24 will accomodate 1000 ports performing source NAT. For example, traffic originating from an endpoint with IP address 192.168.100.100 and source port 16000 will be source NAT’d to IP address 10.10.10.1 with port 10000, etc. In the case where multiple IP and port range combinations are available, the 128T router will exhaust the first range before consuming the next. In the above example, the dynamic source NAT allocation will begin from 10.10.10.1 port 10000 and will consume all 1000 ports for incoming sessions until 10.10.10.1 port 11000. Once these ports are exhausted, we will use the next IP and ports in the range such as 10.10.10.2:10000 to 10.10.10.2:11000, and so on.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="shared-nat-pools"></a>Shared NAT pools<a aria-hidden="true" tabindex="-1" class="hash-link" href="#shared-nat-pools" title="Direct link to heading">#</a></h3><p>In some scenarios, it is desirable to share the same NAT pool across services and interfaces. This feature accommodates the same NAT pool to be configured on different interfaces. For static NAT pools, no additional configuration considerations need to be made. However, for dynamic NAT pools, when the pool is shared across multiple <em>device-interfaces</em> and <em>network-interfaces</em>, there are some considerations that should be noted for failure and recovery. </p><u>Flow Move Considerations</u><p>Currently session migration is only supported for SVR sessions. This restriction exists because session migration of a non-SVR session is not guaranteed to terminate on the same server. As a result, the remote server might receive mid flow packets from a different source, resulting in undefined behavior.</p><u>Session Recovery Considerations</u><p>Shared NAT pools provisioned on a HA interface that encur a failover, the 128T software puts the interface in recovery mode to recover all sessions. At the end of the recovery period, all non-discovered ports as designed as free and are returned to the NAT pool.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="tenant-filtering"></a>Tenant filtering<a aria-hidden="true" tabindex="-1" class="hash-link" href="#tenant-filtering" title="Direct link to heading">#</a></h3><p>The <em>nat-pool</em> configuration can optionally be provisioned with a list of tenants. When the configuration has <em>multiple</em> IP pools available, the <em>tenant</em> can be used to determine which IP pool will be selected for the source NAT. Absence of a tenant implies that the IP pool is valid for all traffic. The following rules will be applied in order to determine the selection of the NAT pool:</p><ul><li>The packet has a source tenant associated with it<ul><li>If more than one IP pool has matching tenant<ul><li>Static nat-pool: Only the first IP pool is used and hash is applied to create a session. The remainder of the matches are discarded</li><li>Dynamic nat-pool: Picks the first IP pool with available capacity.</li></ul></li><li>If a pool with no tenant is configured<ul><li>Static nat-pool: Same as above</li><li>Dynamic nat-pool: Same as above</li></ul></li><li>All IP pools have tenant configured but none of them match the source tenant<ul><li>Log the failure, increment stat and drop the packet</li></ul></li></ul></li><li>The packet has no source tenant associated with it<ul><li>At least one IP pool has no tenant configured to do the source NAT; otherwise this will result in the session being dropped.</li></ul></li></ul><p>The tenant matching rules will apply to sub-tenants as well. For example, if an IP pool allows tenant engineering; traffic with source tenant lab.engineering will also match the pool.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-05-12T21:07:05.000Z" class="docLastUpdatedAt_217_">5/12/2020</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/config_transition_standalone_to_ha"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Transitioning a Conductor from Standalone to HA</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/config_ospf"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Open Shortest Path First (OSPF) »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#source-nat" class="table-of-contents__link">Source NAT</a></li><li><a href="#destination-nat" class="table-of-contents__link">Destination NAT</a></li><li><a href="#nat-pools" class="table-of-contents__link">NAT Pools</a><ul><li><a href="#static-nat-bindings" class="table-of-contents__link">Static NAT bindings</a></li><li><a href="#dynamic-nat-bindings" class="table-of-contents__link">Dynamic NAT bindings</a></li><li><a href="#shared-nat-pools" class="table-of-contents__link">Shared NAT pools</a></li><li><a href="#tenant-filtering" class="table-of-contents__link">Tenant filtering</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>Copyright © 2020 128 Technology, Inc.</div></div></div></footer></div>
<script src="/styles.c3d814b8.js"></script>
<script src="/runtime~main.e3d5150e.js"></script>
<script src="/main.c993cd9a.js"></script>
<script src="/1.e48c6587.js"></script>
<script src="/2.0b9f4486.js"></script>
<script src="/124.866c24a0.js"></script>
<script src="/127.c5fb5cb6.js"></script>
<script src="/20ac7829.d2166c4c.js"></script>
<script src="/17896441.20f74e96.js"></script>
<script src="/24fe8a40.bb17aa58.js"></script>
</body>
</html>
<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">GRE Plugin | 128T Docs</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="128T Docs"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="The 128T GRE plugin can be used for creating IPv4 GRE tunnel between 128T router and a remote GRE tunnel destination. For some applications such as Zscaler etc this provides a better throughput compared to other tunneling mechanism."><meta data-react-helmet="true" property="og:description" content="The 128T GRE plugin can be used for creating IPv4 GRE tunnel between 128T router and a remote GRE tunnel destination. For some applications such as Zscaler etc this provides a better throughput compared to other tunneling mechanism."><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/gre_plugin">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.71d4e6da.css">


<link rel="preload" href="/styles.104e1ffe.js" as="script">

<link rel="preload" href="/runtime~main.f892d825.js" as="script">

<link rel="preload" href="/main.cac71f1e.js" as="script">

<link rel="preload" href="/1.4ffabab0.js" as="script">

<link rel="preload" href="/2.47c801dd.js" as="script">

<link rel="preload" href="/54.b3ed53b4.js" as="script">

<link rel="preload" href="/20ac7829.623ca1fb.js" as="script">

<link rel="preload" href="/17896441.bfeb97f5.js" as="script">

<link rel="preload" href="/1dd681e0.806db5dd.js" as="script">

</head>
<body>

<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title"></strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://community.128technology.com/home">Interchange</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://www.128technology.com/">Company</a><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Docs</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://community.128technology.com/home">Interchange</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://www.128technology.com/">Company</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/img/128t_black.png" alt="128 Technology Logo"><strong></strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Release Notes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/release_notes_4.2.0">4.2.0 Release Notes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/release_notes_4.2.1">4.2.1 Release Notes</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/CONTRIBUTING">Contributing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_downloading">Downloading</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Getting Started</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_glossary">Glossary</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_application_discovery">Application Discovery</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_ha_theoryofoperation">HA - Theory of Operation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_interface_types">Interface Types</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_linux_host_networking">Linux Host Networking</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_network_planes">Forwarding Planes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_management_connections">M2M Communication</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_session_timer">Session Timers</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Administration</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/config_basics">Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_audit_log">Audit Log</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_dns_proxy">DNS Proxy</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_ldap">LDAP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_ha">High Availability</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_adding_interfaces_to_ha_team">Adding Interfaces to HA Team Interface</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_transition_standalone_to_ha">Transitioning a Conductor from Standalone to HA</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_nat">NAT</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_snmp">SNMP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_snmp_metrics">SNMP: User defined metrics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_tenants">Tenants</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/ts_applications">Application Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_ap_salt_minion">AP: Salt Minion</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_cpu_spikes">CPU Spikes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_connecting_to_routers">Connecting to Routers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_forwarding_resource_pools">Forwarding Plane Resource Pools</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_mac_uniqueness">MAC Address Uniqueness</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Events</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/events">Alarms and Events</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Best Practics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_conductor_deployment">Conductor Deployment</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_lte_peering">LTE Peering</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_service_and_service_policy_design">Service and Service Policy Design</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_tenants">Tenancy Design</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_trusted_ca_certificate">Adding a Trusted Certificate</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CLI Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/cli_reference">Reference</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/monitoring_agent">Monitoring</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/gre_plugin">GRE Plugin</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/apis_rest">REST</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apis_netconf">NETCONF</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">GRE Plugin</h1></header><div class="markdown"><p>The 128T GRE plugin can be used for creating IPv4 GRE tunnel between 128T router and a remote GRE tunnel destination. For some applications such as Zscaler etc this provides a better throughput compared to other tunneling mechanism.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="installation"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#installation" title="Direct link to heading">#</a>Installation</h2><p>The 128T-gre plugin is available in following versions:</p><ul><li>128T-gre-1.0.0: &gt;= 128T-3.2.8, &lt; 128T-4.3.0</li><li>128T-gre-2.0.0: &gt;= 128T-4.3.0</li></ul><p>It is recommended to use the conductor GUI &gt; Plugins page for installing any plugin. This allows the system to select the correct version of plugin based on the 128T version.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># dnf list 128T 128T-gre</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Last metadata expiration check: 5 days, 5:37:52 ago on Wed 18 Mar 2020 08:54:57 PM UTC.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Installed Packages</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">128T.x86_64         4.2.4-1.el7         @128tech-local-saved</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">128T-gre.x86_64     1.0.0-1.el7         @128tech-local-saved</span></div></code></pre></div><div class="admonition admonition-important alert alert--info"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>important</h5></div><div class="admonition-content"><p>After installing the plugin, the 128T service on the conductor should be restarted for the changes to take effect.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="configuration"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#configuration" title="Direct link to heading">#</a>Configuration</h2><p>The GRE plugin can be configured on an individual router. In order to configure the tunnel, it&#x27;s important to collect the following information up-front</p><ul><li>Remote tunnel information</li><li>Ingress traffic to be sent through the tunnel</li><li>WAN interfaces to be used for sending the tunnel traffic</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="remote-gre-tunnel-information"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#remote-gre-tunnel-information" title="Direct link to heading">#</a>Remote GRE tunnel information</h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="tunnel-information"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#tunnel-information" title="Direct link to heading">#</a>Tunnel information</h4><p>First and foremost, its important to identify the address and other probe parameter for the remote GRE endpoints.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1# show config running authority router router1 gre</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router  router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name  router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            gre</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                enabled       true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                destination   pri-tunnel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    name  pri-tunnel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    host  20.20.20.13</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                destination   sec-tunnel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    name  sec-tunnel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    host  30.30.30.14</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    icmp-keep-alive</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        enabled             true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        link-test-interval  10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        number-of-retries          3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        retry-interval      1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                enabled-node  node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name    node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    tenant       _internal_</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    destination  pri-tunnel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    destination  sec-tunnel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1#</span></div></code></pre></div><p>In the above example, you can notice there are two tunnels configured on the router. Each <code>destination</code> represents a single tunnel interface and allows the user to configure an IPv4 address for the destination. The <code>enabled-node</code> configuration allows the user to control which 128T router node will be operating which tunnel. In addition the <code>enabled-node &gt; tenant</code> can be used to apply a specific tenant for the GRE tunnel traffic. For each destination on each enabled-node, the 128T router creates a unique KNI interface and the configured tenant is applied to this interface.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="tunnel-icmp-health-check-parameters"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#tunnel-icmp-health-check-parameters" title="Direct link to heading">#</a>Tunnel ICMP health check parameters</h4><p>The GRE tunnels do not have an inherent mechanism to detect if the remote peer is available or not. As a result, the GRE plugin allows the user to configure ICMP probes to the destination. The configuration is enabled by default with the following settings:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">icmp-keep-alive</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    enabled             true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    link-test-interval  10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    number-of-retries          3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    retry-interval      1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></code></pre></div><blockquote><p>NOTE: All time units for this algorithm are in seconds</p></blockquote><p>Every <code>link-test-interval</code> an icmp probe is performed to check the availability of the remote tunnel peer. When the peer does not respond, a new attempt is made after <code>retry-interval</code>. After sending the initial ping plus <code>number-of-retries</code> amount of ping requests, the peer is considered as down. In the above config, assuming a dead peer, first ping is sent at 10 seconds, followed by 3 more pings at 1 second interval each. In total taking the system about 13 seconds and 4 pings to detect a peer as down. Once a peer is considered as down, the next attempt to detect the tunnel liveliness is made after 10 seconds (or the <code>link-test-interval</code>).</p><p>In the above example, the two tunnels <code>pri-tunnel</code> and <code>sec-tunnel</code> create two additional KNI interfaces called <code>gre-0</code> and <code>gre-1</code> respectively. When a tunnel is deemed as non-responsive, the corresponding <code>gre-x</code> interfaces is brought down. For example, in the above config, when the <code>pri-tunnel</code> goes down, the corresponding <code>gre-0</code> interfaces is brought down as well. The significance of this will be made clear in the next sections.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="128t-services-to-transport-over-the-tunnel"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#128t-services-to-transport-over-the-tunnel" title="Direct link to heading">#</a>128T services to transport over the tunnel</h3><p>Next step is to identify the the prefix or the subnet to be transported over the tunnel. In some cases, it might be desirable to transport all internet traffic through the tunnel, so the prefix could be as simple as 0.0.0.0/0. This can be done by capturing the prefix in a 128T service and setting the next-hop as the <code>gre-x</code> interfaces. As noted in the <a href="#tunnel_icmp_health_check_parameters">previous section</a>, each destination on a given node corresponds to a <code>gre-x</code> inteface. By configuring the next-hop as the appropriate GRE interfaces, it allows the incoming traffic to be service-function chained to a GRE tunnel towards a WAN interface.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1# show config running authority service lan-svc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        service  lan-svc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name           lan-svc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address        10.10.10.0/24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy  lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                source  lan</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1# show config running authority router router1 service-route lan-svc-rte-primary</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router  router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name           router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route  lan-svc-rte-primary</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name          lan-svc-rte-primary</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  lan-svc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                next-hop      node1 gre-0-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name   node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface   gre-0-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    gateway-ip  169.254.132.10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1# show config running authority router router1 service-route lan-svc-rte-secondary</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router  router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name           router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route  lan-svc-rte-secondary</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name          lan-svc-rte-secondary</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  lan-svc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                next-hop      node1 gre-1-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name   node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface   gre-1-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    gateway-ip  169.254.132.14</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1#</span></div></code></pre></div><p>In the example above, all the <code>lan</code> tenant traffic in the <code>10.10.10.0/24</code> subnet will be sent to the <code>gre-0</code> and <code>gre-1</code> network interfaces. These <code>gre-x-intf</code> are auto generated by the conductor and correspond to the configured destination. In the above config, when the <code>gre-0</code> interface will be used as primary target for lan subnet while that tunnel is up. If the <code>pri-tunnel</code> goes down, all new sessions will automatically be routed to the <code>sec-tunnel</code> via the <code>gre-1</code> interface.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="wan-interfaces-for-sending-the-tunnel-packets"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#wan-interfaces-for-sending-the-tunnel-packets" title="Direct link to heading">#</a>WAN interfaces for sending the tunnel packets</h3><p>Another piece of configuration that is auto-generated is the service corresponding to the two configured tunnels. In the above example, the two tunnels <code>pri-tunnel</code> and <code>sec-tunnel</code> will trigger two auto-generated services, one for each of the destination. The generated service will look something like this:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1# show config running authority service gre_router1__internal__0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        service  gre_router1__internal__0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name                  gre_router1__internal__0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            applies-to            router</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                type         router</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                router-name  router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            transport             gre</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                protocol  gre</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            transport             icmp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                protocol  icmp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address               20.20.20.13</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy         _internal_</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                source      _internal_</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                permission  allow</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            share-service-routes  false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1# show config running authority service gre_router1__internal__1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        service  gre_router1__internal__1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name                  gre_router1__internal__1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            applies-to            router</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                type         router</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                router-name  router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            transport             gre</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                protocol  gre</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            transport             icmp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                protocol  icmp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address               30.30.30.14</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy         _internal_</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                source      _internal_</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                permission  allow</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            share-service-routes  false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></code></pre></div><p>The next step, is to configure the service-routes or other routing configuration for these generated services. Typically, such routes are directed towards the WAN interface and user has full control over how &amp; where this traffic can be routed.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1# show config running authority router router1 service-route pri_tunnel_rte</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router  router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name           router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route  pri_tunnel_rte</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name          pri_tunnel_rte</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  gre_router1__internal__0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                next-hop      node1 dpdk2-wan1-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name        node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface        dpdk2-wan1-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    source-nat-pool  gre-dpdk2-nat-pool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1# show config running authority router router1 service-route sec_tunnel_rte</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router  router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name           router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route  sec_tunnel_rte</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name          sec_tunnel_rte</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  gre_router1__internal__1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                next-hop      node1 dpdk3-wan2-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name        node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface        dpdk3-wan2-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    source-nat-pool  gre-dpdk3-nat-pool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1#</span></div></code></pre></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="static-source-nat-considerations"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#static-source-nat-considerations" title="Direct link to heading">#</a>Static Source NAT considerations</h4><blockquote><p>NOTE: For some of the KNI based interfaces such as PPPoE and LTE, the source nat may not be needed</p></blockquote><p>Please note that the <code>next-hop</code> is making use of a <code>shared-nat-pool</code> called <code>gre-dpdk2-nat-pool</code> for example. This nat-pool is necessary for performing a source nat of the GRE tunnel traffic depending on which egress interface are being used. </p><blockquote><p>NOTE: The <code>network-interface &gt; source-nat</code> flag does not support GRE, hence the <code>shared-nat-pool</code> is required.</p></blockquote><p>The sample <code>shared-nat-pool</code> configuration looks something like this:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1# show config running authority router router1 nat-pool gre-dpdk2-nat-pool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router  router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name      router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            nat-pool  gre-dpdk2-nat-pool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name          gre-dpdk2-nat-pool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                address-pool  20.20.20.12/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    address      20.20.20.12/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    tenant-name  _internal_</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1# show config running authority router router1 nat-pool gre-dpdk3-nat-pool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router  router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name      router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            nat-pool  gre-dpdk3-nat-pool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name          gre-dpdk3-nat-pool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                address-pool  30.30.30.12/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    address      30.30.30.12/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    tenant-name  _internal_</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1#</span></div></code></pre></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="debugging--troubleshooting"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#debugging--troubleshooting" title="Direct link to heading">#</a>Debugging &amp; Troubleshooting</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="config-generation"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#config-generation" title="Direct link to heading">#</a>Config generation</h3><p>When the plugin is installed on the conductor, each commit triggers two scripts called <code>generate_confguration</code> and <code>generate_pillar</code> to auto-generate KNI, services etc and to generate pillar data for each router. Please check the following locations for debugging information.</p><ul><li>Logs for the config and pillar generation for each commit can be found here</li></ul><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/var/log/128technology/plugins/gre-generate-config.log</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/var/lib/128technology/plugins/pillar/gre/&lt;router&gt;.sls</span></div></code></pre></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="gre-tunnel-not-working-on-the-router"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#gre-tunnel-not-working-on-the-router" title="Direct link to heading">#</a>GRE Tunnel not working on the router</h3><p>When the config and pillar data are successfully generated, a <code>t128-setup-gre</code> RPM is installed on the router itself. As part of this process, a script called <code>handle_gre_config</code> is executed which will create all the necessary config etc on the running system.</p><ul><li>Logs for the config generation on the router can be found here</li></ul><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/var/log/128technology/plugins/gre-handle-config.log</span></div></code></pre></div><ul><li>Debugging the runtime status of the GRE tunnels can be done by monitoring the journal for the following tags</li></ul><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">journalctl -t /monitoring_script.par -t /init.par</span></div></code></pre></div><ul><li>For debugging the linux network namespace, here are some of the common commands:</li></ul><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># ip netns &lt;name&gt; ip addr</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># ip netns &lt;name&gt; ip route show table all</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># ip netns &lt;name&gt; ip rule list</span></div></code></pre></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="tunnel-operation"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#tunnel-operation" title="Direct link to heading">#</a>Tunnel operation</h3><p>The status of the tunnel and other data is available via the auto generated tunnel interfaces. Here&#x27;s an example</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1# show device-interface router router1 name pri-tunnel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Tue 2020-03-24 03:22:37 UTC</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===========================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> node1.router1:pri-tunnel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===========================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                host</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Mode:                host</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         ea:a6:fe:1c:3d:70</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  up</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               1000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                     6243918</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:                104054</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                    4691030</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:               100393</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                          0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> GRE::</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   icmp-probe-status:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     attempts:        45008</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     elapsed:         0.006435333052650094</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     last_attempt:    1585020151.1222534</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     status:          up</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   stats:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     RX errors::</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       crc:           0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       fifo:          0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       frame:         0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       length:        0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       missed:        0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     RX::</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       bytes:         380</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       dropped:       0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       errors:        0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       mcast:         0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       overrun:       0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       packets:       7</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     TX errors::</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       aborted:       0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       fifo:          0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       heartbeat:     0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       transns:       0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       window:        0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     TX::</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       bytes:         692</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       carrier:       106</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       collsns:       4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       dropped:       0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       errors:        110</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       packets:       11</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.07 seconds</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor1#</span></div></code></pre></div><p>In addition, a <code>ping-monitor</code> service is started for each configured tunnel, the <code>systemctl status ping-monitor@&lt;tunnel-name&gt;</code> can be used to query the status of the ping service.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="conclusion"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#conclusion" title="Direct link to heading">#</a>Conclusion</h2><p>Please report any issues with the plugin through JIRA. Select the following:</p><ul><li>Project: 128T-Plugins</li><li>Issue Type: Bug</li><li>Affects Version: gre-1.0.0 or gre-2.0.0</li><li>Components: Extensibility</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/128technology/docs/tree/master/docs/gre_plugin.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-03-25T03:30:51.000Z" class="docLastUpdatedAt_1sqk">3/25/2020</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/monitoring_agent"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« 128T Monitoring Agent</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/apis_rest"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">REST »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#installation" class="contents__link">Installation</a></li><li><a href="#configuration" class="contents__link">Configuration</a><ul><li><a href="#remote-gre-tunnel-information" class="contents__link">Remote GRE tunnel information</a></li><li><a href="#128t-services-to-transport-over-the-tunnel" class="contents__link">128T services to transport over the tunnel</a></li><li><a href="#wan-interfaces-for-sending-the-tunnel-packets" class="contents__link">WAN interfaces for sending the tunnel packets</a></li></ul></li><li><a href="#debugging--troubleshooting" class="contents__link">Debugging &amp; Troubleshooting</a><ul><li><a href="#config-generation" class="contents__link">Config generation</a></li><li><a href="#gre-tunnel-not-working-on-the-router" class="contents__link">GRE Tunnel not working on the router</a></li><li><a href="#tunnel-operation" class="contents__link">Tunnel operation</a></li></ul></li><li><a href="#conclusion" class="contents__link">Conclusion</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>Copyright © 2020 128 Technology, Inc.</div></div></div></footer>
</div>

<script src="/styles.104e1ffe.js"></script>

<script src="/runtime~main.f892d825.js"></script>

<script src="/main.cac71f1e.js"></script>

<script src="/1.4ffabab0.js"></script>

<script src="/2.47c801dd.js"></script>

<script src="/54.b3ed53b4.js"></script>

<script src="/20ac7829.623ca1fb.js"></script>

<script src="/17896441.bfeb97f5.js"></script>

<script src="/1dd681e0.806db5dd.js"></script>


</body>
</html>
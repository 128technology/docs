<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.ff31de0ff">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="128T Docs Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="128T Docs Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-167298415-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="128T Docs" href="/opensearch.xml"><title data-react-helmet="true">DNS Cache Plugin | 128T Docs</title><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/plugin_dns_cache"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="DNS Cache Plugin | 128T Docs"><meta data-react-helmet="true" name="description" content="The 128T-dns-cache plugin provides a DNS caching service on your 128T router by forwarding all traffic on a configured ingress-service and tenant to dnsmasq. By default it uses existing system configuration for nameserver resolution, but supports optionally configuring custom server addresses. The plugin is implemented as a service function chain (SFC) where the DNS traffic received on an ingress interface is detoured through a Kernel Network Interface (KNI) to be cached by dnsmasq. A typical flow of the packets for the plugin is illustrated below:"><meta data-react-helmet="true" property="og:description" content="The 128T-dns-cache plugin provides a DNS caching service on your 128T router by forwarding all traffic on a configured ingress-service and tenant to dnsmasq. By default it uses existing system configuration for nameserver resolution, but supports optionally configuring custom server addresses. The plugin is implemented as a service function chain (SFC) where the DNS traffic received on an ingress interface is detoured through a Kernel Network Interface (KNI) to be cached by dnsmasq. A typical flow of the packets for the plugin is illustrated below:"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.128technology.com/docs/plugin_dns_cache"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/plugin_dns_cache" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/plugin_dns_cache" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.b920482b.css">
<link rel="preload" href="/assets/js/runtime~main.bc8e57c4.js" as="script">
<link rel="preload" href="/assets/js/main.6f545d22.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Session Smart</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.128technology.com/home" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Interchange</a><a href="https://www.128technology.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Session Smart</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Docs</a></li><li class="menu__list-item"><a href="https://community.128technology.com/home" target="_blank" rel="noopener noreferrer" class="menu__link">Interchange</a></li><li class="menu__list-item"><a href="https://www.128technology.com/" target="_blank" rel="noopener noreferrer" class="menu__link">Company</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><div class="docSidebarContainer_0YBq" role="complementary"><div class="sidebar_a3j0"><div class="menu menu--responsive thin-scrollbar menu_cyFh"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_128t">128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_svr_savings">Secure Vector Routing Savings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_releases">128T Releases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_support_policy">Software Support Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_supported_platforms">Platform Support Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_supported_drivers">Supported NICs and Drivers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_certified_platforms">Certified Plus Platforms</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_security_policy">Security Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_services_description">Services Description</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/CONTRIBUTING">Contributing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_getting_started">Getting Started with the 128T Networking Platform</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deployment Considerations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_system_reqs">System Requirements</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Installation Process</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation">Installation Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_downloading_iso">Downloading ISOs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_creating_bootable_usb">Creating Bootable USB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_bootable_media">Conductor Interactive Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_basic_conductor_config">Configure the Conductor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_basic_router_config">Basic Router Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_otp_iso_install">Router Installation Using OTP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_install_quickstart_otpiso">QuickStart from the OTP ISO</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Cloud Installations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_aws">Installing from the AWS Marketplace</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_quickstart_aws">QuickStart Installation in AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_azure">Installing in Azure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_initialize_HA_conductor">Conductor High Availability for Cloud Deployments</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Supporting Information - Appendix</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_installer">Manually Installing the 128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/legacy_OTP_install">Installing Using the Pre-5.0 Interactive ISO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_upgrade_considerations">Upgrade Considerations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_upgrading">Upgrading</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_rollback">Rollback</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_application_discovery">Application Discovery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_appid">Application Identification</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_EthOverSVR">Ethernet Over Secure Vector Routing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_ha_theoryofoperation">HA - Theory of Operation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_interface_types">Interface Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_kni">Kernel Network Interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_linux_host_networking">Linux Host Networking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_learning_VRF_routes">Learning VRF Routes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_network_planes">Forwarding Planes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_metadata">128T Metadata</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_metrics">Metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_machine_communication">Machine Communication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_pcli">PCLI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_session_timer">Session Timers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_STEP">Service and Topology Exchange Protocol (STEP)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_waypoint_ports">Waypoints</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_glossary">Data Model</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Administration</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_basics">Configuration Management</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_access_mgmt">Access Management</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_asset_connection_resiliency">Asset Connection Resiliency</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_bgp">Configuring BGP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_ospf">OSPF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_dscp_steering">Configuring DSCP Steering</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_vrf_learning">VRF Learning</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_reference_guide">Element Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_audit_event">Audit Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_dhcp">DHCP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_dns_proxy">DNS Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_ldap">LDAP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_management_over_forwarding">Management over Forwarding</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_domain-based_web_filter">Configuring Domain-based Web Filtering/Routing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_EthoSVR">Configuring Ethernet Over Secure Vector Routing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_flow_perf_mon">Inline Flow Performance Monitoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_gre_tunnel">Native GRE Tunnels</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_in-memory_metrics">In-Memory Metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_nat">NAT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_rate_limiting">Rate Limiting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_RBAC">Configuring Role-Based Access Control</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_service_health">Service Health Learning and Fault Avoidance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_snmp">SNMP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_snmp_metrics">SNMP: User defined metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_static_hostname_mapping">Static Hostname Mappings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_STEP">Configuring Service and Topology Exchange Protocol (STEP)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_tenants">Tenants</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_templates">Configuration Templates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_transport_encryption">Transport Based Encryption</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_wan_assurance">Configuring WAN Assurance</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">High Availability</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_ha">Dual Node High Availability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_dual_router_ha">Dual Router High Availability using iBGP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_ha_vrrp">Dual Router High Availability and VRRP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_adding_interfaces_to_ha_team">Adding Interfaces to HA Team Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_transition_standalone_to_ha">Transitioning a Conductor from Standalone to HA</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Security</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sec_adaptive_encrypt">Adaptive Encryption</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">How To</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_conductor_migration">Conductor Migration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_extend_gui_nav">Extending GUI Nav</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_lte">LTE and Dual LTE Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_config_PPPoE">Configuring Dual PPPoE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_maintenance_mode">Maintenance Mode</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_ms365">Microsoft 365</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_trusted_ca_certificate">Adding a Trusted Certificate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_tune_bfd">Tuning BFD</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_applications">Application Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_ap_duplicate_assets">AP: Duplicate Asset ID Error</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_ap_salt_minion">AP: Salt Minion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_cpu_spikes">CPU Spikes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_connecting_to_routers">Connecting to Routers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_forwarding_resource_pools">Forwarding Plane Resource Pools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_logs">Logs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_mac_uniqueness">MAC Address Uniqueness</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_packet_capture">Packet Capture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_t1_troubleshooting">T1 Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_troubleshooting_vrf">Troubleshooting VRF</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Events</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_overview">Alarm and Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_alarms">Alarms</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_events">Events</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Best Practices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_att_avpn_configuration">AT&amp;T AVPN Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_using_128T_as_ntp_server">Branch NTP Service</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_conductor_deployment">Conductor Deployment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_per-adjacency_traffic_engineering">Per Adjacency Traffic Engineering</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_qos_msft_expressroute">ExpressRoute QoS Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_lte_peering">LTE Peering</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_monitoring_headends">Monitoring Head End Routers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_salt_pillars">Saltstack at Scale With 128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_sdwan_design_guide">SD-WAN Design Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_service_and_service_policy_design">Service and Service Policy Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_service-policy_defaults">Service Policy Baseline Defaults</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_tenants">Tenancy Design</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CLI Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli_reference">Command Line Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli_stats_reference">Show Stats Reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Installer/Initializer Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/installer_cli_reference">Installer Command Line Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/installer_preferences">Installer Preferences File Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/initializer_cli_reference">Initializer Command Line Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/initializer_preferences">Initializer Preferences File Reference</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_bgp_community_services">BGP Community Services</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_aws_tgw_connect">AWS Transit Gateway Connect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_cloud_ha">Cloud HA</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_app_id">DNS App Id</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/plugin_dns_cache">DNS Cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_gre">GRE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_ha_sync_redundancy">HA Sync Redundancy Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_icmp_reachability_detection">ICMP Reachability Detection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_ipsec_client">IPsec Client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_loopback_static_routes">Loopback Static Routes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_m800_watchdog">M800 Watchdog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_monitoring_agent">Monitoring Agent</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_mosh">Mosh</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_set_hostname">Set Hostname</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_sip_alg">SIP ALG</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_wireguard">Wireguard</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">REST APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api_rest_4.2.0">128T-4.2.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Release Notes</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">SSR</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_5.4">5.4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_5.3">5.3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_5.2">5.2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_5.1">5.1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_5.0">5.0</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.5">4.5</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.4">4.4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.3">4.3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.2">4.2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.1">4.1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.0">4.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">SSR Installer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_3.1">3.1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_3.0">3.0</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.7">2.7</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.6">2.6</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.5">2.5</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.4">2.4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.3">2.3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.2">2.2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.1">2.1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">SSR SIP ALG</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_sip_alg_2.1">2.1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">SSR ZScaler</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_zscaler_1.1">1.1</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_r8cw"><div class="container padding-vert--lg docItemWrapper_NJLN"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><header><h1 class="docTitle_-X99">DNS Cache Plugin</h1></header><div class="markdown"><p>The 128T-dns-cache plugin provides a DNS caching service on your 128T router by forwarding all traffic on a configured <code>ingress-service</code> and <code>tenant</code> to <a href="http://www.thekelleys.org.uk/dnsmasq/doc.html" target="_blank" rel="noopener noreferrer">dnsmasq</a>. By default it uses existing system configuration for nameserver resolution, but supports optionally configuring custom server addresses. The plugin is implemented as a <a href="/docs/plugin_intro#service-function-chaining">service function chain</a> (SFC) where the DNS traffic received on an ingress interface is detoured through a <a href="/docs/concepts_kni">Kernel Network Interface</a> (KNI) to be cached by <code>dnsmasq</code>. A typical flow of the packets for the plugin is illustrated below:</p><p>lan-intf (lan-tenant) &gt; <code>ingress-service</code> &gt; <code>dnsmasq</code> &gt; dns-kni (<code>tenant</code>) &gt; egress-service &gt; wan-intf</p><p>By enabling this plugin, you can provide DNS caching with fast resolution times to your network.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The instructions for installing and managing the plugin can be found <a href="/docs/plugin_intro#installation-and-management">here</a>.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="configuration"></a>Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">#</a></h2><p>Assuming the below 128T configuration:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><div tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name Authority128</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        conductor-address labconductor.acme.com</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        tenant dns-cache-plugin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name dns-cache-plugin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        tenant lan-clients</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name lan-clients</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            security aes1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        service internet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name internet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            security internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address 0.0.0.0/0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy lan-clients</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                source lan-clients</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                permission allow</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy dns-cache-plugin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                source dns-cache-plugin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                permission allow</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            share-service-routes false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        service dns-catcher</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name dns-catcher</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            transport udp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                protocol udp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                port-range 53</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    start-port 53</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address 0.0.0.0/0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy lan-clients</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                source lan-clients</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                permission allow</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router labrouter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name labrouter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            node node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                role combo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface LAN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    name LAN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface vlan0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        name vlan0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        tenant lan-clients</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        dhcp v4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>We can apply the following DNS cache plugin configuration:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><div tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router lab-router</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name lab-router</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            dns-cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                enabled true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                tenant dns-cache-plugin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ingress-service dns-catcher</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><table><thead><tr><th>Element</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>enabled</td><td>boolean</td><td>true</td><td>Governs whether the DNS cache is operationally enabled or not.</td></tr><tr><td>name</td><td>128T device name</td><td><code>dns-cache</code></td><td>This controls the name of the service function chain interface.</td></tr><tr><td>addresses</td><td>IPv4 address</td><td>N/A</td><td>Multiple instance object. This will specify the upstream DNS resolvers to use, overriding the ones normally used by the Linux host operating system on the machine.</td></tr><tr><td>ingress-service</td><td>reference</td><td>N/A</td><td>This refers to a configured <code>service</code> within the authority that will be used to &quot;trap&quot; inbound DNS requests, to divert them to dnsmasq. Generally, this is a service that has an address of 0.0.0.0/0 and restricted to UDP/53.</td></tr><tr><td>plugin-network</td><td>CIDR</td><td>169.254.141.128/30</td><td>This controls the IP addresses used for the internal SFC network to detour packets to and from the on-board DNS cache. This should only be changed if there is a conflict with another IP block in use on this same host system.</td></tr><tr><td>tenant</td><td>reference</td><td>N/A</td><td>This is the tenant that will be assigned to the SFC interface (of type KNI). All packets leaving the DNS cache and heading toward an upstream DNS resolver will be associated with this tenant. For this reason, it is important that your 128T configuration also includes a <code>service</code> that allows this <code>tenant</code> to reach the upstream resolvers. Typically, this is an <code>internet</code> service (0.0.0.0/0).</td></tr><tr><td>ingress-source-nat-pool</td><td>reference</td><td>N/A</td><td>This refers to a configured <code>source-nat-pool</code>, and will be used when forwarding the traffic through the DNS cache/service function chain.</td></tr><tr><td>max-ttl</td><td>seconds</td><td>1500</td><td>The configured maximum TTL will be advertised to clients instead of the true TTL value if it is lower. The true TTL value is however kept in the cache to avoid flooding the upstream DNS servers. See <a href="#release-120-220">release notes for details</a></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="notes-about-the-sample-configuration"></a>Notes about the Sample Configuration<a class="hash-link" href="#notes-about-the-sample-configuration" title="Direct link to heading">#</a></h3><p>The <code>ingress-service</code> we have configured is <code>dns-catcher</code>. This is a simple service that matches any IP address (0.0.0.0/0) and has a destination protocol and port of UDP/53. Our <code>dns-catcher</code> service is set to allow the <code>lan-clients</code> tenant (which is assigned to the LAN <code>network-interface</code>), so any traffic arriving on this interface destined for UDP/53 will be detoured to the DNS cache.</p><p>The DNS cache will either respond locally (if there&#x27;s an existing cache entry), or will forward the request to an upstream resolver. For the latter case, it will reenter the 128T&#x27;s forwarding plane via the KNI interface (a.k.a. the &quot;service function chain&quot; interface) and be affiliated with the <code>tenant</code> named <code>dns-cache-plugin</code>.</p><p>Once in the 128T&#x27;s data plane, this traffic will match the <code>internet</code> service (we&#x27;ve added an <code>allow</code> statement for the <code>dns-cache-plugin</code> tenant), and be forwarded out to the upstream server(s).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="custom-dns-servers"></a>Custom DNS Servers<a class="hash-link" href="#custom-dns-servers" title="Direct link to heading">#</a></h3><p>To configure custom server addresses for dnsmasq instead of the ones affiliated with the host machine that the plugin is running on, add the <code>addresses</code> field:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><div tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">dns-cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    enabled          true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    addresses        1.1.1.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    addresses        2.2.2.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    tenant           dns-cache-plugin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ingress-service  dns-catcher</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="redirecting-and-blocking-domains"></a>Redirecting and blocking domains<a class="hash-link" href="#redirecting-and-blocking-domains" title="Direct link to heading">#</a></h3><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="version-history"></a>Version History<a class="hash-link" href="#version-history" title="Direct link to heading">#</a></h5><table><thead><tr><th>Release</th><th>Modification</th></tr></thead><tbody><tr><td>1.1.0, 2.1.0</td><td><code>dns-cache &gt; redirect-domains</code> and <code>dns-cache &gt; block-domains</code> were introduced</td></tr></tbody></table><p>The DNS cache plugin will send all requests it processes to the list of servers provided in its configuration. Generally, these are configured as public DNS servers. However, many enterprises commonly host their own authoritative name server for their own domain (e.g., some-private-domain.com). The redirect-domains configuration lets administrators specify a distinct DNS server for a given domain, and 128T will use this when issuing queries for any host within that domain.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI config"><div tabindex="0" class="prism-code language-config codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        router  router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name       router1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            dns-cache</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                enabled true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                tenant dns-cache-plugin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ingress-service dns-catcher</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                redirect-domains  some-private-domain.com</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    domain   some-private-domain.com</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    address  192.168.8.8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                block-domains     block-domain.com</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The <code>block-domains</code> configuration allows the DNS server to block those domains by replying back with NXDOMAIN indicating that the domain name doesn&#x27;t exist.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="third-party-software-and-licenses"></a>Third Party Software and Licenses<a class="hash-link" href="#third-party-software-and-licenses" title="Direct link to heading">#</a></h2><ul><li>dnsmasq (GNU GPL v2, v3)</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="troubleshooting"></a>Troubleshooting<a class="hash-link" href="#troubleshooting" title="Direct link to heading">#</a></h2><p>To verify that the services are running properly on the 128T router:</p><ul><li><code>systemctl status 128T-dns-cache-forwarder.service</code></li><li><code>systemctl status 128T-dns-cache-matcher.service</code></li></ul><p>Verify that the dns-cache network interface (default <code>dns-cache-intf</code>) is UP.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="release-notes"></a>Release Notes<a class="hash-link" href="#release-notes" title="Direct link to heading">#</a></h2><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>The plugin must be updated to version 3.2.1 or later prior to <a href="/docs/intro_upgrade_considerations#plugin-config-generation-changes">upgrading the conductor to SSR version 5.4.0.</a></p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="release-321"></a>Release 3.2.1<a class="hash-link" href="#release-321" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="issues-fixed"></a>Issues Fixed<a class="hash-link" href="#issues-fixed" title="Direct link to heading">#</a></h4><ul><li><p><strong>PLUGIN-1461</strong>  Config generation for the plugin failing in the Bonsai mode</p><p><em><strong>Resolution:</strong></em> Correctly handle the config generation for routers where the DNS cache plugin is not enabled during bonsai config generation</p></li><li><p><strong>PLUGIN-1367</strong>  DNS cache services constantly fail on system startup</p><p><em><strong>Resolution:</strong></em> The DNS cache systemd services will be deferred until the 128T services are running and stable.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="release-310"></a>Release 3.1.0<a class="hash-link" href="#release-310" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="issues-fixed-1"></a>Issues Fixed<a class="hash-link" href="#issues-fixed-1" title="Direct link to heading">#</a></h4><ul><li><strong>PLUGIN-768</strong> Support the DNS Cache plugin in 128T versions <code>5.1.0</code> and greater.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="release-120-220"></a>Release 1.2.0, 2.2.0<a class="hash-link" href="#release-120-220" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="issues-fixed-2"></a>Issues Fixed<a class="hash-link" href="#issues-fixed-2" title="Direct link to heading">#</a></h4><ul><li><p><strong>PLUGIN-952</strong> FIB entry for dns-app-id based applications was deleted before the advertised TTL causing traffic to be blackholed</p><p><em><strong>Resolution:</strong></em> The TTL value advertised to the clients is made configurable and is also set to 1500 seconds by default to match the internal DNS cache timers.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="release-110-210"></a>Release 1.1.0, 2.1.0<a class="hash-link" href="#release-110-210" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="new-features-and-improvements"></a>New Features and Improvements<a class="hash-link" href="#new-features-and-improvements" title="Direct link to heading">#</a></h4><ul><li><strong>PLUGIN-641</strong> Provide support for redirecting and blocking domains</li></ul><p>Added support for redirecting domains to a different upstream domain server. In addition, added support for blocking domains that the user should not be able to access.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="issues-fixed-3"></a>Issues Fixed<a class="hash-link" href="#issues-fixed-3" title="Direct link to heading">#</a></h4><ul><li><p><strong>PLUGIN-684</strong> DNS cache plugin fails to apply configuration on initial installation</p><p><em><strong>Resolution:</strong></em> Make config handling on the router dependent on a successful plugin router RPM installation.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="release-101-201"></a>Release 1.0.1, 2.0.1<a class="hash-link" href="#release-101-201" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="issues-fixed-4"></a>Issues Fixed<a class="hash-link" href="#issues-fixed-4" title="Direct link to heading">#</a></h4><ul><li><strong>PLUGIN-402</strong> Ensure the application restarts with 128T</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-11-19T17:23:41.000Z" class="lastUpdatedDate_nN9m">11/19/2021</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/plugin_dns_app_id"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label"> DNS App Id Plugin</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/plugin_gre"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">GRE Plugin </div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configuration" class="table-of-contents__link">Configuration</a><ul><li><a href="#notes-about-the-sample-configuration" class="table-of-contents__link">Notes about the Sample Configuration</a></li><li><a href="#custom-dns-servers" class="table-of-contents__link">Custom DNS Servers</a></li><li><a href="#redirecting-and-blocking-domains" class="table-of-contents__link">Redirecting and blocking domains</a></li></ul></li><li><a href="#third-party-software-and-licenses" class="table-of-contents__link">Third Party Software and Licenses</a></li><li><a href="#troubleshooting" class="table-of-contents__link">Troubleshooting</a></li><li><a href="#release-notes" class="table-of-contents__link">Release Notes</a><ul><li><a href="#release-321" class="table-of-contents__link">Release 3.2.1</a></li><li><a href="#release-310" class="table-of-contents__link">Release 3.1.0</a></li><li><a href="#release-120-220" class="table-of-contents__link">Release 1.2.0, 2.2.0</a></li><li><a href="#release-110-210" class="table-of-contents__link">Release 1.1.0, 2.1.0</a></li><li><a href="#release-101-201" class="table-of-contents__link">Release 1.0.1, 2.0.1</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright  2021 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.bc8e57c4.js"></script>
<script src="/assets/js/main.6f545d22.js"></script>
</body>
</html>
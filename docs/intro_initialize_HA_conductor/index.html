<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-intro_initialize_HA_conductor">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Conductor High Availability for Cloud Deployments | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/docs/intro_initialize_HA_conductor"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Conductor High Availability for Cloud Deployments | SSN Docs"><meta data-rh="true" name="description" content="This document describes the process for deploying a Highly Available Conductor in the AWS and Azure clouds. The procedure for deploying on Azure has additional steps performed using the Azure Portal. If you are installing on Azure, please refer to Using the Azure Portal before beginning."><meta data-rh="true" property="og:description" content="This document describes the process for deploying a Highly Available Conductor in the AWS and Azure clouds. The procedure for deploying on Azure has additional steps performed using the Azure Portal. If you are installing on Azure, please refer to Using the Azure Portal before beginning."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/docs/intro_initialize_HA_conductor"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/intro_initialize_HA_conductor" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/intro_initialize_HA_conductor" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8e1fdc51.css">
<link rel="preload" href="/assets/js/runtime~main.05a3e2dc.js" as="script">
<link rel="preload" href="/assets/js/main.8efb112e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Session Smart</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Session Smart Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/install_conductor_overview">Conductor Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_image">Image-Based Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/supported_cloud_platforms">Cloud Installations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/supported_cloud_platforms">Cloud Platform Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/intro_installation_quickstart_aws">Installing in AWS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/intro_installation_azure">Installing in Azure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/intro_initialize_HA_conductor">Conductor High Availability for Cloud Deployments</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_upgrade_considerations">Upgrades and Rollback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_installer">Supporting Install Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/config_basics">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/plugin_intro">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/release_notes_128t_6.1">Release Notes</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cloud Installations</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Conductor High Availability for Cloud Deployments</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Conductor High Availability for Cloud Deployments</h1></header><p>This document describes the process for deploying a Highly Available Conductor in the AWS and Azure clouds. The procedure for deploying on Azure has additional steps performed using the Azure Portal. If you are installing on Azure, please refer to <a href="#using-the-azure-portal">Using the Azure Portal</a> before beginning.  </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>Juniper Networks is committed to providing the highest quality software with each release. As such, Critical Vulnerability Exposures (CVE) are continuously addressed, and security and administration best practices are enforced. Allowing SSH Root login has been identified as a significant vulnerability and has been mitigated. Additionally, all public cloud providers enforce SSH key-based authentication instead of password-based authentication. As a result of this stricter security posture, the process to deploy a Highly Available Conductor in the public cloud requires additional steps during the Initialization procedure. Use the following procedure to successfully deploy an HA Conductor in the cloud. </p><p>The process to deploy a highly available Conductor in the public cloud consists of the following steps:</p><ol><li>Launch two Session Smart Conductor VMs as described in the following links:</li></ol><ul><li><a href="/docs/intro_installation_quickstart_aws">AWS</a></li><li><a href="/docs/intro_installation_azure">Azure</a></li></ul><p>Click on the link of the public cloud provider where you want to perform the Session Smart Conductor HA deployment. In this document these Conductors are referred to as Node A and Node B respectively.</p><ol start="2"><li><p>If you have selected the Hourly or Private AWS AMI or Azure Plan during step 1, then proceed to step 3. Otherwise, refer to <a href="#deploying-the-primary-node-conductor--node-a">Deploying the Primary Node Conductor – Node A</a> to install the SSR software in Node A. When completed, proceed to step 4.</p></li><li><p>Initialize the primary node of Conductor as described in the section <a href="#configure-node-a">Configure Node A</a>.</p></li><li><p>If you have selected the Hourly or Private AWS AMI or Azure Plan during step 1, then proceed to step 5. Otherwise, refer to <a href="#deploying-the-secondary-node-conductor--node-b">Deploying the Primary Node Conductor – Node B</a> to install the SSR software in Node B. When completed, proceed to step 6.</p></li><li><p>Initialize the secondary node of Conductor as described in the section <a href="#configure-node-b">Configure Node B</a>.</p></li><li><p><a href="#disable-password-based-authentication-in-the-primary-node">Disable Password-based Authentication in the Primary Node</a>.</p></li><li><p><a href="#validate-the-ha-conductor-deployment">Validate the HA Conductor Deployment</a>.</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-the-primary-node-conductor--node-a">Deploying the Primary Node Conductor – Node A<a href="#deploying-the-primary-node-conductor--node-a" class="hash-link" aria-label="Direct link to Deploying the Primary Node Conductor – Node A" title="Direct link to Deploying the Primary Node Conductor – Node A">​</a></h2><p>If the SSR software is not already installed on the Node A VM, launch the SSR installer using the command <code>install128t</code> and follow the <a href="/docs/intro_installation_installer">Installation Procedure</a>. After the installation is complete, the system will restart and the initializer will launch automatically.</p><p>If the software is already installed, launch the initializer from the command line using <code>initialize128t</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-node-a">Configure Node A<a href="#configure-node-a" class="hash-link" aria-label="Direct link to Configure Node A" title="Direct link to Configure Node A">​</a></h3><ol><li><p>On the SSR Initializer Wizard, use the spacebar to select the Conductor role for the SSR node and press the Enter key to select OK.</p></li><li><p>To configure Node A, select <strong>1st HA Node HA peer is not set up</strong> on the HA Setup screen, and OK. </p><p><img loading="lazy" alt="HA Setup" src="/assets/images/CloudHA_NodeA1-bd7e083835b335c7a2404c395f1e277d.png" width="844" height="492" class="img_ev3q"></p></li><li><p>Enter the IP address of Node A that will be used as the HA sync interface.</p></li><li><p>Continue with step 4 in the <a href="/docs/intro_installation_bootable_media#initialize-the-ssr-node">Initialize the SSR Node</a> procedure. After the initialization is complete, reboot Node A as instructed.</p><p>Once Node A has rebooted, you must perform the following steps to configure SSH key-based authentication. Please note the commands vary depending on the public cloud provider.</p></li><li><p>Log in to the Node A VM via SSH and run the following commands, according to your public cloud provider.</p><ul><li>Azure: <code>sudo su -</code><code>passwd &lt;username of the VM&gt;</code></li><li>AWS: <code>sudo su –</code><code>passwd t128</code></li></ul><p>When the password has been updated successfully the following message is displayed:</p><p><code>passwd: all authentication tokens updated successfully</code></p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Do not proceed to the next step until the password has been updated successfully.</p></div></div></li><li><p>After updating the password, perform the following commands.</p></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mv /etc/sudoers.d/90-cloud-init-users /etc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">visudo -f /etc/sudoers</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="7"><li>In the output of <code>visudo -f</code>, verify the line <code>%wheel  ALL=(ALL)  ALL</code> is <strong>not</strong> prepended with a #.</li><li>In the output of <code>visudo -f</code>, verify the line <code># %wheel   ALL=(ALL)  NOPASSWD: ALL</code> is prepended with a #.</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Allows people in group wheel to run all commands</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">%wheel  ALL=(ALL)   ALL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Same thing without a password</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># %wheel    ALL=(ALL)   NOPASSWD: ALL</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Node A is now ready to allow access to Node B in order to form the HA pair. The user (t128 for AWS, or the user login for the Azure VM) has been set up in Node A to temporarily accept password-based authentication.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-the-secondary-node-conductor--node-b">Deploying the Secondary Node Conductor – Node B<a href="#deploying-the-secondary-node-conductor--node-b" class="hash-link" aria-label="Direct link to Deploying the Secondary Node Conductor – Node B" title="Direct link to Deploying the Secondary Node Conductor – Node B">​</a></h2><p>Log in to the Node B VM. If the SSR software is not already installed, launch the SSR installer using the command <code>install128t</code> and follow the <a href="/docs/intro_installation_installer">Installation Procedure</a>. After the installation is complete, the system will restart and the initializer will launch automatically.
If the software is already installed, launch the initializer from the command line using <code>initialize128t.</code></p><ol><li><p>On the SSR Initializer Wizard, use the space bar to select the Conductor role for the SSR node and press the Enter key to select OK.</p></li><li><p>To configure Node B, select <strong>2nd HA Node HA peer is already set up</strong> on the HA Setup screen, and <strong>OK</strong>.</p><p><img loading="lazy" alt="HA Setup" src="/assets/images/CloudHA_NodeB1-cd61359da11e21998d9f2a6c898579af.png" width="512" height="292" class="img_ev3q"></p></li><li><p>Enter the IP address for the HA Sync Interface on Node B in the HA Address field.</p><p><img loading="lazy" alt="HA Setup Node" src="/assets/images/CloudHA_NodeB2-90d7a56305046669802d4ef7feab55dc.png" width="512" height="255" class="img_ev3q"></p></li><li><p>Enter the IP address for Node A in the Peer HA Address field.</p><p><img loading="lazy" alt="HA Peer Credentials" src="/assets/images/CloudHA_NodeB3-55812b1368518662188b399022804e99.png" width="512" height="239" class="img_ev3q"></p></li><li><p>On the HA Peer Credentials screen, enter the username and password configured for Node A.</p></li></ol><table><thead><tr><th>Azure</th><th>Amazon Web Services - AWS</th></tr></thead><tbody><tr><td>Username is (username of the VM)</td><td>Username is t128</td></tr></tbody></table><ol start="6"><li>Select OK. Upon successful configuration, the following message is displayed.</li></ol><div class="theme-admonition theme-admonition-important alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Do not restart Node A. Restart only Node B as suggested by the installer.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="disable-password-based-authentication-in-the-primary-node">Disable Password-based Authentication in the Primary Node<a href="#disable-password-based-authentication-in-the-primary-node" class="hash-link" aria-label="Direct link to Disable Password-based Authentication in the Primary Node" title="Direct link to Disable Password-based Authentication in the Primary Node">​</a></h3><p>To ensure secure operation, you must disable password-based authentication so Node A only allows SSH Key-based authentication.</p><ol><li>Log in to Node A via SSH.</li><li>Based on your public cloud provider, run the following commands to disable password-based authentication.
<strong>Azure:</strong></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    sudo su -</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mv /etc/90-cloud-init-users /etc/sudoers.d</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">passwd -d &lt;username of the VM&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">passwd -l &lt;username of the VM&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>AWS:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    sudo su -</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mv /etc/90-cloud-init-users /etc/sudoers.d</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">passwd -d t128</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">passwd -l t128</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Reboot Node A in order for it to recognize Node B.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="validate-the-ha-conductor-deployment">Validate the HA Conductor Deployment<a href="#validate-the-ha-conductor-deployment" class="hash-link" aria-label="Direct link to Validate the HA Conductor Deployment" title="Direct link to Validate the HA Conductor Deployment">​</a></h3><p>When Node A has fully rebooted, both Node A and Node B will be synced. To validate the Conductor deployment is Highly Available, login to the Conductor CLI (pCLI) on Node A and run the command <code>show system connectivity</code>. If the status displays <strong>Connected</strong>, the HA setup has completed successfully.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-azure-portal">Using the Azure Portal<a href="#using-the-azure-portal" class="hash-link" aria-label="Direct link to Using the Azure Portal" title="Direct link to Using the Azure Portal">​</a></h2><p>This section describes the process to deploy a SSR Conductor in HA using the Azure Portal.</p><ol><li><p>Begin with the section <a href="#deploying-the-primary-node-conductor--node-a">Deploying the Primary Node Conductor – Node A</a>.</p></li><li><p>After Node A reboots, click on the name of the VM shown in the Azure Portal (Node A).</p></li><li><p>In the left menu, scroll down to the Support + troubleshooting section and select Reset password.</p><p><img loading="lazy" alt="Support and Troubleshooting" src="/assets/images/CloudHA_azure1-517e61f928092f2bbe13a3a018e177cd.png" width="496" height="342" class="img_ev3q"></p></li><li><p>Enter the username you use to log into the VM via SSH, and enter a temporary password.</p><p><img loading="lazy" alt="Reset Screen" src="/assets/images/CloudHA_azure2-34c64f54c98993dd1564b45ddd6ca8d6.png" width="512" height="254" class="img_ev3q"></p></li><li><p>Click on Save and wait until the request to reset the password is completed.</p><p><img loading="lazy" alt="Update Screen" src="/assets/images/CloudHA_azure3-28d1016d9a277ca8c99b858a0b485e37.png" width="372" height="200" class="img_ev3q"></p><p><img loading="lazy" alt="Notifications Screen" src="/assets/images/CloudHA_azure4-fee2aaceda068b9cca059235ad53595a.png" width="512" height="264" class="img_ev3q"></p></li><li><p>Check the list of notifications to confirm the change.</p></li><li><p>Perform the configuration steps in the section <a href="#deploying-the-secondary-node-conductor--node-b">Deploying the Secondary Node Conductor – Node B</a>.</p></li><li><p>To disable password-based authentication in the primary node of the Conductor using the Azure portal, click on the name of the VM shown in the Azure Portal (Node A).</p></li><li><p>In the left menu, scroll down to the <strong>Support + troubleshooting</strong> section and select Reset password.</p></li></ol><p><img loading="lazy" alt="Support and Troubleshooting" src="/assets/images/CloudHA_azure1-517e61f928092f2bbe13a3a018e177cd.png" width="496" height="342" class="img_ev3q"></p><ol start="10"><li>Select mode “reset SSH public key.”</li></ol><p><img loading="lazy" alt="Reset SSH Key" src="/assets/images/CloudHA_azure5-dd47b36de1df0912abde84abaf6b01b1.png" width="510" height="129" class="img_ev3q"></p><ol start="11"><li>Enter the username and paste the value of the corresponding public SSH key.</li><li>Click on Save and verify the request to reset the SSH key in the notifications list.</li></ol><p>To validate the Conductor has been deployed successfully, refer to the section <a href="#validate-the-ha-conductor-deployment">Validate the HA Conductor Deployment</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-05-01T19:09:50.000Z">May 1, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/intro_installation_azure"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Installing in Azure</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/intro_upgrade_considerations"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Upgrade Considerations</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#deploying-the-primary-node-conductor--node-a" class="table-of-contents__link toc-highlight">Deploying the Primary Node Conductor – Node A</a><ul><li><a href="#configure-node-a" class="table-of-contents__link toc-highlight">Configure Node A</a></li></ul></li><li><a href="#deploying-the-secondary-node-conductor--node-b" class="table-of-contents__link toc-highlight">Deploying the Secondary Node Conductor – Node B</a><ul><li><a href="#disable-password-based-authentication-in-the-primary-node" class="table-of-contents__link toc-highlight">Disable Password-based Authentication in the Primary Node</a></li><li><a href="#validate-the-ha-conductor-deployment" class="table-of-contents__link toc-highlight">Validate the HA Conductor Deployment</a></li></ul></li><li><a href="#using-the-azure-portal" class="table-of-contents__link toc-highlight">Using the Azure Portal</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.05a3e2dc.js"></script>
<script src="/assets/js/main.8efb112e.js"></script>
</body>
</html>
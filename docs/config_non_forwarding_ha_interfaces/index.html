<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">Non-forwarding HA Interfaces | 128T Docs</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="128T Docs"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="Non forwarding interfaces are used for several purposes, including HA peer node control traffic, reaching a 128T Conductor from a 128T Router, reaching managed 128T Routers from a 128T Conductor, management traffic and reaching the public internet."><meta data-react-helmet="true" property="og:description" content="Non forwarding interfaces are used for several purposes, including HA peer node control traffic, reaching a 128T Conductor from a 128T Router, reaching managed 128T Routers from a 128T Conductor, management traffic and reaching the public internet."><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/config_non_forwarding_ha_interfaces">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.71d4e6da.css">


<link rel="preload" href="/styles.f2b4486f.js" as="script">

<link rel="preload" href="/runtime~main.8e28e262.js" as="script">

<link rel="preload" href="/main.745077b2.js" as="script">

<link rel="preload" href="/1.1169400b.js" as="script">

<link rel="preload" href="/2.40f51189.js" as="script">

<link rel="preload" href="/81.86acfc06.js" as="script">

<link rel="preload" href="/20ac7829.2a8b644f.js" as="script">

<link rel="preload" href="/17896441.2d03608c.js" as="script">

<link rel="preload" href="/e211bde1.675f5cea.js" as="script">

</head>
<body>

<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title"></strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://community.128technology.com/home">Interchange</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://www.128technology.com/">Company</a><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Docs</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://community.128technology.com/home">Interchange</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://www.128technology.com/">Company</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/img/128t_black.png" alt="128 Technology Logo"><strong></strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/about_128t">128T</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/CONTRIBUTING">Contributing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_downloading_iso">Downloading ISOs</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation_installer">Installing 128T</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation_bootable_media">Installing From ISO</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation_aws">Installing in AWS</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_ztp">QuickStart</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_creating_bootable_usb">Creating Bootable USB</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_upgrading">Upgrading</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_rollback">Rollback</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_application_discovery">Application Discovery</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_ha_theoryofoperation">HA - Theory of Operation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_interface_types">Interface Types</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_linux_host_networking">Linux Host Networking</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_network_planes">Forwarding Planes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_metrics">Metrics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_machine_communication">Machine Communication</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_session_timer">Session Timers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_glossary">Glossary</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Administration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/config_basics">Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_audit_log">Audit Log</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_dns_proxy">DNS Proxy</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_ldap">LDAP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_ha">High Availability</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_adding_interfaces_to_ha_team">Adding Interfaces to HA Team Interface</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_transition_standalone_to_ha">Transitioning a Conductor from Standalone to HA</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_nat">NAT</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_ospf">OSPF</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_snmp">SNMP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_snmp_metrics">SNMP: User defined metrics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_tenants">Tenants</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_templates">Configuration Templates</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">How To</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/howto_bgp">BGP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/howto_conductor_migration">Conductor Migration</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/howto_maintenance_mode">Maintenance Mode</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/howto_trusted_ca_certificate">Adding a Trusted Certificate</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/howto_tune_bfd">Tuning BFD</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/ts_applications">Application Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_ap_salt_minion">AP: Salt Minion</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_cpu_spikes">CPU Spikes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_connecting_to_routers">Connecting to Routers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_forwarding_resource_pools">Forwarding Plane Resource Pools</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_logs">Logs</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_mac_uniqueness">MAC Address Uniqueness</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Events</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/events_overview">Alarm and Events</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/events_alarms">Alarms</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/events_events">Events</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Best Practices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_conductor_deployment">Conductor Deployment</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_lte_peering">LTE Peering</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_service_and_service_policy_design">Service and Service Policy Design</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_tenants">Tenancy Design</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CLI Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/cli_reference">Reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/plugin_monitoring_agent">Monitoring</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/plugin_gre">GRE Plugin</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">REST APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/api_rest_4.2.0">128T-4.2.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Release Notes</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">128T</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/128t_release_notes_4.3">4.3</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/128t_release_notes_4.2">4.2</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/128t_release_notes_4.1">4.1</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/128t_release_notes_4.0">4.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">128T Installer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/128t_installer_release_notes_2.4">2.4</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/128t_installer_release_notes_2.3">2.3</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/128t_installer_release_notes_2.2">2.2</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/128t_installer_release_notes_2.1">2.1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">128T IPSEC Client</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/128t_ipsec_client_release_notes_2.0">2.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/128t_ipsec_client_release_notes_1.0">1.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">128T SIP ALG</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/128t_sip_alg_release_notes_2.1">2.1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">128T ZScaler</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/128t_zscaler_release_notes_1.1">1.1</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Non-forwarding HA Interfaces</h1></header><div class="markdown"><p>Non forwarding interfaces are used for several purposes, including HA peer node control traffic, reaching a 128T Conductor from a 128T Router, reaching managed 128T Routers from a 128T Conductor, management traffic and reaching the public internet.</p><p>Before we get started, it is important to understand the <a href="concepts_interface_types">terminology relating to 128T interfaces</a></p><div class="admonition admonition-important alert alert--info"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>important</h5></div><div class="admonition-content"><p>Changing a forwarding interface to non forwarding and vice versa is not dynamically reconfigurable and requires a restart of the 128T node</p></div></div><p>A quick recap:</p><p><code>External</code> interfaces are not used for any control traffic to the node&#x27;s HA peer and the user has no limit to how many <code>external</code> interfaces they configure. A user may configure either one <code>fabric</code> or one <code>shared</code> interface per node, and that interface will be used for all HA control traffic.</p><p>This example will configure an interface to be used to establish connectivity between HA peers. To configure a non-forwarding interface, set the <code>forwarding</code> flag to <code>false</code>. This examples uses a <code>device-interface</code> set to type <code>ethernet</code>.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">node    T116_DUT1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name                      T116_DUT1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    device-interface          control</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name               control</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        type               ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        pci-address        0000:00:04.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        forwarding         false</span></div></code></pre></div><p>The next step is to add a <code>network-interface</code>. Start by creating a <code>fabric</code> interface to reach the HA peer node.  <code>fabric</code> was chosen in this situation because the HA nodes are directly connected:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">node    T127_DUT1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name                      T127_DUT1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    device-interface          control</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name               control</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        type               ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        pci-address        0000:00:04.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        forwarding         false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface  peer-fabric-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name       peer-fabric-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            type       fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address    172.16.1.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ip-address     172.16.1.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                prefix-length  24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                gateway        172.16.1.201</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></code></pre></div><p>This interface is needed to establish connectivity to the HA peer node. A similar <code>fabric</code> interface is required on each node of the HA pair.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">node    T127_DUT2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name                      T127_DUT2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    device-interface          control</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name               control</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        type               ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        pci-address        0000:00:04.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        forwarding         false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface  peer-fabric-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name       peer-fabric-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            type       fabric</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            address    172.16.1.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ip-address     172.16.1.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                prefix-length  24</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                gateway        172.16.1.201</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></code></pre></div><p>At this point, it may be a good time to commit the configuration.</p><p>The interfaces created within the 128T configuration will manage corresponding interfaces in Linux. 128T will dynamically update all SSH tunnels which are used to send control traffic to the peer node.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">eth1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        inet6 fe80::f816:3eff:fe4c:5ebe  prefixlen 64  scopeid 0x20&lt;link&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ether fa:16:3e:4c:5e:be  txqueuelen 1000  (Ethernet)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        RX packets 5581689  bytes 1057148542 (1008.1 MiB)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        RX errors 0  dropped 0  overruns 0  frame 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        TX packets 5818989  bytes 1002306918 (955.8 MiB)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">team-eth1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        inet 172.16.1.1  netmask 255.255.255.0  broadcast 172.16.1.255</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        inet6 fe80::f816:3eff:fe4c:5ebe  prefixlen 64  scopeid 0x20&lt;link&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ether fa:16:3e:4c:5e:be  txqueuelen 1000  (Ethernet)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        RX packets 5544219  bytes 977056448 (931.7 MiB)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        RX errors 0  dropped 0  overruns 0  frame 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        TX packets 5777931  bytes 979222766 (933.8 MiB)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        TX errors 0  dropped 2 overruns 0  carrier 0  collisions 0</span></div></code></pre></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>The first time a non-forwarding interface is configured and 128T &quot;takes over&quot; the Linux interfaces, a backup of all the previous ifcfg scripts will be created at <code>/var/run/128technology/network-script-backups.tar.gz</code>.</p></div></div><p>Notice the interfaces are configured as network team because the type was set to <code>fabric</code>. If instead the type was set to <code>shared</code> then interface <code>eth1</code> would have been configured directly with the static IP address.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>info</h5></div><div class="admonition-content"><p>Upon committing configuration changing the control IP addresses, it can take up to <strong>two minutes</strong> for the node to reconnect internally or reconnect to its HA peer node. This delay happens because 128T is waiting for the TCP state machine to close existing connections.  Don&#x27;t panic.  Just sit tight and wait for everything to reconnect.</p></div></div><p>While this example showcases peering with a HA node on a conductor, the configuration and operations are identical for a router.</p><p>Run <code>show system connectivity</code> to ensure that both nodes are connected.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@T127_DUT1.Conductor# show system connectivity</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2019-02-13 16:09:06 UTC</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===================== ===================== ==============</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Local Node            Remote Node           State</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===================== ===================== ==============</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   connected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.11 seconds</span></div></code></pre></div><p>Run <code>show system connectivity internal</code> to confirm that the internal processes are communicating with each other.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@T127_DUT1.Conductor# show system connectivity internal</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2019-02-13 16:09:30 UTC</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===================== ===================== ================= ================= ===========</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Local Node            Remote Node           Service           Address           Message</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===================== ===================== ================= ================= ===========</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT1.Conductor   Zookeeper         127.0.0.1:4370    Connected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT1.Conductor   ssc               127.0.0.2:12222   Connected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT1.Conductor   step-repository   127.0.0.2:15555   Connected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   Internal SSH      127.0.0.1:932     Connected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   LeaderElect       127.0.0.1:2225    Connected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   Quorum            127.0.0.1:2224    Connected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   ZED               127.0.0.1:4392    Connected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   Zookeeper         127.0.0.1:4371    Connected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   influx-rpc        127.0.0.3:8088    Connected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   ssc               127.0.0.3:12222   Connected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   step-repository   127.0.0.3:15555   Connected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   tank              127.0.0.3:11011   Connected</span></div></code></pre></div><p>Now that connectivity has been fully established between HA peer nodes, it is useful to configure some external management interfaces. This example will create an <code>external</code> Ethernet interface using <code>DHCPv4</code>.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">device-interface          mgmt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name               mgmt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type               ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pci-address        0000:00:03.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    forwarding         false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    network-interface  ext-mgmt-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name               ext-mgmt-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        type               external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        default-route      true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        management-vector</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            name      ext-mgmt-vector</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            priority  100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        dhcp               v4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></code></pre></div><p>Notice that some additional fields were configured. The <code>default-route</code> is set to <code>true</code>.  This instructs Linux to set this external interface as the default route for all traffic. Secondly, a <code>management-vector</code> was configured.  This is required when setting the <code>default-route</code> to <code>true</code>. The user is allowed to define multiple interfaces as the <code>default-route</code>, so the <code>management-vector</code> is used to define the priority of all interfaces which are set as the default route.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>If you configure the interface that is currently being used to connect to 128T as an <code>external</code> interface, you will notice your connection hang for a few moments while 128T takes over the interface after the config is committed. Once the commit is complete you will notice the interface&#x27;s ifcfg script has been updated:</p></div></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[root@t127-dut1 ~]# cat /etc/sysconfig/network-scripts/ifcfg-eth0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BOOTPROTO=dhcp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DEFROUTE=yes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DEVICE=eth0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">METRIC=100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">MTU=1500</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">NM_CONTROLLED=no</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ONBOOT=yes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">TYPE=Ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">USERCTL=no</span></div></code></pre></div><p>The goal of this functionality is to eliminate the need for administrators to have to drop to the Linux shell to manually configure interfaces. A configuration field name <code>ifcfg-option</code> was added to the <code>network-interface</code> to allow super users to add any config field directly to an ifcfg script that 128T currently does not support. 128T does validate that the user is not trying to configure any options that 128T already configures to avoid creating conflicts with 128T settings. An example is firewalld zones.  Perhaps this external interface needs to be configured as a trusted interface.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">network-interface  ext-mgmt-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name               ext-mgmt-intf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    global-id          5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type               external</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    default-route      true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    management-vector</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name      ext-mgmt-vector</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        priority  100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dhcp               v4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ifcfg-option       ZONE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        name   ZONE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        value  trusted</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></code></pre></div><p>Upon committing this configuration you will see the ifcfg script get updated with the new value.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[root@t127-dut1 ~]# cat /etc/sysconfig/network-scripts/ifcfg-eth0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BOOTPROTO=dhcp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DEFROUTE=yes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DEVICE=eth0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">METRIC=100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">MTU=1500</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">NM_CONTROLLED=no</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ONBOOT=yes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">TYPE=Ethernet</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">USERCTL=no</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ZONE=trusted</span></div></code></pre></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/128technology/docs/tree/master/docs/config_non_forwarding_ha_interfaces.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-03-12T19:51:29.000Z" class="docLastUpdatedAt_1sqk">3/12/2020</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/config_ha"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« Configuring High Availability (128T Router)</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/config_adding_interfaces_to_ha_team"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Adding Interfaces to HA Team Interface »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"></div></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>Copyright © 2020 128 Technology, Inc.</div></div></div></footer>
</div>

<script src="/styles.f2b4486f.js"></script>

<script src="/runtime~main.8e28e262.js"></script>

<script src="/main.745077b2.js"></script>

<script src="/1.1169400b.js"></script>

<script src="/2.40f51189.js"></script>

<script src="/81.86acfc06.js"></script>

<script src="/20ac7829.2a8b644f.js"></script>

<script src="/17896441.2d03608c.js"></script>

<script src="/e211bde1.675f5cea.js"></script>


</body>
</html>
<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">Non-forwarding HA Interfaces | SSN Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/config_non_forwarding_ha_interfaces"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Non-forwarding HA Interfaces | SSN Docs"><meta data-react-helmet="true" name="description" content="Non forwarding interfaces are used for several purposes, including HA peer node control traffic, reaching a 128T Conductor from a 128T Router, reaching managed 128T Routers from a 128T Conductor, management traffic and reaching the public internet."><meta data-react-helmet="true" property="og:description" content="Non forwarding interfaces are used for several purposes, including HA peer node control traffic, reaching a 128T Conductor from a 128T Router, reaching managed 128T Routers from a 128T Conductor, management traffic and reaching the public internet."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.128technology.com/docs/config_non_forwarding_ha_interfaces"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/config_non_forwarding_ha_interfaces" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/config_non_forwarding_ha_interfaces" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.21b25f22.css">
<link rel="preload" href="/assets/js/runtime~main.89de3d26.js" as="script">
<link rel="preload" href="/assets/js/main.d589b7f3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Session Smart</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Session Smart Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation_aws">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation_installer">Supporting Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/config_basics">Administration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/config_basics">Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" tabindex="0" href="/docs/config_ha">High Availability</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ha">Dual Node High Availability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dual_router_ha">Dual Router High Availability using iBGP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ha_vrrp">Dual Router High Availability and VRRP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_adding_interfaces_to_ha_team">Adding Interfaces to HA Team Interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_transition_standalone_to_ha">Transitioning a Conductor from Standalone to HA</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/sec_adaptive_encrypt">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/how_to_use_app_summary">How To</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/ts_applications">Troubleshooting</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/plugin_intro">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/release_notes_128t_5.5">Release Notes</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="theme-doc-markdown markdown"><header><h1>Non-forwarding HA Interfaces</h1></header><p>Non forwarding interfaces are used for several purposes, including HA peer node control traffic, reaching a 128T Conductor from a 128T Router, reaching managed 128T Routers from a 128T Conductor, management traffic and reaching the public internet.</p><p>Before we get started, it is important to understand the <a href="/docs/concepts_interface_types">terminology relating to 128T interfaces</a></p><div class="admonition admonition-important alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</h5></div><div class="admonition-content"><p>Changing a forwarding interface to non forwarding and vice versa is not dynamically reconfigurable and requires a restart of the 128T node</p></div></div><p>A quick recap:</p><p><code>External</code> interfaces are not used for any control traffic to the node&#x27;s HA peer and the user has no limit to how many <code>external</code> interfaces they configure. A user may configure either one <code>fabric</code> or one <code>shared</code> interface per node, and that interface will be used for all HA control traffic.</p><p>This example will configure an interface to be used to establish connectivity between HA peers. To configure a non-forwarding interface, set the <code>forwarding</code> flag to <code>false</code>. This example uses a <code>device-interface</code> set to type <code>ethernet</code>.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">node    T116_DUT1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name                      T116_DUT1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    device-interface          control</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name               control</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        type               ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        pci-address        0000:00:04.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        forwarding         false</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The next step is to add a <code>network-interface</code>. Start by creating a <code>fabric</code> interface to reach the HA peer node.  <code>fabric</code> was chosen in this situation because the HA nodes are directly connected:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">node    T127_DUT1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name                      T127_DUT1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    device-interface          control</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name               control</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        type               ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        pci-address        0000:00:04.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        forwarding         false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface  peer-fabric-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name       peer-fabric-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type       fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address    172.16.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ip-address     172.16.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                gateway        172.16.1.201</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This interface is needed to establish connectivity to the HA peer node. A similar <code>fabric</code> interface is required on each node of the HA pair.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">node    T127_DUT2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name                      T127_DUT2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    device-interface          control</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name               control</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        type               ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        pci-address        0000:00:04.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        forwarding         false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface  peer-fabric-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name       peer-fabric-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type       fabric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address    172.16.1.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ip-address     172.16.1.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                gateway        172.16.1.201</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>At this point, it may be a good time to commit the configuration.</p><p>The interfaces created within the 128T configuration will manage corresponding interfaces in Linux. 128T will dynamically update all SSH tunnels which are used to send control traffic to the peer node.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eth1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        inet6 fe80::f816:3eff:fe4c:5ebe  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ether fa:16:3e:4c:5e:be  txqueuelen 1000  (Ethernet)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        RX packets 5581689  bytes 1057148542 (1008.1 MiB)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        RX errors 0  dropped 0  overruns 0  frame 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        TX packets 5818989  bytes 1002306918 (955.8 MiB)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">team-eth1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        inet 172.16.1.1  netmask 255.255.255.0  broadcast 172.16.1.255</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        inet6 fe80::f816:3eff:fe4c:5ebe  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ether fa:16:3e:4c:5e:be  txqueuelen 1000  (Ethernet)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        RX packets 5544219  bytes 977056448 (931.7 MiB)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        RX errors 0  dropped 0  overruns 0  frame 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        TX packets 5777931  bytes 979222766 (933.8 MiB)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        TX errors 0  dropped 2 overruns 0  carrier 0  collisions 0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The first time a non-forwarding interface is configured and 128T &quot;takes over&quot; the Linux interfaces, a backup of all the previous ifcfg scripts will be created at <code>/var/run/128technology/network-script-backups.tar.gz</code>.</p></div></div><p>Notice the interfaces are configured as network team because the type was set to <code>fabric</code>. If instead the type was set to <code>shared</code> then interface <code>eth1</code> would have been configured directly with the static IP address.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Upon committing configuration changing the control IP addresses, it can take up to <strong>two minutes</strong> for the node to reconnect internally or reconnect to its HA peer node. This delay happens because 128T is waiting for the TCP state machine to close existing connections.  Don&#x27;t panic.  Just sit tight and wait for everything to reconnect.</p></div></div><p>While this example showcases peering with a HA node on a conductor, the configuration and operations are identical for a router.</p><p>Run <code>show system connectivity</code> to ensure that both nodes are connected.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@T127_DUT1.Conductor# show system connectivity</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2019-02-13 16:09:06 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">===================== ===================== ==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Local Node            Remote Node           State</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">===================== ===================== ==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.11 seconds</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Run <code>show system connectivity internal</code> to confirm that the internal processes are communicating with each other.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@T127_DUT1.Conductor# show system connectivity internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2019-02-13 16:09:30 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">===================== ===================== ================= ================= ===========</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Local Node            Remote Node           Service           Address           Message</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">===================== ===================== ================= ================= ===========</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT1.Conductor   Zookeeper         127.0.0.1:4370    Connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT1.Conductor   ssc               127.0.0.2:12222   Connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT1.Conductor   step-repository   127.0.0.2:15555   Connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   Internal SSH      127.0.0.1:932     Connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   LeaderElect       127.0.0.1:2225    Connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   Quorum            127.0.0.1:2224    Connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   ZED               127.0.0.1:4392    Connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   Zookeeper         127.0.0.1:4371    Connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   influx-rpc        127.0.0.3:8088    Connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   ssc               127.0.0.3:12222   Connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   step-repository   127.0.0.3:15555   Connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> T127_DUT1.Conductor   T127_DUT2.Conductor   tank              127.0.0.3:11011   Connected</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Now that connectivity has been fully established between HA peer nodes, it is useful to configure some external management interfaces. This example will create an <code>external</code> Ethernet interface using <code>DHCPv4</code>.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">device-interface          mgmt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name               mgmt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type               ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pci-address        0000:00:03.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    forwarding         false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    network-interface  ext-mgmt-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name               ext-mgmt-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        type               external</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        default-route      true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        management-vector</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name      ext-mgmt-vector</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            priority  100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dhcp               v4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Notice that some additional fields were configured. The <code>default-route</code> is set to <code>true</code>.  This instructs Linux to set this external interface as the default route for all traffic. Secondly, a <code>management-vector</code> was configured.  This is required when setting the <code>default-route</code> to <code>true</code>. The user is allowed to define multiple interfaces as the <code>default-route</code>, so the <code>management-vector</code> is used to define the priority of all interfaces which are set as the default route.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If you configure the interface that is currently being used to connect to 128T as an <code>external</code> interface, you will notice your connection hang for a few moments while 128T takes over the interface after the config is committed. Once the commit is complete you will notice the interface&#x27;s ifcfg script has been updated:</p></div></div><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[root@t127-dut1 ~]# cat /etc/sysconfig/network-scripts/ifcfg-eth0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BOOTPROTO=dhcp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFROUTE=yes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEVICE=eth0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">METRIC=100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MTU=1500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NM_CONTROLLED=no</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ONBOOT=yes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TYPE=Ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">USERCTL=no</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The goal of this functionality is to eliminate the need for administrators to have to drop to the Linux shell to manually configure interfaces. A configuration field name <code>ifcfg-option</code> was added to the <code>network-interface</code> to allow super users to add any config field directly to an ifcfg script that 128T currently does not support. 128T does validate that the user is not trying to configure any options that 128T already configures to avoid creating conflicts with 128T settings. An example is firewalld zones.  Perhaps this external interface needs to be configured as a trusted interface.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">network-interface  ext-mgmt-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name               ext-mgmt-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    global-id          5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type               external</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    default-route      true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    management-vector</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name      ext-mgmt-vector</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        priority  100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dhcp               v4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ifcfg-option       ZONE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name   ZONE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        value  trusted</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Upon committing this configuration you will see the ifcfg script get updated with the new value.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[root@t127-dut1 ~]# cat /etc/sysconfig/network-scripts/ifcfg-eth0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BOOTPROTO=dhcp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFROUTE=yes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEVICE=eth0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">METRIC=100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MTU=1500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NM_CONTROLLED=no</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ONBOOT=yes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TYPE=Ethernet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">USERCTL=no</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ZONE=trusted</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-03-30T16:31:24.000Z">3/30/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/config_ha_vrrp"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Dual Router High Availability and VRRP</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/config_adding_interfaces_to_ha_team"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Adding Interfaces to HA Team Interface</div></a></div></nav></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.89de3d26.js"></script>
<script src="/assets/js/main.d589b7f3.js"></script>
</body>
</html>
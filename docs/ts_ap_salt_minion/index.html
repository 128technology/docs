<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">Automated Provisioner: Salt Minion | 128T Docs</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="128T Docs"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="This document describes the process for troubleshooting issues with Automated Provisioning (AP) using Salt."><meta data-react-helmet="true" property="og:description" content="This document describes the process for troubleshooting issues with Automated Provisioning (AP) using Salt."><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/ts_ap_salt_minion">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.71d4e6da.css">


<link rel="preload" href="/styles.f40a9954.js" as="script">

<link rel="preload" href="/runtime~main.74af9032.js" as="script">

<link rel="preload" href="/main.73a08333.js" as="script">

<link rel="preload" href="/1.0b81d69d.js" as="script">

<link rel="preload" href="/2.237cb5db.js" as="script">

<link rel="preload" href="/65.ec3378fa.js" as="script">

<link rel="preload" href="/20ac7829.31427b13.js" as="script">

<link rel="preload" href="/17896441.9d4a5710.js" as="script">

<link rel="preload" href="/1bb8506c.d4bc6695.js" as="script">

</head>
<body>

<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title"></strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://community.128technology.com/home">Interchange</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://www.128technology.com/">Company</a><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Docs</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://community.128technology.com/home">Interchange</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://www.128technology.com/">Company</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/img/128t_black.png" alt="128 Technology Logo"><strong></strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/about_128t">128T</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/CONTRIBUTING">Contributing</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Release Notes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/release_notes_4.2.0">4.2.0 Release Notes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/release_notes/release_notes_4.2.1">4.2.1 Release Notes</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_downloading_iso">Downloading ISOs</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation_installer">Installing 128T</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation_bootable_media">Installing From ISO</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_installation_aws">Installing in AWS</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_ztp">QuickStart</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_creating_bootable_usb">Creating Bootable USB</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_upgrading">Upgrading</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro_rollback">Rollback</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_application_discovery">Application Discovery</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_ha_theoryofoperation">HA - Theory of Operation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_interface_types">Interface Types</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_linux_host_networking">Linux Host Networking</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_network_planes">Forwarding Planes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_machine_communication">Machine Communication</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_session_timer">Session Timers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/concepts_glossary">Glossary</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Administration</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/config_basics">Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_audit_log">Audit Log</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_dns_proxy">DNS Proxy</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_ldap">LDAP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_ha">High Availability</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_adding_interfaces_to_ha_team">Adding Interfaces to HA Team Interface</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_transition_standalone_to_ha">Transitioning a Conductor from Standalone to HA</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_nat">NAT</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_snmp">SNMP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_snmp_metrics">SNMP: User defined metrics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/config_tenants">Tenants</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">How To</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/howto_bgp">BGP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/howto_trusted_ca_certificate">Adding a Trusted Certificate</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/ts_applications">Application Troubleshooting</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/ts_ap_salt_minion">AP: Salt Minion</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_cpu_spikes">CPU Spikes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_connecting_to_routers">Connecting to Routers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_forwarding_resource_pools">Forwarding Plane Resource Pools</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ts_mac_uniqueness">MAC Address Uniqueness</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Events</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/events_overview">Alarm and Events</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/events_alarms">Alarms</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/events_events">Events</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Best Practices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_conductor_deployment">Conductor Deployment</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_lte_peering">LTE Peering</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_service_and_service_policy_design">Service and Service Policy Design</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/bcp_tenants">Tenancy Design</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CLI Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/cli_reference">Reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/plugin_monitoring_agent">Monitoring</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/plugin_gre">GRE Plugin</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/apis_rest">REST</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/apis_netconf">NETCONF</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Automated Provisioner: Salt Minion</h1></header><div class="markdown"><p>This document describes the process for troubleshooting issues with Automated Provisioning (AP) using Salt.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>The terms &quot;master&quot; and &quot;conductor&quot; are used interchangeably throughout this document. &quot;Master&quot; refers to the salt-master process running on conductor, which orchestrates tasks for AP.  Also the terms &quot;minion&quot;, &quot;salt-minion&quot; and &quot;asset&quot; are used interchangeably throughout this document. &quot;Minion&quot; runs on an &quot;asset&quot;, or system hosting a 128T router. Minions are responsible for carrying out tasks on the host, given to it by the master.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="symptoms"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#symptoms" title="Direct link to heading">#</a>Symptoms</h2><p>There are several conditions which are symptomatic of issues which may be affecting AP, such as asset disconnected from conductor and general asset errors. These can be seen from conductor CLI using the <code>show assets</code> command with a provided asset-id. For example:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor# show assets asset-id</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2019-08-21 19:45:35 EDT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">=======================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> asset-id</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">=======================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Router:                  my-router</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Node:                    node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Current Version:         None</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Status:                  disconnected</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> -----------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Software Versions Information</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> -----------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Refresh In Progress:     False</span></div></code></pre></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor# show assets asset-id</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2019-08-26 19:45:12 EDT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">=============================================================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> asset-id</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">=============================================================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Router:                  my-router</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Node:                    node1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Current Version:         4.1.4-1.el7.centos</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Status:                  running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Failed Status:           running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> ------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Errors</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> ------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> reverse-ssh_conductor1_login_unit: Unable to manage file: Message timed out</span></div></code></pre></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="root-cause"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#root-cause" title="Direct link to heading">#</a>Root Cause</h2><p>At certain times some errors that are seen may be transient during periods of intermittent connectivity, or while the salt master corrects things found in the incorrect state on the minion. Errors that persist are often the result of issues with connectivity between the minion and conductor, or the minion timing out tying to complete tasks given to it by the master.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="steps-to-rectify"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#steps-to-rectify" title="Direct link to heading">#</a>Steps to Rectify</h2><p>Throughout the lifecycle of a 128T asset, some errors are normal and will clear on their own over time. The first steps are to ensure there is working connectivity between the minion and the master.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="diagnosing-the-issues"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#diagnosing-the-issues" title="Direct link to heading">#</a>Diagnosing the issues</h3><p>The following steps can help diagnose issues with salt-minion which may be affecting AP:</p><ul><li>Ensure that the <code>salt-minion</code> process is running:</li></ul><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[t128@host ~]$ sudo systemctl status salt-minion</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">● salt-minion.service - The Salt Minion</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Loaded: loaded (/usr/lib/systemd/system/salt-minion.service; enabled; vendor preset: disabled)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Drop-In: /usr/lib/systemd/system/salt-minion.service.d</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           └─restartAlways.conf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Active: active (running) since Wed 2019-08-28 09:23:19 PDT; 6min ago</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     Docs: man:salt-minion(1)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           file:///usr/share/doc/salt/html/contents.html</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           https://docs.saltstack.com/en/latest/contents.html</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Main PID: 5036 (salt-minion)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Tasks: 14</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Memory: 92.0M</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   CGroup: /system.slice/salt-minion.service</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           ├─5036 /usr/bin/python /usr/bin/salt-minion</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           ├─5039 /usr/bin/python /usr/bin/salt-minion</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           └─5058 /usr/bin/python /usr/bin/salt-minion</span></div></code></pre></div><ul><li>Ensure the host has a working route to conductor by inspecting the route table. For example the following host has a default route via the <code>kni254</code> data interface:</li></ul><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[t128@host ~]$ ip r l</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">default via 169.254.127.126 dev kni254</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">169.254.0.0/16 dev kni254 scope link metric 1009</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">169.254.127.126/31 dev kni254 proto kernel scope link src 169.254.127.127</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">169.254.253.128/30 dev habr proto kernel scope link src 169.254.253.130 metric 425</span></div></code></pre></div><ul><li>Verify that the minion is successfully opening connections to the master on TCP port 4505 and 4506. For example, you can use the <code>ss</code> Linux utility to look for active sockets:</li></ul><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[t128@host ~]$ sudo ss -ptn | grep -E &#x27;(4505|4506)&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ESTAB      0      162    169.254.127.127:39308              128.128.128.128:4506                users:((&quot;salt-minion&quot;,pid=5234,fd=24))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ESTAB      0      0      169.254.127.127:35024              128.128.128.128:4505                users:((&quot;salt-minion&quot;,pid=5234,fd=19),(&quot;salt-minion&quot;,pid=5039,fd=19))</span></div></code></pre></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>Connections on TCP port 4506 are transient, and only exist when the minion needs to report information back to the master. Seeing a none, or a varying number of connections being opened on TCP port 4506 is normal.</p></div></div><ul><li>If you suspect network issues are impacting the minion&#x27;s ability to function, you can further diagnose by verifying packets are flowing as expected on the wire using <code>tcpdump</code>. For example:</li></ul><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[t128@host ~]$ sudo tcpdump -i any &#x27;tcp port 4505 or tcp port 4506&#x27; -nnN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tcpdump: verbose output suppressed, use -v or -vv for full protocol decode</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">listening on any, link-type LINUX_SLL (Linux cooked), capture size 262144 bytes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:55.380670 IP 128.128.128.128.4505 &gt; 169.254.127.127.35024: Flags [.], ack 1309158047, win 219, options [nop,nop,TS val 2905329152 ecr 1874888070], length 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:55.380703 IP 169.254.127.127.35024 &gt; 128.128.128.128.4505: Flags [.], ack 1, win 544, options [nop,nop,TS val 1874908102 ecr 2905322513], length 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:56.892259 IP 169.254.127.127.39500 &gt; 128.128.128.128.4506: Flags [S], seq 1973885769, win 29200, options [mss 1460,sackOK,TS val 1874909613 ecr 0,nop,wscale 7], length 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:56.982670 IP 128.128.128.128.4506 &gt; 169.254.127.127.39500: Flags [S.], seq 2047989050, ack 1973885770, win 26847, options [mss 1460,sackOK,TS val 2905330754 ecr 1874909613,nop,wscale 7], length 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:56.982752 IP 169.254.127.127.39500 &gt; 128.128.128.128.4506: Flags [.], ack 1, win 229, options [nop,nop,TS val 1874909704 ecr 2905330754], length 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:56.983720 IP 169.254.127.127.39500 &gt; 128.128.128.128.4506: Flags [P.], seq 1:499, ack 1, win 229, options [nop,nop,TS val 1874909705 ecr 2905330754], length 498</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:57.073622 IP 128.128.128.128.4506 &gt; 169.254.127.127.39500: Flags [.], ack 499, win 219, options [nop,nop,TS val 2905330844 ecr 1874909705], length 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:57.075619 IP 128.128.128.128.4506 &gt; 169.254.127.127.39500: Flags [P.], seq 1:85, ack 499, win 219, options [nop,nop,TS val 2905330847 ecr 1874909705], length 84</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:57.075648 IP 169.254.127.127.39500 &gt; 128.128.128.128.4506: Flags [.], ack 85, win 229, options [nop,nop,TS val 1874909797 ecr 2905330847], length 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:57.077239 IP 169.254.127.127.39500 &gt; 128.128.128.128.4506: Flags [F.], seq 499, ack 85, win 229, options [nop,nop,TS val 1874909798 ecr 2905330847], length 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:57.168641 IP 128.128.128.128.4506 &gt; 169.254.127.127.39500: Flags [F.], seq 85, ack 500, win 219, options [nop,nop,TS val 2905330940 ecr 1874909798], length 0</span></div></code></pre></div><p>If the <code>salt-minion</code> does not appear to be attempting connections to master, or has healthy connections to conductor but continues to have persistent errors, you can try restarting <code>salt-minion</code>:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo systemctl restart salt-minion</span></div></code></pre></div><p>If it appears there are connectivity issues that are preventing AP from functioning, correct any networking issues that exist.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/128technology/docs/tree/master/docs/ts_ap_salt_minion.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-03-19T15:03:11.000Z" class="docLastUpdatedAt_1sqk">3/19/2020</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/ts_applications"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« Application Troubleshooting</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/ts_cpu_spikes"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">CPU Spikes »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#symptoms" class="contents__link">Symptoms</a></li><li><a href="#root-cause" class="contents__link">Root Cause</a></li><li><a href="#steps-to-rectify" class="contents__link">Steps to Rectify</a><ul><li><a href="#diagnosing-the-issues" class="contents__link">Diagnosing the issues</a></li></ul></li></ul></div></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>Copyright © 2020 128 Technology, Inc.</div></div></div></footer>
</div>

<script src="/styles.f40a9954.js"></script>

<script src="/runtime~main.74af9032.js"></script>

<script src="/main.73a08333.js"></script>

<script src="/1.0b81d69d.js"></script>

<script src="/2.237cb5db.js"></script>

<script src="/65.ec3378fa.js"></script>

<script src="/20ac7829.31427b13.js"></script>

<script src="/17896441.9d4a5710.js"></script>

<script src="/1bb8506c.d4bc6695.js"></script>


</body>
</html>
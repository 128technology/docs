<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">Automated Provisioner: Salt Minion | SSN Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/ts_ap_salt_minion"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Automated Provisioner: Salt Minion | SSN Docs"><meta data-react-helmet="true" name="description" content="This document describes the process for troubleshooting issues with Automated Provisioning (AP) using Salt."><meta data-react-helmet="true" property="og:description" content="This document describes the process for troubleshooting issues with Automated Provisioning (AP) using Salt."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.128technology.com/docs/ts_ap_salt_minion"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/ts_ap_salt_minion" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.128technology.com/docs/ts_ap_salt_minion" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.21b25f22.css">
<link rel="preload" href="/assets/js/runtime~main.2345cacc.js" as="script">
<link rel="preload" href="/assets/js/main.555dbe5a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Session Smart</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Session Smart Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation_image">Image-Based Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/supported_cloud_platforms">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_upgrade_considerations">Upgrades and Rollback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/intro_installation_installer">Supporting Install Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/config_basics">Administration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/config_basics">Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/howto_tune_bfd">Optimizing Routing Protocols</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/config_ha">High Availability</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/config_access_mgmt">Access Management and Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/config_ntp_auth">NTP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/sec_adaptive_encrypt">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/concepts_ssr_idp">Intrusion Detection and Prevention</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/config_STEP">Service and Topology Exchange Protocol (STEP)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/how_to_use_app_summary">How To</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" tabindex="0" href="/docs/ts_applications">Troubleshooting</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_applications">Application Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_ap_duplicate_assets">AP: Duplicate Asset ID Error</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/ts_ap_salt_minion">AP: Salt Minion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_cpu_spikes">CPU Spikes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_connecting_to_routers">Connecting to Routers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_forwarding_resource_pools">Forwarding Plane Resource Pools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_logs">Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_mac_uniqueness">MAC Address Uniqueness</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_packet_capture">Packet Capture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_t1_troubleshooting">T1 Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_troubleshooting_vrf">Troubleshooting VRF</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/plugin_intro">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/release_notes_128t_6.0">Release Notes</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Automated Provisioner: Salt Minion</h1></header><p>This document describes the process for troubleshooting issues with Automated Provisioning (AP) using Salt.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The terms &quot;salt-master&quot; and &quot;conductor&quot; are used interchangeably throughout this document. &quot;Salt-master&quot; refers to the salt-master process running on the conductor, which orchestrates tasks for AP.  Also the terms &quot;minion&quot;, &quot;salt-minion&quot; and &quot;asset&quot; are used interchangeably throughout this document. &quot;Minion&quot; runs on an &quot;asset&quot;, or system hosting a 128T router. Minions are responsible for carrying out tasks on the host, given to it by the salt-master.</p></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="symptoms">Symptoms<a class="hash-link" href="#symptoms" title="Direct link to heading">​</a></h2><p>There are several conditions which are symptomatic of issues which may be affecting AP, such as asset disconnected from conductor and general asset errors. These can be seen from conductor CLI using the <code>show assets</code> command with a provided asset-id. For example:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor# show assets asset-id</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2019-08-21 19:45:35 EDT</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=======================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> asset-id</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=======================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Router:                  my-router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Node:                    node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Current Version:         None</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Status:                  disconnected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> -----------------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Software Versions Information</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> -----------------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Refresh In Progress:     False</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor# show assets asset-id</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2019-08-26 19:45:12 EDT</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=============================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> asset-id</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=============================================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Router:                  my-router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Node:                    node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Current Version:         4.1.4-1.el7.centos</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Status:                  running</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Failed Status:           running</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Errors</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> reverse-ssh_conductor1_login_unit: Unable to manage file: Message timed out</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="root-cause">Root Cause<a class="hash-link" href="#root-cause" title="Direct link to heading">​</a></h2><p>At certain times some errors that are seen may be transient during periods of intermittent connectivity, or while the salt-master corrects things found in the incorrect state on the minion. Errors that persist are often the result of issues with connectivity between the minion and conductor, or the minion timing out tying to complete tasks given to it by the salt-master.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="steps-to-rectify">Steps to Rectify<a class="hash-link" href="#steps-to-rectify" title="Direct link to heading">​</a></h2><p>Throughout the lifecycle of a 128T asset, some errors are normal and will clear on their own over time. The first steps are to ensure there is working connectivity between the minion and the salt-master.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="diagnosing-the-issues">Diagnosing the issues<a class="hash-link" href="#diagnosing-the-issues" title="Direct link to heading">​</a></h3><p>The following steps can help diagnose issues with salt-minion which may be affecting AP:</p><ul><li>Ensure that the <code>salt-minion</code> process is running:</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[t128@host ~]$ sudo systemctl status salt-minion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">● salt-minion.service - The Salt Minion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Loaded: loaded (/usr/lib/systemd/system/salt-minion.service; enabled; vendor preset: disabled)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Drop-In: /usr/lib/systemd/system/salt-minion.service.d</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           └─restartAlways.conf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Active: active (running) since Wed 2019-08-28 09:23:19 PDT; 6min ago</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     Docs: man:salt-minion(1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           file:///usr/share/doc/salt/html/contents.html</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           https://docs.saltstack.com/en/latest/contents.html</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Main PID: 5036 (salt-minion)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Tasks: 14</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Memory: 92.0M</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   CGroup: /system.slice/salt-minion.service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           ├─5036 /usr/bin/python /usr/bin/salt-minion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           ├─5039 /usr/bin/python /usr/bin/salt-minion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           └─5058 /usr/bin/python /usr/bin/salt-minion</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>Ensure the host has a working route to conductor by inspecting the route table. For example the following host has a default route via the <code>kni254</code> data interface:</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[t128@host ~]$ ip r l</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">default via 169.254.127.126 dev kni254</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">169.254.0.0/16 dev kni254 scope link metric 1009</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">169.254.127.126/31 dev kni254 proto kernel scope link src 169.254.127.127</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">169.254.253.128/30 dev habr proto kernel scope link src 169.254.253.130 metric 425</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>Verify that the minion is successfully opening connections to the salt-master on TCP port 4505 and 4506. For example, you can use the <code>ss</code> Linux utility to look for active sockets:</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[t128@host ~]$ sudo ss -ptn | grep -E &#x27;(4505|4506)&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ESTAB      0      162    169.254.127.127:39308              128.128.128.128:4506                users:((&quot;salt-minion&quot;,pid=5234,fd=24))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ESTAB      0      0      169.254.127.127:35024              128.128.128.128:4505                users:((&quot;salt-minion&quot;,pid=5234,fd=19),(&quot;salt-minion&quot;,pid=5039,fd=19))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Connections on TCP port 4506 are transient, and only exist when the minion needs to report information back to the salt-master. Seeing a none, or a varying number of connections being opened on TCP port 4506 is normal.</p></div></div><ul><li>If you suspect network issues are impacting the minion&#x27;s ability to function, you can further diagnose by verifying packets are flowing as expected on the wire using <code>tcpdump</code>. For example:</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[t128@host ~]$ sudo tcpdump -i any &#x27;tcp port 4505 or tcp port 4506&#x27; -nnN</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tcpdump: verbose output suppressed, use -v or -vv for full protocol decode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">listening on any, link-type LINUX_SLL (Linux cooked), capture size 262144 bytes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:55.380670 IP 128.128.128.128.4505 &gt; 169.254.127.127.35024: Flags [.], ack 1309158047, win 219, options [nop,nop,TS val 2905329152 ecr 1874888070], length 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:55.380703 IP 169.254.127.127.35024 &gt; 128.128.128.128.4505: Flags [.], ack 1, win 544, options [nop,nop,TS val 1874908102 ecr 2905322513], length 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:56.892259 IP 169.254.127.127.39500 &gt; 128.128.128.128.4506: Flags [S], seq 1973885769, win 29200, options [mss 1460,sackOK,TS val 1874909613 ecr 0,nop,wscale 7], length 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:56.982670 IP 128.128.128.128.4506 &gt; 169.254.127.127.39500: Flags [S.], seq 2047989050, ack 1973885770, win 26847, options [mss 1460,sackOK,TS val 2905330754 ecr 1874909613,nop,wscale 7], length 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:56.982752 IP 169.254.127.127.39500 &gt; 128.128.128.128.4506: Flags [.], ack 1, win 229, options [nop,nop,TS val 1874909704 ecr 2905330754], length 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:56.983720 IP 169.254.127.127.39500 &gt; 128.128.128.128.4506: Flags [P.], seq 1:499, ack 1, win 229, options [nop,nop,TS val 1874909705 ecr 2905330754], length 498</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:57.073622 IP 128.128.128.128.4506 &gt; 169.254.127.127.39500: Flags [.], ack 499, win 219, options [nop,nop,TS val 2905330844 ecr 1874909705], length 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:57.075619 IP 128.128.128.128.4506 &gt; 169.254.127.127.39500: Flags [P.], seq 1:85, ack 499, win 219, options [nop,nop,TS val 2905330847 ecr 1874909705], length 84</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:57.075648 IP 169.254.127.127.39500 &gt; 128.128.128.128.4506: Flags [.], ack 85, win 229, options [nop,nop,TS val 1874909797 ecr 2905330847], length 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:57.077239 IP 169.254.127.127.39500 &gt; 128.128.128.128.4506: Flags [F.], seq 499, ack 85, win 229, options [nop,nop,TS val 1874909798 ecr 2905330847], length 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">09:34:57.168641 IP 128.128.128.128.4506 &gt; 169.254.127.127.39500: Flags [F.], seq 85, ack 500, win 219, options [nop,nop,TS val 2905330940 ecr 1874909798], length 0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If the <code>salt-minion</code> does not appear to be attempting connections to salt-master, or has healthy connections to conductor but continues to have persistent errors, you can try restarting <code>salt-minion</code>:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo systemctl restart salt-minion</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If it appears there are connectivity issues that are preventing AP from functioning, correct any networking issues that exist.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-11-18T13:48:10.000Z">11/18/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/ts_ap_duplicate_assets"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">AP: Duplicate Asset ID Error</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/ts_cpu_spikes"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">CPU Spikes</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#symptoms" class="table-of-contents__link toc-highlight">Symptoms</a></li><li><a href="#root-cause" class="table-of-contents__link toc-highlight">Root Cause</a></li><li><a href="#steps-to-rectify" class="table-of-contents__link toc-highlight">Steps to Rectify</a><ul><li><a href="#diagnosing-the-issues" class="table-of-contents__link toc-highlight">Diagnosing the issues</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2345cacc.js"></script>
<script src="/assets/js/main.555dbe5a.js"></script>
</body>
</html>
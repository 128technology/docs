<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-config_bgp" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Border Gateway Protocol (BGP) | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/docs/config_bgp"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Border Gateway Protocol (BGP) | SSN Docs"><meta data-rh="true" name="description" content="The Border Gateway Protocol (BGP) is a standard exterior gateway protocol developed for exchanging routing and reachability information between Autonomous Systems, a collection of IP routing prefixes managed by a single administrative entity. BGP makes routing decisions based on paths and network policies; although historically mainly seen in service provider networks, it is now gaining acceptance in large enterprise networks. BGP can also be used for routing within an autonomous system as an interior gateway protocol; when doing so it is referred to as iBGP."><meta data-rh="true" property="og:description" content="The Border Gateway Protocol (BGP) is a standard exterior gateway protocol developed for exchanging routing and reachability information between Autonomous Systems, a collection of IP routing prefixes managed by a single administrative entity. BGP makes routing decisions based on paths and network policies; although historically mainly seen in service provider networks, it is now gaining acceptance in large enterprise networks. BGP can also be used for routing within an autonomous system as an interior gateway protocol; when doing so it is referred to as iBGP."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/docs/config_bgp"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/config_bgp" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/config_bgp" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.e30a7dc4.css">
<script src="/assets/js/runtime~main.fbc0371a.js" defer="defer"></script>
<script src="/assets/js/main.1d489193.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cc_fips_titlepage">SSR Common Criteria Install and Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/install_conductor_overview">Conductor Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_bootable_media">Router Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_image">Image-Based Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported_cloud_platforms">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_upgrade_considerations">Upgrades and Rollback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_installer">Supporting Install Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/config_basics">Administration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_basics">Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/concepts_appid">Application Identification</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/howto_tune_bfd">Optimizing Routing Protocols</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/howto_tune_bfd">Tuning BFD</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_session_optimization">TCP Session Optimization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/config_bgp">BGP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_vrf_route_leaking">VRF Route Leaking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ospf">OSPF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_bfd">BFD with BGP and OSPF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_multicast">Multicast</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_lacp">Link Aggregation and LACP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dhcp">DHCP</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_ha">High Availability</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_access_mgmt">Access Management and Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_ntp_auth">NTP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/sec_adaptive_encrypt">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/concepts_ssr_idp">Intrusion Detection and Prevention</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_STEP">Service and Topology Exchange Protocol (STEP)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/how_to_local_config_override">How To</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/ts_applications">Troubleshooting</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/plugin_intro">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/release_notes_128t_6.2">Release Notes</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Administration</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Optimizing Routing Protocols</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">BGP</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Border Gateway Protocol (BGP)</h1></header><p>The Border Gateway Protocol (BGP) is a standard exterior gateway protocol developed for exchanging routing and reachability information between Autonomous Systems, a collection of IP routing prefixes managed by a single administrative entity. BGP makes routing decisions based on paths and network policies; although historically mainly seen in service provider networks, it is now gaining acceptance in large enterprise networks. BGP can also be used for routing within an autonomous system as an interior gateway protocol; when doing so it is referred to as iBGP.</p>
<p>Learning routes from BGP simplifies enterprise configuration and integration with Secure Vector Routing. In this configuration guide we will also discuss a SSR-specific feature referred to as &quot;BGP over SVR&quot; (or BGPoSVR), which combines the power of Secure Vector Routing with the rich feature set of the BGP protocol.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<p>This section presumes that you have a running SSR system and wants to add configuration to support BGP. The running SSR system should already include configuration for basic platform functionality (e.g., <code>router</code>, <code>node</code>, <code>device-interface</code>, <code>network-interface</code>) and basic SSR modeling configuration (e.g., tenants, services, etc.). Refer to the <a href="/docs/config_reference_guide">Element Reference</a> section of our documentation for a better understanding about basics of the SSR data model.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="peering-with-non-ssr-routers">Peering with non-SSR Routers<a href="#peering-with-non-ssr-routers" class="hash-link" aria-label="Direct link to Peering with non-SSR Routers" title="Direct link to Peering with non-SSR Routers">​</a></h2>
<p>The BGP configuration exists in the <a href="/docs/config_reference_guide#routing-per-router"><code>routing</code></a> configuration container within the SSR data model. For any routing configuration, static or dynamic, a default routing instance called <code>default-instance</code> must be defined in the SSR configuration.</p>
<p>In this example we will assume that BGP is configured on the peering router with IP address 1.1.1.1, as autonomous system number (ASN) 6000.</p>
<ol>
<li>To peer the SSR with this router, configure BGP on our SSR using the following commands:</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# config auth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (authority)# router seattlesite1 </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# routing default-instance</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Every SSR router (in this case, the router named <code>seattlesite1</code>), contains all of its legacy routing protocol information within the <code>default-instance</code> routing container.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing[type=default-instance])# routing-protocol bgp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Enter into the BGP portion of the routing configuration model; set the local autonomous system number to 100, and set the router ID to 1.1.1.128.</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# local-as 100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# router-id 1.1.1.128</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Configure the <code>address-family</code> using <code>ipv4-unicast</code>. At least one <code>address-family</code>must be configured, and typically is set as <code>ipv4-unicast</code>. If your deployment uses other address families (e.g., IPv6) or routes multicast, you may also need to configure support for other address families.</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# address-family ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Address families are also sometimes referred to as &quot;AFI-SAFI&quot; (pronounced &quot;affy-saffy&quot;), which is an Address Family Indicator plus Sub-Address Family Indicator.</p>
<ol start="4">
<li>Configure the <code>neighbor</code>. In the example here, we&#x27;ve identified its IP address as <code>1.1.1.1</code> and its ASN as 6000. (Because this neighbor has a different ASN than the SSR, the SSR will recognize it as an eBGP peer rather than an iBGP peer.) An <code>address-family</code> of <code>ipv4-unicast</code>, lets the SSR know to exchange IPv4 unicast routes with the peer.</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# neighbor 1.1.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=1.1.1.1])# neighbor-as 6000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=1.1.1.1])# address-family ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# next-hop-self true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])#exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=1.1.1.1])# exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="5">
<li>Set <code>next-hop-self</code> to <code>true.</code> During advertisement, non-directly connected routers need to learn how to reach an advertised route. To provide this information to the non-directly connected (as well as iBGP peers), next-hop-self command is used. This will cause the SSR to rewrite the <code>next-hop</code> information in the routes it advertises to this peer to be its own address.</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>In the example above, we&#x27;ve set our router&#x27;s AS to 100. This will apply to all neighbors as the &quot;default&quot; AS it will advertise. You can override this on a per-neighbor basis by setting <code>local-as</code> within the <code>neighbor</code> configuration to a different value. However, <em>you must not configure the same value within the neighbor as you&#x27;ve already set in your global configuration</em>. This may cause issues when attempting to establish a peering relationship.</p></div></div>
<ol start="6">
<li>Use the <code>exit</code> command several times to return to the <code>routing-protocol</code> level of the configuration hierarchy, and issue the <code>show</code> command. Your configuration should look something like this:</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# show</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">type bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local-as 100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router-id 1.1.1.128</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">address-family  ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    afi-safi  ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">neighbor        1.1.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    neighbor-address  1.1.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    neighbor-as       6000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    shutdown          false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address-family    ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        afi-safi      ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        next-hop-self true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advertising-routes">Advertising Routes<a href="#advertising-routes" class="hash-link" aria-label="Direct link to Advertising Routes" title="Direct link to Advertising Routes">​</a></h2>
<p>There are two ways to advertise routes into BGP:</p>
<ul>
<li>Using <code>network</code> statements to identify the prefixes you want to advertise</li>
<li>Redistributing routes learned through other IGP or from configuration</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-network-statement">Using the <code>network</code> Statement<a href="#using-the-network-statement" class="hash-link" aria-label="Direct link to using-the-network-statement" title="Direct link to using-the-network-statement">​</a></h4>
<p>To advertise routes to BGP, configure the network to be advertised under the address-family of the router. You may also apply a policy to the advertised route using  					 					 					command.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>You can apply policies to these routes (i.e., policy and filters) individually. Policies are configured within the authority-level <code>routing</code> configuration at <code>config &gt; authority &gt; routing &gt; filter</code> and <code>config &gt; authority &gt; routing &gt; policy</code>. For more information, refer to the section in our documentation on Filters and Policies.</p></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">**admin@branchoffice1.seattlesite1# config auth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> admin@branchoffice1.seattlesite1 (authority)# router seattlesite1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> admin@branchoffice1.seattlesite1 (routing[type=default-instance])# routing-protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# address- family ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# network 172.16.255.0/30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> admin@branchoffice1.seattlesite1 (network[network- address=172.16.255.0/30])# policy allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> admin@branchoffice1.seattlesite1 (network[network- address=172.16.255.0/30])# exit**</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example we&#x27;re advertising the CIDR <code>172.16.255.0/30</code>, and it will use the global route policy named <code>allow</code> (not shown).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="redistributing-routes">Redistributing Routes<a href="#redistributing-routes" class="hash-link" aria-label="Direct link to Redistributing Routes" title="Direct link to Redistributing Routes">​</a></h4>
<p>To redistribute connected, static, service routes and/or routes learned through OSPF, you can use the <code>redistribute</code> configuration.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# config auth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (authority)# router seattlesite1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing[type=default-instance])# routing-protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# redistribute connected</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bgp-over-svr-bgposvr">BGP over SVR (BGPoSVR)<a href="#bgp-over-svr-bgposvr" class="hash-link" aria-label="Direct link to BGP over SVR (BGPoSVR)" title="Direct link to BGP over SVR (BGPoSVR)">​</a></h2>
<p>Use BGP over SVR when peering with an SSR to gain the benefit of Secure Vector Routing for all BGP traffic flowing to-and-from the SSR peers.</p>
<p>This procedure assumes that the SSR system is configured for basic platform functionality. Refer to the configuration example below for context.</p>
<p>To configure BGP over SVR:</p>
<ol>
<li>Configure a <em>routing interface</em>. This is similar to a loopback interface on traditional routers.
Unlike normal loopback BGP peering, this IP address does not need to be routable on the transport network because it will never see the wire. BGP peering is created on this interface. The conductor triggers on this and autogenerates the following components to activate BGP over SVR:</li>
</ol>
<ul>
<li><em>bgp_speaker</em> tenant</li>
<li>Auto-generated BGP services and service routes</li>
<li>Router Peers</li>
</ul>
<p>These BGP connections are protected by SVR, and able to migrate between SVR paths.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>You must use a conductor to configure BGP over SVR; manually configuring the various pieces between two routers is not supported.</p></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>If the interface facing the BGPoSVR peer is already part of a neighborhood, then ensure that the two routers&#x27; interface topology types (<code>network-interface &gt;neighborhood &gt; topology</code>) are configured allowing the routers to form peering relationships for the auto-generated peer service routes; e.g., mesh-mesh, mesh-hub, mesh-spoke or hub-spoke.</p></div></div>
<ol start="2">
<li>
<p>Configure a BGP instance with the router’s local AS and a router-id that matches the routing interface&#x27;s IP. For each BGP over SVR peer, use a neighbor address of the neighbor&#x27;s routing interface IP address.</p>
</li>
<li>
<p>Configure the BGP peer configuration options such as the timers and address families. In address-family IPv4-unicast, <code>next-hop-self</code> must be set to <code>true</code>.</p>
</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>When configuring BGPoSVR with an eBGP peer, you must set <code>multihop ttl</code> to at least <code>2</code>.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-example">Configuration Example:<a href="#configuration-example" class="hash-link" aria-label="Direct link to Configuration Example:" title="Direct link to Configuration Example:">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    router myRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            interface rtg-int</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name rtg-int</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ip-address &lt;myAddress&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            routing-protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                type bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                local-as 100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                router-id &lt;myAddress&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                neighbor &lt;theirAddress&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                neighbor-as 200</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                timers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    hold-time 9</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    keepalive-interval 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                address-family ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    afi-safi ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    next-hop-self true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                transport</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    local-address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        routing-interface rtg-int</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                multihop</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    ttl 255</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="sample-configuration">Sample Configuration:<a href="#sample-configuration" class="hash-link" aria-label="Direct link to Sample Configuration:" title="Direct link to Sample Configuration:">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# config auth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (authority)# router seattlesite1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing[type=default-instance])# interface bgp-int-seattle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (interface[name=bgp-int-seattle])# ip- address 10.128.128.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (interface[name=bgp-int-seattle])# exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing[type=default-instance])# routing- protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# local-as 100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# router-id 10.128.128.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# address- family ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# neighbor 10.128.128.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=10.128.128.1])# neighbor-as 300</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=10.128.128.1])# address-family ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# next-hop-self true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=10.128.128.1])# transport</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (transport)# local-address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (local-address)# routing-interface bgp-int-seattle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (local-address)# exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (transport)# exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=10.128.128.1])# multihop</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (multihop)# ttl 255</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (multihop)# exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=10.128.128.1])# exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing[type=default-instance])# exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (authority)# exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="service-route-mesh-for-route-reflector-clients">Service-route Mesh For Route Reflector Clients<a href="#service-route-mesh-for-route-reflector-clients" class="hash-link" aria-label="Direct link to Service-route Mesh For Route Reflector Clients" title="Direct link to Service-route Mesh For Route Reflector Clients">​</a></h3>
<p>Use this option to generate a full-mesh BGP over SVR configuration, where all spokes learn the routes from other spokes via the reflector. In this configuration, the hub is a route reflector and all spokes are SVR peers, having been placed in the same mesh neighborhood. The BGP next hop is the originating spoke, and traffic is passed via SVR directly between the spokes.</p>
<p>To use this feature, the following configuration must be in place:</p>
<ul>
<li>BGP must be configured with one or more route reflectors.<!-- -->
<ul>
<li>On the router to be used as a route reflector, configure <code>routing-protocol bgp neighbor &lt;ip-addr&gt; address-family ipv4-unicast route-reflector client  true</code>.</li>
</ul>
</li>
<li>The route-reflector is configured to connect via BGP over SVR to multiple clients.</li>
<li>The route-reflector clients are configured to have a full mesh of SVR peering relationships with each other - this is done by putting them all in the same mesh neighborhood.</li>
</ul>
<p>After verifying the router configurations are correct, use the GUI or the pcli to set <code>route-reflector-client-mesh</code> to <code>true</code>. The conductor then generates the service-routes to allow direct SVR communication between the clients, based on the BGP routes they learn from each other via the reflector.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="version-history">Version History<a href="#version-history" class="hash-link" aria-label="Direct link to Version History" title="Direct link to Version History">​</a></h4>
<table><thead><tr><th>Release</th><th>Modification</th></tr></thead><tbody><tr><td>6.1.0</td><td>This feature was introduced.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="security-policy-and-service-policy">Security Policy and Service Policy<a href="#security-policy-and-service-policy" class="hash-link" aria-label="Direct link to Security Policy and Service Policy" title="Direct link to Security Policy and Service Policy">​</a></h3>
<p>The Security and Service Policy configuration options are provided for specifying the policy to be used for generated BGP-over-SVR services.</p>
<p><img decoding="async" loading="lazy" alt="BGP Service Generation Settings" src="/assets/images/config_bgp_serv_gen_settings-336528b8c4307f4aaa74026406259869.png" width="1878" height="562" class="img_ev3q"></p>
<p>To access these settings from the pcli:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        bgp-service-generation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        security-policy                 internal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service-policy                  prefer-path1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        route-reflector-client-mesh     true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="version-history-1">Version History<a href="#version-history-1" class="hash-link" aria-label="Direct link to Version History" title="Direct link to Version History">​</a></h4>
<table><thead><tr><th>Release</th><th>Modification</th></tr></thead><tbody><tr><td>6.1.0</td><td>This feature was introduced.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ipv6-addressing">IPv6 Addressing<a href="#ipv6-addressing" class="hash-link" aria-label="Direct link to IPv6 Addressing" title="Direct link to IPv6 Addressing">​</a></h3>
<p>The SSR supports BGP using IPv6 addressing. IPv6 can be used alone, combined with IPv4, or IPv4 can continue to be used without IPv6. The functionality is broken out as follows:</p>
<ul>
<li>BGP IPv6 transport – BGP neighbors configured with IPv6 addresses</li>
<li>BGP IPv6 unicast address family – BGP instances and neighbors support IPv6 unicast and IPv4 unicast</li>
<li>BGP over SVR IPv6</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="bgp-ipv6-transport">BGP IPv6 Transport<a href="#bgp-ipv6-transport" class="hash-link" aria-label="Direct link to BGP IPv6 Transport" title="Direct link to BGP IPv6 Transport">​</a></h4>
<p>The command <code>routing-protocol bgp neighbor-address</code> accepts either an IPv4 or IPv6 address.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">routing-protocol bgp neighbor fc00::3 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ipv6-unicast">IPv6 Unicast<a href="#ipv6-unicast" class="hash-link" aria-label="Direct link to IPv6 Unicast" title="Direct link to IPv6 Unicast">​</a></h4>
<p>The commands <code>routing-protocol bgp address-family</code> and <code>routing-protocol bgp neighbor address-family</code> now accept ipv6-unicast and ipv4-unicast addresses.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">routing-protocol bgp address-family ipv6-unicast  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">routing-protocol bgp neighbor fc00::3 address-family ipv6-unicast </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Any combination of address families can be configured on a BGP instance or BGP neighbor.  The neighbor IP address does not influence the neighbor address family configuration. IPv4 is the default address family; in situations where only IPv6 is or will be used for the neighbor, disable IPv4 using the following command:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">routing-protocol bgp neighbor &lt;&gt; address-family ipv4-unicast activate false  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>BGP protocol redistribution is address family specific. The command <code>routing-protocol bgp redistribute</code> applies to the ipv4-unicast address family only. Use the following command for IPv6 unicast redistribution:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">routing-protocol bgp address-family ipv6-unicast redistribute static</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Service addresses can be distributed into both the IPv4 and IPv6 unicast address families.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="bgp-over-svr-ipv6">BGP over SVR IPv6<a href="#bgp-over-svr-ipv6" class="hash-link" aria-label="Direct link to BGP over SVR IPv6" title="Direct link to BGP over SVR IPv6">​</a></h4>
<p>An IPv6 address can be configured on a routing interface. The restriction of a single IP address per routing interface remains, but support for multiple routing interfaces is provided.</p>
<p>To auto-generate BGP over SVR IPv6 services:
Configure the IP address of the remote routing interface for the neighbor, and set the neighbor transport to use a local routing interface.</p>
<p>IPv4 and IPv6  BGP over SVR peering sessions can be mixed, including connecting to the same peer with both an IPv4 and IPv6 address; however, the local routing interfaces must have the same IP address types as any remote IP BGP over SVR addresses.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h4>
<p>Use the following show commands to gather route, alarm, event, and log information.</p>
<p><code>show bgp ipv6 &lt;route&gt;</code>: Displays IPv6 specific routes.
(add example here)</p>
<p><code>show bgp neighbors &lt;addr&gt; received-routes | advertised-routes [&lt;family&gt;]</code>
The valid values for <code>family</code> include <code>all      ipv4     ipv4-vpn ipv6     ipv6-vpn</code>
(add example here)</p>
<p><code>show bgp summary [&lt;family&gt;]</code><br>
<!-- -->The valid values for <code>family</code> include <code>all      ipv4     ipv4-vpn ipv6     ipv6-vpn</code>
(add example here)</p>
<p>The remaining PCLI BGP commands are not address family specific.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="version-history-2">Version History<a href="#version-history-2" class="hash-link" aria-label="Direct link to Version History" title="Direct link to Version History">​</a></h4>
<table><thead><tr><th>Release</th><th>Modification</th></tr></thead><tbody><tr><td>6.2.0</td><td>This feature was introduced.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="verifying-the-bgp-configuration">Verifying the BGP Configuration<a href="#verifying-the-bgp-configuration" class="hash-link" aria-label="Direct link to Verifying the BGP Configuration" title="Direct link to Verifying the BGP Configuration">​</a></h3>
<p>Use <code>show bgp</code> to see the overview of the BGP routing process on the SSR:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# show bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2019-02-20 23:14:58 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BGP table version is 12, local router ID is 10.128.128.2, vrf id 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Status codes:  s suppressed, d damped, h history, * valid, &gt; best, = multipath,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               i internal, r RIB-failure, S Stale, R Removed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Nexthop codes: @NNN nexthop&#x27;s vrf id, &lt; announce-nh-self</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Origin codes:  i - IGP, e - EGP, ? - incomplete</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Network          Next Hop            Metric LocPrf Weight Path</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   10.128.128.2/32  10.128.128.3                           0 200 300 ?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   10.128.128.3/32  10.128.128.3                           0 200 300 ?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   128.128.128.1/32 10.128.128.3                           0 200 300 ?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   128.128.128.128/32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    10.128.128.3                           0 200 300 ?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   172.16.128.2/32  10.128.128.3                           0 200 300 ?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   172.16.255.0/30  0.0.0.0                  0         32768 i</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   172.26.128.0/30  10.128.128.3                           0 200 300 i</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Displayed  7 routes and 7 total paths</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In addition to the output from <code>show bgp</code>, the contributions to the RIB from BGP are visible in the output of <code>show rib</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# show rib</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2019-02-20 23:04:20 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Codes: K - kernel route, C - connected, S - static, R - RIP,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       O - OSPF, I - IS-IS, B - BGP, P - PIM, T - Table, v - VNC,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       V - VNC-Direct,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       &gt; - selected route, * - FIB route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">B   1.1.1.0/24 [20/0] via 1.1.1.1 inactive, 22:28:18</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 1.1.1.0/24 is directly connected, g4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">B&gt;* 2.2.2.0/24 [20/0] via 1.1.1.1, g4, 22:28:18</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">B&gt;* 3.3.3.0/24 [20/0] via 1.1.1.1, g4, 22:28:18</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 10.0.128.0/31 is directly connected, g1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">K&gt;* 128.128.128.1/32 is directly connected, Null0, bh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">K&gt;* 128.128.128.128/32 is directly connected, Null0, bh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 169.254.127.126/31 is directly connected, g4294967294</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">S&gt;* 172.16.128.2/32 [1/0] via 10.0.128.1, g1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">K   172.16.128.2/32 is directly connected, Null0, bh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">K&gt;* 172.26.128.2/32 is directly connected, Null0, bh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 192.168.64.0/24 is directly connected, g2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.09 seconds</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>As shown in the header, the routes that start with <strong>B</strong> are contributed by BGP.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bgp-over-svr-inter-hub-steering">BGP over SVR Inter-Hub Steering<a href="#bgp-over-svr-inter-hub-steering" class="hash-link" aria-label="Direct link to BGP over SVR Inter-Hub Steering" title="Direct link to BGP over SVR Inter-Hub Steering">​</a></h2>
<p>Path based BGP over SVR Routing responds to changes in peer adjacency, operational status, or SLA. It adds the ability to select and advertise BGP routes between BGP over SVR neighbors. It does this by monitoring the peer paths between BGP over SVR peers and dynamically adjusting the BGP neighbor inbound and outbound policy on those peers to reflect the priority and SLA of the peer paths.</p>
<p>In an SVR hub and spoke topology where a spoke connects to more than one hub router, it may be desirable to align service-policy based peer-path selection (between spoke and the hubs) with the BGP next-hop selection. The BGP next-hop (i.e. hub) that the spoke selects should correspond to the best available peer-path at any time.</p>
<p>The user configures the service-policy which provides the criteria for picking the best path. With this information, the BGP neighbors are prioritized. To ensure that BGP uses the best path, we configure the <code>action set-path-based-as-path prepend</code> to an AS path, which is a sequence of AS numbers. The prepend value is applied to BGP routes matched by the policy, making the BGP route AS path longer and thus less preferred. This forces BGP over a particular path, based on the path quality requirements.</p>
<p>However, in cases where failover or connection issues force the use of a less desirable path, the software will recognize the (lesser) path as &quot;in use&quot; and will not prepend the AS-path. When the path returns to the best path, the value is prepended to the less desirable path.</p>
<p>This changes dynamically over time: If the preferred path (based on the <code>service-policy</code>) changes, the system adjusts the routing policy on the fly. The same criteria is applied to any changes to the path choice.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h2>
<p>The following configuration process assumes that we are starting with a BGP over SVR configuration that has multiple BGP over SVR neighbors.</p>
<ol>
<li>Configure the network interface neighborhoods so that each SVR adjacency is identified by a unique vector. If a particular network interface has multiple adjacencies, configure multiple neighborhoods on that interface.</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router hub1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface mpls </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood mpls-hub1-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             vector mpls-hub1-spoke</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface lte </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood lte-hub1-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            vector lte-hub1-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router hub2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface mpls </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood mpls-hub2-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             vector mpls-hub2-spoke</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface lte </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood lte-hub2-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            vector lte-hub2-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router spoke1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface mpls </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood mpls-hub1-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             vector mpls-hub1-spoke</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface mpls </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood mpls-hub2-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             vector mpls-hub2-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface lte </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood lte-hub1-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            vector lte-hub1-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        network-interface lte </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighborhood lte-hub2-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            vector lte-hub2-spoke</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Configure a service policy that maps the adjacency vectors to a priority.</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">service-policy prefer-mpls-hub1 </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vector mpls-hub1-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    priority 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service-policy prefer-mpls-hub1 </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vector mpls-hub2-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    priority 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service-policy prefer-mpls-hub1 </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vector lte-hub1-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    priority 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service-policy prefer-mpls-hub1 </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vector lte-hub2-spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    priority 4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Configure a routing policy that includes the new routing policy <code>set-path-based-as-path</code> action. See <a href="#configuration-commands">Configuration Commands</a> below for additional information.</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">policy spoke-to-hub  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    statement 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        action set-path-based-as-path </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type             set-path-based-as-path</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            prepend          65000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-policy   prefer-mpls-hub1 </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>Configure the BGP over SVR neighbor policies: Inbound and Outbound policies are configured on the spoke to select a BGP route containing the hub with the most preferred adjacency.</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    routing default-instance </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        routing-protocol bgp </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        neighbor &lt;hub1&gt; </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighbor-policy inbound-policy spoke-to-hub</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    routing default-instance </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        routing-protocol bgp </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        neighbor &lt;hub1&gt; </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighbor-policy outbound-policy spoke-to-hub</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     routing default-instance </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        routing-protocol bgp </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        neighbor &lt;hub2&gt; </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighbor-policy inbound-policy spoke-to-hub</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router spoke </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    routing default-instance </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        routing-protocol bgp </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        neighbor &lt;hub2&gt; </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            neighbor-policy outbound-policy spoke-to-hub </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The service policy in the new routing policy path-based action determines the best BGP peer using the adjacency vectors. Per peer routing policies are dynamically modified as the best paths to the BGP over SVR neighbors change.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works">How It Works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How It Works" title="Direct link to How It Works">​</a></h3>
<p>On the spoke, the best adjacency is to <code>hub1</code> (via mpls1). The BGP <code>hub1</code> inbound policy uses the primary routing policy which has no <code>as-path prepend</code>. The BGP <code>hub2</code> inbound policy uses the shadow inbound policy that sets an <code>as-path prepend</code> making the received routes less preferred.</p>
<p>When the adjacency from spoke to <code>hub1</code> over mpls goes down, the best adjacency is now <code>hub2</code> (via mpls2). The <code>hub1</code> inbound policy changes to use the shadow, and the <code>hub2</code> inbound policy uses the primary. Route updates from <code>hub2</code> are now preferred.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bgp-conditional-advertisement">BGP Conditional Advertisement<a href="#bgp-conditional-advertisement" class="hash-link" aria-label="Direct link to BGP Conditional Advertisement" title="Direct link to BGP Conditional Advertisement">​</a></h3>
<p>Path-based BGP can be used in combination with BGP conditional advertisement. Path-based BGP sets the BGP selected route using the inbound policy. BGP conditional advertisement only considers the BGP selected route. BGP conditional advertisement will always override the neighbor outbound policy. If a BGP prefix matches both the BGP outbound policy and the BGP conditional advertisement advertise-policy, the conditional advertisement takes precedence.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-commands">Configuration Commands<a href="#configuration-commands" class="hash-link" aria-label="Direct link to Configuration Commands" title="Direct link to Configuration Commands">​</a></h3>
<p>The configuration for <code>set-path-based-as-path</code> is performed under the routing policy, as an action within a statement:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">action set-path-based-as-path </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type             set-path-based-as-path</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    prepend          &lt;as-path&gt; </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    service-policy   &lt;service-policy-name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In context:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    routing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        policy spoke-to-hub</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name spoke-to-hub</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            statement  s0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name    s0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                policy  accept</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                action  set-path-based-as-path</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    type            set-path-based-as-path</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    prepend         65001</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    service-policy  prefer-mpls-hub1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-1">Troubleshooting<a href="#troubleshooting-1" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<p>The PCLI command <code>show bgp path-based-policy</code> displays the current best peer for each group of peers sharing the same service policy. Information includes the last time the best peer changed for the group, and the number of times the best peer changed. The current <code>show bgp</code> commands, along with the <code>show peers</code> and logging messages can also help debug this feature.</p>
<p>The following is an example output from <code>show bgp path-based-policy</code>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node0.02000101ffc5# show bgp path-based-policy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2023-06-26 19:24:04 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\u2714 Getting BGP path-based-policy information...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">========================= ============= ============= =================== ==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Routing Policy            Num Changes   Last Change   Service Policy      Primary Peer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">========================= ============= ============= =================== ==============</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> prefer_wan2-from-hub                1   13s           prefer_wan2-s0-sp   hub2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> prefer_wan2-towards-hub             1   13s           prefer_wan2-s0-sp   hub2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Successfully retrieved BGP path-based-policy information.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.19 seconds</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node0.02000101ffc5# show bgp path-based-policy detail</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2023-06-26 19:24:10 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">\u2714 Getting BGP path-based-policy information...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Information</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Path Based Policy:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Peers:                        hub1, hub2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Time Since Update Millisec:   18976</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Routing Policy:               prefer_wan2-from-hub</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Service Policy:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     Primary Peers:              hub2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     Policy:                     prefer_wan2-s0-sp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Changes:                      1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Path Based Policy:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Peers:                        hub1, hub2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Time Since Update Millisec:   18949</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Routing Policy:               prefer_wan2-towards-hub</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Service Policy:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     Primary Peers:              hub2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     Policy:                     prefer_wan2-s0-sp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Changes:                      1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Successfully retrieved BGP path-based-policy information.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.04 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vrf-bgp-over-svr">VRF BGP Over SVR<a href="#vrf-bgp-over-svr" class="hash-link" aria-label="Direct link to VRF BGP Over SVR" title="Direct link to VRF BGP Over SVR">​</a></h2>
<p>The establishment of a BGP session over SVR is achieved by the conductor auto-generating the necessary services and service-routes. The introduction of the VRF feature allows for configuring BGP instances within a VRF, and establishing BGP sessions with neighbors within the same VRF.</p>
<p>When configuring VRFs, there can be multiple BGP instances configured on one router, each one expecting to communicate via a separate VRF routing table. The result is that the generated routing-stack service-route needs to indicate which VRF table to direct the BGP session to.</p>
<p>By explicitly disabling the auto-generation of BGP services and service-routes for any configured BGP neighbor, it is possible to establish BGP sessions that use routing interfaces (aka “loopback” interfaces) for communication without also using SVR.</p>
<p>Other supported use cases include the ability to establish BGP over SVR sessions with each side residing in a different VRF. The typical scenario is a VPN architecture where one router is a CPE device on a customer site without any explicit VRF configuration. It connects to another router at the VPN provider which has a VRF configured for this customer and a BGP instance inside that VRF:</p>
<p><img decoding="async" loading="lazy" alt="BGP Instance inside VRF" src="/assets/images/config_BGPoSVRinVRF-b1f0b14a118e12dfc45016eef75713d8.png" width="990" height="528" class="img_ev3q"></p>
<p>In this example, the BGP instance configured in the default VRF on a CPE router needs to establish a session with a VRF BGP instance in the VPN provider’s router. To enable the generation of appropriate BGP service and service-route configuration objects, and in cases where the VRF&#x27;s have overlapping address space, some additional BGP neighbor configuration is required.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-example-1">Configuration Example<a href="#configuration-example-1" class="hash-link" aria-label="Direct link to Configuration Example" title="Direct link to Configuration Example">​</a></h3>
<p>The following example is based on the VPN provider scenario illustrated above: <strong>router A</strong> (the VPN Provider) represents a core router with a BGP instance inside a VRF peered with <strong>router B’s</strong> (Customer Y) BGP instance inside the default VRF.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    router A</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            vrf vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                interface loopback-vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    ip-address 10.0.0.10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                routing-protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    local-as 500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    router-id 10.0.0.10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    neighbor 10.0.0.11</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        neighbor-as 500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        transport</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            bgp-service-generation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                neighbor-vrf default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            local-address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                routing-interface loopback-vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    router B</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            interface loopback</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 ip-address 10.0.0.11</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            routing-protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                local-as 500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                router-id 10.0.0.11</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                neighbor 10.0.0.10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    neighbor-as 500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    transport</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        bgp-service-generation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            neighbor-vrf vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        local-address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            routing-interface loopback</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="bgp-service-generation">BGP Service Generation<a href="#bgp-service-generation" class="hash-link" aria-label="Direct link to BGP Service Generation" title="Direct link to BGP Service Generation">​</a></h4>
<p>The <code>bgp-service-generation</code> configuration object is available in a BGP neighbor’s <code>transport</code> settings. For neighbors specified in the default routing instance or specified inside a VRF, the following choices are available:</p>
<ul>
<li><code>disabled </code>: Do not generate BGP service or service-routes.</li>
<li><code>neighbor-vrf (&lt;vrf-name&gt;|default) </code>: Name of the neighbor’s VRF in which the peer BGP instance resides. Can be “default” to specify the default VRF.</li>
<li><code>same-neighbor-vrf </code>: (Default) Generate the BGP service if there is a matching peer with a BGP instance within the same VRF. Explicitly specifying this is equivalent to not configuring any <code>bgp-service-generation</code> statement.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="routing-stack-service-route">Routing-Stack Service-Route<a href="#routing-stack-service-route" class="hash-link" aria-label="Direct link to Routing-Stack Service-Route" title="Direct link to Routing-Stack Service-Route">​</a></h4>
<p>A service-route of type <code>routing-stack</code> can be directed to a specific VRF:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service-route &lt;service-route-name&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-name &lt;service-name&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            routing-stack</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            routing-stack-vrf &lt;vrf-name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The existing <code>routing-stack</code> statement directs the session into the <code>routingEngine</code> network namespace used by the routing engine. The optional <code>routing-stack-vrf &lt;vrf-name&gt;</code> statement specifies the desired VRF within the <code>routingEngine</code> namespace. The <code>vrf-name</code> parameter is a reference to an existing VRF in the same router. If no <code>routing-stack-vrf</code> is specified, the target of the service-route is the default VRF.</p>
<p>Service-routes of type <code>routing-stack</code> are automatically generated by the conductor for use with an auto-generated BGP service. Manually creating this type of service-route is not supported.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="generated-services-and-tenants">Generated Services and Tenants<a href="#generated-services-and-tenants" class="hash-link" aria-label="Direct link to Generated Services and Tenants" title="Direct link to Generated Services and Tenants">​</a></h4>
<p>More than one access-policy can be specified in a service; a service is generated for each unique routing-interface and VRF tuple for a given router. Because multiple peering relationships may exist using that service, the access-policy lists all tenants associated with the BGP neighbors using that service for peering. All tenants used in these access-policy statements appear as generated tenants in the configuration, one for each VRF in use.</p>
<p>For a BGP neighbor residing in the default VRF, the generated BGP service  is named <code>_bgp_&lt;router-name&gt;_&lt;routing-interface-name&gt;</code>, and the tenant associated with this BGP neighbor in the default VRF is named <code>_bgp_speaker_</code>.</p>
<p>For a BGP neighbor residing in a non-default VRF, the generated BGP service is named <code>_bgp_&lt;router-name&gt;_&lt;vrf-name&gt;_&lt;vrf-routing-interface-name&gt;</code>. The associated tenant is named <code>_&lt;vrf-name&gt;._vrf_bgp_speaker_</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-2">Troubleshooting<a href="#troubleshooting-2" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h3>
<p>If expected BGP services or service-routes are not auto-generated, use the log messages on the conductor to troubleshoot. Each BGP service and service-route that is generated or skipped for config generation results in a debug level log message. These messages are written to <code>persistentDataManager.log</code> with category RTG and sub-category CFG.</p>
<p>If all expected configuration has been generated, but a BGP over SVR session does not come up, then all available tools for debugging traffic problems also apply to BGP sessions:</p>
<ul>
<li>show fib</li>
<li>show service-path</li>
<li>show sessions</li>
</ul>
<p>Additionally, use the <code>show rib {vrf &lt;vrf-name&gt;}</code> command to verify the BGP neighbor is reachable and its kernel route entry is not superseded by another, higher priority entry in the RIB.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bgp-conditional-advertisement-1">BGP Conditional Advertisement<a href="#bgp-conditional-advertisement-1" class="hash-link" aria-label="Direct link to BGP Conditional Advertisement" title="Direct link to BGP Conditional Advertisement">​</a></h2>
<p>When an SSR prefers a given provider for outbound traffic, it can be configured to receive locally destined traffic from that provider. By advertising the SSR&#x27;s local routes to the preferred provider, it ensures that locally destined traffic only comes from the preferred provider.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-1">Configuration<a href="#configuration-1" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h3>
<p>BGP conditional advertisement is configured under the BGP neighbor address by configuring a conditional routing policy and an advertisement routing policy.</p>
<p>When the conditional routing policy is satisfied against all BGP selected routes in the BGP RIB, all routes in the BGP RIB matched by the advertising routing policy are advertised to the configured neighbor.</p>
<p>If the conditional routing policy is not satisfied, all routes matched by the advertising route policy are withdrawn from the configured neighbor. The conditional routing policy may be configured to be satisfied in an <code>exist-case</code>, where any route matches the policy; or where no route matches - a <code>non-exist case</code>.</p>
<p>For example:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">routing-protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type                       bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local-as                   2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    conditional-advertisement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        interval-time  15</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    neighbor                   &lt;neighbor-ip&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        address-family    ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            conditional-advertisement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                advertisement-policy  &lt;policy-name&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exist-policy          &lt;policy-name&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    neighbor                   &lt;neighbor-ip&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        address-family    ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            conditional-advertisement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                advertisement-policy  &lt;policy-name&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                non-exist-policy      &lt;policy-name&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The conditional routing policy is evaluated by default every 60 seconds, but is configurable as shown above.</p>
<p>Conditional advertisement is applicable to established BGP neighbors only.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-configuration">Example Configuration<a href="#example-configuration" class="hash-link" aria-label="Direct link to Example Configuration" title="Direct link to Example Configuration">​</a></h3>
<p>In this example, the hubs are 11.1.1.4, 11.1.1.5, and 172.16.3.6. The conditional exist policy for each hub is the default route prefix match, and the peer address of the hub. The hubs use the same advertise policy.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">filter  default-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type  prefix-filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name  default-route </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rule  10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name    10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        prefix  0.0.0.0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">filter  15-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type  prefix-filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name  15-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rule  10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name    10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        prefix  15.0.0.0/16</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        le      32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">policy  default-dut4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name       default-dut4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    statement  10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name       10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        condition  address-prefix-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type           address-prefix-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            prefix-filter  default-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        condition  peer-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type          peer-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            peer-address  11.1.1.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">policy  default-dut5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name       default-dut5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    statement  10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name       10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        condition  address-prefix-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type           address-prefix-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            prefix-filter  default-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        condition  peer-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type          peer-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            peer-address  11.1.1.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">policy  default-dut6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name       default-dut6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    statement  10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name       10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        condition  address-prefix-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type           address-prefix-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            prefix-filter  default-route</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        condition  peer-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type          peer-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            peer-address  172.16.3.6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">policy  15-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name       15-0 </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    statement  10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name       10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         condition  address-prefix-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type           address-prefix-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            prefix-filter  15-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        action     set-community</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            type                 set-community</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            community-attribute  2:15</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">routing-protocol  bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    type                       bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local-as                   2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    conditional-advertisement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        interval-time  15</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    neighbor                   11.1.1.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        neighbor-address  11.1.1.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        neighbor-as       4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        address-family    ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            afi-safi                   ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            conditional-advertisement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                advertisement-policy  15-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exist-policy          default-dut4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    neighbor                   11.1.1.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        neighbor-address  11.1.1.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        neighbor-as       5 </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        address-family    ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            afi-safi                   ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            conditional-advertisement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                advertisement-policy  15-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exist-policy          default-dut5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    neighbor                   172.16.3.6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        neighbor-address  172.16.3.6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        neighbor-as       6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        address-family    ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            afi-safi                   ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            conditional-advertisement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                advertisement-policy  15-0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exist-policy          default-dut6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="known-limitations">Known Limitations<a href="#known-limitations" class="hash-link" aria-label="Direct link to Known Limitations" title="Direct link to Known Limitations">​</a></h3>
<p>This feature may introduce some additional load on the routing engine as the conditional policy must be executed each time the BGP RIB changes.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="show-commands">Show Commands<a href="#show-commands" class="hash-link" aria-label="Direct link to Show Commands" title="Direct link to Show Commands">​</a></h3>
<p>Use <code>show bgp neighbors</code> to see information about the neighbor conditional advertisement configuration and state:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">PCLI# show bgp neighbors</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BGP neighbor is 11.1.1.5, remote AS 5, local AS 2, external link</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">…</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Condition EXIST, Condition-map *default-dut5, Advertise-map *15-0, status: Withdraw</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bgp-graceful-restart">BGP Graceful Restart<a href="#bgp-graceful-restart" class="hash-link" aria-label="Direct link to BGP Graceful Restart" title="Direct link to BGP Graceful Restart">​</a></h2>
<p>Users can now configure <code>graceful-restart</code> as disabled, rather than helper mode or full graceful restart. Additionally, the graceful restart mode on BGP neighbors can be configured differently than on the BGP instance. Historically there was no separate neighbor configuration. The graceful restart mode must be explicitly enabled, otherwise the default mode is <strong>helper</strong>.</p>
<p>Example New Data Model Objects</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">routing-protocol     bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    local-as         65    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    graceful-restart        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        mode             enable       </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        restart-time     150       </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        stale-routes-time    150        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    …        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    neighbor     172.16.0.1            </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        neighbor-as    66           </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        graceful-restart               </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            mode         disable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="show-command-and-troubleshooting">Show Command and Troubleshooting<a href="#show-command-and-troubleshooting" class="hash-link" aria-label="Direct link to Show Command and Troubleshooting" title="Direct link to Show Command and Troubleshooting">​</a></h3>
<p>Use the <code>show bgp neighbors</code> command to verify graceful restart is configured as expected. Graceful restart is part of BGP capabilities negotiation.  When the BGP peering session is established, the command output includes the negotiated graceful restart:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Graceful Restart Capability: advertised</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Graceful restart information:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Local GR Mode: Helper*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Remote GR Mode: Disable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    R bit: False</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Timers:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Configured Restart Time(sec): 120</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Received Restart Time(sec): 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the BGP peering session does not form, use packet capture to view the local BGP protocol traffic from the linux shell:
<code>ip netns exec routingEngine tcpdump -i any -v &quot;tcp port 179”</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="routing-features">Routing Features<a href="#routing-features" class="hash-link" aria-label="Direct link to Routing Features" title="Direct link to Routing Features">​</a></h2>
<p>This section contains various features supported by the SSR&#x27;s BGP implementation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-ssr-as-a-route-reflector">Configuring SSR as a Route Reflector<a href="#configuring-ssr-as-a-route-reflector" class="hash-link" aria-label="Direct link to Configuring SSR as a Route Reflector" title="Direct link to Configuring SSR as a Route Reflector">​</a></h3>
<p>While configuring iBGP, you may need to enable the <strong>Route Reflector</strong> capability to facilitate easy learning of routes. Your SSR can be configured as a route reflector for a particular neighbor or more realistically a set of neighbors, also known as a route reflector client(s). This can be configured in the route reflector router&#x27;s BGP config, under the respective neighbor object.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# config auth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (authority)# router seattlesite1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing[type=default-instance])# routing- protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# neighbor 1.1.1.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In our example, the route reflector in our network is <code>branchoffice1</code> router, and our route reflector client is its neighbor <code>1.1.1.1</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=1.1.1.1])# address-family ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# route-reflector client true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By setting <code>route-reflector client true</code>, we instruct the <code>branchoffice1</code> router to treat the neighbor as a route reflector client.</p>
<p>There is one additional field which needs to be set in route reflector&#x27;s BGP config, and that is <code>Cluster-ID</code>, which has the format of an IP address. This can be set to anything unique in the AS, and can be the same as the <code>Router ID</code> field.</p>
<p>When the route reflector sends routes to the clients, by default it doesn&#x27;t modify the next-hop. An outbound policy can be used to change the next-hop in these routes to that of the route reflector, if desired. In such instances, another option, which is turned off by default, needs to be set in the route reflector&#x27;s BGP config: <code>Route Reflector Allow Outbound Policy = TRUE</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bgp-confederations">BGP Confederations<a href="#bgp-confederations" class="hash-link" aria-label="Direct link to BGP Confederations" title="Direct link to BGP Confederations">​</a></h3>
<p>When configuring iBGP, the <strong>Confederation</strong> feature may be helpful when dealing with an enormous autonomous system. This feature allows you to break up the AS into smaller sub-autonomous systems. Confederation can be directly configured under the routing protocol element. Here, 65535 is the <strong>confederation identifier AS number</strong> and, 1100 and 2200 are the <strong>member AS</strong> numbers of that confederation AS.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# config auth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (authority)# router seattlesite1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing[type=default-instance])# routing- protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# confederation identifier 65535</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# confederation member-as 1100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# confederation member-as 2200</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/config_session_optimization"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">TCP Session Optimization</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/config_vrf_route_leaking"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">VRF Route Leaking</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#peering-with-non-ssr-routers" class="table-of-contents__link toc-highlight">Peering with non-SSR Routers</a></li><li><a href="#advertising-routes" class="table-of-contents__link toc-highlight">Advertising Routes</a></li><li><a href="#bgp-over-svr-bgposvr" class="table-of-contents__link toc-highlight">BGP over SVR (BGPoSVR)</a><ul><li><a href="#service-route-mesh-for-route-reflector-clients" class="table-of-contents__link toc-highlight">Service-route Mesh For Route Reflector Clients</a></li><li><a href="#security-policy-and-service-policy" class="table-of-contents__link toc-highlight">Security Policy and Service Policy</a></li><li><a href="#ipv6-addressing" class="table-of-contents__link toc-highlight">IPv6 Addressing</a></li><li><a href="#verifying-the-bgp-configuration" class="table-of-contents__link toc-highlight">Verifying the BGP Configuration</a></li></ul></li><li><a href="#bgp-over-svr-inter-hub-steering" class="table-of-contents__link toc-highlight">BGP over SVR Inter-Hub Steering</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How It Works</a></li><li><a href="#bgp-conditional-advertisement" class="table-of-contents__link toc-highlight">BGP Conditional Advertisement</a></li><li><a href="#configuration-commands" class="table-of-contents__link toc-highlight">Configuration Commands</a></li></ul></li><li><a href="#troubleshooting-1" class="table-of-contents__link toc-highlight">Troubleshooting</a></li><li><a href="#vrf-bgp-over-svr" class="table-of-contents__link toc-highlight">VRF BGP Over SVR</a><ul><li><a href="#configuration-example-1" class="table-of-contents__link toc-highlight">Configuration Example</a></li><li><a href="#troubleshooting-2" class="table-of-contents__link toc-highlight">Troubleshooting</a></li></ul></li><li><a href="#bgp-conditional-advertisement-1" class="table-of-contents__link toc-highlight">BGP Conditional Advertisement</a><ul><li><a href="#configuration-1" class="table-of-contents__link toc-highlight">Configuration</a></li><li><a href="#example-configuration" class="table-of-contents__link toc-highlight">Example Configuration</a></li><li><a href="#known-limitations" class="table-of-contents__link toc-highlight">Known Limitations</a></li><li><a href="#show-commands" class="table-of-contents__link toc-highlight">Show Commands</a></li></ul></li><li><a href="#bgp-graceful-restart" class="table-of-contents__link toc-highlight">BGP Graceful Restart</a><ul><li><a href="#show-command-and-troubleshooting" class="table-of-contents__link toc-highlight">Show Command and Troubleshooting</a></li></ul></li><li><a href="#routing-features" class="table-of-contents__link toc-highlight">Routing Features</a><ul><li><a href="#configuring-ssr-as-a-route-reflector" class="table-of-contents__link toc-highlight">Configuring SSR as a Route Reflector</a></li><li><a href="#bgp-confederations" class="table-of-contents__link toc-highlight">BGP Confederations</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Juniper Networks, Inc.</div></div></div></footer></div>
</body>
</html>
<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-167298415-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="128T Docs" href="/opensearch.xml"><title data-react-helmet="true">Configuring BGP | 128T Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Configuring BGP | 128T Docs"><meta data-react-helmet="true" name="description" content="The Border Gateway Protocol (BGP) is a standard exterior gateway protocol developed for exchanging routing and reachability information between Autonomous Systems, a collection of IP routing prefixes managed by a single administrative entity. BGP makes routing decisions based on paths and network policies; although historically mainly seen in service provider networks, it is now gaining acceptance in large enterprise networks. BGP can also be used for routing within an autonomous system as an interior gateway protocol; when doing so it is referred to as iBGP."><meta data-react-helmet="true" property="og:description" content="The Border Gateway Protocol (BGP) is a standard exterior gateway protocol developed for exchanging routing and reachability information between Autonomous Systems, a collection of IP routing prefixes managed by a single administrative entity. BGP makes routing decisions based on paths and network policies; although historically mainly seen in service provider networks, it is now gaining acceptance in large enterprise networks. BGP can also be used for routing within an autonomous system as an interior gateway protocol; when doing so it is referred to as iBGP."><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/config_bgp"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://docs.128technology.com/docs/config_bgp"><link rel="stylesheet" href="/styles.9a832058.css">
<link rel="preload" href="/styles.55a5b0d8.js" as="script">
<link rel="preload" href="/runtime~main.6d5cdf5d.js" as="script">
<link rel="preload" href="/main.a1254e33.js" as="script">
<link rel="preload" href="/1.bbd3324d.js" as="script">
<link rel="preload" href="/2.c4b385fd.js" as="script">
<link rel="preload" href="/127.65ccf4c5.js" as="script">
<link rel="preload" href="/130.1f62f360.js" as="script">
<link rel="preload" href="/20ac7829.3ed525dc.js" as="script">
<link rel="preload" href="/17896441.e81f1411.js" as="script">
<link rel="preload" href="/f94bd8bd.a6a0db1c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title">Technology</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.128technology.com/home" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Interchange</a><a href="https://www.128technology.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title">Technology</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Docs</a></li><li class="menu__list-item"><a href="https://community.128technology.com/home" target="_blank" rel="noopener noreferrer" class="menu__link">Interchange</a></li><li class="menu__list-item"><a href="https://www.128technology.com/" target="_blank" rel="noopener noreferrer" class="menu__link">Company</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_128t">128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_releases">128T Releases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_support_policy">Software Support Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_supported_platforms">Platform Support Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_security_policy">Security Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_svr_savings">SVR Savings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/CONTRIBUTING">Contributing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_getting_started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation">Installation Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_system_reqs">Hardware Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_prepare_OS">Operating System Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_installer">Manually Installing the 128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_downloading_iso">Downloading ISOs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_bootable_media">Installing From ISO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_creating_bootable_usb">Creating Bootable USB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_otp_iso">Installing From OTP ISO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_ztp">QuickStart from a Bootable ISO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_aws">Installing in AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_quickstart_aws">QuickStart Installation in AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_azure">Installing in Azure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_upgrading">Upgrading</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_rollback">Rollback</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_application_discovery">Application Discovery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_appid">Application Identification</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_ha_theoryofoperation">HA - Theory of Operation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_interface_types">Interface Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_kni">Kernel Network Interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_linux_host_networking">Linux Host Networking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_network_planes">Forwarding Planes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_metadata">128T Metadata</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_metrics">Metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_machine_communication">Machine Communication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_pcli">PCLI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_session_timer">Session Timers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_waypoint_ports">Waypoints</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_glossary">Glossary</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Administration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_asset_connection_resiliency">Asset Connection Resiliency</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_basics">Basics</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/config_bgp">BGP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_reference_guide">Element Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_audit_log">Audit Log</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dhcp">DHCP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dns_proxy">DNS Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dual_router_ha">High Availability (Dual Router)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ldap">LDAP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ha">High Availability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_management_over_forwarding">Management over Forwarding</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_adding_interfaces_to_ha_team">Adding Interfaces to HA Team Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_transition_standalone_to_ha">Transitioning a Conductor from Standalone to HA</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_nat">NAT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ospf">OSPF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_rate_limiting">Rate Limiting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_snmp">SNMP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_snmp_metrics">SNMP: User defined metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_static_hostname_mapping">Static Hostname Mappings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_tenants">Tenants</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_templates">Configuration Templates</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">How To</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_conductor_migration">Conductor Migration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_extend_gui_nav">Extending GUI Nav</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_lte">LTE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_maintenance_mode">Maintenance Mode</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_ms365">Microsoft 365</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_trusted_ca_certificate">Adding a Trusted Certificate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_tune_bfd">Tuning BFD</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_applications">Application Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_ap_salt_minion">AP: Salt Minion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_cpu_spikes">CPU Spikes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_connecting_to_routers">Connecting to Routers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_forwarding_resource_pools">Forwarding Plane Resource Pools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_logs">Logs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_mac_uniqueness">MAC Address Uniqueness</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_packet_capture">PCLI Packet Capture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ts_t1_troubleshooting">T1 Troubleshooting</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Events</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_overview">Alarm and Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_alarms">Alarms</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_events">Events</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Best Practices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_att_avpn_configuration">AT&amp;T AVPN Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_conductor_deployment">Conductor Deployment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_qos_msft_expressroute">ExpressRoute QoS Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_lte_peering">LTE Peering</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_monitoring_headends">Monitoring Head End Routers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_salt_pillars">Saltstack at Scale With 128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_sdwan_design_guide">SD-WAN Design Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_service_and_service_policy_design">Service and Service Policy Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_service-policy_defaults">Service Policy Baseline Defaults</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_tenants">Tenancy Design</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CLI Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli_reference">Command Line Reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_dns_app_id">DNS App Id</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_dns_cache">DNS Cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_gre">GRE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_icmp_reachability_detection">ICMP Reachability Detection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_ipsec_client">IPsec Client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_loopback_static_routes">Loopback Static Routes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_m800_watchdog">M800 Watchdog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_monitoring_agent">Monitoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_mosh">Mosh</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_sip_alg">SIP ALG</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_wireguard">Wireguard</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">REST APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api_rest_4.2.0">128T-4.2.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Release Notes</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.5">4.5</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.4">4.4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.3">4.3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.2">4.2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.1">4.1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.0">4.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T Installer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.6">2.6</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.5">2.5</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.4">2.4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.3">2.3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.2">2.2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.1">2.1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T SIP ALG</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_sip_alg_2.1">2.1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T ZScaler</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_zscaler_1.1">1.1</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Configuring BGP</h1></header><div class="markdown"><p>The Border Gateway Protocol (BGP) is a standard exterior gateway protocol developed for exchanging routing and reachability information between Autonomous Systems, a collection of IP routing prefixes managed by a single administrative entity. BGP makes routing decisions based on paths and network policies; although historically mainly seen in service provider networks, it is now gaining acceptance in large enterprise networks. BGP can also be used for routing within an autonomous system as an interior gateway protocol; when doing so it is referred to as iBGP.</p><p>Learning routes from BGP simplifies enterprise configuration and integration with Secure Vector Routing. In this configuration guide we will also discuss a 128T-specific feature referred to as &quot;BGP over SVR&quot; (or BGPoSVR), which combines the power of Secure Vector Routing with the rich feature set of the BGP protocol.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="prerequisites"></a>Prerequisites<a aria-hidden="true" tabindex="-1" class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h3><p>This section presumes that the reader has a running 128T system and wants to add configuration to support BGP. The running 128T system should already include configuration for basic platform functionality (e.g., <code>router</code>, <code>node</code>, <code>device-interface</code>, <code>network-interface</code>) and basic 128T modeling configuration (e.g., tenants, services, etc.). Refer to the <a href="/docs/config_reference_guide">Element Reference</a> section of our documentation for a better understanding about basics of the 128T data model.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="peering-with-non-128t-routers"></a>Peering with non-128T Routers<a aria-hidden="true" tabindex="-1" class="hash-link" href="#peering-with-non-128t-routers" title="Direct link to heading">#</a></h3><p>The BGP configuration exists in the <a href="/docs/config_reference_guide#routing"><code>routing</code></a> configuration container within the 128T data model. For any routing configuration, static or dynamic, a default routing instance called <code>default-instance</code> must be defined in the 128T configuration.</p><p>In this example we will assume that BGP is configured on the peering router with IP address 1.1.1.1, as autonomous system number (ASN) 6000. To peer the 128T router with this router, we can configure BGP on our 128T using the following commands:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# config auth</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (authority)# router seattlesite1 </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# routing default-instance</span></div></div></div></div></div><p>Every 128T router (in this case, the router named <code>seattlesite1</code>), contains all of its legacy routing protocol information within the <code>default-instance</code> routing container.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing[type=default-instance])# routing-protocol bgp</span></div></div></div></div></div><p>Here we will enter into the BGP portion of the routing configuration model.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# local-as 100 admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# router-id 1.1.1.128</span></div></div></div></div></div><p>This sets our local autonomous system number to 100, and sets the router ID to 1.1.1.128.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# address-family ipv4-unicast</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# exit</span></div></div></div></div></div><p>At least one <code>address-family</code> is required to be configured. These address families are also sometimes referred to as &quot;AFI-SAFI&quot; (pronounced &quot;affy-saffy&quot;), which is an Address Family Indicator plus Sub-Address Family Indicator. The most commonly configured <code>address-family</code> on the 128T router is by far <code>ipv4-unicast</code>. If your deployment uses other address families (e.g., IPv6) or routes multicast, you may also need to configure support for other address families.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# neighbor 1.1.1.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=1.1.1.1])# neighbor-as 6000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=1.1.1.1])# address-family ipv4-unicast</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# next-hop-self true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])#exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=1.1.1.1])# exit</span></div></div></div></div></div><p>Last, we configure the <code>neighbor</code>. As stated in the example above, we&#x27;ve identified its IP address as <code>1.1.1.1</code> and its ASN as 6000. (Because this neighbor has a different ASN than the 128T, the 128T will recognize it as an eBGP peer rather than an iBGP peer.) We give it an <code>address-family</code> of <code>ipv4-unicast</code>, which lets the 128T know to exchange IPv4 unicast routes with the peer.</p><p>Lastly, we set <code>next-hop-self</code> to <code>true.</code> During advertisement, non-directly connected routers need to learn how to reach an advertised route. To provide this information to the non-directly connected (as well as iBGP peers), next-hop-self command is used. This will cause the 128T to rewrite the <code>next-hop</code> information in the routes it advertises to this peer to be its own address.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>In the example above, we&#x27;ve set our router&#x27;s AS to 100. This will apply to all neighbors as the &quot;default&quot; AS it will advertise. You can override this on a per-neighbor basis by setting <code>local-as</code> within the <code>neighbor</code> configuration to a different value. However, <em>you must not configure the same value within the neighbor as you&#x27;ve already set in your global configuration</em>. This may cause issues when attempting to establish a peering relationship.</p></div></div><p>Use the <code>exit</code> command several times to return to the <code>routing-protocol</code> level of the configuration hierarchy, and issue the <code>show</code> command. Your configuration should look something like this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# show</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">type bgp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">local-as 100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">router-id 1.1.1.128</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">address-family  ipv4-unicast</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    afi-safi  ipv4-unicast</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">neighbor        1.1.1.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    neighbor-address  1.1.1.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    neighbor-as       6000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    shutdown          false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    address-family    ipv4-unicast</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        afi-safi      ipv4-unicast</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        next-hop-self true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="advertising-routes"></a>Advertising Routes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#advertising-routes" title="Direct link to heading">#</a></h3><p>There are two ways to advertise routes into BGP:</p><ol><li>Using <code>network</code> statements to identify the prefixes you want to advertise</li><li>Redistributing routes learned through other IGP or from configuration</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="using-the-network-statement"></a>Using the <code>network</code> Statement<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-the-network-statement" title="Direct link to heading">#</a></h4><p>To advertise routes to BGP, configure the network to be advertised under the address-family of the router. You may also apply a policy to the advertised route using  					 					 					command.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You can apply policies to these routes (i.e., policy and filters) individually. Policies are configured within the authority-level <code>routing</code> configuration at <code>config &gt; authority &gt; routing &gt; filter</code> and <code>config &gt; authority &gt; routing &gt; policy</code>. For more information, refer to the section in our documentation on Filters and Policies.</p></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">**admin@branchoffice1.seattlesite1# config auth admin@branchoffice1.seattlesite1 (authority)# router seattlesite1 admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# routing default-instance</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> admin@branchoffice1.seattlesite1 (routing[type=default-instance])# routing-protocol bgp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# address- family ipv4-unicast</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# network 172.16.255.0/30</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> admin@branchoffice1.seattlesite1 (network[network- address=172.16.255.0/30])# policy allow</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> admin@branchoffice1.seattlesite1 (network[network- address=172.16.255.0/30])# exit**</span></div></div></div></div></div><p>In this example we&#x27;re advertising the CIDR <code>172.16.255.0/30</code>, and it will use the global route policy named <code>allow</code> (not shown).</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="redistributing-routes"></a>Redistributing Routes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#redistributing-routes" title="Direct link to heading">#</a></h4><p>To redistribute connected, static, service routes and/or routes learned through OSPF, you can use the <code>redistribute</code> configuration.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# config auth admin@branchoffice1.seattlesite1 (authority)# router seattlesite1 admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# routing default-instance</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing[type=default-instance])# routing-protocol bgp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# redistribute connected</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="routing-features"></a>Routing Features<a aria-hidden="true" tabindex="-1" class="hash-link" href="#routing-features" title="Direct link to heading">#</a></h3><p>This section contains various features supported by the 128T&#x27;s BGP implementation.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="configuring-128t-as-a-route-reflector"></a>Configuring 128T as a Route Reflector<a aria-hidden="true" tabindex="-1" class="hash-link" href="#configuring-128t-as-a-route-reflector" title="Direct link to heading">#</a></h4><p>While configuring iBGP, you may need to enable the <strong>Route Reflector</strong> capability to facilitate easy learning of routes. Your 128T can be configured as a route reflector for a particular neighbor or more realistically a set of neighbors, also known as a route reflector client(s).  This can be configured in the route reflector router&#x27;s BGP config, under the respective neighbor object.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# config auth admin@branchoffice1.seattlesite1 (authority)# router seattlesite1 admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# routing default-instance</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing[type=default-instance])# routing- protocol bgp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# neighbor 1.1.1.1</span></div></div></div></div></div><p>In our example, the route reflector in our network is <code>branchoffice1</code> router, and our route reflector client is its neighbor <code>1.1.1.1</code>.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=1.1.1.1])# address-family ipv4-unicast</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# route-reflector client true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# exit</span></div></div></div></div></div><p>By setting <code>route-reflector client true</code>, we instruct the <code>branchoffice1</code> router to treat the neighbor as a route reflector client.</p><p>There is one additional field which needs to be set in route reflector&#x27;s BGP config, and that is <code>Client-ID</code>, which has the format of an IP address.  This can be set to anything unique in the AS, and can be the same as the <code>Router ID</code> field.</p><p>When the route reflector sends routes to the clients, by default it doesn&#x27;t modify the next-hop.  An outbound policy can be used to change the next-hop in these routes to that of the route reflector, if desired.  In such instances, another option, which is turned off by default, needs to be set in the route reflector&#x27;s BGP config: <code>Route Reflector Allow Outbound Policy = TRUE</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="bgp-confederations"></a>BGP Confederations<a aria-hidden="true" tabindex="-1" class="hash-link" href="#bgp-confederations" title="Direct link to heading">#</a></h4><p>When configuring iBGP, the <strong>Confederation</strong> feature may come in handy when dealing with an enormous autonomous system. This feature allows you to break up the AS into smaller sub-autonomous systems. Confederation can be directly configured under the routing protocol element. Here, 65535 is the <strong>confederation identifier AS number</strong> and, 1100 and 2200 are the <strong>member AS</strong> numbers of that confederation AS.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# config auth admin@branchoffice1.seattlesite1 (authority)# router seattlesite1 admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# routing default-instance</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing[type=default-instance])# routing- protocol bgp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# confederation identifier 65535</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# confederation member-as 1100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# confederation member-as 2200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# exit</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="bgp-over-svr-bgposvr"></a>BGP over SVR (BGPoSVR)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#bgp-over-svr-bgposvr" title="Direct link to heading">#</a></h4><p>BGP over SVR can be used when peering with a 128T. This provides the benefit of Secure Vector Routing for all BGP traffic flowing to-and-from the 128T peers. To configure BGP over SVR, ensure that the running 128T system has configuration for basic platform functionality.</p><p>Next, we need to configure a <em>routing interface</em>, which is similar to a loopback interface on traditional routers. Unlike normal loopback BGP peering, this IP address does not need to be routable on the transport network as it will never see the wire. BGP peering will be created on this interface. The conductor will then trigger on this and configure a few more pieces (autogenerated) to activate BGP over SVR, such as:</p><ul><li><em>bgp_speaker</em> tenant</li><li>Auto-generated BGP services and service routes</li><li>Router Peers</li></ul><p>These BGP connections will then be protected by SVR, and able to flexibly migrate between SVR paths.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You must use a conductor to configure BGP over SVR; manually configuring the various pieces between two routers is not supported.</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If the interface facing the BGPoSVR peer is already part of a neighborhood, then ensure that the two routers&#x27; interface topology types (<code>network-interface &gt;neighborhood &gt; topology</code>) are configured such that it allows the routers to form peering relationships for the auto-generated peer service routes; e.g., mesh-mesh, mesh-hub, mesh-spoke or hub-spoke.</p></div></div><p>Next, configure a BGP instance with the routerâ€™s local AS and a router-id which matches the routing interface&#x27;s IP. For each BGP over SVR peer, use a neighbor address of the neighbor&#x27;s routing interface IP address. Next, configure the normal BGP peer configuration options such as the timers and address families that are needed. In address-family IPv4-unicast, <code>next-hop-self</code> must be set to <code>true</code>.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>When configuring BGPoSVR with an eBGP peer, you must set <code>multihop ttl</code> to at least <code>2</code>.</p></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="configuration-template"></a>Configuration Template:<a aria-hidden="true" tabindex="-1" class="hash-link" href="#configuration-template" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    router myRouter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        routing default-instance</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            type default-instance</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            interface rtg-int</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                name rtg-int</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ip-address &lt;myAddress&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            routing-protocol bgp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                type bgp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                local-as 100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                router-id &lt;myAddress&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                neighbor &lt;theirAddress&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                neighbor-as 200</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                timers</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    hold-time 9</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    keepalive-interval 3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                address-family ipv4-unicast</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    afi-safi ipv4-unicast</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    next-hop-self true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                transport</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    local-address</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        routing-interface rtg-int</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                multihop</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    ttl 255</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span></div></div></div></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="sample-configuration"></a>Sample Configuration:<a aria-hidden="true" tabindex="-1" class="hash-link" href="#sample-configuration" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# config auth admin@branchoffice1.seattlesite1 (authority)# router seattlesite1 admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# routing default-instance</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing[type=default-instance])# interface bgp-int-seattle</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (interface[name=bgp-int-seattle])# ip- address 10.128.128.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (interface[name=bgp-int-seattle])# exit admin@branchoffice1.seattlesite1 (routing[type=default-instance])# routing- protocol bgp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# local-as 100 admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# router-id 10.128.128.2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# address- family ipv4-unicast</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# neighbor 10.128.128.1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=10.128.128.1])# neighbor-as 300</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=10.128.128.1])# address-family ipv4-unicast</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# next-hop-self true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (address-family[afi-safi=ipv4-unicast])# exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=10.128.128.1])# transport</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (transport)# local-address</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (local-address)# routing-interface bgp-int-seattle</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (local-address)# exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (transport)# exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=10.128.128.1])# multihop</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (multihop)# ttl 255</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (multihop)# exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (neighbor[neighbor-address=10.128.128.1])# exit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1 (routing-protocol[type=bgp])# exit admin@branchoffice1.seattlesite1 (routing[type=default-instance])# exit admin@branchoffice1.seattlesite1 (router[name=seattlesite1])# exit admin@branchoffice1.seattlesite1 (authority)# exit admin@branchoffice1.seattlesite1#</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="verifying-the-bgp-configuration"></a>Verifying the BGP Configuration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#verifying-the-bgp-configuration" title="Direct link to heading">#</a></h4><p>Use <code>show bgp</code> to see the overview of the BGP routing process on the 128T:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# show bgp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2019-02-20 23:14:58 UTC</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BGP table version is 12, local router ID is 10.128.128.2, vrf id 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Status codes:  s suppressed, d damped, h history, * valid, &gt; best, = multipath,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">               i internal, r RIB-failure, S Stale, R Removed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Nexthop codes: @NNN nexthop&#x27;s vrf id, &lt; announce-nh-self</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Origin codes:  i - IGP, e - EGP, ? - incomplete</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   Network          Next Hop            Metric LocPrf Weight Path</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   10.128.128.2/32  10.128.128.3                           0 200 300 ?</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   10.128.128.3/32  10.128.128.3                           0 200 300 ?</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   128.128.128.1/32 10.128.128.3                           0 200 300 ?</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   128.128.128.128/32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    10.128.128.3                           0 200 300 ?</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   172.16.128.2/32  10.128.128.3                           0 200 300 ?</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   172.16.255.0/30  0.0.0.0                  0         32768 i</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   172.26.128.0/30  10.128.128.3                           0 200 300 i</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Displayed  7 routes and 7 total paths</span></div></div></div></div></div><p>In addition to the output from <code>show bgp</code>, you will now see contributions to the RIB from BGP in the output of <code>show rib</code>.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1# show rib</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Wed 2019-02-20 23:04:20 UTC</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Codes: K - kernel route, C - connected, S - static, R - RIP,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       O - OSPF, I - IS-IS, B - BGP, P - PIM, T - Table, v - VNC,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       V - VNC-Direct,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       &gt; - selected route, * - FIB route</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">B   1.1.1.0/24 [20/0] via 1.1.1.1 inactive, 22:28:18</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 1.1.1.0/24 is directly connected, g4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">B&gt;* 2.2.2.0/24 [20/0] via 1.1.1.1, g4, 22:28:18</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">B&gt;* 3.3.3.0/24 [20/0] via 1.1.1.1, g4, 22:28:18</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 10.0.128.0/31 is directly connected, g1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">K&gt;* 128.128.128.1/32 is directly connected, Null0, bh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">K&gt;* 128.128.128.128/32 is directly connected, Null0, bh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 169.254.127.126/31 is directly connected, g4294967294</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">S&gt;* 172.16.128.2/32 [1/0] via 10.0.128.1, g1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">K   172.16.128.2/32 is directly connected, Null0, bh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">K&gt;* 172.26.128.2/32 is directly connected, Null0, bh</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">C&gt;* 192.168.64.0/24 is directly connected, g2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.09 seconds</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">admin@branchoffice1.seattlesite1#</span></div></div></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>As shown in the header, the routes that start with <code>B</code> are contributed by BGP.</p></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-09-04T14:25:11.000Z" class="docLastUpdatedAt_217_">9/4/2020</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/config_basics"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Configuration Management on the 128T</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/config_reference_guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuration Element Reference Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link">Prerequisites</a></li><li><a href="#peering-with-non-128t-routers" class="table-of-contents__link">Peering with non-128T Routers</a></li><li><a href="#advertising-routes" class="table-of-contents__link">Advertising Routes</a></li><li><a href="#routing-features" class="table-of-contents__link">Routing Features</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>Copyright Â© 2020 128 Technology, Inc.</div></div></div></footer></div>
<script src="/styles.55a5b0d8.js"></script>
<script src="/runtime~main.6d5cdf5d.js"></script>
<script src="/main.a1254e33.js"></script>
<script src="/1.bbd3324d.js"></script>
<script src="/2.c4b385fd.js"></script>
<script src="/127.65ccf4c5.js"></script>
<script src="/130.1f62f360.js"></script>
<script src="/20ac7829.3ed525dc.js"></script>
<script src="/17896441.e81f1411.js"></script>
<script src="/f94bd8bd.a6a0db1c.js"></script>
</body>
</html>
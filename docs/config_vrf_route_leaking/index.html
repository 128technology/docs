<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-config_vrf_route_leaking">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">VRF Route Leaking | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/docs/config_vrf_route_leaking"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="VRF Route Leaking | SSN Docs"><meta data-rh="true" name="description" content="Why Leak Routes?"><meta data-rh="true" property="og:description" content="Why Leak Routes?"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/docs/config_vrf_route_leaking"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/config_vrf_route_leaking" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/config_vrf_route_leaking" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8e1fdc51.css">
<link rel="preload" href="/assets/js/runtime~main.4541fa23.js" as="script">
<link rel="preload" href="/assets/js/main.5cdde051.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Juniper Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/install_conductor_overview">Conductor Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_bootable_media">Router Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_image">Image-Based Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported_cloud_platforms">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_upgrade_considerations">Upgrades and Rollback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_installer">Supporting Install Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/config_basics">Administration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_basics">Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/howto_tune_bfd">Optimizing Routing Protocols</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/howto_tune_bfd">Tuning BFD</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_bgp">BGP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/config_vrf_route_leaking">VRF Route Leaking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_ospf">OSPF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_bfd">BFD with BGP and OSPF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_multicast">Multicast</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_lacp">Link Aggregation and LACP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/config_dhcp">DHCP</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_ha">High Availability</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_access_mgmt">Access Management and Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_ntp_auth">NTP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/sec_adaptive_encrypt">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/concepts_ssr_idp">Intrusion Detection and Prevention</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_STEP">Service and Topology Exchange Protocol (STEP)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/how_to_use_app_summary">How To</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/ts_applications">Troubleshooting</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/plugin_intro">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/release_notes_128t_6.2">Release Notes</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Administration</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Optimizing Routing Protocols</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">VRF Route Leaking</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>VRF Route Leaking</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-leak-routes">Why Leak Routes?<a href="#why-leak-routes" class="hash-link" aria-label="Direct link to Why Leak Routes?" title="Direct link to Why Leak Routes?">​</a></h2><p>The word &quot;leak&quot; implies a break or a breach, and in some cases, route leaking can be malicious. However in the case of VRF route leaking it indicates the intentional sharing of route information across VRF instances. Some benefits are that traffic can be shared or balanced across VRF instances, or sharing a default route to the internet that can be adopted by each VRF. This document describes the process of configuring the import and export actions for sharing VRF routes, whether on the same router, between routers, or sharing routes from multiple VRFs between routers.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works">How It Works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How It Works" title="Direct link to How It Works">​</a></h2><p>The exchange of routes between a VRF on one SSR and a VRF on another SSR is achieved using a single BGP session in the default VRF, where the VPN address family carries the routes for multiple VRFs via that one BGP session. This configuration allows each VRF to share and copy the designated routes.</p><p>Only one instance of the BGP VPN RIB route table exists on a router within the default VRF. It can be modified to hold routes from multiple VRFs using a combination of the IP prefix and an 8-byte Route Distinguisher (RD). The RD must be configured for each VRF that is meant to export routes into the VPN table. To identify which VPN routes are imported to a VRF, a Route Target (RT) is identified. The RT is a BGP extended community attribute that identifies both the VPN RIB where the routes will be shared, and is used to identify the routes to be imported to a VRF.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="route-distinguisher">Route Distinguisher<a href="#route-distinguisher" class="hash-link" aria-label="Direct link to Route Distinguisher" title="Direct link to Route Distinguisher">​</a></h3><p>The Route Distinguisher (RD) is an identification number, used to create a distinct route to a common IPv4 address prefix. In the example below, we use the router-ID and a vlan-id from the VRF, but any number or name can be used.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="route-target">Route Target<a href="#route-target" class="hash-link" aria-label="Direct link to Route Target" title="Direct link to Route Target">​</a></h3><p>The Route Target (RT) identifies one or more routers that may receive a set of routes carried by BGP. There should be an understanding between the routers what the RT represents. In the example below, we use the local AS number (65000 from the private AS number space), and append a logical value; 1 for <code>vrfA</code> and 2 for <code>vrfB</code>. This construction makes it fairly easy to understand.  </p><p>The RFC 4364 architecture for VPN route exchange via BGP depends on an underlying MPLS transport network, so that traffic from different VRFs (with overlapping IP address space) can be tunneled through the network. The SSR does not use MPLS for this purpose. Instead of MPLS tunneling, the SSR uses SVR and the tenant concept to enable tunnel-free forwarding of VPN traffic. The tenant identifies the VRF and provides functionality similar to the VPN label in the RFC 4364 architecture. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h2><p>Route leaking can be configured for any of the following scenarios.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vrf-route-sharing-within-a-router">VRF Route Sharing Within a Router<a href="#vrf-route-sharing-within-a-router" class="hash-link" aria-label="Direct link to VRF Route Sharing Within a Router" title="Direct link to VRF Route Sharing Within a Router">​</a></h3><p>To share routes between VRF A and VRF B on the same SSR, use the following process:</p><ol><li>Configure a <code>route-distinguisher</code> for VRF A.</li><li>Configure the route export from VRF A into the VPN RIB </li></ol><ul><li>Specify the RT to attach to the exported routes </li><li>Optionally specify an export policy. </li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router     router-boston</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            routing       default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                type      default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                vrf    vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name             vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    tenant-name      tenantA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    routing-protocol    bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type            bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        local-as        65000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address-family     ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            afi-safi       ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vpn-export</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                route-distinguisher        16.0.0.2:101</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                vpn-export-route-target    65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vpn-import</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                vpn-import-route-target    65000:2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            redistribute     connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                protocol     connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address-family       ipv6-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            afi-safi         ipv6-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vpn-export</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                route-distinguisher         16.0.0.2:101</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                vpn-export-route-target     65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            vpn-import</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 vpn-import-route-target     65000:2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            redistribute     connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                protocol     connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Configure an RD for VRF B.</li><li>Configure the route import from the VPN RIB into VRF B </li></ol><ul><li>Specify the RT to attach to the exported routes </li><li>Optionally specify an export policy. </li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">                vrf      vrfB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name                vrfB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    tenant-name         tenantB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        routing-protocol    bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            type bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            local-as     65000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            address-family    ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                afi-safi      ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                vpn-export</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    route-distinguisher       16.0.0.2:102</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    vpn-export-route-target   65000:2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                vpn-import</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    vpn-import-route-target   65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                redistribute     connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    protocol     connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit                                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            address-family     ipv6-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                afi-safi       ipv6-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                vpn-export</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    route-distinguisher         16.0.0.2:102</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    vpn-export-route-target     65000:2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                vpn-import</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    vpn-import-route-target     65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                redistribute     connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    protocol     connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="some-notes">Some Notes<a href="#some-notes" class="hash-link" aria-label="Direct link to Some Notes" title="Direct link to Some Notes">​</a></h4><ul><li>Either VRF A or VRF B may be the default VRF.</li><li>Route leaking is only allowed with BGP routes, however, BGP neighbors do not need to be configured. If static, connected, or OSPF routes of a VRF are to be shared, they first need to be redistributed into BGP. </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vrf-route-sharing-between-different-routers">VRF Route Sharing Between Different Routers<a href="#vrf-route-sharing-between-different-routers" class="hash-link" aria-label="Direct link to VRF Route Sharing Between Different Routers" title="Direct link to VRF Route Sharing Between Different Routers">​</a></h3><p>Use the following configuration process to allow routes from VRF A on SSR-MZ to appear in VRF A on SSR-DZ. </p><ol><li>Configure VRF A on SSR-MZ, and identify the RD and RT.</li><li>Configure the route export from vrfA into the VPN RIB, </li></ol><ul><li>Specify the RT to attach to the exported routes </li><li>Optionally specify an export policy. (more steps)</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router SSR-MZ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                vrf vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                   name vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                   tenant-name tenantA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                   routing-protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       type bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       local-as 65000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       router-id 16.0.0.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       address-family ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           afi-safi ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           vpn-export</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                               route-distinguisher 16.0.0.2:101</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                               vpn-export-route-target 65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           vpn-import</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                               vpn-import-route-target 65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       address-family ipv6-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           afi-safi ipv6-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           vpn-export</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                               route-distinguisher 16.0.0.2:101</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                               vpn-export-route-target 65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           vpn-import</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                               vpn-import-route-target 65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       redistribute connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           protocol connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                   exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Configure the route import from the VPN RIB into vrfA on SSR-DZ</li></ol><ul><li>Select what routes to import by specifying the same RT as in the previous steps</li><li>Optionally specify an import policy. (more steps)</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router SSR-DZ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                vrf vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    tenant-name tenantA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    routing-protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        local-as 65000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        router-id 16.0.0.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            address-family ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                afi-safi ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                vpn-export</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    route-distinguisher 16.0.0.3:201</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    vpn-export-route-target 65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                vpn-import                                          </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    vpn-import-route-target 65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            address-family ipv6-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                redistribute connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    protocol connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                afi-safi ipv6-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                vpn-export</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    route-distinguisher 16.0.0.3:201</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    vpn-export-route-target 65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                vpn-import</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    vpn-import-route-target 65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            redistribute connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                protocol connected</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>Configure the exchange of BGP VPN routes between SSR-MZ and SSR-DZ. Configure the VPN address family on each BGP neighbor. If the routers are direct BGP neighbors, the BGP peering is done using each router’s default VRF, where the VPN RIB is located. The result is the exchange of routes between SSR-MZ and SSR-DZ from the VPN RIB, allowing the BGP policy mechanisms to be available to select the subset of the VPN routes for exchange, and for modifying their attributes.</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router SSR-DZ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                type default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface loopback</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name loopback</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        ip-address 16.0.0.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    routing-protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        local-as 65000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        router-id 16.0.0.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        neighbor SSR-MZ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            neighbor-address 16.0.0.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                neighbor-as 65000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                transport</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    local-address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                        routing-interface loopback</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                address-family ipv4-vpn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    afi-safi ipv4-vpn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    next-hop-self true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                address-family ipv6-vpn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    afi-safi ipv6-vpn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    next-hop-self true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If SSR-MZ and SSR-DZ are not direct BGP neighbors, there must be some set of other BGP peers between them, configured to propagate the VPN address family routes from SSR-MZ and ultimately send them to SSR-DZ.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router SSR-MZ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                type default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface loopback</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name loopback</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        ip-address 16.0.0.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    routing-protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        local-as 65000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        router-id 16.0.0.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        neighbor SSR-DZ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            neighbor-address 16.0.0.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                neighbor-as 65000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                transport</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    local-address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                        routing-interface loopback</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                address-family ipv4-vpn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    afi-safi ipv4-vpn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    next-hop-self true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                address-family ipv6-vpn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    afi-safi ipv6-vpn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    next-hop-self true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sharing-routes-from-multiple-vrfs-via-a-single-bgp-session">Sharing Routes from Multiple VRFs via a Single BGP Session<a href="#sharing-routes-from-multiple-vrfs-via-a-single-bgp-session" class="hash-link" aria-label="Direct link to Sharing Routes from Multiple VRFs via a Single BGP Session" title="Direct link to Sharing Routes from Multiple VRFs via a Single BGP Session">​</a></h3><p>In a situation where SSR-MZ has multiple VRFs A, B, C; and all routes are to be shared with SSR-DZ, (which also has VRFs A, B, C) the configuration is very similar as the previous steps. The difference is using a different RT for each VRF. </p><ul><li>Export each VRF on SSR-MZ into it’s VPN RIB, using a different RT for each VRF</li><li>Share the VPN RIB routes from SSR-MZ to SSR-DZ using a single BGP session in the default VRF.</li><li>Import the routes from the VPN RIB on SSR-DZ into the respective VRF&#x27;s (based on the RT).</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="import-and-export-policies">Import and Export Policies<a href="#import-and-export-policies" class="hash-link" aria-label="Direct link to Import and Export Policies" title="Direct link to Import and Export Policies">​</a></h3><p>Import and export policies can be applied to the route leaking configuration. These can be general import/export routing policies, or specific to the VRF import/export configuration. For example, an import routing policy can be configured as below:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">            routing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                filter match-vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    type extended-community-filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name match-vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    rule r1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name r1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        extended-community 65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                filter match-vrfB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    type extended-community-filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name match-vrfB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        rule r1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name r1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           extended-community 65000:2                                 </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    filter match-vlan70</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type prefix-filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name match-vlan70</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        rule r1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name r1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix 10.70.0.0/16</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    policy select-all-of-vrfA-and-only-vlan70-from-vrfB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name select-all-of-vrfA-and-only-vlan70-from-vrfB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        statement get-vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name get-vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            condition extended-community-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                type extended-community-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                extended-community-filter match-vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        statement get-vlan70-from-vrfB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            name get-vlan70-from-vrfB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            condition address-prefix-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                type address-prefix-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                prefix-filter match-vlan70</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            condition extended-community-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                type extended-community-filter-condition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                extended-community-filter match-vrfB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This policy is then applied to both routing targets (configured earlier) as shown here:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">             router SSR-MZ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 routing default-instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                     vrf vrfA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                         routing-protocol bgp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                             address-family ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 afi-safi ipv4-unicast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 vpn-import</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     vpn-import-route-target 65000:1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     vpn-import-route-target 65000:2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     import-policy select-all-of-vrfA-and-only-vlan70-from-vrfB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this example, the vpn-import action imports both routes from vrfA and vrfB, but the policy only selects a subset of those routes.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-commands">Configuration Commands<a href="#configuration-commands" class="hash-link" aria-label="Direct link to Configuration Commands" title="Direct link to Configuration Commands">​</a></h2><p><strong>Links to configuration command documentation will be integrated when that doc is available</strong></p><p>The following commands are used to configure VRF Route Sharing.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="vpn-export"><a href="/docs/config_command_guide#configure-authority-router-routing-routing-protocol-address-family-vpn-export"><code>vpn-export</code></a><a href="#vpn-export" class="hash-link" aria-label="Direct link to vpn-export" title="Direct link to vpn-export">​</a></h4><p><code>vpn-export</code> is specified under <code>routing-protocol bgp &gt; address-family ipv4-unicast</code> (or <code>ipv6-unicast</code>) in the VRF. When the <code>vpn-export</code> configuration is present, IPv4 (or IPv6) BGP routes are exported from the VRF into the VPN RIB. The <code>route-distinguisher</code> and <code>route-target</code> attributes are mandatory and need to be specified. The <code>export-policy</code> attribute is optional and must reference an existing routing policy. When specified, this routing policy is applied when exporting the routes into the VPN RIB.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="vpn-import"><a href="/docs/config_command_guide#configure-authority-router-routing-routing-protocol-address-family-vpn-import"><code>vpn-import</code></a><a href="#vpn-import" class="hash-link" aria-label="Direct link to vpn-import" title="Direct link to vpn-import">​</a></h4><p><code>vpn-import</code> is specified under <code>routing-protocol bgp &gt; address-family ipv4-unicast</code> (or <code>ipv6-unicast</code>) in the VRF. When the <code>vpn-import</code> configuration is present, IPv4 (or IPv6) BGP routes are imported from the VPN RIB into the VRF. The <code>route-target</code> attribute is mandatory; at least one must be specified. Multiple route targets may be specified. The <code>import-policy</code> attribute is optional and must reference an existing routing policy. When specified, this routing policy is applied when importing the routes from the VPN RIB.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="address-family-ipv4-vpn"><a href="/docs/config_command_guide#configure-authority-router-routing-routing-protocol-neighbor-address-family-afi-safi"><code>address-family ipv4-vpn</code></a><a href="#address-family-ipv4-vpn" class="hash-link" aria-label="Direct link to address-family-ipv4-vpn" title="Direct link to address-family-ipv4-vpn">​</a></h4><p><code>address-family ipv4-vpn</code> can only be specified for BGP neighbors in the default VRF. All the configuration elements under <code>address-family ipv4-vpn</code> are the same as under the existing <code>address-family ipv4-unicast</code> configuration element. When this address family is configured and the BGP neighbor router has an equivalent configuration, the VPN RIB routes will be exchanged with the neighbor.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="address-family-ipv6-vpn"><a href="/docs/config_command_guide#configure-authority-router-routing-routing-protocol-neighbor-address-family-afi-safi"><code>address-family ipv6-vpn</code></a><a href="#address-family-ipv6-vpn" class="hash-link" aria-label="Direct link to address-family-ipv6-vpn" title="Direct link to address-family-ipv6-vpn">​</a></h4><p><code>address-family ipv6-vpn</code> can only be specified for BGP neighbors in the default VRF. All the configuration elements under <code>address-family ipv6-vpn</code> are the same as under the existing <code>address-family ipv4-unicast</code> configuration element. When this address family is configured and the BGP neighbor router has an equivalent configuration, the VPN RIB routes will be exchanged with the neighbor.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-11-16T21:37:51.000Z">Nov 16, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/config_bgp"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">BGP</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/config_ospf"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">OSPF</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-leak-routes" class="table-of-contents__link toc-highlight">Why Leak Routes?</a></li><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How It Works</a><ul><li><a href="#route-distinguisher" class="table-of-contents__link toc-highlight">Route Distinguisher</a></li><li><a href="#route-target" class="table-of-contents__link toc-highlight">Route Target</a></li></ul></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#vrf-route-sharing-within-a-router" class="table-of-contents__link toc-highlight">VRF Route Sharing Within a Router</a></li><li><a href="#vrf-route-sharing-between-different-routers" class="table-of-contents__link toc-highlight">VRF Route Sharing Between Different Routers</a></li><li><a href="#sharing-routes-from-multiple-vrfs-via-a-single-bgp-session" class="table-of-contents__link toc-highlight">Sharing Routes from Multiple VRFs via a Single BGP Session</a></li><li><a href="#import-and-export-policies" class="table-of-contents__link toc-highlight">Import and Export Policies</a></li></ul></li><li><a href="#configuration-commands" class="table-of-contents__link toc-highlight">Configuration Commands</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.4541fa23.js"></script>
<script src="/assets/js/main.5cdde051.js"></script>
</body>
</html>
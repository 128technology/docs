<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-167298415-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="128T Docs" href="/opensearch.xml"><title data-react-helmet="true">PCLI Packet Capture | 128T Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="PCLI Packet Capture | 128T Docs"><meta data-react-helmet="true" name="description" content="PCAPs are one of the most useful tools to debug traffic issues on a 128T Router(s) as well as wider networking issues. The nature of troubleshooting is that it is transitory; once the problem has been identified, the system state should be restored to its previous state (or possibly with necessary modifications as a result of the troubleshooting exercise). This guide walks through the approaches for applying dynamic capture filters to the 128T Networking Platform."><meta data-react-helmet="true" property="og:description" content="PCAPs are one of the most useful tools to debug traffic issues on a 128T Router(s) as well as wider networking issues. The nature of troubleshooting is that it is transitory; once the problem has been identified, the system state should be restored to its previous state (or possibly with necessary modifications as a result of the troubleshooting exercise). This guide walks through the approaches for applying dynamic capture filters to the 128T Networking Platform."><meta data-react-helmet="true" property="og:url" content="https://docs.128technology.com/docs/ts_packet_capture"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://docs.128technology.com/docs/ts_packet_capture"><link rel="stylesheet" href="/styles.9a832058.css">
<link rel="preload" href="/styles.73668351.js" as="script">
<link rel="preload" href="/runtime~main.26b87c82.js" as="script">
<link rel="preload" href="/main.410f8457.js" as="script">
<link rel="preload" href="/1.63ea54f5.js" as="script">
<link rel="preload" href="/2.941882b3.js" as="script">
<link rel="preload" href="/125.367c0584.js" as="script">
<link rel="preload" href="/128.097e2975.js" as="script">
<link rel="preload" href="/20ac7829.3ec522c8.js" as="script">
<link rel="preload" href="/17896441.368b0352.js" as="script">
<link rel="preload" href="/eb901005.0c07aba5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title">Technology</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.128technology.com/home" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Interchange</a><a href="https://www.128technology.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">⌘</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/128t_black.png" alt="128 Technology Logo"><strong class="navbar__title">Technology</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro_getting_started">Docs</a></li><li class="menu__list-item"><a href="https://community.128technology.com/home" target="_blank" rel="noopener noreferrer" class="menu__link">Interchange</a></li><li class="menu__list-item"><a href="https://www.128technology.com/" target="_blank" rel="noopener noreferrer" class="menu__link">Company</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_128t">128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_releases">128T Releases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_support_policy">Software Support Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_supported_platforms">Platform Support Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_security_policy">Security Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about_svr_savings">SVR Savings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/CONTRIBUTING">Contributing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_getting_started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_downloading_iso">Downloading ISOs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_installer">Installing 128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_bootable_media">Installing From ISO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_aws">Installing in AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_otp_iso">Installing From OTP ISO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_quickstart_aws">QuickStart installation in AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_installation_azure">Installing in Azure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_ztp">QuickStart</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_creating_bootable_usb">Creating Bootable USB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_upgrading">Upgrading</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/intro_rollback">Rollback</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_application_discovery">Application Discovery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_appid">Application Identification</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_ha_theoryofoperation">HA - Theory of Operation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_interface_types">Interface Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_kni">Kernel Network Interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_linux_host_networking">Linux Host Networking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_network_planes">Forwarding Planes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_metadata">128T Metadata</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_metrics">Metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_machine_communication">Machine Communication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_pcli">PCLI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_session_timer">Session Timers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_waypoint_ports">Waypoints</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/concepts_glossary">Glossary</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Administration</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_asset_connection_resiliency">Asset Connection Resiliency</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_basics">Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_bgp">BGP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_reference_guide">Element Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_audit_log">Audit Log</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_dhcp">DHCP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_dns_proxy">DNS Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_dual_router_ha">High Availability (Dual Router)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_ldap">LDAP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_ha">High Availability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_management_over_forwarding">Management over Forwarding</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_non_forwarding_ha_interfaces">Non-forwarding HA Interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_adding_interfaces_to_ha_team">Adding Interfaces to HA Team Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_transition_standalone_to_ha">Transitioning a Conductor from Standalone to HA</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_nat">NAT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_ospf">OSPF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_rate_limiting">Rate Limiting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_snmp">SNMP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_snmp_metrics">SNMP: User defined metrics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_static_hostname_mapping">Static Hostname Mappings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_tenants">Tenants</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/config_templates">Configuration Templates</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">How To</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_conductor_migration">Conductor Migration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_extend_gui_nav">Extending GUI Nav</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_lte">LTE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_maintenance_mode">Maintenance Mode</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_ms365">Microsoft 365</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_trusted_ca_certificate">Adding a Trusted Certificate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/howto_tune_bfd">Tuning BFD</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_applications">Application Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_ap_salt_minion">AP: Salt Minion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_cpu_spikes">CPU Spikes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_connecting_to_routers">Connecting to Routers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_forwarding_resource_pools">Forwarding Plane Resource Pools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_logs">Logs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_mac_uniqueness">MAC Address Uniqueness</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/ts_packet_capture">PCLI Packet Capture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_t1_troubleshooting">T1 Troubleshooting</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Events</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_overview">Alarm and Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_alarms">Alarms</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/events_events">Events</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Best Practices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_att_avpn_configuration">AT&amp;T AVPN Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_conductor_deployment">Conductor Deployment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_qos_msft_expressroute">ExpressRoute QoS Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_lte_peering">LTE Peering</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_monitoring_headends">Monitoring Head End Routers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_salt_pillars">Saltstack at Scale With 128T</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_sdwan_design_guide">SD-WAN Design Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_service_and_service_policy_design">Service and Service Policy Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_service-policy_defaults">Service Policy Baseline Defaults</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bcp_tenants">Tenancy Design</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CLI Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli_reference">Command Line Reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_dns_app_id">DNS App Id</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_dns_cache">DNS Cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_gre">GRE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_icmp_reachability_detection">ICMP Reachability Detection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_ipsec_client">IPsec Client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_loopback_static_routes">Loopback Static Routes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_m800_watchdog">M800 Watchdog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_monitoring_agent">Monitoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_mosh">Mosh</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_sip_alg">SIP ALG</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugin_wireguard">Wireguard</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">REST APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api_rest_4.2.0">128T-4.2.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Release Notes</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.5">4.5</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.4">4.4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.3">4.3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.2">4.2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.1">4.1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_4.0">4.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T Installer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.6">2.6</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.5">2.5</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.4">2.4</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.3">2.3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.2">2.2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_installer_2.1">2.1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T SIP ALG</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_sip_alg_2.1">2.1</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">128T ZScaler</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/release_notes_128t_zscaler_1.1">1.1</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">PCLI Packet Capture</h1></header><div class="markdown"><p>PCAPs are one of the most useful tools to debug traffic issues on a 128T Router(s) as well as wider networking issues. The nature of troubleshooting is that it is transitory; once the problem has been identified, the system state should be restored to its previous state (or possibly with necessary modifications as a result of the troubleshooting exercise). This guide walks through the approaches for applying dynamic capture filters to the 128T Networking Platform.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="packet-capture-per-device-interface"></a>Packet Capture per Device Interface<a aria-hidden="true" tabindex="-1" class="hash-link" href="#packet-capture-per-device-interface" title="Direct link to heading">#</a></h2><p>Enabling packet capture through configuration, while useful for defining filters that will survive a reboot, can pose challenges while debugging. Pending configuration changes may exist, requiring reverting the configuration so as to apply a capture filter. Thankfully there exists a dynamic way to apply capture filters to a device interface that does not require making configuration changes.</p><p>When using dynamic capture filters, the following rules apply:</p><ul><li>Creating or removing a dynamic capture filter does not persist and will not survive a restart of the 128T software</li><li>Interactions exist with configured capture filters<ul><li>If capture filters exist within the configuration and a configuration change happens that does not impact static capture filters, the configuration change will not affect dynamic capture filters</li><li>If static capture filters exist within the configuration, and if a configuration change modifies the static capture filters, all dynamic capture filters will be removed</li></ul></li></ul><p>Three commands provide the capabilities to manage dynamic capture filters.</p><ul><li><a href="/docs/cli_reference#create-capture-filter">create capture-filter</a></li><li><a href="/docs/cli_reference#delete-capture-filter">delete capture-filter</a></li><li><a href="/docs/cli_reference#show-capture-filters">show capture-filter</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="create-capture-filter"></a>create capture-filter<a aria-hidden="true" tabindex="-1" class="hash-link" href="#create-capture-filter" title="Direct link to heading">#</a></h3><p>Dynamic capture filters use Berkeley Packet Filter (BPF) syntax, the same as statically configured capture filters. If the syntax is not correct, the filter will be rejected. Please refer to <a href="https://biot.com/capstats/bpf.html" target="_blank" rel="noopener noreferrer">online BPF documentation</a> for syntax help. If a capture filter already exists, the create operation will be ignored.</p><p>The syntax for creating a capture filter can be seen below:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; create capture-filter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  usage: capture-filter [force] [router &lt;router&gt;] [node &lt;node&gt;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                         device-interface &lt;device-interface&gt; &lt;capture-filter&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Creates capture-filter from highway at the specified node</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  keyword arguments:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  device-interface    The device interface on which to create the capture</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      filter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  force               Skip confirmation prompt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  node                The node on which to create the capture filter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  router              The router on which to create the capture filter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  positional arguments:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  capture-filter      The capture-filter to create (Uses BPF syntax)</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="delete-capture-filter"></a>delete capture-filter<a aria-hidden="true" tabindex="-1" class="hash-link" href="#delete-capture-filter" title="Direct link to heading">#</a></h3><p>This command can be used to remove dynamic capture filters as well as temporarily removing any static capture filtered added through configuration.  The command will return an error if the capture filter is not present.</p><p>The syntax for removing a capture filter can be seen below:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; delete capture-filter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  usage: capture-filter [force] [router &lt;router&gt;] [node &lt;node&gt;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        device-interface &lt;device-interface&gt; &lt;capture-filter&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Deletes capture-filter from highway at the specified node</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  keyword arguments:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  device-interface    The device interface on which to delete the capture</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      filter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  force               Skip confirmation prompt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  node                The node on which to remove the capture filter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  router              The router on which to remove the capture filter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  positional arguments:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  capture-filter    The capture-filter to remove (Uses BPF syntax)</span></div></div></div></div></div><p>The keyword <code>all</code> can be used as an argument to <code>device-interface</code> to remove all capture filters on a particular node and router.  Omitting <code>capture-filter</code> from the command will remove all capture filters for a specified device interface.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="show-capture-filter"></a>show capture-filter<a aria-hidden="true" tabindex="-1" class="hash-link" href="#show-capture-filter" title="Direct link to heading">#</a></h3><p>In order to display both static and dynamic capture filters, the <em>show capture-filters</em> PCLI command will reflect the current state capture filters.</p><p>The syntax for displaying static and dynamic capture filters can be seen below:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; show capture-filters</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  usage: capture-filters [device-interface &lt;device-interface&gt;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                         [force] [router &lt;router&gt;] [node &lt;node&gt;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Show active capture-filters</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  keyword arguments:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  device-interface    Device interface on which to show capture-filters</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  force               Skip confirmation prompt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  node                The node on which to show capture-filters</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  router              The router on which to show capture-filters</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="selective-packet-capture"></a>Selective Packet Capture<a aria-hidden="true" tabindex="-1" class="hash-link" href="#selective-packet-capture" title="Direct link to heading">#</a></h2><p>While a powerful tool, it can be difficult to isolate a particular set of packets pertaining to a service using device-interface packet captures; especially if the session that is being tracked is an SVR session, where the IPs and L4 ports will be NATed. To simplify the troubleshooting effort, selective packet captures provides filtering controls beyond what is capable with BPF, and affords the administrator the ability to match traffic by service. A powerful capability of this feature is to apply a trace not only on the ingress node where the capture is defined, but also triggering traces on every subsequent 128T node the session traverses.</p><p>Selective capture can operate in one of two modes:</p><ul><li><em>local-only</em> mode will trigger a capture only on the node to which the command is issued</li><li><em>default</em> mode will propagate the capture to all subsequent 128T nodes the session traverses</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Much like per device interface packet captures, selective packet captures will not survive a restart of the 128T.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="default-mode"></a>Default Mode<a aria-hidden="true" tabindex="-1" class="hash-link" href="#default-mode" title="Direct link to heading">#</a></h3><p>There are four locations within the 128T wherein capturing packets will provide full visibility into the behavior of a packet.</p><ol><li>Forward flow of a session arriving on the ingress interface (before any NATing has been applied)</li><li>Forward flow of a session leaving the egress interface (post NAT with decrypted metadata)</li><li>Reverse flow of a session arriving on the egress interface</li><li>Reverse flow of a session leaving the ingress interface</li></ol><p>When creating a selective capture filter on the LAN interface, sessions will be tagged with an action that will capture all packets for the session at each of the four points listed above. Additionally, <a href="/docs/concepts_metadata">metadata</a> will indicate to subsequent 128T nodes/routers to enable the packet capture for this session. Each 128T node will install capture filters in each of the four capture points for the same session. A <a href="https://www.tcpdump.org/pcap.html" target="_blank" rel="noopener noreferrer">PCAP</a> file will be created on each node, containing the name of the service captured.</p><p><img src="/img/ts_packet_capture_selective_capture.png" alt="Typical Network Diagram"></p><p>Referencing the above diagram, a capture on node1.routerA will create PCAPs for a single session on each of the 12 points shown.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="local-mode"></a>Local Mode<a aria-hidden="true" tabindex="-1" class="hash-link" href="#local-mode" title="Direct link to heading">#</a></h4><p>When creating selective packet captures in <em>local-mode</em>, a user can initiate a capture filter, targeting a particular node. No other &quot;downstream&quot; nodes will capture this session.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="creating-selective-packet-capture"></a>Creating Selective Packet Capture<a aria-hidden="true" tabindex="-1" class="hash-link" href="#creating-selective-packet-capture" title="Direct link to heading">#</a></h3><p>Executing <code>create session-capture</code> will create a file with the name <code>128T_service_&lt;service-name&gt;.pcap</code> on each node the session traverses. Additionally, <code>INFO</code> level logging for session setup and tear down will be added to the <code>serviceArea.log</code>. All sessions captured for the same service, even if they match more than one filter will be added to the same file and the “.pcap” file.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>There is no mechanism to stop a capture for an existing session once the capture is in progress. Each session defaults to capturing 100 packets.</p></div></div><p>The syntax for creating a selective capture filter can be seen below:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; create session-capture</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">usage: session-capture [source-ip &lt;source-ip&gt;] [source-port &lt;source-port&gt;] [destination-ip &lt;destination-ip&gt;] [destination-port &lt;destination-port&gt;] [protocol &lt;protocol&gt;] [session-count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                       &lt;session-count&gt;] [packet-count &lt;packet-count&gt;] [local-only] [force] [router &lt;router&gt;] [node &lt;node&gt;] service &lt;service&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Creates a session capture at the specified node for service</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">When destination or source IPs are not specified, any IP will be matched.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">When destination or source port is not provided, port range of 0-65535 is used.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">When protocol is not provided, all protocols will be matched.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">When session-count is not specified, default will be unlimited.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">When packet-count is not specified, default is 100 packets in each direction for each session matched.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">keyword arguments:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">destination-ip      The destination IP address/prefix to match</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">destination-port    The destination port to match (can be a range)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">force               Skip confirmation prompt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">local-only          Session capture is local to the node</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node                The ingress node on which to create the session capture</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">packet-count        The number of packets to capture per session, in each direction</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">protocol            The protocol to match (in decimal or by name, eg &#x27;tcp&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">router              The router on which to create the session capture</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">service             The service on which to create the session capture</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">session-count       The number of sessions to capture</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">source-ip           The source IP address/prefix to match</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">source-port         The source port to match (can be a range)</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="removing-selective-packet-capture"></a>Removing Selective Packet Capture<a aria-hidden="true" tabindex="-1" class="hash-link" href="#removing-selective-packet-capture" title="Direct link to heading">#</a></h3><p>The selective packet capture can be removed by specifying the filter or by the uniquely generated capture id which is displayed in the <a href="#showing-selective-packet-captures">show command</a>:</p><p>The syntax for removing a selective capture filter can be seen below:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; delete session-capture</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">usage: session-capture [source-ip &lt;source-ip&gt;] [source-port &lt;source-port&gt;] [destination-ip &lt;destination-ip&gt;] [destination-port &lt;destination-port&gt;] [protocol &lt;protocol&gt;] [session-count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                       &lt;session-count&gt;] [packet-count &lt;packet-count&gt;] [local-only] [force] [router &lt;router&gt;] [node &lt;node&gt;] service &lt;service&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Deletes session-capture from selected service</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">keyword arguments:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">destination-ip      The destination IP address/prefix to match</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">destination-port    The destination port to match (can be a range)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">force               Skip confirmation prompt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">local-only          Session capture is local to the node</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node                The node on which to remove the session-capture filter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">packet-count        The number of packets to capture per session, in each direction</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">protocol            The protocol to match (in decimal or by name, eg &#x27;tcp&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">router              The router on which to remove the session-capture filter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">service             The service on which to create the session capture</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">session-count       The number of sessions to capture</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">source-ip           The source IP address/prefix to match</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">source-port         The source port to match (can be a range)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">subcommands:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">by-id    Deletes session-capture from selected service</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; delete session-capture by-id</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">usage: by-id [force] [router &lt;router&gt;] [node &lt;node&gt;] service &lt;service&gt; &lt;capture-id&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Deletes session-capture from selected service</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">keyword arguments:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">force      Skip confirmation prompt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node       The node on which to remove the session-capture filter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">router     The router on which to remove the session-capture filter</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">service    The service on which to create the session capture</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">positional arguments:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">capture-id    The session-capture to remove.</span></div></div></div></div></div><p>If the selective capture is created for a limited number of sessions, once all the sessions have been captured, the capture will remove itself. Issuing a command to remove the capture will stop any new captures for new sessions on that service and any session that is still active will continue capturing until the packet count reaches the specified or default termination count.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="showing-selective-packet-captures"></a>Showing Selective Packet Captures<a aria-hidden="true" tabindex="-1" class="hash-link" href="#showing-selective-packet-captures" title="Direct link to heading">#</a></h3><p>The syntax for displaying selective packet capture filters can be seen below:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; show session-captures</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">usage: session-captures [{id &lt;id&gt; | detail}] [service &lt;service&gt;] [force] [router &lt;router&gt;] [node &lt;node&gt;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Show active session-captures</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">keyword arguments:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">detail     display session-captures in detail</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">force      Skip confirmation prompt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">id         The session-capture to show in detail</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node       The node on which to show session-captures</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">router     The router on which to show session-captures</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">service    Service for which to show session-captures</span></div></div></div></div></div><p>The output from the show command will display currently enabled capture filters as well as the session IDs for those sessions that were captured.  With no parameters, the command will display a summary of all captures for all services.  Below is a sample output, with two captures for service “west”, and one capture for service “east”, with one active session being captured.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">========= ==== =================== =================== ========== ==================== =================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Service   Id   Source              Destination         Protocol   Remaining Sessions   Active Sessions</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">========= ==== =================== =================== ========== ==================== =================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> west       2   0.0.0.0/0:0-65535   0.0.0.0/0:0-65535   tcp        unlimited                          0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> west       5   0.0.0.0/0:0-65535   0.0.0.0/0:0-65535   icmp       unlimited                          1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> east       1   0.0.0.0/0:0-65535   0.0.0.0/0:0-65535   icmp       unlimited                          0</span></div></div></div></div></div><p>If you specify the service and capture ID via arguments, you will see details of the sessions being captured.  In the above example you can see that service “west” has an active session on capture <code>5</code>.  The detailed view can be seen below, where it shows session “1640858e-fe6a-44cd-b38a-7d479a68418” is actively being captured:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; show session-captures service west id 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2020-06-08 11:32:57 EDT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">=============================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Router: Novigrad</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">=============================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> ===========================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Service: west</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Id:      5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> ===========================================</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Filter:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    source-ip:        0.0.0.0/0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    source-port:      0-65535</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    destination-ip:   0.0.0.0/0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    destination-port: 0-65535</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    protocol:         icmp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    packet-count:     100</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    session-count:    unlimited</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Sessions:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    active:           1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      1640858e-fe6a-44cd-b38a-7d479a68418</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    remaining:        unlimited</span></div></div></div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-07-06T20:21:18.000Z" class="docLastUpdatedAt_217_">7/6/2020</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/ts_mac_uniqueness"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« MAC Address Uniqueness on 128T</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/ts_t1_troubleshooting"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">T1 Troubleshooting »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#packet-capture-per-device-interface" class="table-of-contents__link">Packet Capture per Device Interface</a><ul><li><a href="#create-capture-filter" class="table-of-contents__link">create capture-filter</a></li><li><a href="#delete-capture-filter" class="table-of-contents__link">delete capture-filter</a></li><li><a href="#show-capture-filter" class="table-of-contents__link">show capture-filter</a></li></ul></li><li><a href="#selective-packet-capture" class="table-of-contents__link">Selective Packet Capture</a><ul><li><a href="#default-mode" class="table-of-contents__link">Default Mode</a></li><li><a href="#creating-selective-packet-capture" class="table-of-contents__link">Creating Selective Packet Capture</a></li><li><a href="#removing-selective-packet-capture" class="table-of-contents__link">Removing Selective Packet Capture</a></li><li><a href="#showing-selective-packet-captures" class="table-of-contents__link">Showing Selective Packet Captures</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>Copyright © 2020 128 Technology, Inc.</div></div></div></footer></div>
<script src="/styles.73668351.js"></script>
<script src="/runtime~main.26b87c82.js"></script>
<script src="/main.410f8457.js"></script>
<script src="/1.63ea54f5.js"></script>
<script src="/2.941882b3.js"></script>
<script src="/125.367c0584.js"></script>
<script src="/128.097e2975.js"></script>
<script src="/20ac7829.3ec522c8.js"></script>
<script src="/17896441.368b0352.js"></script>
<script src="/eb901005.0c07aba5.js"></script>
</body>
</html>
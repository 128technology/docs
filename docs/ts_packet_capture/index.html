<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ts_packet_capture">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Packet Capture | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/docs/ts_packet_capture"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Packet Capture | SSN Docs"><meta data-rh="true" name="description" content="PCAPs are one of the most useful tools to debug traffic issues on the SSR, as well as wider networking issues. The nature of troubleshooting is that it is transitory; once the problem has been identified, the system state should be restored to its previous state (or possibly with necessary modifications as a result of the troubleshooting exercise). This guide walks through the approaches for applying dynamic capture filters to the SSR Networking Platform."><meta data-rh="true" property="og:description" content="PCAPs are one of the most useful tools to debug traffic issues on the SSR, as well as wider networking issues. The nature of troubleshooting is that it is transitory; once the problem has been identified, the system state should be restored to its previous state (or possibly with necessary modifications as a result of the troubleshooting exercise). This guide walks through the approaches for applying dynamic capture filters to the SSR Networking Platform."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/docs/ts_packet_capture"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/ts_packet_capture" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/ts_packet_capture" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8e1fdc51.css">
<link rel="preload" href="/assets/js/runtime~main.83cd0453.js" as="script">
<link rel="preload" href="/assets/js/main.3b0d8498.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Session Smart</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Session Smart Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/install_conductor_overview">Conductor Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_image">Image-Based Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported_cloud_platforms">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_upgrade_considerations">Upgrades and Rollback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_installer">Supporting Install Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/config_basics">Administration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_basics">Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/howto_tune_bfd">Optimizing Routing Protocols</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_ha">High Availability</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_access_mgmt">Access Management and Authentication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_ntp_auth">NTP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/sec_adaptive_encrypt">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/concepts_ssr_idp">Intrusion Detection and Prevention</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/config_STEP">Service and Topology Exchange Protocol (STEP)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/how_to_use_app_summary">How To</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/ts_applications">Troubleshooting</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_applications">Application Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_ap_duplicate_assets">AP: Duplicate Asset ID Error</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_ap_salt_minion">AP: Salt Minion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_cpu_spikes">CPU Spikes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_connecting_to_routers">Connecting to Routers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_forwarding_resource_pools">Forwarding Plane Resource Pools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_logs">Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_mac_uniqueness">MAC Address Uniqueness</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/ts_packet_capture">Packet Capture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_serial_console_tsing">Serial Console Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_t1_troubleshooting">T1 Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ts_troubleshooting_vrf">Troubleshooting VRF</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/plugin_intro">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/release_notes_128t_6.0">Release Notes</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Administration</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Troubleshooting</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Packet Capture</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Packet Capture</h1></header><p>PCAPs are one of the most useful tools to debug traffic issues on the SSR, as well as wider networking issues. The nature of troubleshooting is that it is transitory; once the problem has been identified, the system state should be restored to its previous state (or possibly with necessary modifications as a result of the troubleshooting exercise). This guide walks through the approaches for applying dynamic capture filters to the SSR Networking Platform.</p><p>Packet capture information can be viewed and configured from both the PCLI and the <a href="#packet-capture-in-the-gui">user interface</a>. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pcli-packet-capture-per-device-interface">PCLI Packet Capture per Device Interface<a href="#pcli-packet-capture-per-device-interface" class="hash-link" aria-label="Direct link to PCLI Packet Capture per Device Interface" title="Direct link to PCLI Packet Capture per Device Interface">​</a></h2><p>Enabling packet capture through configuration, while useful for defining filters that will survive a reboot, can pose challenges while debugging. Pending configuration changes may exist, requiring reverting the configuration so as to apply a capture filter. Thankfully there exists a dynamic way to apply capture filters to a device interface that does not require making configuration changes.</p><p>When using dynamic capture filters, the following rules apply:</p><ul><li>Creating or removing a dynamic capture filter does not persist and will not survive a restart of the SSR software</li><li>Interactions exist with configured capture filters<ul><li>If capture filters exist within the configuration and a configuration change happens that does not impact static capture filters, the configuration change will not affect dynamic capture filters</li><li>If static capture filters exist within the configuration, and if a configuration change modifies the static capture filters, all dynamic capture filters will be removed</li></ul></li></ul><p>Three commands provide the capabilities to manage dynamic capture filters.</p><ul><li><a href="/docs/cli_reference#create-capture-filter">create capture-filter</a></li><li><a href="/docs/cli_reference#delete-capture-filter">delete capture-filter</a></li><li><a href="/docs/cli_reference#show-capture-filters">show capture-filter</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-capture-filter">create capture-filter<a href="#create-capture-filter" class="hash-link" aria-label="Direct link to create capture-filter" title="Direct link to create capture-filter">​</a></h3><p>Dynamic capture filters use Berkeley Packet Filter (BPF) syntax, the same as statically configured capture filters. If the syntax is not correct, the filter will be rejected. Please refer to <a href="https://biot.com/capstats/bpf.html" target="_blank" rel="noopener noreferrer">online BPF documentation</a> for syntax help. If a capture filter already exists, the create operation will be ignored.</p><p>The syntax for creating a capture filter can be seen below:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; create capture-filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  usage: capture-filter [force] [router &lt;router&gt;] [node &lt;node&gt;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                         device-interface &lt;device-interface&gt; &lt;capture-filter&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Creates capture-filter from highway at the specified node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  keyword arguments:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  device-interface    The device interface on which to create the capture</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                      filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  force               Skip confirmation prompt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  node                The node on which to create the capture filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  router              The router on which to create the capture filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  positional arguments:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  capture-filter      The capture-filter to create (Uses BPF syntax)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="delete-capture-filter">delete capture-filter<a href="#delete-capture-filter" class="hash-link" aria-label="Direct link to delete capture-filter" title="Direct link to delete capture-filter">​</a></h3><p>This command can be used to remove dynamic capture filters as well as temporarily removing any static capture filtered added through configuration.  The command will return an error if the capture filter is not present.</p><p>The syntax for removing a capture filter can be seen below:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; delete capture-filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  usage: capture-filter [force] [router &lt;router&gt;] [node &lt;node&gt;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        device-interface &lt;device-interface&gt; &lt;capture-filter&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Deletes capture-filter from highway at the specified node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  keyword arguments:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  device-interface    The device interface on which to delete the capture</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                      filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  force               Skip confirmation prompt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  node                The node on which to remove the capture filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  router              The router on which to remove the capture filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  positional arguments:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  capture-filter    The capture-filter to remove (Uses BPF syntax)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The keyword <code>all</code> can be used as an argument to <code>device-interface</code> to remove all capture filters on a particular node and router.  Omitting <code>capture-filter</code> from the command will remove all capture filters for a specified device interface.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="show-capture-filter">show capture-filter<a href="#show-capture-filter" class="hash-link" aria-label="Direct link to show capture-filter" title="Direct link to show capture-filter">​</a></h3><p>In order to display both static and dynamic capture filters, the <em>show capture-filters</em> PCLI command will reflect the current state capture filters.</p><p>The syntax for displaying static and dynamic capture filters can be seen below:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; show capture-filters</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  usage: capture-filters [device-interface &lt;device-interface&gt;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                         [force] [router &lt;router&gt;] [node &lt;node&gt;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Show active capture-filters</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  keyword arguments:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  device-interface    Device interface on which to show capture-filters</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  force               Skip confirmation prompt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  node                The node on which to show capture-filters</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  router              The router on which to show capture-filters</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="selective-packet-capture">Selective Packet Capture<a href="#selective-packet-capture" class="hash-link" aria-label="Direct link to Selective Packet Capture" title="Direct link to Selective Packet Capture">​</a></h2><p>While a powerful tool, it can be difficult to isolate a particular set of packets pertaining to a service using device-interface packet captures; especially if the session that is being tracked is an SVR session, where the IPs and L4 ports will be NATed. To simplify the troubleshooting effort, selective packet captures provides filtering controls beyond what is capable with BPF, and affords the administrator the ability to match traffic by service. A powerful capability of this feature is to apply a trace not only on the ingress node where the capture is defined, but also triggering traces on every subsequent SSR node the session traverses.</p><p>Selective capture can operate in one of two modes:</p><ul><li><em>local-only</em> mode will trigger a capture only on the node to which the command is issued</li><li><em>default</em> mode will propagate the capture to all subsequent SSR nodes the session traverses</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Much like per device interface packet captures, selective packet captures will not survive a restart of the SSR.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="default-mode">Default Mode<a href="#default-mode" class="hash-link" aria-label="Direct link to Default Mode" title="Direct link to Default Mode">​</a></h3><p>There are four locations within the SSR wherein capturing packets will provide full visibility into the behavior of a packet.</p><ol><li>Forward flow of a session arriving on the ingress interface (before any NATing has been applied)</li><li>Forward flow of a session leaving the egress interface (post NAT with decrypted metadata)</li><li>Reverse flow of a session arriving on the egress interface</li><li>Reverse flow of a session leaving the ingress interface</li></ol><p>When creating a selective capture filter on the LAN interface, sessions will be tagged with an action that will capture all packets for the session at each of the four points listed above. Additionally, <a href="/docs/concepts_metadata">metadata</a> will indicate to subsequent SSR nodes/routers to enable the packet capture for this session. Each SSR node will install capture filters in each of the four capture points for the same session. A <a href="https://www.tcpdump.org/pcap.html" target="_blank" rel="noopener noreferrer">PCAP</a> file will be created on each node, containing the name of the service captured.</p><p><img loading="lazy" alt="Typical Network Diagram" src="/assets/images/ts_packet_capture_selective_capture-a7d0ffc17c76e290192dabd14883ee9c.png" width="1305" height="486" class="img_ev3q"></p><p>Referencing the above diagram, a capture on node1.routerA will create PCAPs for a single session on each of the 12 points shown.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="local-mode">Local Mode<a href="#local-mode" class="hash-link" aria-label="Direct link to Local Mode" title="Direct link to Local Mode">​</a></h4><p>When creating selective packet captures in <em>local-mode</em>, a user can initiate a capture filter, targeting a particular node. No other &quot;downstream&quot; nodes will capture this session.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-selective-packet-capture">Creating Selective Packet Capture<a href="#creating-selective-packet-capture" class="hash-link" aria-label="Direct link to Creating Selective Packet Capture" title="Direct link to Creating Selective Packet Capture">​</a></h3><p>Executing <code>create session-capture</code> will create a file with the name <code>128T_service_&lt;service-name&gt;.pcap</code> on each node the session traverses. Additionally, <code>INFO</code> level logging for session setup and tear down will be added to the <code>serviceArea.log</code>. All sessions captured for the same service, even if they match more than one filter will be added to the same file and the “.pcap” file.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>There is no mechanism to stop a capture for an existing session once the capture is in progress. Each session defaults to capturing 100 packets.</p></div></div><p>The syntax for creating a selective capture filter can be seen below:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; create session-capture</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">usage: session-capture [source-ip &lt;source-ip&gt;] [source-port &lt;source-port&gt;] [destination-ip &lt;destination-ip&gt;] [destination-port &lt;destination-port&gt;] [protocol &lt;protocol&gt;] [session-count</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       &lt;session-count&gt;] [packet-count &lt;packet-count&gt;] [local-only] [force] [router &lt;router&gt;] [node &lt;node&gt;] service &lt;service&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Creates a session capture at the specified node for service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">When destination or source IPs are not specified, any IP will be matched.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">When destination or source port is not provided, port range of 0-65535 is used.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">When protocol is not provided, all protocols will be matched.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">When session-count is not specified, default will be unlimited.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">When packet-count is not specified, default is 100 packets in each direction for each session matched.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">keyword arguments:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">destination-ip      The destination IP address/prefix to match</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">destination-port    The destination port to match (can be a range)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">force               Skip confirmation prompt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local-only          Session capture is local to the node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">node                The ingress node on which to create the session capture</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">packet-count        The number of packets to capture per session, in each direction</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protocol            The protocol to match (in decimal or by name, eg &#x27;tcp&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router              The router on which to create the session capture</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service             The service on which to create the session capture</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">session-count       The number of sessions to capture</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source-ip           The source IP address/prefix to match</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source-port         The source port to match (can be a range)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="removing-selective-packet-capture">Removing Selective Packet Capture<a href="#removing-selective-packet-capture" class="hash-link" aria-label="Direct link to Removing Selective Packet Capture" title="Direct link to Removing Selective Packet Capture">​</a></h3><p>The selective packet capture can be removed by specifying the filter or by the uniquely generated capture id which is displayed in the <a href="#showing-selective-packet-captures">show command</a>:</p><p>The syntax for removing a selective capture filter can be seen below:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; delete session-capture</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">usage: session-capture [source-ip &lt;source-ip&gt;] [source-port &lt;source-port&gt;] [destination-ip &lt;destination-ip&gt;] [destination-port &lt;destination-port&gt;] [protocol &lt;protocol&gt;] [session-count</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       &lt;session-count&gt;] [packet-count &lt;packet-count&gt;] [local-only] [force] [router &lt;router&gt;] [node &lt;node&gt;] service &lt;service&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Deletes session-capture from selected service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">keyword arguments:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">destination-ip      The destination IP address/prefix to match</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">destination-port    The destination port to match (can be a range)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">force               Skip confirmation prompt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">local-only          Session capture is local to the node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">node                The node on which to remove the session-capture filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">packet-count        The number of packets to capture per session, in each direction</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">protocol            The protocol to match (in decimal or by name, eg &#x27;tcp&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router              The router on which to remove the session-capture filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service             The service on which to create the session capture</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">session-count       The number of sessions to capture</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source-ip           The source IP address/prefix to match</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source-port         The source port to match (can be a range)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">subcommands:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">by-id    Deletes session-capture from selected service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; delete session-capture by-id</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">usage: by-id [force] [router &lt;router&gt;] [node &lt;node&gt;] service &lt;service&gt; &lt;capture-id&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Deletes session-capture from selected service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">keyword arguments:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">force      Skip confirmation prompt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">node       The node on which to remove the session-capture filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router     The router on which to remove the session-capture filter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service    The service on which to create the session capture</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">positional arguments:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">capture-id    The session-capture to remove.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If the selective capture is created for a limited number of sessions, once all the sessions have been captured, the capture will remove itself. Issuing a command to remove the capture will stop any new captures for new sessions on that service and any session that is still active will continue capturing until the packet count reaches the specified or default termination count.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="showing-selective-packet-captures">Showing Selective Packet Captures<a href="#showing-selective-packet-captures" class="hash-link" aria-label="Direct link to Showing Selective Packet Captures" title="Direct link to Showing Selective Packet Captures">​</a></h3><p>The syntax for displaying selective packet capture filters can be seen below:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; show session-captures</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">usage: session-captures [{id &lt;id&gt; | detail}] [service &lt;service&gt;] [force] [router &lt;router&gt;] [node &lt;node&gt;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Show active session-captures</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">keyword arguments:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">detail     display session-captures in detail</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">force      Skip confirmation prompt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">id         The session-capture to show in detail</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">node       The node on which to show session-captures</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">router     The router on which to show session-captures</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">service    Service for which to show session-captures</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The output from the show command will display currently enabled capture filters as well as the session IDs for those sessions that were captured.  With no parameters, the command will display a summary of all captures for all services.  Below is a sample output, with two captures for service “west”, and one capture for service “east”, with one active session being captured.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">========= ==== =================== =================== ========== ==================== =================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Service   Id   Source              Destination         Protocol   Remaining Sessions   Active Sessions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">========= ==== =================== =================== ========== ==================== =================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> west       2   0.0.0.0/0:0-65535   0.0.0.0/0:0-65535   tcp        unlimited                          0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> west       5   0.0.0.0/0:0-65535   0.0.0.0/0:0-65535   icmp       unlimited                          1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> east       1   0.0.0.0/0:0-65535   0.0.0.0/0:0-65535   icmp       unlimited                          0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you specify the service and capture ID via arguments, you will see details of the sessions being captured.  In the above example you can see that service “west” has an active session on capture <code>5</code>.  The detailed view can be seen below, where it shows session “1640858e-fe6a-44cd-b38a-7d479a68418” is actively being captured:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt; show session-captures service west id 5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Mon 2020-06-08 11:32:57 EDT</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=============================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Router: Novigrad</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=============================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ===========================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Service: west</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Id:      5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ===========================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Filter:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    source-ip:        0.0.0.0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    source-port:      0-65535</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    destination-ip:   0.0.0.0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    destination-port: 0-65535</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    protocol:         icmp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    packet-count:     100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    session-count:    unlimited</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Sessions:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    active:           1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      1640858e-fe6a-44cd-b38a-7d479a68418</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    remaining:        unlimited</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="session-capture-in-the-gui">Session Capture in the GUI<a href="#session-capture-in-the-gui" class="hash-link" aria-label="Direct link to Session Capture in the GUI" title="Direct link to Session Capture in the GUI">​</a></h2><p>Packet capture in the GUI is labelled <strong>Session Capture</strong> and is accessed from the Tools menu. </p><p><img loading="lazy" alt="Session Capture Window" src="/assets/images/ts_session_capture_window-19f9edd46c3518c7221e57dcfc0f009d.png" width="576" height="235" class="img_ev3q"></p><p>Select a row to display the Details window for the capture. Selecting the PCAP FILE button brings you to the Logs page and displays the PCAP file, allowing you to select and download data. The capture can also be deleted from the Session Capture Details window. </p><p><img loading="lazy" alt="Session Capture Details" src="/assets/images/ts_session_capture_details-c72ed3a8181d1468f348d9c4933c22c9.png" width="576" height="253" class="img_ev3q"></p><p>To configure Session Capture, click the CREATE button to open the Create Session Capture window. Enter or select a router, and specify the information to capture. </p><p><img loading="lazy" alt="Create Session Capture" src="/assets/images/ts_create_session_capture-8a8115bbaa3716a7425a55c1e6cd0160.png" width="432" height="352" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-03-17T18:42:05.000Z">Mar 17, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/ts_mac_uniqueness"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">MAC Address Uniqueness</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/ts_serial_console_tsing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Serial Console Troubleshooting</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pcli-packet-capture-per-device-interface" class="table-of-contents__link toc-highlight">PCLI Packet Capture per Device Interface</a><ul><li><a href="#create-capture-filter" class="table-of-contents__link toc-highlight">create capture-filter</a></li><li><a href="#delete-capture-filter" class="table-of-contents__link toc-highlight">delete capture-filter</a></li><li><a href="#show-capture-filter" class="table-of-contents__link toc-highlight">show capture-filter</a></li></ul></li><li><a href="#selective-packet-capture" class="table-of-contents__link toc-highlight">Selective Packet Capture</a><ul><li><a href="#default-mode" class="table-of-contents__link toc-highlight">Default Mode</a></li><li><a href="#creating-selective-packet-capture" class="table-of-contents__link toc-highlight">Creating Selective Packet Capture</a></li><li><a href="#removing-selective-packet-capture" class="table-of-contents__link toc-highlight">Removing Selective Packet Capture</a></li><li><a href="#showing-selective-packet-captures" class="table-of-contents__link toc-highlight">Showing Selective Packet Captures</a></li></ul></li><li><a href="#session-capture-in-the-gui" class="table-of-contents__link toc-highlight">Session Capture in the GUI</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.83cd0453.js"></script>
<script src="/assets/js/main.3b0d8498.js"></script>
</body>
</html>
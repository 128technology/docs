<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-plugin_ipsec_client">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">IPsec Client plugin | SSN Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.128technology.com/docs/plugin_ipsec_client"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="IPsec Client plugin | SSN Docs"><meta data-rh="true" name="description" content="The 128T-ipsec-client plugin provides a way to send and encrypt traffic to IPsec endpoints through the SSR. It is possible to configure the plugin for each router to have multiple destination IPsec endpoints and thus the SSR will failover between them. This is accomplished by performing a Service Function Chain (SFC) with Libreswan, a third-party IPsec client. By enabling this plugin, you can provide IPsec tunnel connectivity to third party providers from your SSR."><meta data-rh="true" property="og:description" content="The 128T-ipsec-client plugin provides a way to send and encrypt traffic to IPsec endpoints through the SSR. It is possible to configure the plugin for each router to have multiple destination IPsec endpoints and thus the SSR will failover between them. This is accomplished by performing a Service Function Chain (SFC) with Libreswan, a third-party IPsec client. By enabling this plugin, you can provide IPsec tunnel connectivity to third party providers from your SSR."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.128technology.com/docs/plugin_ipsec_client"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/plugin_ipsec_client" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.128technology.com/docs/plugin_ipsec_client" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8e1fdc51.css">
<link rel="preload" href="/assets/js/runtime~main.87dc5d2a.js" as="script">
<link rel="preload" href="/assets/js/main.3b0d8498.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Juniper Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_dark.png" alt="Juniper Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Session Smart</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro_getting_started">Docs</a><a href="https://community.juniper.net/answers/communities/community-home?CommunityKey=310d1a41-12fa-4627-9a99-880145a7c87c" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Session Smart Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.juniper.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Company<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/about_128t">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_getting_started">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_system_reqs">Deployment Considerations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation">Installation Process</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/install_conductor_overview">Conductor Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_image">Image-Based Installation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/supported_cloud_platforms">Cloud Installations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_upgrade_considerations">Upgrades and Rollback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/intro_installation_installer">Supporting Install Information - Appendix</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/concepts_application_discovery">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/wan_overview">WAN Assurance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/config_basics">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/events_overview">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bcp_att_avpn_configuration">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/cli_reference">CLI and Element Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/installer_cli_reference">Installer/Initializer Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/plugin_intro">Plugins</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_aws_tgw_connect">AWS Transit Gateway Connect</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_bgp_community_services">BGP Community Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_cloud_ha">Cloud HA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_app_id">DNS App Id</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_dns_cache">DNS Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_gre">GRE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_ha_sync_redundancy">HA Sync Redundancy Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_http_probe">HTTP Probe Reachability Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_icmp_reachability_detection">ICMP Reachability Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/plugin_ipsec_client">IPsec Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_loopback_static_routes">Loopback Static Routes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_m800_watchdog">M800 Watchdog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_monitoring_agent">Monitoring Agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_mosh">Mosh</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_set_hostname">Set Hostname</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_sip_alg">SIP ALG</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_wireguard">Wireguard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin_kni_namespace_scripts">KNI Namespace Scripts</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/release_notes_128t_6.0">Release Notes</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Plugins</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">IPsec Client</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>IPsec Client plugin</h1></header><p>The 128T-ipsec-client plugin provides a way to send and encrypt traffic to IPsec endpoints through the SSR. It is possible to configure the plugin for each router to have multiple destination IPsec endpoints and thus the SSR will failover between them. This is accomplished by performing a <a href="/docs/plugin_intro#service-function-chaining">Service Function Chain (SFC)</a> with Libreswan, a third-party IPsec client. By enabling this plugin, you can provide IPsec tunnel connectivity to third party providers from your SSR.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>The instructions for installing and managing the plugin can be found <a href="/docs/plugin_intro#installation-and-management">here</a>.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h2><p>The IPsec plugin setup has the following key parts to the configuration.</p><ul><li><code>ipsec-profile</code> describing the mechanism with which to connect to the server.</li><li><code>ipsec-client</code> represent the remote endpoints or server with which the ipsec client communicates.</li><li><code>service-route</code>&#x27;s to route the traffic through the tunnels</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="profiles">Profiles<a href="#profiles" class="hash-link" aria-label="Direct link to Profiles" title="Direct link to Profiles">​</a></h3><p>The <code>router &gt; ipsec-profile</code>&#x27;s are reusable IPsec settings that can be used across multiple nodes in a router and multiple IPsec endpoint <code>remote</code>s. The table below represents the most common configuration elements for a valid ipsec profile.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ipsec-profile  zscaler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name                     zscaler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ike-encryption           aes256</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ike-digest               sha2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ike-modp                 modp1024</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        authentication-protocol  esp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        phase2-encryption        aes_gcm128</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        phase2-digest            sha2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        phase2-modp              modp1024</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ike-lifetime             1h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        connection-lifetime      8h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        perfect-forward-secrecy  true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dpddelay                 20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dpdtimeout               100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dpdaction                restart</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        local-id                 [local-id@domain.com]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        pre-shared-key           (removed)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above configuration example represents a typical profile used for a IPSec provider such as Zscaler. Please tune the settings to match the settings recommended by your provider.</p><table><thead><tr><th>Config</th><th>Type</th><th>Recommended</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>string</td><td>-</td><td>The name of the profile</td></tr><tr><td>ike-encryption</td><td>enum</td><td>aes256</td><td>Algorithm used for IKE encryption</td></tr><tr><td>ike-digest</td><td>enum</td><td>sha2</td><td>Hash algorithm used for IKE encryption</td></tr><tr><td>ike-modp</td><td>enum</td><td>modp1024</td><td>Modp group used for IKE encryption</td></tr><tr><td>authentication-protocol</td><td>enum</td><td>esp</td><td>The type of SA to be produced for authentication</td></tr><tr><td>phase2-encryption</td><td>enum</td><td>aes_gcm128</td><td>Algorithm used for phase 2 encryption</td></tr><tr><td>phase2-digest</td><td>enum</td><td>sha2</td><td>Hash algorithm used for phase 2 encryption</td></tr><tr><td>phase2-modp</td><td>enum</td><td>modp1024</td><td>Modp group used for phase 2 encryption</td></tr><tr><td>ike-lifetime</td><td>time</td><td>1h</td><td>Lifetime of the keying channel for a connection</td></tr><tr><td>connection-lifetime</td><td>time</td><td>8h</td><td>Lifetime for the security association</td></tr><tr><td>perfect-forward-secrecy</td><td>bool</td><td>yes</td><td>Whether Perfect Forward Secrecy of keys is required on the connection</td></tr><tr><td>dpddelay</td><td>seconds</td><td>20</td><td>Delay between DPP keepalives on the connection</td></tr><tr><td>dpdtimeout</td><td>seconds</td><td>100</td><td>After the period has elapsed with no traffic including DPD traffic, the connection will be declared dead</td></tr><tr><td>dpdaction</td><td>enum</td><td>restart</td><td>Action taken once the enabled peer is detected as dead</td></tr><tr><td>local-id</td><td>string</td><td>user-defined</td><td>How to identify the router for authentication. Can be an IP address of FQDN. Must be preceded with an <code>@</code> symbol to prevent resolution as shown in the example</td></tr><tr><td>pre-shared-key</td><td>string</td><td>user-defined</td><td>pre-shared key used for authentication</td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>This plugin can only connect to IPsec endpoints that support pre-shared key authentication.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="custom-options">Custom Options<a href="#custom-options" class="hash-link" aria-label="Direct link to Custom Options" title="Direct link to Custom Options">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="version-history">Version History<a href="#version-history" class="hash-link" aria-label="Direct link to Version History" title="Direct link to Version History">​</a></h5><table><thead><tr><th>Release</th><th>Modification</th></tr></thead><tbody><tr><td>3.3.0</td><td><code>profile &gt; custom-option</code> introduced</td></tr></tbody></table><p>The <code>custom-option</code> allows the user to configure additional obscure libreswan options that are not exposed via the profile and remote configuration.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router  myRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name           myRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ipsec-profile  myProfile</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name           myProfile</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                custom-option  key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name   key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    value  value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Config</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>The name of the libreswan option</td></tr><tr><td>value</td><td>The value of the option</td></tr></tbody></table><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>The <code>custom-option</code> is added to the libreswan config file; any invalid option could prevent the application from starting up.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="clients">Clients<a href="#clients" class="hash-link" aria-label="Direct link to Clients" title="Direct link to Clients">​</a></h3><p>Clients are a collection of remote endpoints which can be used for connection and failover purposes.</p><p>The main config properties of a remote endpoint are as follows.</p><table><thead><tr><th>Config</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>string</td><td>The name of the remote client to be used for sending traffic to the tunnel.</td></tr><tr><td>host</td><td>ip-or-fqdn</td><td>The address or FQDN of the remote endpoint.</td></tr><tr><td>profile</td><td>reference</td><td>The name of the profile to be used for this remote endpoint.</td></tr><tr><td>remote-id</td><td>string</td><td>The optional remote identifier used during authentication.</td></tr><tr><td>subnet</td><td>ip-prefix</td><td>The remote subnet behind the tunnel.</td></tr><tr><td>tunnel-monitor</td><td>container</td><td>Properties for monitoring the phase-2 connection. See <a href="#tunnel-monitoring">Tunnel Monitoring</a> for more information.</td></tr></tbody></table><p>Example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">router myRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name    myRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ipsec-client client1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name client1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            enabled true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            tenant ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            remote primary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name primary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                host &lt;primary-address&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                profile myProfile</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                remote-id prisma@paloalto.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                subnet 0.0.0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                tunnel-monitor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    enabled true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    destination 8.8.8.8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address 8.8.8.8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        timeout 10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        max-retries 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        interval 60</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            remote secondary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name primary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                host &lt;primary-address&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                profile myProfile</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                remote-id prisma@paloalto.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                subnet 0.0.0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                tunnel-monitor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    enabled true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    destination 8.8.8.8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address 8.8.8.8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        timeout 10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        max-retries 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        interval 60</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Only one <code>ipsec-client</code> can be configured per node, but two <code>remote</code>s can be configured per client.</p></div></div><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>The <code>ipsec-client &gt; name</code> cannot start with <code>ipsec</code> or <code>mast</code>. See notes <a href="#release-340">here</a>.</p></div></div><p>Each <code>remote</code> represents a unique tunnel destination and can be used to route traffic in/out of the tunnels. Typically each node has two tunnels to act as primary and backup.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tunnel-monitoring">Tunnel Monitoring<a href="#tunnel-monitoring" class="hash-link" aria-label="Direct link to Tunnel Monitoring" title="Direct link to Tunnel Monitoring">​</a></h3><h5 class="anchor anchorWithStickyNavbar_LWe7" id="version-history-1">Version History<a href="#version-history-1" class="hash-link" aria-label="Direct link to Version History" title="Direct link to Version History">​</a></h5><table><thead><tr><th>Release</th><th>Modification</th></tr></thead><tbody><tr><td>3.2.0</td><td><code>remote &gt; tunnel-monitor</code> introduced</td></tr></tbody></table><p>Tunnel monitoring is a way to monitor the health of individual tunnels and have them automatically restart if they become unhealthy. An ICMP ping is used for the traffic. For each <code>remote</code>, you can specify a destination, interval, timeout, and the number of max retries for each interval.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ipsec-client client1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        remote c1gateway1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            tunnel-monitor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                enabled true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                destination 8.8.8.8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    address 8.8.8.8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    timeout 10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    max-retries 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    interval 120</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tunnel-monitor-nat-network 10.128.128.0/28</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>Config</th><th>Description</th></tr></thead><tbody><tr><td><code>enabled</code></td><td>Allows you to switch tunnel monitoring on and off for a <code>remote</code>.</td></tr><tr><td><code>address</code></td><td>The IP or hostname where traffic is sent. This address must be reachable after traversing the  tunnel.</td></tr><tr><td><code>timeout</code></td><td>Duration (in seconds) within which to reach the destination. Each attempt will be made in this duration / <code>max-retries</code> interval.</td></tr><tr><td><code>max-retries</code></td><td>Number of consecutive missed ICMP ping responses from the destination within the interval before deciding that the tunnel is unhealthy.</td></tr><tr><td><code>interval</code></td><td>Duration (in seconds) of how often to perform an ICMP probe test to the probe-address.</td></tr><tr><td><code>tunnel-monitor-nat-network</code></td><td>The subnet where traffic originates. The corresponding ingress KNI&#x27;s fourth octet is used. By default, the subnet <code>10.128.128.0/28</code> is used.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-services-for-tunnel-traffic">Configuring services for tunnel traffic<a href="#configuring-services-for-tunnel-traffic" class="hash-link" aria-label="Direct link to Configuring services for tunnel traffic" title="Direct link to Configuring services for tunnel traffic">​</a></h3><p>The user can define up to four <code>ipsec-client &gt; remote</code> endpoints per node. In addition, the user must also define the necessary service and service-routes to route the tunnel traffic over the desired WAN interface.</p><p>The following example shows a configuration for capturing the tunnel traffic and allows the <code>ipsec</code> tenant as defined in <code>router &gt; ipsec-client &gt; tenant</code> config above.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service  ipsec-tunnel</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name           ipsec-tunnel</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            scope          private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address        &lt;remote-address-1&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address        &lt;remote-address-2&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            transport      udp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                protocol    udp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                port-range  4500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    start-port  4500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                port-range  500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    start-port  500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy  ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                source  ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>&lt;remote-address-1&gt;</code> and <code>&lt;remote-address-2&gt;</code> represent the <code>node &gt; ipsec-client &gt; remote &gt; host</code> address. The <code>ipsec</code> tenant is allowed as per the tenant defined under <code>ipsec-client &gt; tenant</code>. The user can split the tunnels into separate services per the routing requirements.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="directing-traffic-through-the-tunnel">Directing traffic through the tunnel<a href="#directing-traffic-through-the-tunnel" class="hash-link" aria-label="Direct link to Directing traffic through the tunnel" title="Direct link to Directing traffic through the tunnel">​</a></h3><p>The user can leverage standard SSR service and service-route to direct intended traffic over the ipsec tunnel. In the example below, all guest internet traffic is sent over the ipsec tunnel for break and inspect. This can be accomplished as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router   myRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name           myRouter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route  guest-internet-rte-primary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name          guest-internet-rte-primary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  guest-internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                next-hop      combo-east-1 primary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name  combo-east-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface  primary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route  guest-internet-rte-secondary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name          guest-internet-rte-secondary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  guest-internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                next-hop      combo-east-1 secondary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name  combo-east-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface  secondary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tenant   guest</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name  guest</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service  guest-internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name           guest-internet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            description    &quot;guest-internet access&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            scope          private</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address        0.0.0.0/0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy  guest</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                source  guest</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>service-route &gt; next-hop &gt; interface</code> must point to the corresponding <code>ipsec-client &gt; remote &gt; name</code>-intf to route the traffic through the tunnel. All available SSR routing techniques including using vectors, service-policy, etc., can be leveraged to define how the untrusted traffic is sent over the tunnels, and how to route the traffic. The SSR routes the packets through the appropriate IPSec tunnels and manages the failover as per the policy. On the return path, the encrypted traffic is processed, decrypted, and send back to the client that originated the session.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="redundancy">Redundancy<a href="#redundancy" class="hash-link" aria-label="Direct link to Redundancy" title="Direct link to Redundancy">​</a></h3><p>By default both nodes of an HA pair will create and maintain the tunnels configured for them.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="version-history-2">Version History<a href="#version-history-2" class="hash-link" aria-label="Direct link to Version History" title="Direct link to Version History">​</a></h5><table><thead><tr><th>Release</th><th>Modification</th></tr></thead><tbody><tr><td>3.5.0</td><td>Introduced Active-Standby</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="active-standby">Active-Standby<a href="#active-standby" class="hash-link" aria-label="Direct link to Active-Standby" title="Direct link to Active-Standby">​</a></h4><p>This mode of operation can be configured on a per router basis under <code>router &gt; ipsec</code>.</p><table><thead><tr><th>Config</th><th>Description</th></tr></thead><tbody><tr><td><code>redundancy-enabled</code></td><td>Turns on the active-standby mode of operation. The default is false.</td></tr><tr><td><code>redundancy-interval</code></td><td>How often to check for a failover when in active-standby mode (in seconds). The default is 1 second.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="thirdparty-software--licenses">Thirdparty Software &amp; Licenses<a href="#thirdparty-software--licenses" class="hash-link" aria-label="Direct link to Thirdparty Software &amp; Licenses" title="Direct link to Thirdparty Software &amp; Licenses">​</a></h2><h5 class="anchor anchorWithStickyNavbar_LWe7" id="version-history-3">Version History<a href="#version-history-3" class="hash-link" aria-label="Direct link to Version History" title="Direct link to Version History">​</a></h5><table><thead><tr><th>Release</th><th>Modification</th></tr></thead><tbody><tr><td>3.5.0</td><td>libreswan-3.28-1</td></tr><tr><td>1.0.0</td><td>libreswan-3.23-5</td></tr></tbody></table><ul><li>Libreswan v3.28-1.el7_5 (GNU GPLv2)</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-model">Data Model<a href="#data-model" class="hash-link" aria-label="Direct link to Data Model" title="Direct link to Data Model">​</a></h3><p>If the data model doesn’t appear in the PCLI or GUI, make sure that you have restarted the SSR service.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="logging">Logging<a href="#logging" class="hash-link" aria-label="Direct link to Logging" title="Direct link to Logging">​</a></h3><p>The <code>/var/log/128technology/persistentDataManager.log</code> file at trace level will hold whether the configuration generation was run as well as output and return code.
The <code>/var/log/128technology/automatedProvisioner.log</code> file at trace level will hold whether the pillar generation was run as well as output and return code.
Configuration and pillar generation logs can be found on the conductor under <code>/var/log/128technology/plugins/ipsec-client-config-generation.log</code> and <code>/var/log/128technology/plugins/ipsec-client-pillar-generation.log</code> respectively.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="salt">Salt<a href="#salt" class="hash-link" aria-label="Direct link to Salt" title="Direct link to Salt">​</a></h3><p>Salt status can be found on the conductor by utilizing the PCLI’s <code>show assets</code> and <code>show assets &lt;asset-id&gt;</code> commands.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcli-enhancements">PCLI Enhancements<a href="#pcli-enhancements" class="hash-link" aria-label="Direct link to PCLI Enhancements" title="Direct link to PCLI Enhancements">​</a></h3><h5 class="anchor anchorWithStickyNavbar_LWe7" id="version-history-4">Version History<a href="#version-history-4" class="hash-link" aria-label="Direct link to Version History" title="Direct link to Version History">​</a></h5><table><thead><tr><th>Release</th><th>Modification</th></tr></thead><tbody><tr><td>3.5.0</td><td>Enhanced output</td></tr></tbody></table><p>To check the status of the IPsec tunnels for a given ingress KNI, extra IPsec tunnel related output will be found in the <code>show device-interface</code> command as well as the <code>show plugin state</code> command.</p><p>Example output for a healthy tunnel:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@combo-west.RTR_WEST_COMBO# show device-interface name rem2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Tue 2020-06-30 16:44:39 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=========================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> combo-west:rem2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">=========================================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Mode:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         22:ee:4e:b6:37:a8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               1000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Duplex:              full</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                        9992</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:                   161</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                       6986</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:                  161</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                         11</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> IPSec:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     rem2:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         Tunnel Status:Up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         Tunnel Details:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Name:    ipsec-client-tunnel-secondary-rem2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Remote Host:172.16.5.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Remote id:172.16.5.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             SA Details:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 Add time:2023-03-14 18:05:03</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 In bytes:0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 Out bytes:0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Ingress Bytes:3846598</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Ingress Packets:85732</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Egress Bytes:5344740</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Egress Packets:85857</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             IKE Version:2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             IKE Algorithm Elected:AES_CBC_128-HMAC_SHA1-MODP1024</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             ESP Algorithm Elected:NULL_000-HMAC_MD5_96</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         SA Count:    1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         Up Since:    2023-03-10 04:04:08.768292</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.12 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Example output for a tunnel that is down:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">========================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> combo-west:rem1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">========================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Type:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Forwarding:          true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Mode:                host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> MAC Address:         76:78:79:fc:eb:69</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Admin Status:        up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Operational Status:  down</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Redundancy Status:   non-redundant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Speed:               0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Duplex:              unknown</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-octets:                     1962932</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-unicast-pkts:                 32710</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> in-errors:                           0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-octets:                    1373442</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-unicast-pkts:                32701</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> out-errors:                          6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> IPSec:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     rem1:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         Tunnel Status:Down</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         Tunnel Details:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Name:    ipsec-client-tunnel-primary-rem1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Remote Host:172.16.4.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         Down Reason: No response from Remote Host</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="tunnel-monitor-state">Tunnel Monitor State<a href="#tunnel-monitor-state" class="hash-link" aria-label="Direct link to Tunnel Monitor State" title="Direct link to Tunnel Monitor State">​</a></h4><p>If tunnel monitoring is enabled for a remote, corresponding tunnel monitoring state is included in the pcli commands.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"> IPSec:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     rem2:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         Tunnel Status:Up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         Tunnel Details:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Name:    ipsec-client-tunnel-secondary-rem2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Remote Host:172.16.5.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Remote id:172.16.5.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             SA Details:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 Add time:2023-03-14 18:05:03</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 In bytes:0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 Out bytes:0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Ingress Bytes:3846598</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Ingress Packets:85732</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Egress Bytes:5344740</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Egress Packets:85857</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             IKE Version:2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             IKE Algorithm Elected:AES_CBC_128-HMAC_SHA1-MODP1024</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             ESP Algorithm Elected:NULL_000-HMAC_MD5_96</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         SA Count:    1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         Up Since:    2023-03-10 04:04:08.768292</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         Tunnel Monitoring:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Destination:8.8.8.8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Status:    up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Last Attempt:2022-02-14 15:42:34</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             Last Restart:2022-02-14 15:41:15</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="metrics">Metrics<a href="#metrics" class="hash-link" aria-label="Direct link to Metrics" title="Direct link to Metrics">​</a></h3><p>Non-persistent metrics were added for the ingress/egress packets/bytes of the tunnels.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># show stats ipsec-client</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Tue 2023-03-14 18:50:47 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">✔ Retrieving statistics...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">IPSec Client Metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">================== ============ ======== =========</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Metric             Node         Remote     Value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">================== ============ ======== =========</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> received bytes     combo-west   rem1           0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    combo-west   rem2     3854998</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> received packets   combo-west   rem1           0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    combo-west   rem2       85932</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> sent bytes         combo-west   rem1        9662</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    combo-west   rem2     5356740</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> sent packets       combo-west   rem1         136</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    combo-west   rem2       86057</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.12 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="commands">Commands<a href="#commands" class="hash-link" aria-label="Direct link to Commands" title="Direct link to Commands">​</a></h3><h5 class="anchor anchorWithStickyNavbar_LWe7" id="version-history-5">Version History<a href="#version-history-5" class="hash-link" aria-label="Direct link to Version History" title="Direct link to Version History">​</a></h5><table><thead><tr><th>Release</th><th>Modification</th></tr></thead><tbody><tr><td>3.3.0</td><td><code>restart ipsec remote</code> command was introduced</td></tr></tbody></table><p>The <code>restart ipsec remote</code> command can be used to restart an individual IPSec tunnel via the conductor PCLI and UI.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor# restart ipsec remote router router-1 node node-1 remote-1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">✔ Retrieving 0/1 targets complete....</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Target: node1.conductor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">002 &quot;ipsec-client-tunnel-primary-remote-1&quot;: terminating SAs using this connection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">002 &quot;ipsec-client-tunnel-primary-remote-1&quot; #8261: deleting state (STATE_PARENT_I1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">002 &quot;ipsec-client-tunnel-primary-remote-1&quot; #8262: initiating v2 parent SA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">133 &quot;ipsec-client-tunnel-primary-remote-1&quot; #8262: STATE_PARENT_I1: initiate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Successfully retrieved info.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin@node1.conductor#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>From the conductor UI, the command can be accessed as shown in the screenshot below.</p><p><img loading="lazy" alt="IPsec Tunnel Restart Command" src="/assets/images/ipsec_tunnel_restart-148ecaf788dacf7fc5a9cfd2ef6ead65.png" width="3552" height="1262" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="systemd-services">Systemd Services<a href="#systemd-services" class="hash-link" aria-label="Direct link to Systemd Services" title="Direct link to Systemd Services">​</a></h3><p>To check the status of the IPsec client service on the router, you can run <code>show system services</code> which will show all SSR related services running on the specified node. The one for this plugin is named <code>128t-ipsec</code>.</p><p>To verify that the services are running properly on the SSR:</p><ul><li><code>systemctl status 128t-ipsec@&lt;client&gt;.service</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="failover-alarms">Failover Alarms<a href="#failover-alarms" class="hash-link" aria-label="Direct link to Failover Alarms" title="Direct link to Failover Alarms">​</a></h3><p>If a tunnel goes down, we set the corresponding ingress KNI to be operationally down. An alarm will be created when this happens.</p><p>Example output when the tunnel for <code>rem1</code> goes down:</p><div class="language-admin@combo-west.RTR_WEST_COMBO# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-admin@combo-west.RTR_WEST_COMBO# codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Tue 2020-06-30 16:42:50 UTC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============== ===================== ========== ============= =========== ==================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ID             Time                  Severity   Source        Category    Message</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">============== ===================== ========== ============= =========== ==================================</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> combo-west:8   2020-06-30 16:32:42   critical   unavailable   interface   Intf rem1 (4) operationally down</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">There are 0 shelved alarms</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Completed in 0.10 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="appendix">Appendix<a href="#appendix" class="hash-link" aria-label="Direct link to Appendix" title="Direct link to Appendix">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="generated-ssr-configuration">Generated SSR Configuration<a href="#generated-ssr-configuration" class="hash-link" aria-label="Direct link to Generated SSR Configuration" title="Direct link to Generated SSR Configuration">​</a></h3><p>A KNI per remote is created with the name of the <code>remote</code> and a single egress KNI is created with the name of the <code>ipsec-client</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-specific-ssr-configuration">User-Specific SSR Configuration<a href="#user-specific-ssr-configuration" class="hash-link" aria-label="Direct link to User-Specific SSR Configuration" title="Direct link to User-Specific SSR Configuration">​</a></h3><p>To allow the maximum flexibility on getting the traffic into the plugin&#x27;s network namespace and getting the traffic out, we rely on the user to configure those means (usually through services and service routes).</p><p>You will need to have the IPsec endpoint bound traffic sent into the KNIs with the names of the <code>remote</code>s. You can use builtin SSR failover techniques due to the KNIs being reported operationally down when the corresponding tunnel is down. You will also need to configure a way for the traffic to be routed towards the IPsec endpoint after being encrypted. All of this encrypted traffic will be assigned to the <code>tenant</code> configured under <code>ipsec-client</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="complete-example-configuration">Complete Example Configuration<a href="#complete-example-configuration" class="hash-link" aria-label="Direct link to Complete Example Configuration" title="Direct link to Complete Example Configuration">​</a></h3><p>Below is an example of a complete, but minimal configuration entered by the user.</p><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>This example configuration is good to understand all of the concepts but should not be used on a system as is.</p></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tenant ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tenant lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service         cleartext</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name            cleartext</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address         1.1.1.0/24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy   lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                source      lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                permission  allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        service         ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            name           ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            address        172.16.4.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            access-policy  ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                source      ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                permission  allow</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router               router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ipsec-profile         primary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name                 primary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                pre-shared-key       somekey1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ipsec-profile         secondary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name                 secondary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                pre-shared-key       somekey2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            node node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface          lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  lanintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name          lanintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        tenant        lan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address       172.16.1.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     172.16.1.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            gateway        2.2.2.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface          wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               wan</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  wanintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name          wanintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address       172.16.3.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     172.16.3.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  24</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            gateway        172.16.3.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ipsec-client              client1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name     client1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    enabled  true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    tenant   ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    remote   rem1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name     rem1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        host     172.16.4.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        profile  primary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    remote   rem2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name     rem2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        host     172.16.5.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        profile  secondary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route         rem1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name          rem1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  cleartext</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                next-hop      router1 rem1-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name   router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface   rem1-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    gateway-ip  169.254.129.6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route         rem2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name          rem2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  cleartext</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                next-hop      router1 rem2-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name   router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface   rem2-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    gateway-ip  169.254.129.10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            service-route         ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                name          ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                service-name  ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                next-hop      router1 wanintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    node-name   router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    interface   wanintf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    gateway-ip  172.16.3.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Upon commit, the plugin will generate other configuration as shown below:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    authority</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        router router1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            node node1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface          client1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               client1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    description        &quot;Auto-generated host interface for use with ipsec-client&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    type               host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-namespace  client1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  client1-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name       client1-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type       external</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        tenant     ipsec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address    169.254.129.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     169.254.129.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            gateway        169.254.129.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface          rem1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               rem1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    description        &quot;Auto-generated host interface for use with ipsec-client&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    type               host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-namespace  client1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  rem1-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name       rem1-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type       external</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        tenant     _internal_</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address    169.254.129.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     169.254.129.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            gateway        169.254.129.6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                device-interface          rem2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    name               rem2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    description        &quot;Auto-generated host interface for use with ipsec-client&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    type               host</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-namespace  client1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    network-interface  rem2-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        name       rem2-intf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        type       external</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        tenant     _internal_</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        address    169.254.129.9</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            ip-address     169.254.129.9</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            prefix-length  30</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                            gateway        169.254.129.10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exit</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="release-notes">Release Notes<a href="#release-notes" class="hash-link" aria-label="Direct link to Release Notes" title="Direct link to Release Notes">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-350">Release 3.5.0<a href="#release-350" class="hash-link" aria-label="Direct link to Release 3.5.0" title="Direct link to Release 3.5.0">​</a></h3><p><strong>Release Date:</strong> Mar 17, 2023</p><p><strong>Router Version</strong> 128T-ipsec-2.3.0-4</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-features-and-improvements">New Features and Improvements<a href="#new-features-and-improvements" class="hash-link" aria-label="Direct link to New Features and Improvements" title="Direct link to New Features and Improvements">​</a></h4><ul><li><strong>WAN-1298</strong> Upgrade libreswan version</li></ul><p>Upgraded from 3.23-5 to 3.28-1.</p><ul><li><strong>PLUGIN-1981</strong> Enhance the plugin state output for better insights into the tunnels</li></ul><p>The plugin now supports more helpful plugin state output such as:</p><ul><li>Down reason</li><li>Chosen ike proposal</li><li>Chosen ipsec proposal</li><li>More accurate uptime</li><li>More accurate ingress/egress bytes/packets</li><li>Ike version</li></ul><p>Example output can be found in the <a href="#pcli-enhancements">PCLI Enhancements</a> section.</p><ul><li><strong>PLUGIN-1911</strong> Support an active-standby HA mode</li></ul><p>The plugin now supports the <code>redundancy-enabled</code> <a href="#redundancy">configuration option</a>. This ensures that tunnels are being created by only one node at a time. The default behavior remains active-active.</p><ul><li><strong>PLUGIN-1913</strong> Add metrics for tunnel statistics</li></ul><p>The plugin now supports non-persisted metrics for tunnels. More details and examples can be found in the <a href="#metrics">Metrics</a> section.</p><ul><li><strong>PLUGIN-1996</strong> WAN Assurance 1.0 will display conductor managed ipsec tunnels</li></ul><p>When using the 128T-ipsec-client and 128T-mist-wan-assurance plugins together, ipsec tunnel details will show up in the Mist UI.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed">Issues Fixed<a href="#issues-fixed" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><p><strong>PLUGIN-1999</strong> Tunnels failed to come up because of unresolvable DNS during startup</p><p><em><strong>Resolution:</strong></em> The salt application no longer requires DNS to generate libreswan configuration.</p></li><li><p><strong>PLUGIN-1906</strong> DNS Proxy services were not being used for ipsec hostname resolution</p><p><em><strong>Resolution</strong></em> The plugin now automatically adds the configured ipsec tenant to dns-proxy services.</p></li><li><p><strong>PLUGIN-1782</strong> Removing destinations from tunnel monitoring config causes invalid configuration</p><p><em><strong>Resolution</strong></em> The configuration validation now accepts this configuration flow</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-340">Release 3.4.0<a href="#release-340" class="hash-link" aria-label="Direct link to Release 3.4.0" title="Direct link to Release 3.4.0">​</a></h3><p><strong>Release Date:</strong> Jul 13, 2022</p><p><strong>Router Version</strong> 128T-ipsec-2.2.4-2</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-features-and-improvements-1">New Features and Improvements<a href="#new-features-and-improvements-1" class="hash-link" aria-label="Direct link to New Features and Improvements" title="Direct link to New Features and Improvements">​</a></h4><ul><li><strong>PLUGIN-1720</strong> Added support for new ciphers for Phase-1 and Phase-2 security</li></ul><p>The plugin now support aes-256-gcm, dh-20, sha512 and no-auth encryption schemes.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-1">Issues Fixed<a href="#issues-fixed-1" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><p><strong>PLUGIN-880</strong> IPSec client connection is not initiated for certain config combinations</p><p><em><strong>Resolution:</strong></em> The ipsec client names beginning with ipsec and mast are not supported by libreswan. As part of the fix, a new config rule was added to enforce this requirement.</p></li><li><p><strong>PLUGIN-1807</strong> IPSec health monitoring configuration does not report correct status</p><p><em><strong>Resolution:</strong></em> The monitoring scripts were writing data to a non-persistent path resulting in the failure across reboots. The state directory will not be automatically re-generated on system reboots.</p></li><li><p><strong>PLUGIN-1810</strong> Trace logging in configuration results in IPSec failures</p><p><em><strong>Resolution:</strong></em> Trace level logging is now converted appropriately for IPSec configuration to prevent underlying failures.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-331">Release 3.3.1<a href="#release-331" class="hash-link" aria-label="Direct link to Release 3.3.1" title="Direct link to Release 3.3.1">​</a></h3><p><strong>Release Date:</strong> May 25, 2022</p><p><strong>Router Version</strong> 128T-ipsec-2.2.2-1</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-2">Issues Fixed<a href="#issues-fixed-2" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><p><strong>PLUGIN-1730</strong> Invalid libreswan configuration was being generated when multiple local or remote subnets were configured.</p><p><em><strong>Resolution</strong></em> The issue with the libreswan configuration generation has been resolved.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-330">Release 3.3.0<a href="#release-330" class="hash-link" aria-label="Direct link to Release 3.3.0" title="Direct link to Release 3.3.0">​</a></h3><p><strong>Release Date:</strong> Apr 27, 2022</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-features-and-improvements-2">New Features and Improvements<a href="#new-features-and-improvements-2" class="hash-link" aria-label="Direct link to New Features and Improvements" title="Direct link to New Features and Improvements">​</a></h4><ul><li><strong>PLUGIN-630</strong> Raise the number of supported IPSec client tunnels from 2 to 4</li></ul><p>The plugin now supports up to 4 IPSec tunnels per node.</p><ul><li><strong>PLUGIN-1641</strong> Optimize the initial IPSec environment setup</li></ul><p>The majority of the IPSec config and environment management is performed locally on the router thereby minimizing the interaction with salt states.</p><ul><li><strong>PLUGIN-1533</strong> Create a command to restart an individual tunnel</li></ul><p>A new command was added to allow the user to restart an individual tunnel. More details can be found in the <a href="#commands">commands section</a></p><ul><li><strong>PLUGIN-1532</strong> Enable additional configuration options for IPSec tunnels.</li></ul><p>The <code>encapsulation</code> and <code>remote-peer-type</code> options are now available for configuration.</p><ul><li><strong>PLUGIN-1554</strong> Collect ipsec-client plugin data as part of tech support info</li></ul><p>The detailed tech support info bundle will now include the necessary logs and data for troubleshooting ipsec-client plugin related problems.</p><ul><li><strong>PLUGIN-1598</strong> - Support custom options for obscure libreswan config fields</li></ul><p>A new config option has been added to enable libreswan features that are not made available as first class configuration.</p><ul><li><strong>PLUGIN-1591</strong> Add cpu, memory, and  status tracking for ipsec services.</li></ul><p>The system will now track the cpu, memory and usage information for various IPSec client related processes.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-3">Issues Fixed<a href="#issues-fixed-3" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><p><strong>PLUGIN-1628</strong> Incorrect network-script path was being used in the auto generated device-interface configuration</p><p><em><strong>Resolution</strong></em> The auto configuration was updated to use the correct script path.</p></li><li><p><strong>PLUGIN-1610</strong> The IPSec environment setup can fail on first time plugin install</p><p><em><strong>Resolution</strong></em> The salt states were improved to have better interdependencies to avoid the first time boot failure.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-320">Release 3.2.0<a href="#release-320" class="hash-link" aria-label="Direct link to Release 3.2.0" title="Direct link to Release 3.2.0">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-features-and-improvements-3">New Features and Improvements<a href="#new-features-and-improvements-3" class="hash-link" aria-label="Direct link to New Features and Improvements" title="Direct link to New Features and Improvements">​</a></h4><ul><li><strong>PLUGIN-1509</strong> Ability to configure tunnel monitors</li></ul><p>The feature adds support for configuring tunnel monitors using ping. See <a href="#tunnel-monitoring">the tunnel monitoring section</a> for more details.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-4">Issues Fixed<a href="#issues-fixed-4" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><p><strong>PLUGIN-1389</strong> Corrupt encryption database caused tunnels to not come up.</p><p><em><strong>Resolution</strong></em> The service on the router will clean up these database files on startup.</p></li><li><p><strong>PLUGIN-1467</strong> Configuring <code>aes_gcm256</code> for <code>phase2-encryption</code> resulted in invalid libreswan configuration.</p><p><em><strong>Resolution</strong></em> The libreswan config generation will generate valid configuration for <code>aes_gcm256</code>.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-313">Release 3.1.3<a href="#release-313" class="hash-link" aria-label="Direct link to Release 3.1.3" title="Direct link to Release 3.1.3">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-5">Issues Fixed<a href="#issues-fixed-5" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><p><strong>PLUGIN-1480</strong> IPSec tunnels were removed from all previously configured routers after config commit</p><p><em><strong>Resolution:</strong></em> The config generation logic for the plugin will handle config with long lines correctly</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-220-310">Release 2.2.0, 3.1.0<a href="#release-220-310" class="hash-link" aria-label="Direct link to Release 2.2.0, 3.1.0" title="Direct link to Release 2.2.0, 3.1.0">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-features-and-improvements-4">New Features and Improvements<a href="#new-features-and-improvements-4" class="hash-link" aria-label="Direct link to New Features and Improvements" title="Direct link to New Features and Improvements">​</a></h4><ul><li><strong>PLUGIN-1289</strong> Ability to provision custom MSS on the remote tunnel interfaces</li></ul><p>The feature adds support for configuring a custom MSS value on the remote IPSec tunnel interface. The new configuration can be found under <code>router &gt; node &gt; ipsec-client &gt; remote &gt; enforced-mss</code>. The configuration follows the same format as the <a href="/docs/config_reference_guide#network-interface">network-interface &gt; enforced-mss</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-107-207-210-302">Release 1.0.7, 2.0.7, 2.1.0, 3.0.2<a href="#release-107-207-210-302" class="hash-link" aria-label="Direct link to Release 1.0.7, 2.0.7, 2.1.0, 3.0.2" title="Direct link to Release 1.0.7, 2.0.7, 2.1.0, 3.0.2">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-6">Issues Fixed<a href="#issues-fixed-6" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><p><strong>PLUGIN-1092</strong> IPSec left and right subnet configuration does not always work correctly</p><p><em><strong>Resolution:</strong></em> The non-default left and right subnet configuration is correctly translated to corresponding libreswan configuration.</p></li><li><p><strong>PLUGIN-1103</strong> IPSec remote host does not appear as link on the GUI</p><p><em><strong>Resolution:</strong></em> The GUI presentation model was updated to include the missing key field.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-301">Release 3.0.1<a href="#release-301" class="hash-link" aria-label="Direct link to Release 3.0.1" title="Direct link to Release 3.0.1">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-7">Issues Fixed<a href="#issues-fixed-7" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><strong>PLUGIN-1092</strong> Added fix for local and remote subnet configuration option to allow a single value or a list of values.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-300">Release 3.0.0<a href="#release-300" class="hash-link" aria-label="Direct link to Release 3.0.0" title="Direct link to Release 3.0.0">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-8">Issues Fixed<a href="#issues-fixed-8" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><strong>PLUGIN-768</strong> Support the IPSec client plugin in SSR versions <code>5.1.0</code> and greater.</li><li><strong>PLUGIN-611</strong> Added support for plugin state. Plugin state information can be accessed on the PCLI using <code>show plugins state [router &lt;router&gt;] [node &lt;node&gt;] [{detail | summmary}] 128T-ipsec-client</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-106-206">Release 1.0.6, 2.0.6<a href="#release-106-206" class="hash-link" aria-label="Direct link to Release 1.0.6, 2.0.6" title="Direct link to Release 1.0.6, 2.0.6">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-9">Issues Fixed<a href="#issues-fixed-9" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><strong>PLUGIN-1057</strong> Ensure all critical IPsec client directories are created during installation of the plugin.</li><li><strong>PLUGIN-1053</strong> Added an inactive IPsec client plugin state to allow seamless migration from zscaler. The inactive state is achieved by excluding <code>ipsec-client</code> from the configuration.</li><li><strong>PLUGIN-1046</strong> Provide IPsec client auto-upgrade capability while crossing the SSR version <code>4.3.0</code> boundary.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-105-205">Release 1.0.5, 2.0.5<a href="#release-105-205" class="hash-link" aria-label="Direct link to Release 1.0.5, 2.0.5" title="Direct link to Release 1.0.5, 2.0.5">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-10">Issues Fixed<a href="#issues-fixed-10" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><strong>PLUGIN-994</strong> The <code>ipsec-client &gt; remote-id</code> configuration is not being used correctly when generating the libreswan config.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-104-204">Release 1.0.4, 2.0.4<a href="#release-104-204" class="hash-link" aria-label="Direct link to Release 1.0.4, 2.0.4" title="Direct link to Release 1.0.4, 2.0.4">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-11">Issues Fixed<a href="#issues-fixed-11" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><strong>PLUGIN-384</strong> Added an MTU configuration option to the ipsec profile.</li><li><strong>PLUGIN-333</strong> The <code>plugin-network</code> ip prefix setting in the configuration was ignored and would instead use the default ip prefix setting.</li><li><strong>PLUGIN-336</strong> Using the <code>vector-name</code> configuration option would generate invalid configuration.</li><li><strong>PLUGIN-400</strong> Added a local subnet configuration option and enhanced the remote subnet configuration option to allow a list of values.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="release-101-201">Release 1.0.1, 2.0.1<a href="#release-101-201" class="hash-link" aria-label="Direct link to Release 1.0.1, 2.0.1" title="Direct link to Release 1.0.1, 2.0.1">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="issues-fixed-12">Issues Fixed<a href="#issues-fixed-12" class="hash-link" aria-label="Direct link to Issues Fixed" title="Direct link to Issues Fixed">​</a></h4><ul><li><strong>PLUGIN-47</strong> Created generic IPsec client plugin to provide connectivity to remote ipsec endpoints. This version supports a single client with up to two remote endpoints.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-03-17T23:07:06.000Z">Mar 17, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/plugin_icmp_reachability_detection"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ICMP Reachability Detection</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/plugin_loopback_static_routes"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Loopback Static Routes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#profiles" class="table-of-contents__link toc-highlight">Profiles</a></li><li><a href="#clients" class="table-of-contents__link toc-highlight">Clients</a></li><li><a href="#tunnel-monitoring" class="table-of-contents__link toc-highlight">Tunnel Monitoring</a></li><li><a href="#configuring-services-for-tunnel-traffic" class="table-of-contents__link toc-highlight">Configuring services for tunnel traffic</a></li><li><a href="#directing-traffic-through-the-tunnel" class="table-of-contents__link toc-highlight">Directing traffic through the tunnel</a></li><li><a href="#redundancy" class="table-of-contents__link toc-highlight">Redundancy</a></li></ul></li><li><a href="#thirdparty-software--licenses" class="table-of-contents__link toc-highlight">Thirdparty Software &amp; Licenses</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#data-model" class="table-of-contents__link toc-highlight">Data Model</a></li><li><a href="#logging" class="table-of-contents__link toc-highlight">Logging</a></li><li><a href="#salt" class="table-of-contents__link toc-highlight">Salt</a></li><li><a href="#pcli-enhancements" class="table-of-contents__link toc-highlight">PCLI Enhancements</a></li><li><a href="#metrics" class="table-of-contents__link toc-highlight">Metrics</a></li><li><a href="#commands" class="table-of-contents__link toc-highlight">Commands</a></li><li><a href="#systemd-services" class="table-of-contents__link toc-highlight">Systemd Services</a></li><li><a href="#failover-alarms" class="table-of-contents__link toc-highlight">Failover Alarms</a></li></ul></li><li><a href="#appendix" class="table-of-contents__link toc-highlight">Appendix</a><ul><li><a href="#generated-ssr-configuration" class="table-of-contents__link toc-highlight">Generated SSR Configuration</a></li><li><a href="#user-specific-ssr-configuration" class="table-of-contents__link toc-highlight">User-Specific SSR Configuration</a></li><li><a href="#complete-example-configuration" class="table-of-contents__link toc-highlight">Complete Example Configuration</a></li></ul></li><li><a href="#release-notes" class="table-of-contents__link toc-highlight">Release Notes</a><ul><li><a href="#release-350" class="table-of-contents__link toc-highlight">Release 3.5.0</a></li><li><a href="#release-340" class="table-of-contents__link toc-highlight">Release 3.4.0</a></li><li><a href="#release-331" class="table-of-contents__link toc-highlight">Release 3.3.1</a></li><li><a href="#release-330" class="table-of-contents__link toc-highlight">Release 3.3.0</a></li><li><a href="#release-320" class="table-of-contents__link toc-highlight">Release 3.2.0</a></li><li><a href="#release-313" class="table-of-contents__link toc-highlight">Release 3.1.3</a></li><li><a href="#release-220-310" class="table-of-contents__link toc-highlight">Release 2.2.0, 3.1.0</a></li><li><a href="#release-107-207-210-302" class="table-of-contents__link toc-highlight">Release 1.0.7, 2.0.7, 2.1.0, 3.0.2</a></li><li><a href="#release-301" class="table-of-contents__link toc-highlight">Release 3.0.1</a></li><li><a href="#release-300" class="table-of-contents__link toc-highlight">Release 3.0.0</a></li><li><a href="#release-106-206" class="table-of-contents__link toc-highlight">Release 1.0.6, 2.0.6</a></li><li><a href="#release-105-205" class="table-of-contents__link toc-highlight">Release 1.0.5, 2.0.5</a></li><li><a href="#release-104-204" class="table-of-contents__link toc-highlight">Release 1.0.4, 2.0.4</a></li><li><a href="#release-101-201" class="table-of-contents__link toc-highlight">Release 1.0.1, 2.0.1</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Juniper Networks, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.87dc5d2a.js"></script>
<script src="/assets/js/main.3b0d8498.js"></script>
</body>
</html>